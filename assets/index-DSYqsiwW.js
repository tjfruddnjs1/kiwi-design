import{r as o,c as mm,R as Ct,u as al,f as nu,e as $p,g as fm,h as ym,L as gc,O as au,N as rc,i as jm,j as Dr,B as bm}from"./react-vendor-3o_L2hvS.js";import{j as Uo,a as iu,A as Op}from"./utils-vendor-D2e37WGr.js";import{s as f,R as el,B,T as we,C as ie,S as $e,P as qt,a as Ie,b as g,c as Ze,d as Es,e as Tr,f as il,g as T,h as Dp,i as _t,j as Pt,k as wr,l as _m,m as Da,n as _s,o as Ke,p as Y,I as ue,q as Ks,r as Pa,t as dr,u as fa,v as xc,E as Je,w as Fp,x as nr,y as wm,F as wt,M as rt,z as ps,A as xe,D as H,G as mn,H as Sm,J as Ee,K as rr,L as gt,N as ii,O as zs,Q as xs,U as xt,V as Up,W as Cn,X as ya,Y as gs,Z as ur,_ as Se,$ as Bs,a0 as xo,a1 as mc,a2 as ou,a3 as fc,a4 as lu,a5 as Fi,a6 as Kt,a7 as $a,a8 as Un,a9 as Qn,aa as Hp,ab as Zc,ac as ar,ad as Md,ae as at,af as Yt,ag as za,ah as cu,ai as Vp,aj as rn,ak as du,al as uu,am as qp,an as xa,ao as vm,ap as ln,aq as Qr,ar as km,as as Cm,at as yc,au as xn,av as Im,aw as Tm,ax as hr,ay as aa,az as Ui,aA as Ea,aB as Vr,aC as Rm,aD as Fr,aE as zm,aF as mo,aG as Wo,aH as So,aI as Zr,aJ as pr,aK as In,aL as Em,aM as hu,aN as jc,aO as Gu,aP as Pm,aQ as Mm,aR as Lm,aS as Am,aT as Ko,aU as Nm,aV as Gp,aW as Bm,aX as Yo,aY as Wp,aZ as Ld,a_ as Kp,a$ as $m,b0 as fo,b1 as Ad,b2 as Yp,b3 as pu,b4 as Jp,b5 as Zp,b6 as Om,b7 as si,b8 as nc,b9 as Jn,ba as Wu,bb as Ku,bc as Dm,bd as ni,be as ai,bf as Qp,bg as Fm,bh as Yu,bi as Xp,bj as Nd,bk as Bd,bl as $d,bm as Um,bn as bc,bo as bi,bp as eg,bq as Od,br as Ju,bs as Hm,bt as Jo,bu as Qc,bv as Vm,bw as tg,bx as Zu,by as Xc,bz as Qu,bA as qm,bB as Gm,bC as Gn,bD as Xu}from"./antd-vendor-Bx6BiF_3.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var sg={exports:{}},_c={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wm=o,Km=Symbol.for("react.element"),Ym=Symbol.for("react.fragment"),Jm=Object.prototype.hasOwnProperty,Zm=Wm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qm={key:!0,ref:!0,__self:!0,__source:!0};function rg(s,t,r){var n,a={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)Jm.call(t,n)&&!Qm.hasOwnProperty(n)&&(a[n]=t[n]);if(s&&s.defaultProps)for(n in t=s.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Km,type:s,key:i,ref:l,props:a,_owner:Zm.current}}_c.Fragment=Ym;_c.jsx=rg;_c.jsxs=rg;sg.exports=_c;var e=sg.exports,Dd={},eh=mm;Dd.createRoot=eh.createRoot,Dd.hydrateRoot=eh.hydrateRoot;var ng=(s=>(s[s.DEBUG=0]="DEBUG",s[s.INFO=1]="INFO",s[s.WARN=2]="WARN",s[s.ERROR=3]="ERROR",s[s.FATAL=4]="FATAL",s))(ng||{});class Xm{constructor(){this.timers=new Map,this.isDevelopment=!1,this.minLevel=this.isDevelopment?0:1,this.sessionId=this.generateSessionId()}generateSessionId(){return`${Date.now()}-${Math.random().toString(36).substring(2,15)}`}setUserId(t){this.userId=t}setMinLevel(t){this.minLevel=t}shouldLog(t){return t>=this.minLevel}formatMessage(t){const r=ng[t.level],n=t.timestamp,a=t.component?`[${t.component}]`:"",i=t.action?`(${t.action})`:"";return`${n} ${r} ${a}${i} ${t.message}`}createLogEntry(t,r,n,a,i,l){const d={timestamp:new Date().toISOString(),level:t,message:r,sessionId:this.sessionId};return n&&(d.context=n),a&&(d.error=a),this.userId&&(d.userId=this.userId),i&&(d.component=i),l&&(d.action=l),d}log(t){if(!this.shouldLog(t.level))return;const r=this.formatMessage(t);if(this.isDevelopment){const n=this.getConsoleMethod(t.level);t.context||t.error?(console.group(r),t.context&&console.table(t.context),t.error&&(console.error("Error Details:",t.error),t.error.stack&&console.trace("Stack Trace:",t.error.stack)),console.groupEnd()):n(r)}}getConsoleMethod(t){switch(t){case 0:return console.debug;case 1:return console.info;case 2:return console.warn;case 3:case 4:return console.error}}debug(t,r,n,a){const i=this.createLogEntry(0,t,r,void 0,n,a);this.log(i)}info(t,r,n,a){const i=this.createLogEntry(1,t,r,void 0,n,a);this.log(i)}warn(t,r,n,a){const i=this.createLogEntry(2,t,r,void 0,n,a);this.log(i)}error(t,r,n,a,i){const l=this.createLogEntry(3,t,n,r,a,i);this.log(l)}fatal(t,r,n,a,i){const l=this.createLogEntry(4,t,n,r,a,i);this.log(l)}startTimer(t){this.timers.set(t,performance.now())}endTimer(t,r){const n=this.timers.get(t);if(n===void 0){this.warn(`Timer '${t}' was not started`);return}const a=performance.now()-n;this.timers.delete(t),this.debug(r||`Timer '${t}' completed`,{timer:t,duration:`${a.toFixed(2)}ms`})}logApiCall(t,r,n,a,i,l,d){const c={method:t,url:r,status:n,duration:`${a.toFixed(2)}ms`,requestData:this.isDevelopment?l:void 0,responseData:this.isDevelopment?d:void 0};n>=400?this.error(`API call failed: ${t} ${r}`,i,c,"API"):n>=300?this.warn(`API call redirected: ${t} ${r}`,c,"API"):this.info(`API call success: ${t} ${r}`,c,"API")}logUserAction(t,r,n){this.info(`User action: ${t}`,n,r,t)}logComponentError(t,r,n){this.error(`Component error in ${n}`,t,{componentStack:r.componentStack,errorBoundary:n},n,"render")}}const O=new Xm,ef=5*60*1e3,th=1*60*1e3,tf=30*1e3;function sh(s){return typeof s=="object"&&s!==null&&typeof s.email=="string"&&typeof s.exp=="number"}const ag=o.createContext(void 0),sf=({children:s})=>{const[t,r]=o.useState(!1),[n,a]=o.useState(null),[i,l]=o.useState(!0),[d,c]=o.useState(null),p=o.useRef(null),h=o.useRef(!1),x=o.useCallback(async()=>{if(!d||!t)return;const E=Date.now(),P=d-E;if(P<=0){O.warn("í† í°ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìë™ ë¡œê·¸ì•„ì›ƒí•©ë‹ˆë‹¤."),f.warning("ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”."),localStorage.removeItem("authToken"),localStorage.removeItem("authUser"),r(!1),a(null),c(null),window.location.href="/login";return}P<=th&&!h.current&&(h.current=!0,f.warning("ì„¸ì…˜ì´ ê³§ ë§Œë£Œë©ë‹ˆë‹¤. ì‘ì—…ì„ ì €ì¥í•´ì£¼ì„¸ìš”."),O.warn("í† í° ë§Œë£Œ 1ë¶„ ì „ ê²½ê³ ",{expiresAt:new Date(d).toISOString(),timeRemaining:`${Math.floor(P/1e3)}ì´ˆ`})),P<=ef&&P>th&&(O.info("í† í° ë§Œë£Œ ì„ë°•. ìë™ ê°±ì‹  ì‹œë„ ì¤‘..."),await _()?(h.current=!1,O.info("í† í°ì´ ìë™ìœ¼ë¡œ ê°±ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤.")):O.warn("í† í° ìë™ ê°±ì‹  ì‹¤íŒ¨. ë§Œë£Œ ì‹œ ë¡œê·¸ì•„ì›ƒë©ë‹ˆë‹¤."))},[d,t]),_=async()=>{var E;try{const P=localStorage.getItem("authToken");if(!P)return!1;const I=await fetch("/api/v1/auth/refresh",{method:"POST",headers:{Authorization:`Bearer ${P}`,"Content-Type":"application/json"}}),$=await I.json();if(!I.ok||!$.success)return!1;const y=$.data.token,v=$.data.user;localStorage.setItem("authToken",y);const u=Uo(y);if(c(u.exp*1e3),v){const m={id:v.id,email:v.email,permissions:v.permissions||[],role:v.role,organization_id:(E=v.organization_id)!=null?E:null,awx_inventory:v.awxInventory||u.awx_inventory||0,awx_template:v.awxTemplate||u.awx_template||0};a(m),localStorage.setItem("authUser",JSON.stringify(m))}return!0}catch(P){return!1}};o.useEffect(()=>{if(!t||!d){p.current&&(clearInterval(p.current),p.current=null);return}return x(),p.current=setInterval(()=>{x()},tf),()=>{p.current&&(clearInterval(p.current),p.current=null)}},[t,d,x]),o.useEffect(()=>{const E=()=>{document.visibilityState==="visible"&&t&&x()};return document.addEventListener("visibilitychange",E),()=>{document.removeEventListener("visibilitychange",E)}},[t,x]),o.useEffect(()=>{(async()=>{var $,y,v,u;const P=localStorage.getItem("authToken"),I=localStorage.getItem("authUser");if(P)try{const m=Uo(P);if(!sh(m))throw new Error("Invalid token structure");if(m.exp*1e3>Date.now())if(r(!0),c(m.exp*1e3),I)try{const j=JSON.parse(I),b={...j,role:($=m.role)!=null?$:j.role,organization_id:(y=m.organization_id)!=null?y:j.organization_id,permissions:j.permissions||m.permissions||[]};a(b);try{localStorage.setItem("authUser",JSON.stringify(b))}catch(A){}}catch(j){a({id:typeof m.user_id=="number"?m.user_id:parseInt(String(m.user_id)||"0"),email:m.email,permissions:m.permissions||[],role:m.role,organization_id:(v=m.organization_id)!=null?v:null,awx_inventory:m.awx_inventory||0,awx_template:m.awx_template||0})}else a({id:typeof m.user_id=="number"?m.user_id:parseInt(String(m.user_id)||"0"),email:m.email,permissions:m.permissions||[],role:m.role,organization_id:(u=m.organization_id)!=null?u:null,awx_inventory:m.awx_inventory||0,awx_template:m.awx_template||0});else localStorage.removeItem("authToken"),localStorage.removeItem("authUser"),O.error("Token expired",new Error("JWT token has expired"))}catch(m){O.error("Invalid token",m),localStorage.removeItem("authToken"),localStorage.removeItem("authUser")}l(!1)})()},[]);const S=(E,P)=>{var I,$,y,v,u;try{O.info("ğŸ” Starting login process"),localStorage.setItem("authToken",E);const m=Uo(E);if(O.info("ğŸ” Token decoded successfully",{email:m.email,hasPermissions:!!m.permissions,permissionCount:((I=m.permissions)==null?void 0:I.length)||0,exp:new Date(m.exp*1e3).toISOString()}),c(m.exp*1e3),P&&typeof P=="object"){const j=P;r(!0),a({id:j.id,email:j.email,permissions:j.permissions||m.permissions||[],role:j.role,organization_id:($=j.organization_id)!=null?$:null,awx_inventory:j.awxInventory||m.awx_inventory||0,awx_template:j.awxTemplate||m.awx_template||0});try{localStorage.setItem("authUser",JSON.stringify({id:j.id,email:j.email,permissions:j.permissions||m.permissions||[],role:j.role,organization_id:(y=j.organization_id)!=null?y:null,awx_inventory:j.awxInventory||m.awx_inventory||0,awx_template:j.awxTemplate||m.awx_template||0}))}catch(b){O.error("Failed to store authUser",b)}}else{if(!sh(m))throw new Error("Invalid token structure");const j=m.permissions||[];O.info(" User permissions loaded",{permissions:j}),r(!0),a({id:typeof m.user_id=="number"?m.user_id:parseInt(String(m.user_id)||"0"),email:m.email,permissions:j,role:m.role,organization_id:(v=m.organization_id)!=null?v:null,awx_inventory:m.awx_inventory||0,awx_template:m.awx_template||0});try{localStorage.setItem("authUser",JSON.stringify({id:typeof m.user_id=="number"?m.user_id:parseInt(String(m.user_id)||"0"),email:m.email,permissions:j,role:m.role,organization_id:(u=m.organization_id)!=null?u:null,awx_inventory:m.awx_inventory||0,awx_template:m.awx_template||0}))}catch(b){O.error("Failed to store authUser",b)}}O.info("ğŸ‰ Login process completed successfully")}catch(m){throw O.error(" Login failed: Invalid token",m),localStorage.removeItem("authToken"),m}},L=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("authUser"),r(!1),a(null),c(null),window.location.href="/login"},k=async()=>{var E;try{const P=localStorage.getItem("authToken");if(!P)return O.error("í† í° ê°±ì‹  ì‹¤íŒ¨: í˜„ì¬ í† í°ì´ ì—†ìŠµë‹ˆë‹¤."),!1;const I=await fetch("/api/v1/auth/refresh",{method:"POST",headers:{Authorization:`Bearer ${P}`,"Content-Type":"application/json"}}),$=await I.json();if(!I.ok||!$.success)return O.error("í† í° ê°±ì‹  ì‹¤íŒ¨:",$.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"),!1;const y=$.data.token,v=$.data.user;localStorage.setItem("authToken",y);const u=Uo(y);if(c(u.exp*1e3),v){const m={id:v.id,email:v.email,permissions:v.permissions||[],role:v.role,organization_id:(E=v.organization_id)!=null?E:null,awx_inventory:v.awxInventory||u.awx_inventory||0,awx_template:v.awxTemplate||u.awx_template||0};a(m),localStorage.setItem("authUser",JSON.stringify(m))}return O.info(" í† í°ì´ ì„±ê³µì ìœ¼ë¡œ ê°±ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤.",{newExp:new Date(u.exp*1e3).toISOString()}),!0}catch(P){return O.error("í† í° ê°±ì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ:",P),!1}};return e.jsx(ag.Provider,{value:{isAuthenticated:t,isLoading:i,user:n,tokenExpiresAt:d,login:S,logout:L,refreshToken:k},children:s})},Tn=()=>{const s=o.useContext(ag);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},ed={DELETE:"service:delete",DEPLOY_ROLLBACK:"service:deploy:rollback",OPERATE_EXEC:"service:operate:exec"},rh={DELETE:"infra:delete",K8S_MANAGE:"infra:k8s:manage"},nh={DELETE:"backup:delete",RESTORE:"backup:restore"},ah={DELETE:"database:delete",MIGRATE_EXECUTE:"database:migrate:execute"},ih=[ed.DELETE,ed.DEPLOY_ROLLBACK,ed.OPERATE_EXEC,rh.DELETE,rh.K8S_MANAGE,nh.DELETE,nh.RESTORE,ah.DELETE,ah.MIGRATE_EXECUTE],Gl={service:"ì„œë¹„ìŠ¤ ê´€ë¦¬",infra:"ëŸ°íƒ€ì„ í™˜ê²½",backup:"ë°±ì—… ê´€ë¦¬",device:"ì¥ë¹„ ê´€ë¦¬",database:"ë°ì´í„°ë² ì´ìŠ¤"},ig={low:"ë‚®ìŒ",medium:"ë³´í†µ",high:"ë†’ìŒ",critical:"ë§¤ìš° ë†’ìŒ"},og={low:"green",medium:"orange",high:"red",critical:"magenta"},rf={view:"ì¡°íšŒ",create:"ìƒì„±",update:"ìˆ˜ì •",delete:"ì‚­ì œ",build:"ë¹Œë“œ",deploy:"ë°°í¬",operate:"ìš´ì˜",security:"ë³´ì•ˆ ìŠ¤ìº”",k8s:"Kubernetes",docker:"Docker",nginx:"Nginx",storage:"ìŠ¤í† ë¦¬ì§€",restore:"ë³µêµ¬",download:"ë‹¤ìš´ë¡œë“œ",test:"ì—°ê²° í…ŒìŠ¤íŠ¸",sync:"ë™ê¸°í™”",migrate:"ë§ˆì´ê·¸ë ˆì´ì…˜"};var gu={};let Fd=class extends Error{constructor(t,r,n,a,i,l){super(t),this.name="ApiError",this.statusCode=r,this.apiError=n,this.originalError=a,this.response=a.response,this.requestUrl=i,this.requestAction=l}};class wc{constructor(t){this.config={timeout:3e5,showErrorMessages:!0,enableRetry:!0,maxRetries:3,...t},this.instance=iu.create({baseURL:this.config.baseURL,timeout:this.config.timeout,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}setupInterceptors(){this.instance.interceptors.request.use(t=>{const r=localStorage.getItem("authToken");return r&&t.headers&&(t.headers.Authorization=`Bearer ${r}`),t},t=>(O.error("Request interceptor error:",t),Promise.reject(t))),this.instance.interceptors.response.use(t=>{if(t.data&&!t.data.success&&t.data.error){const r=new Fd(t.data.error,t.status,t.data.error,new Op(t.data.error,"API_ERROR",t.config,void 0,t),t.config.url);return Promise.reject(r)}return t},t=>this.handleResponseError(t))}async handleResponseError(t){var l,d;let r="ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",n=0,a="";if(t.response){n=t.response.status;const c=t.response.data;c!=null&&c.error?(a=c.error,r=c.error):r=this.getDefaultErrorMessage(n),this.handleSpecialCases(n,c)}else t.request?(r="ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",O.error("Network error - no response received:",new Error(String(t.request)))):(r=t.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",O.error("Request configuration error:",new Error(t.message||"Unknown error")));if(n===404&&(r.includes("íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")||r.includes("í•´ë‹¹ íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")),this.config.enableRetry&&this.shouldRetry(t))return this.retryRequest(t);const i=new Fd(r,n,a,t,(l=t.config)==null?void 0:l.url);throw O.error("API Error:",new Error(JSON.stringify({message:r,statusCode:n,url:(d=t.config)==null?void 0:d.url,apiError:a}))),i}getDefaultErrorMessage(t){return{400:"ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤.",401:"ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.",403:"ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. (ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ì˜ Network íƒ­ì„ í™•ì¸í•˜ì„¸ìš”)",404:"ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",422:"ìš”ì²­ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.",429:"ë„ˆë¬´ ë§ì€ ìš”ì²­ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",500:"ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",502:"ê²Œì´íŠ¸ì›¨ì´ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",503:"ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",504:"ê²Œì´íŠ¸ì›¨ì´ íƒ€ì„ì•„ì›ƒì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}[t]||`ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (${t})`}handleSpecialCases(t,r){if(t===401){const n=(r==null?void 0:r.error)&&(r.error.includes("GitLab")||r.error.includes("í† í°")||r.error.includes("token")),a=(r==null?void 0:r.data)&&typeof r.data=="object"&&"requires_ssh_credentials"in r.data&&r.data.requires_ssh_credentials===!0;!n&&!a&&(localStorage.removeItem("authToken"),window.location.href="/login");return}if(t===403&&r&&"expiry_date"in r){const n=r,a=new CustomEvent("licenseExpired",{detail:{expiryDate:n.expiry_date,message:r.error}});window.dispatchEvent(a)}}shouldRetry(t){const r=[408,429,500,502,503,504];return!!(t.response&&r.includes(t.response.status))}async retryRequest(t){const r=t.config;if(!r||r.__retryCount>=this.config.maxRetries)throw t;r.__retryCount=(r.__retryCount||0)+1;const n=Math.min(1e3*Math.pow(2,r.__retryCount-1),5e3);return await new Promise(a=>setTimeout(a,n)),O.info(`Retrying request (${r.__retryCount}/${this.config.maxRetries}):`,{url:r.url}),this.instance.request(r)}async get(t,r){return(await this.instance.get(t,r)).data}async post(t,r,n){return(await this.instance.post(t,r,n)).data}async put(t,r,n){return(await this.instance.put(t,r,n)).data}async patch(t,r,n){return(await this.instance.patch(t,r,n)).data}async delete(t,r){return(await this.instance.delete(t,r)).data}async request(t,r,n,a){const{showSuccessMessage:i=!1,successMessage:l,...d}=a||{};return await this.post(t,{action:r,parameters:n},d)}kubernetes(t,r,n){return this.request("/kubernetes",t,r,n)}pipeline(t,r,n){return this.request("/pipeline",t,r,n)}docker(t,r,n){return this.request("/docker",t,r,n)}infra(t,r,n){return this.request("/infra",t,r,n)}service(t,r,n){return this.request("/service",t,r,n)}backup(t,r,n){return this.request("/backup",t,r,n)}git(t,r,n){return this.request("/git-stats",t,r,n)}async upload(t,r,n,a){const i=new FormData;i.append("file",r);const l={...a,headers:{...a==null?void 0:a.headers,"Content-Type":"multipart/form-data"},onUploadProgress:c=>{if(n&&c.total){const p=Math.round(c.loaded*100/c.total);n(p)}}};return(await this.instance.post(t,i,l)).data}createAbortController(){return new AbortController}async checkHealth(){return this.get("/status")}getAxiosInstance(){return this.instance}}const ee=new wc({baseURL:gu.REACT_APP_API_BASE_URL||"/api/v1",timeout:0,showErrorMessages:!0,enableRetry:!0,maxRetries:3}),Wl=new wc({baseURL:gu.REACT_APP_API_BASE_URL||"/api/v1",timeout:0,showErrorMessages:!0,enableRetry:!1,maxRetries:0});new wc({baseURL:gu.REACT_APP_API_BASE_URL||"/api/v1",timeout:0,showErrorMessages:!1,enableRetry:!1,maxRetries:0});const nf=Object.freeze(Object.defineProperty({__proto__:null,ApiError:Fd,UnifiedApiClient:wc,apiClient:ee,awxApiClient:Wl,default:ee},Symbol.toStringTag,{value:"Module"})),$i={getAllPermissions:async()=>{try{const s=await ee.get("/permissions");return{success:s.success,data:s.data,error:s.error}}catch(s){return console.error("Failed to get all permissions:",s),{success:!1,error:"Failed to fetch permissions"}}},getPermissionsByCategory:async s=>{try{const t=await ee.get(`/permissions/category/${s}`);return{success:t.success,data:t.data,error:t.error}}catch(t){return console.error("Failed to get permissions by category:",t),{success:!1,error:"Failed to fetch permissions"}}},getMyPermissions:async()=>{try{const s=await ee.get("/permissions/me");return{success:s.success,data:s.data,error:s.error}}catch(s){return console.error("Failed to get my permissions:",s),{success:!1,error:"Failed to fetch my permissions"}}},checkPermission:async s=>{var t,r;try{const n=await ee.get(`/permissions/check?code=${encodeURIComponent(s)}`);return{success:n.success,has_permission:(t=n.data)==null?void 0:t.has_permission,permission:(r=n.data)==null?void 0:r.permission}}catch(n){return console.error("Failed to check permission:",n),{success:!1,error:"Failed to check permission"}}},getUserPermissions:async s=>{try{const t=await ee.get(`/permissions/users/${s}`);return{success:t.success,data:t.data,error:t.error}}catch(t){return console.error("Failed to get user permissions:",t),{success:!1,error:"Failed to fetch user permissions"}}},grantUserPermission:async(s,t)=>{var r;try{const n=await ee.post(`/permissions/users/${s}/grant`,t);return{success:n.success,message:(r=n.data)==null?void 0:r.message,error:n.error}}catch(n){return console.error("Failed to grant permission:",n),{success:!1,error:"Failed to grant permission"}}},revokeUserPermission:async(s,t)=>{var r;try{const n=await ee.post(`/permissions/users/${s}/revoke`,t);return{success:n.success,message:(r=n.data)==null?void 0:r.message,error:n.error}}catch(n){return console.error("Failed to revoke permission:",n),{success:!1,error:"Failed to revoke permission"}}},grantServicePermission:async(s,t,r)=>{var n;try{const a=await ee.post(`/permissions/services/${s}/users/${t}/grant`,r);return{success:a.success,message:(n=a.data)==null?void 0:n.message,error:a.error}}catch(a){return console.error("Failed to grant service permission:",a),{success:!1,error:"Failed to grant service permission"}}}},af={hasPermission:()=>!1,hasAnyPermission:()=>!1,hasAllPermissions:()=>!1,isOwner:!1,isManager:!1,isMember:!1,isOwnerOrManager:!1,permissions:[],role:"",allPermissionDefinitions:[],groupedPermissions:{},isHighRiskPermission:()=>!1,refreshPermissions:async()=>{},isLoading:!1},lg=o.createContext(af),of=({children:s})=>{const{user:t,isAuthenticated:r}=Tn(),[n,a]=o.useState([]),[i,l]=o.useState([]),[d,c]=o.useState({}),[p,h]=o.useState(!1),x=(t==null?void 0:t.role)||"",_=x==="Owner",S=x==="Manager",L=x==="Member",k=_||S,E=o.useCallback(async()=>{if(!r){a([]);return}h(!0);try{const u=await $i.getMyPermissions();if(u.success&&u.data&&a(u.data.permissions||[]),k){const m=await $i.getAllPermissions();m.success&&m.data&&(l(m.data.permissions||[]),c(m.data.grouped||{}))}}catch(u){console.error("Failed to fetch permissions:",u)}finally{h(!1)}},[r,k]);o.useEffect(()=>{r?E():(a([]),l([]),c({}))},[r,E]);const P=o.useCallback(u=>_?!0:S?ih.includes(u)?n.includes(u):!0:n.includes(u),[_,S,n]),I=o.useCallback(u=>u.some(m=>P(m)),[P]),$=o.useCallback(u=>u.every(m=>P(m)),[P]),y=o.useCallback(u=>ih.includes(u),[]),v=o.useMemo(()=>({hasPermission:P,hasAnyPermission:I,hasAllPermissions:$,isOwner:_,isManager:S,isMember:L,isOwnerOrManager:k,permissions:n,role:x,allPermissionDefinitions:i,groupedPermissions:d,isHighRiskPermission:y,refreshPermissions:E,isLoading:p}),[P,I,$,_,S,L,k,n,x,i,d,y,E,p]);return e.jsx(lg.Provider,{value:v,children:s})},lf=()=>{const s=o.useContext(lg);if(!s)throw new Error("usePermission must be used within a PermissionProvider");return s};class cf extends o.Component{constructor(t){super(t),this.handleReload=()=>{this.setState({hasError:!1}),window.location.reload()},this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),O.error("ErrorBoundary caught an error",t,{errorDetails:t,errorInfo:r})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{style:{padding:"50px",textAlign:"center"},children:[e.jsx(el,{status:"error",title:"ì•±ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",subTitle:"ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",extra:[e.jsx(B,{type:"primary",onClick:this.handleReload,children:"í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨"},"reload"),e.jsx(B,{onClick:()=>window.history.back(),children:"ì´ì „ í˜ì´ì§€ë¡œ"},"back")]}),!1]}):this.props.children}}const df=async()=>{try{const s=await ee.post("/dashboard",{action:"get_summary",parameters:{}});if(!s||!s.success)throw new Error((s==null?void 0:s.error)||"ëŒ€ì‹œë³´ë“œ ìš”ì•½ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return s.data}catch(s){throw O.error("ëŒ€ì‹œë³´ë“œ ìš”ì•½ ì¡°íšŒ ì‹¤íŒ¨:",s),s}},cg=async(s={})=>{try{const t=await ee.post("/dashboard",{action:"get_dora_metrics",parameters:{scope_type:s.scope_type||"system",...s.service_id!==void 0&&{service_id:s.service_id},days:s.days||30}});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"DORA ë©”íŠ¸ë¦­ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error("DORA ë©”íŠ¸ë¦­ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},uf=async(s,t=30)=>cg({scope_type:"service",service_id:s,days:t}),hf=async(s={})=>{try{const t=await ee.post("/dashboard",{action:"get_dora_history",parameters:{scope_type:s.scope_type||"system",...s.service_id!==void 0&&{service_id:s.service_id},days:s.days||30}});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"DORA ì´ë ¥ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data||[]}catch(t){throw O.error("DORA ì´ë ¥ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},xu=async(s={})=>{try{const t=await ee.post("/dashboard",{action:"get_incidents",parameters:{status:s.status||"all",...s.service_id!==void 0&&{service_id:s.service_id},limit:s.limit||50}});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ì¥ì•  ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data||[]}catch(t){throw O.error("ì¥ì•  ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},pf=async(s=10)=>xu({status:"open",limit:s}),gf=async(s,t="all")=>xu({service_id:s,status:t}),xf=async s=>{try{if(!s.title)throw new Error("ì¥ì•  ì œëª©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");const t=await ee.post("/dashboard",{action:"create_incident",parameters:{title:s.title,severity:s.severity||"medium",...s.service_id!==void 0&&{service_id:s.service_id},...s.infra_id!==void 0&&{infra_id:s.infra_id},...s.description&&{description:s.description}}});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ì¥ì•  ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error("ì¥ì•  ë“±ë¡ ì‹¤íŒ¨:",t),t}},mf=async s=>{try{const t=await ee.post("/dashboard",{action:"resolve_incident",parameters:{id:s.id,...s.resolution_note&&{resolution_note:s.resolution_note}}});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ì¥ì•  í•´ê²° ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(t){throw O.error("ì¥ì•  í•´ê²° ì²˜ë¦¬ ì‹¤íŒ¨:",t),t}},ff=async s=>{try{const t=await ee.post("/dashboard",{action:"acknowledge_incident",parameters:{id:s.id}});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ì¥ì•  í™•ì¸ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(t){throw O.error("ì¥ì•  í™•ì¸ ì²˜ë¦¬ ì‹¤íŒ¨:",t),t}},Kl={getDashboardSummary:df,getDORAMetrics:cg,getServiceDORAMetrics:uf,getDORAHistory:hf,getIncidents:xu,getActiveIncidents:pf,getServiceIncidents:gf,createIncident:xf,resolveIncident:mf,acknowledgeIncident:ff},{Text:Dn}=we,Zn={xs:8,sm:16,md:24},Ir={success:"#52c41a",warning:"#faad14",error:"#ff4d4f",info:"#1890ff"},dg=o.memo(({data:s})=>{const t=s.total_devices>0?Math.round(s.online_devices/s.total_devices*100):0;return e.jsxs(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(il,{style:{color:Ir.info}}),e.jsx("span",{children:"ì¥ë¹„ ê´€ë¦¬"})]}),style:{height:"100%",borderRadius:8},children:[e.jsx($e,{title:"ì´ ì¥ë¹„",value:s.total_devices,suffix:"ëŒ€",valueStyle:{fontSize:"24px",fontWeight:600}}),e.jsx(qt,{percent:t,size:"small",strokeColor:t>=80?Ir.success:t>=50?Ir.warning:Ir.error,style:{marginTop:Zn.xs,marginBottom:Zn.xs}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[e.jsx(Ie,{title:"ì˜¨ë¼ì¸ ì¥ë¹„",children:e.jsxs(g,{size:4,children:[e.jsx(Ze,{style:{color:Ir.success}}),e.jsx(Dn,{type:"secondary",children:s.online_devices})]})}),e.jsx(Ie,{title:"ì˜¤í”„ë¼ì¸ ì¥ë¹„",children:e.jsxs(g,{size:4,children:[e.jsx(Es,{style:{color:Ir.error}}),e.jsx(Dn,{type:"secondary",children:s.offline_devices})]})}),e.jsx(Ie,{title:"ê²½ê³  ì¥ë¹„",children:e.jsxs(g,{size:4,children:[e.jsx(Tr,{style:{color:Ir.warning}}),e.jsx(Dn,{type:"secondary",children:s.warning_devices})]})})]})]})});dg.displayName="DeviceSummaryCard";const ug=o.memo(({data:s})=>(s.total_nodes>0&&Math.round(s.healthy_nodes/s.total_nodes*100),e.jsxs(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#722ed1"}}),e.jsx("span",{children:"ëŸ°íƒ€ì„ í™˜ê²½"})]}),style:{height:"100%",borderRadius:8},children:[e.jsx($e,{title:"ì¸í”„ë¼",value:s.total_infras,suffix:"ê°œ",valueStyle:{fontSize:"24px",fontWeight:600}}),e.jsx("div",{style:{marginTop:Zn.xs,marginBottom:Zn.xs},children:e.jsxs(g,{wrap:!0,size:4,children:[s.kubernetes_count>0&&e.jsxs(T,{color:"blue",icon:e.jsx(Dp,{}),children:["K8s: ",s.kubernetes_count]}),s.docker_count>0&&e.jsxs(T,{color:"cyan",icon:e.jsx(_t,{}),children:["Docker: ",s.docker_count]}),s.podman_count>0&&e.jsxs(T,{color:"purple",children:["Podman: ",s.podman_count]})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[e.jsxs(Dn,{type:"secondary",children:["ë…¸ë“œ: ",s.total_nodes,"ê°œ"]}),e.jsxs(g,{size:4,children:[e.jsx(Ze,{style:{color:Ir.success}}),e.jsxs(Dn,{type:"secondary",children:["ì •ìƒ: ",s.healthy_nodes]})]})]})]})));ug.displayName="RuntimeSummaryCard";const hg=o.memo(({data:s})=>{const t=s.total_backups>0?Math.round(s.successful_backups/s.total_backups*100):100,r=n=>{if(!n)return"-";try{return new Date(n).toLocaleString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(a){return n}};return e.jsxs(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(_m,{style:{color:"#13c2c2"}}),e.jsx("span",{children:"ë°±ì—… ê´€ë¦¬"})]}),style:{height:"100%",borderRadius:8},children:[e.jsx($e,{title:"ì´ ë°±ì—…",value:s.total_backups,suffix:"ê°œ",valueStyle:{fontSize:"24px",fontWeight:600}}),e.jsx(qt,{percent:t,size:"small",strokeColor:t>=90?Ir.success:t>=70?Ir.warning:Ir.error,style:{marginTop:Zn.xs,marginBottom:Zn.xs}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[e.jsx(Ie,{title:"ì„±ê³µ",children:e.jsxs(g,{size:4,children:[e.jsx(Ze,{style:{color:Ir.success}}),e.jsx(Dn,{type:"secondary",children:s.successful_backups})]})}),e.jsx(Ie,{title:"ì‹¤íŒ¨",children:e.jsxs(g,{size:4,children:[e.jsx(Es,{style:{color:Ir.error}}),e.jsx(Dn,{type:"secondary",children:s.failed_backups})]})}),e.jsx(Ie,{title:"ì§„í–‰ì¤‘",children:e.jsxs(g,{size:4,children:[e.jsx(Pt,{style:{color:Ir.info},spin:s.pending_backups>0}),e.jsx(Dn,{type:"secondary",children:s.pending_backups})]})})]}),s.last_backup_time&&e.jsx("div",{style:{marginTop:Zn.xs,fontSize:"11px"},children:e.jsxs(g,{size:4,children:[e.jsx(wr,{}),e.jsxs(Dn,{type:"secondary",children:["ë§ˆì§€ë§‰: ",r(s.last_backup_time)]})]})})]})});hg.displayName="BackupSummaryCard";const pg=o.memo(({data:s})=>{const t=s.total_services>0?Math.round(s.deployed_services/s.total_services*100):0;return e.jsxs(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(Da,{style:{color:"#eb2f96"}}),e.jsx("span",{children:"ì„œë¹„ìŠ¤ ê´€ë¦¬"})]}),style:{height:"100%",borderRadius:8},children:[e.jsx($e,{title:"ì´ ì„œë¹„ìŠ¤",value:s.total_services,suffix:"ê°œ",valueStyle:{fontSize:"24px",fontWeight:600}}),e.jsx(qt,{percent:t,size:"small",strokeColor:Ir.info,format:()=>`${t}% ë°°í¬ë¨`,style:{marginTop:Zn.xs,marginBottom:Zn.xs}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[e.jsx(Ie,{title:"ë°°í¬ë¨",children:e.jsxs(g,{size:4,children:[e.jsx(Ze,{style:{color:Ir.success}}),e.jsx(Dn,{type:"secondary",children:s.deployed_services})]})}),e.jsx(Ie,{title:"ëŒ€ê¸°ì¤‘",children:e.jsxs(g,{size:4,children:[e.jsx(wr,{style:{color:Ir.warning}}),e.jsx(Dn,{type:"secondary",children:s.pending_services})]})}),e.jsx(Ie,{title:"í™œì„± ë¹Œë“œ",children:e.jsxs(g,{size:4,children:[e.jsx(Pt,{style:{color:Ir.info},spin:s.active_builds>0}),e.jsx(Dn,{type:"secondary",children:s.active_builds})]})})]})]})});pg.displayName="ServiceSummaryCard";const gg=o.memo(({data:s})=>{const t=s.total_connections>0?Math.round(s.active_connections/s.total_connections*100):0;return e.jsxs(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(_s,{style:{color:"#fa8c16"}}),e.jsx("span",{children:"ë°ì´í„°ë² ì´ìŠ¤"})]}),style:{height:"100%",borderRadius:8},children:[e.jsx($e,{title:"ì—°ê²°",value:s.total_connections,suffix:"ê°œ",valueStyle:{fontSize:"24px",fontWeight:600}}),e.jsx(qt,{percent:t,size:"small",strokeColor:t>=80?Ir.success:t>=50?Ir.warning:Ir.error,style:{marginTop:Zn.xs,marginBottom:Zn.xs}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[e.jsx(Ie,{title:"í™œì„± ì—°ê²°",children:e.jsxs(g,{size:4,children:[e.jsx(Ze,{style:{color:Ir.success}}),e.jsx(Dn,{type:"secondary",children:s.active_connections})]})}),e.jsx(Ie,{title:"ì‹¤íŒ¨ ì—°ê²°",children:e.jsxs(g,{size:4,children:[e.jsx(Es,{style:{color:Ir.error}}),e.jsx(Dn,{type:"secondary",children:s.failed_connections})]})}),e.jsx(Ie,{title:"ë™ê¸°í™” ì¤‘",children:e.jsxs(g,{size:4,children:[e.jsx(Pt,{style:{color:Ir.info},spin:s.active_syncs>0}),e.jsx(Dn,{type:"secondary",children:s.active_syncs})]})})]})]})});gg.displayName="DatabaseSummaryCard";const xg=o.memo(({devices:s,runtime:t,backup:r,services:n,database:a})=>e.jsxs(Ke,{gutter:[Zn.sm,Zn.sm],style:{marginBottom:Zn.md},children:[e.jsx(Y,{xs:24,sm:12,lg:8,xl:4,children:e.jsx(dg,{data:s})}),e.jsx(Y,{xs:24,sm:12,lg:8,xl:5,children:e.jsx(ug,{data:t})}),e.jsx(Y,{xs:24,sm:12,lg:8,xl:5,children:e.jsx(hg,{data:r})}),e.jsx(Y,{xs:24,sm:12,lg:12,xl:5,children:e.jsx(pg,{data:n})}),e.jsx(Y,{xs:24,sm:12,lg:12,xl:5,children:e.jsx(gg,{data:a})})]}));xg.displayName="SummaryGrid";const{Title:mu,Text:cr,Paragraph:yf}=we,{TextArea:jf}=ue,Yn={xs:8,sm:16,md:24},ri={elite:"#52c41a",high:"#1890ff",medium:"#faad14",low:"#ff4d4f"},yi={elite:"Elite",high:"High",medium:"Medium",low:"Low"},Zo={critical:"#ff4d4f",high:"#ff7a45",medium:"#faad14",low:"#52c41a"},Ud=s=>s===0?"-":s<60?`${s}ì´ˆ`:s<3600?`${Math.round(s/60)}ë¶„`:s<86400?`${Math.round(s/3600)}ì‹œê°„`:`${Math.round(s/86400)}ì¼`,bf={deployment_frequency:{fullName:"ë°°í¬ ë¹ˆë„ (Deployment Frequency)",description:"ì½”ë“œê°€ í”„ë¡œë•ì…˜ì— ì–¼ë§ˆë‚˜ ìì£¼ ë°°í¬ë˜ëŠ”ì§€ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤.",whatItMeasures:"íŒ€ì˜ ë¦´ë¦¬ìŠ¤ ëŠ¥ë ¥ê³¼ CI/CD íŒŒì´í”„ë¼ì¸ íš¨ìœ¨ì„±",improvementTips:["ì‘ì€ ë‹¨ìœ„ë¡œ ìì£¼ ë°°í¬í•˜ëŠ” ìŠµê´€ ê¸°ë¥´ê¸°","CI/CD íŒŒì´í”„ë¼ì¸ ìë™í™” ê°•í™”","í”¼ì²˜ í”Œë˜ê·¸ë¥¼ í™œìš©í•œ ì ì§„ì  ë°°í¬","ë°°í¬ í”„ë¡œì„¸ìŠ¤ ê°„ì†Œí™” ë° ìŠ¹ì¸ ë‹¨ê³„ ìµœì í™”"],eliteTarget:"í•˜ë£¨ ì—¬ëŸ¬ ë²ˆ ë˜ëŠ” ì˜¨ë””ë§¨ë“œ ë°°í¬",affectedByActions:["ì„œë¹„ìŠ¤ ê´€ë¦¬ â†’ ë°°í¬ ì‹¤í–‰ (Deploy)","íŒŒì´í”„ë¼ì¸ â†’ ë°°í¬ ë‹¨ê³„ ì„±ê³µ"]},lead_time:{fullName:"ë³€ê²½ ë¦¬ë“œ íƒ€ì„ (Lead Time for Changes)",description:"ì½”ë“œ ì»¤ë°‹ë¶€í„° í”„ë¡œë•ì…˜ ë°°í¬ê¹Œì§€ ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ì¸¡ì •í•©ë‹ˆë‹¤.",whatItMeasures:"ê°œë°œ í”„ë¡œì„¸ìŠ¤ì˜ íš¨ìœ¨ì„±ê³¼ ë°°í¬ íŒŒì´í”„ë¼ì¸ ì†ë„",improvementTips:["ì½”ë“œ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤ íš¨ìœ¨í™” (ìë™ ë¦¬ë·°ì–´ ì§€ì •)","í…ŒìŠ¤íŠ¸ ìë™í™”ë¡œ ìˆ˜ë™ ê²€ì¦ ì‹œê°„ ë‹¨ì¶•","PR í¬ê¸°ë¥¼ ì‘ê²Œ ìœ ì§€í•˜ì—¬ ë¦¬ë·° ì‹œê°„ ë‹¨ì¶•","ë¹Œë“œ ë° ë°°í¬ íŒŒì´í”„ë¼ì¸ ë³‘ë ¬í™”"],eliteTarget:"1ì‹œê°„ ë¯¸ë§Œ",affectedByActions:["íŒŒì´í”„ë¼ì¸ ë¹Œë“œ(Build) â†’ ë°°í¬(Deploy) ì‹œê°„","Source â†’ Build â†’ Deploy ì „ì²´ ì†Œìš”ì‹œê°„"]},mttr:{fullName:"í‰ê·  ë³µêµ¬ ì‹œê°„ (Mean Time To Recovery)",description:"ì¥ì•  ë°œìƒ ì‹œ ì„œë¹„ìŠ¤ê°€ ì •ìƒìœ¼ë¡œ ë³µêµ¬ë˜ê¸°ê¹Œì§€ì˜ í‰ê·  ì‹œê°„ì…ë‹ˆë‹¤.",whatItMeasures:"ìš´ì˜ ëŒ€ì‘ë ¥ê³¼ ì‹œìŠ¤í…œ ë³µì›ë ¥",improvementTips:["ìë™ ë¡¤ë°± ë©”ì»¤ë‹ˆì¦˜ êµ¬ì¶•","ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼ ì²´ê³„ ê°•í™”","ì¥ì•  ëŒ€ì‘ ëŸ°ë¶(Runbook) ì‘ì„± ë° í›ˆë ¨","ì¹´ë‚˜ë¦¬ ë°°í¬ë¡œ ì˜í–¥ ë²”ìœ„ ìµœì†Œí™”","RCA(ê·¼ë³¸ ì›ì¸ ë¶„ì„) ë¬¸í™” ì •ì°©"],eliteTarget:"1ì‹œê°„ ë¯¸ë§Œ",affectedByActions:["ì¥ì•  ë“±ë¡ â†’ í•´ê²° ì™„ë£Œê¹Œì§€ì˜ ì‹œê°„","ë°°í¬ ì‹¤íŒ¨ ì‹œ ìë™ ì¥ì•  ë“±ë¡ â†’ ì¬ë°°í¬ ì„±ê³µ","ì„œë¹„ìŠ¤ ìƒíƒœ ë³€ê²½ ì¥ì•  â†’ ë³µêµ¬"]},cfr:{fullName:"ë³€ê²½ ì‹¤íŒ¨ìœ¨ (Change Failure Rate)",description:"í”„ë¡œë•ì…˜ ë°°í¬ ì¤‘ ì¥ì• ë‚˜ ë¡¤ë°±ì´ ë°œìƒí•˜ëŠ” ë¹„ìœ¨ì…ë‹ˆë‹¤.",whatItMeasures:"ë°°í¬ í’ˆì§ˆê³¼ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ìˆ˜ì¤€",improvementTips:["í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í™•ëŒ€ (ë‹¨ìœ„/í†µí•©/E2E)","ìŠ¤í…Œì´ì§• í™˜ê²½ì—ì„œ ì¶©ë¶„í•œ ê²€ì¦","ì½”ë“œ ë¦¬ë·° í’ˆì§ˆ í–¥ìƒ","ì ì§„ì  ë°°í¬ ì „ëµ (ì¹´ë‚˜ë¦¬, ë¸”ë£¨-ê·¸ë¦°)","ë°°í¬ ì „ ìë™í™”ëœ í’ˆì§ˆ ê²Œì´íŠ¸ ì¶”ê°€"],eliteTarget:"15% ë¯¸ë§Œ",affectedByActions:["íŒŒì´í”„ë¼ì¸ â†’ Deploy ë‹¨ê³„ ì‹¤íŒ¨ (CFR ì¦ê°€ â†‘)","íŒŒì´í”„ë¼ì¸ â†’ Deploy ë‹¨ê³„ ì„±ê³µ (CFR ê°ì†Œ â†“)","ê³„ì‚°ì‹: ì‹¤íŒ¨í•œ ë°°í¬ ìˆ˜ / ì „ì²´ ë°°í¬ ìˆ˜ Ã— 100"]}},fu=o.memo(({metricKey:s})=>{const t=bf[s],r=e.jsxs("div",{style:{maxWidth:320},children:[e.jsx(mu,{level:5,style:{margin:0,marginBottom:8},children:t.fullName}),e.jsx(yf,{style:{margin:0,marginBottom:12},children:t.description}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs(cr,{type:"secondary",style:{fontSize:12},children:[e.jsx(Ks,{style:{marginRight:4}}),"ì¸¡ì • ëŒ€ìƒ"]}),e.jsx("div",{style:{paddingLeft:16,marginTop:4},children:e.jsx(cr,{children:t.whatItMeasures})})]}),t.affectedByActions&&t.affectedByActions.length>0&&e.jsxs("div",{style:{marginBottom:12,padding:"8px 12px",backgroundColor:"#e6f7ff",borderRadius:4,border:"1px solid #91d5ff"},children:[e.jsxs(cr,{type:"secondary",style:{fontSize:12,color:"#1890ff"},children:[e.jsx(Pa,{style:{marginRight:4}}),"K8sControl ì˜í–¥ ìš”ì†Œ"]}),e.jsx("ul",{style:{paddingLeft:16,margin:"6px 0 0 0",listStyleType:"disc"},children:t.affectedByActions.map((n,a)=>e.jsx("li",{style:{marginBottom:2,fontSize:12,color:"#262626"},children:n},a))})]}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs(cr,{type:"secondary",style:{fontSize:12},children:[e.jsx(dr,{style:{marginRight:4}}),"Elite ëª©í‘œ"]}),e.jsx("div",{style:{paddingLeft:16,marginTop:4},children:e.jsx(T,{color:"green",children:t.eliteTarget})})]}),e.jsxs("div",{children:[e.jsxs(cr,{type:"secondary",style:{fontSize:12},children:[e.jsx(fa,{style:{marginRight:4}}),"ì ìˆ˜ ê°œì„  ë°©ë²•"]}),e.jsx("ul",{style:{paddingLeft:20,margin:"8px 0 0 0"},children:t.improvementTips.map((n,a)=>e.jsx("li",{style:{marginBottom:4,fontSize:13},children:n},a))})]})]});return e.jsx(Ie,{title:r,placement:"bottom",overlayStyle:{maxWidth:360},color:"white",overlayInnerStyle:{color:"#000"},children:e.jsx(xc,{style:{color:"#8c8c8c",cursor:"help",marginLeft:4,fontSize:12}})})});fu.displayName="MetricInfoPopover";const mg=o.memo(({metrics:s})=>{if(!s)return e.jsx(ie,{style:{height:"100%",borderRadius:8,textAlign:"center"},children:e.jsx(Je,{description:"DORA ë©”íŠ¸ë¦­ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"})});const t=ri[s.overall_grade];return e.jsx(ie,{style:{height:"100%",borderRadius:8,border:`2px solid ${t}30`,backgroundColor:`${t}05`},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(Fp,{style:{fontSize:"48px",color:t,marginBottom:Yn.sm}}),e.jsx(mu,{level:2,style:{margin:0,color:t},children:yi[s.overall_grade]}),e.jsx(cr,{type:"secondary",style:{display:"block",marginBottom:Yn.sm},children:"ì¢…í•© ë“±ê¸‰"}),e.jsx(qt,{type:"circle",percent:s.health_score,strokeColor:t,format:()=>e.jsx("span",{style:{fontSize:"20px",fontWeight:600,color:t},children:s.health_score}),size:100}),e.jsx(cr,{type:"secondary",style:{display:"block",marginTop:Yn.xs},children:"ê±´ê°•ë„ ì ìˆ˜"})]})})});mg.displayName="DORAGaugeCard";const Ho=o.memo(({title:s,icon:t,value:r,unit:n,grade:a,threshold:i,metricKey:l})=>{const d=ri[a],c=()=>n==="ì´ˆ"?Ud(r):n==="%"?`${r.toFixed(1)}%`:`${r.toFixed(2)}${n}`;return e.jsx(ie,{size:"small",style:{borderRadius:8,border:`1px solid ${d}30`,backgroundColor:`${d}05`},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:Yn.sm},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:8,backgroundColor:`${d}20`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",color:d},children:t}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(cr,{type:"secondary",style:{fontSize:"12px"},children:s}),e.jsx(fu,{metricKey:l})]}),e.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:4},children:[e.jsx(cr,{strong:!0,style:{fontSize:"18px"},children:c()}),e.jsx(T,{color:d,style:{marginLeft:4},children:yi[a]})]}),e.jsx(Ie,{title:i,children:e.jsx(cr,{type:"secondary",style:{fontSize:"11px",cursor:"help"},children:i})})]})]})})});Ho.displayName="DORAMetricCard";const bl=({title:s,metricKey:t})=>e.jsxs(g,{size:2,children:[e.jsx("span",{children:s}),e.jsx(fu,{metricKey:t})]}),_f=[{grade:"elite",df:"1+íšŒ/ì¼",lt:"<1ì‹œê°„",mttr:"<1ì‹œê°„",cfr:"<15%"},{grade:"high",df:"ì£¼ 1íšŒ+",lt:"<1ì¼",mttr:"<1ì¼",cfr:"<30%"},{grade:"medium",df:"ì›” 1íšŒ+",lt:"<1ì£¼",mttr:"<1ì£¼",cfr:"<45%"},{grade:"low",df:"<ì›” 1íšŒ",lt:"â‰¥1ì£¼",mttr:"â‰¥1ì£¼",cfr:"â‰¥45%"}],fg=o.memo(()=>e.jsx(nr,{size:"small",ghost:!0,expandIcon:({isActive:s})=>e.jsx(wm,{rotate:s?90:0,style:{color:"#8c8c8c"}}),items:[{key:"1",label:e.jsxs(cr,{type:"secondary",style:{fontSize:12},children:[e.jsx(Ks,{style:{marginRight:4}}),"DORA ë“±ê¸‰ ê¸°ì¤€í‘œ ë³´ê¸°"]}),children:e.jsxs("div",{style:{overflowX:"auto"},children:[e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#fafafa"},children:[e.jsx("th",{style:{padding:"8px 12px",textAlign:"left",borderBottom:"1px solid #f0f0f0",fontWeight:600,minWidth:70},children:"ë“±ê¸‰"}),e.jsx("th",{style:{padding:"8px 12px",textAlign:"center",borderBottom:"1px solid #f0f0f0",fontWeight:600},children:e.jsx(Ie,{title:"ë°°í¬ ë¹ˆë„ (Deployment Frequency)",children:e.jsx("span",{style:{cursor:"help"},children:"DF"})})}),e.jsx("th",{style:{padding:"8px 12px",textAlign:"center",borderBottom:"1px solid #f0f0f0",fontWeight:600},children:e.jsx(Ie,{title:"ë³€ê²½ ë¦¬ë“œ íƒ€ì„ (Lead Time for Changes)",children:e.jsx("span",{style:{cursor:"help"},children:"LT"})})}),e.jsx("th",{style:{padding:"8px 12px",textAlign:"center",borderBottom:"1px solid #f0f0f0",fontWeight:600},children:e.jsx(Ie,{title:"í‰ê·  ë³µêµ¬ ì‹œê°„ (Mean Time To Recovery)",children:e.jsx("span",{style:{cursor:"help"},children:"MTTR"})})}),e.jsx("th",{style:{padding:"8px 12px",textAlign:"center",borderBottom:"1px solid #f0f0f0",fontWeight:600},children:e.jsx(Ie,{title:"ë³€ê²½ ì‹¤íŒ¨ìœ¨ (Change Failure Rate)",children:e.jsx("span",{style:{cursor:"help"},children:"CFR"})})})]})}),e.jsx("tbody",{children:_f.map(s=>e.jsxs("tr",{style:{backgroundColor:`${ri[s.grade]}08`,transition:"background-color 0.2s"},children:[e.jsx("td",{style:{padding:"8px 12px",borderBottom:"1px solid #f0f0f0"},children:e.jsx(T,{color:ri[s.grade],style:{margin:0,fontWeight:600},children:yi[s.grade]})}),e.jsx("td",{style:{padding:"8px 12px",textAlign:"center",borderBottom:"1px solid #f0f0f0",color:"#595959"},children:s.df}),e.jsx("td",{style:{padding:"8px 12px",textAlign:"center",borderBottom:"1px solid #f0f0f0",color:"#595959"},children:s.lt}),e.jsx("td",{style:{padding:"8px 12px",textAlign:"center",borderBottom:"1px solid #f0f0f0",color:"#595959"},children:s.mttr}),e.jsx("td",{style:{padding:"8px 12px",textAlign:"center",borderBottom:"1px solid #f0f0f0",color:"#595959"},children:s.cfr})]},s.grade))})]}),e.jsx("div",{style:{marginTop:8,padding:"8px 12px",backgroundColor:"#f6f8fa",borderRadius:4},children:e.jsxs(cr,{type:"secondary",style:{fontSize:11},children:[e.jsx(Ks,{style:{marginRight:4}}),e.jsx("strong",{children:"DF"}),": ë°°í¬ ë¹ˆë„ | ",e.jsx("strong",{children:"LT"}),": ë¦¬ë“œ íƒ€ì„ |",e.jsx("strong",{children:" MTTR"}),": í‰ê·  ë³µêµ¬ ì‹œê°„ |"," ",e.jsx("strong",{children:"CFR"}),": ë³€ê²½ ì‹¤íŒ¨ìœ¨"]})})]})}],style:{backgroundColor:"transparent",marginTop:Yn.xs}}));fg.displayName="DORAGradeCriteriaTable";const yg=o.memo(({services:s})=>{const t=[{title:"ì„œë¹„ìŠ¤",dataIndex:"service_name",key:"service_name",width:150,ellipsis:!0},{title:"ì¢…í•©",dataIndex:["metrics","overall_grade"],key:"overall_grade",width:80,align:"center",render:r=>e.jsx(T,{color:ri[r],children:yi[r]})},{title:e.jsx(bl,{title:"ë°°í¬",metricKey:"deployment_frequency"}),dataIndex:["metrics","deployment_frequency","grade"],key:"df",width:80,align:"center",render:(r,n)=>e.jsx(Ie,{title:`${n.metrics.deployment_frequency.value.toFixed(2)}íšŒ/ì¼`,children:e.jsx(T,{color:ri[r],style:{fontSize:"10px"},children:yi[r]})})},{title:e.jsx(bl,{title:"LT",metricKey:"lead_time"}),dataIndex:["metrics","lead_time","grade"],key:"lt",width:80,align:"center",render:(r,n)=>e.jsx(Ie,{title:Ud(n.metrics.lead_time.value),children:e.jsx(T,{color:ri[r],style:{fontSize:"10px"},children:yi[r]})})},{title:e.jsx(bl,{title:"MTTR",metricKey:"mttr"}),dataIndex:["metrics","mttr","grade"],key:"mttr",width:80,align:"center",render:(r,n)=>e.jsx(Ie,{title:Ud(n.metrics.mttr.value),children:e.jsx(T,{color:ri[r],style:{fontSize:"10px"},children:yi[r]})})},{title:e.jsx(bl,{title:"CFR",metricKey:"cfr"}),dataIndex:["metrics","change_failure_rate","grade"],key:"cfr",width:80,align:"center",render:(r,n)=>e.jsx(Ie,{title:`${n.metrics.change_failure_rate.value.toFixed(1)}%`,children:e.jsx(T,{color:ri[r],style:{fontSize:"10px"},children:yi[r]})})},{title:"ì ìˆ˜",dataIndex:["metrics","health_score"],key:"health_score",width:60,align:"center",render:r=>e.jsx(cr,{strong:!0,children:r})}];return s.length===0?e.jsx(Je,{description:"ì„œë¹„ìŠ¤ë³„ ë©”íŠ¸ë¦­ì´ ì—†ìŠµë‹ˆë‹¤"}):e.jsx(wt,{columns:t,dataSource:s,rowKey:"service_id",size:"small",pagination:!1,scroll:{x:600,y:200}})});yg.displayName="ServiceDORATable";const jg=o.memo(({incident:s,visible:t,onClose:r,onResolve:n,onAcknowledge:a})=>{var _,S;const[i,l]=o.useState(!1),[d,c]=o.useState("");if(!s)return null;const p=async()=>{l(!0);try{await n(s.id,d),c(""),r()}finally{l(!1)}},h=()=>{a(s.id)},x=(_=s.description)!=null&&_.Valid&&((S=s.description)!=null&&S.String)?s.description.String:null;return e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(Tr,{style:{color:Zo[s.severity]}}),e.jsx("span",{children:"ì¥ì•  ìƒì„¸ ì •ë³´"})]}),open:t,onCancel:r,footer:null,width:560,children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[e.jsx(T,{color:Zo[s.severity],style:{fontSize:"12px"},children:s.severity.toUpperCase()}),e.jsx(ps,{status:s.status==="open"?"error":"warning",text:s.status==="open"?"ë¯¸í™•ì¸":"í™•ì¸ë¨"})]}),e.jsx(mu,{level:5,style:{margin:0,marginBottom:8},children:s.title}),x&&e.jsxs("div",{style:{backgroundColor:"#f5f5f5",padding:"12px 16px",borderRadius:6,marginBottom:12},children:[e.jsx(cr,{type:"secondary",style:{fontSize:11,display:"block"},children:"ì„¤ëª…"}),e.jsx(cr,{style:{whiteSpace:"pre-wrap"},children:x})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px 16px",fontSize:13},children:[e.jsxs("div",{children:[e.jsx(cr,{type:"secondary",children:"ê´€ë ¨ ì„œë¹„ìŠ¤: "}),e.jsx(cr,{children:s.service_name||"ì‹œìŠ¤í…œ ì „ì²´"})]}),e.jsxs("div",{children:[e.jsx(cr,{type:"secondary",children:"ì¸í”„ë¼: "}),e.jsx(cr,{children:s.infra_name||"-"})]}),e.jsxs("div",{children:[e.jsx(cr,{type:"secondary",children:"ë°œìƒ ì‹œê°„: "}),e.jsx(cr,{children:new Date(s.started_at).toLocaleString("ko-KR")})]}),e.jsxs("div",{children:[e.jsx(cr,{type:"secondary",children:"ìœ í˜•: "}),e.jsx(cr,{children:s.incident_type==="deployment_failure"?"ë°°í¬ ì‹¤íŒ¨":s.incident_type==="service_status_change"?"ì„œë¹„ìŠ¤ ìƒíƒœ ë³€ê²½":"ìˆ˜ë™ ë“±ë¡"})]})]})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(cr,{type:"secondary",style:{display:"block",marginBottom:8},children:"í•´ê²° ë©”ëª¨ (ì„ íƒ)"}),e.jsx(ue.TextArea,{value:d,onChange:L=>c(L.target.value),placeholder:"ì¥ì•  í•´ê²° ë‚´ìš©ì´ë‚˜ ì›ì¸ ë¶„ì„ì„ ì…ë ¥í•˜ì„¸ìš”",rows:3})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx(B,{onClick:r,children:"ë‹«ê¸°"}),s.status==="open"&&e.jsx(B,{onClick:h,children:"í™•ì¸ ì²˜ë¦¬"}),e.jsx(B,{type:"primary",onClick:p,loading:i,children:"í•´ê²° ì™„ë£Œ"})]})]})});jg.displayName="IncidentDetailModal";const bg=o.memo(({incidents:s,onResolve:t,onAcknowledge:r,onViewDetail:n})=>s.length===0?e.jsx(xe,{message:"í™œì„± ì¥ì•  ì—†ìŒ",description:"í˜„ì¬ ì²˜ë¦¬ê°€ í•„ìš”í•œ ì¥ì• ê°€ ì—†ìŠµë‹ˆë‹¤.",type:"success",showIcon:!0,icon:e.jsx(Ze,{})}):e.jsx("div",{style:{maxHeight:200,overflowY:"auto"},children:s.map(a=>{var l,d;const i=(l=a.description)!=null&&l.Valid&&((d=a.description)!=null&&d.String)?a.description.String:null;return e.jsx(ie,{size:"small",hoverable:!0,onClick:()=>n(a),style:{marginBottom:Yn.xs,borderRadius:6,border:`1px solid ${Zo[a.severity]}30`,backgroundColor:`${Zo[a.severity]}05`,cursor:"pointer"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[e.jsx(T,{color:Zo[a.severity],style:{fontSize:"10px"},children:a.severity.toUpperCase()}),e.jsx(ps,{status:a.status==="open"?"error":"warning",text:a.status==="open"?"ë¯¸í™•ì¸":"í™•ì¸ë¨"})]}),e.jsx(cr,{strong:!0,style:{fontSize:"13px",display:"block"},children:a.title}),i&&e.jsx(cr,{type:"secondary",style:{fontSize:"11px",display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%",marginTop:2},children:i}),e.jsxs(cr,{type:"secondary",style:{fontSize:"11px"},children:[a.service_name||"ì‹œìŠ¤í…œ"," â€¢"," ",new Date(a.started_at).toLocaleString("ko-KR")]})]}),e.jsxs(g,{onClick:c=>c.stopPropagation(),children:[a.status==="open"&&e.jsx(B,{size:"small",onClick:()=>r(a.id),children:"í™•ì¸"}),e.jsx(B,{type:"primary",size:"small",onClick:()=>t(a.id),children:"í•´ê²°"})]})]})},a.id)})}));bg.displayName="ActiveIncidentList";const _g=o.memo(({doraHealth:s,onRefresh:t})=>{const[r,n]=o.useState(!1),[a,i]=o.useState(!1),[l]=H.useForm(),[d,c]=o.useState(null),[p,h]=o.useState(!1),x=s.services||[],_=s.active_incidents||[],S=async $=>{try{i(!0),await Kl.createIncident({title:$.title,severity:$.severity,service_id:$.service_id,description:$.description}),n(!1),l.resetFields(),t()}catch(y){O.error("ì¥ì•  ë“±ë¡ ì‹¤íŒ¨:",y)}finally{i(!1)}},L=async($,y)=>{try{await Kl.resolveIncident({id:$,resolution_note:y}),t()}catch(v){O.error("ì¥ì•  í•´ê²° ì²˜ë¦¬ ì‹¤íŒ¨:",v)}},k=async $=>{try{await Kl.acknowledgeIncident({id:$}),t()}catch(y){O.error("ì¥ì•  í™•ì¸ ì²˜ë¦¬ ì‹¤íŒ¨:",y)}},E=$=>{c($),h(!0)},P=()=>{h(!1),c(null)},I=s.system;return e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(Fp,{style:{color:"#52c41a"}}),e.jsx("span",{children:"DORA ê±´ê°•ë„"}),_.length>0&&e.jsx(ps,{count:_.length,style:{backgroundColor:"#ff4d4f"}})]}),extra:e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),size:"small",onClick:()=>n(!0),children:"ì¥ì•  ë“±ë¡"}),style:{marginBottom:Yn.md,borderRadius:12},children:[e.jsxs(Ke,{gutter:[Yn.sm,Yn.sm],children:[e.jsx(Y,{xs:24,md:6,children:e.jsx(mg,{metrics:I})}),e.jsxs(Y,{xs:24,md:18,children:[e.jsxs(Ke,{gutter:[Yn.sm,Yn.sm],children:[e.jsx(Y,{xs:12,md:6,children:e.jsx(Ho,{title:"ë°°í¬ ë¹ˆë„",icon:e.jsx(Pa,{}),value:(I==null?void 0:I.deployment_frequency.value)||0,unit:"íšŒ/ì¼",grade:(I==null?void 0:I.deployment_frequency.grade)||"low",threshold:(I==null?void 0:I.deployment_frequency.threshold)||"-",metricKey:"deployment_frequency"})}),e.jsx(Y,{xs:12,md:6,children:e.jsx(Ho,{title:"Lead Time",icon:e.jsx(wr,{}),value:(I==null?void 0:I.lead_time.value)||0,unit:"ì´ˆ",grade:(I==null?void 0:I.lead_time.grade)||"low",threshold:(I==null?void 0:I.lead_time.threshold)||"-",metricKey:"lead_time"})}),e.jsx(Y,{xs:12,md:6,children:e.jsx(Ho,{title:"MTTR",icon:e.jsx(mn,{}),value:(I==null?void 0:I.mttr.value)||0,unit:"ì´ˆ",grade:(I==null?void 0:I.mttr.grade)||"low",threshold:(I==null?void 0:I.mttr.threshold)||"-",metricKey:"mttr"})}),e.jsx(Y,{xs:12,md:6,children:e.jsx(Ho,{title:"CFR",icon:e.jsx(Sm,{}),value:(I==null?void 0:I.change_failure_rate.value)||0,unit:"%",grade:(I==null?void 0:I.change_failure_rate.grade)||"low",threshold:(I==null?void 0:I.change_failure_rate.threshold)||"-",metricKey:"cfr"})})]}),e.jsx(fg,{})]})]}),e.jsxs(Ke,{gutter:[Yn.sm,Yn.sm],style:{marginTop:Yn.md},children:[e.jsx(Y,{xs:24,lg:14,children:e.jsx(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx("span",{children:"ì„œë¹„ìŠ¤ë³„ DORA"}),e.jsxs(T,{color:"blue",children:[x.length,"ê°œ"]})]}),style:{borderRadius:8},children:e.jsx(yg,{services:x})})}),e.jsx(Y,{xs:24,lg:10,children:e.jsx(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(Tr,{style:{color:"#ff4d4f"}}),e.jsx("span",{children:"í™œì„± ì¥ì• "}),_.length>0&&e.jsx(ps,{count:_.length,style:{backgroundColor:"#ff4d4f"}})]}),style:{borderRadius:8},children:e.jsx(bg,{incidents:_,onResolve:$=>L($),onAcknowledge:k,onViewDetail:E})})})]}),e.jsx(rt,{title:"ìˆ˜ë™ ì¥ì•  ë“±ë¡",open:r,onCancel:()=>n(!1),footer:null,children:e.jsxs(H,{form:l,layout:"vertical",onFinish:S,initialValues:{severity:"medium"},children:[e.jsx(H.Item,{name:"title",label:"ì¥ì•  ì œëª©",rules:[{required:!0,message:"ì¥ì•  ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì¥ì•  ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"})}),e.jsx(H.Item,{name:"service_id",label:"ê´€ë ¨ ì„œë¹„ìŠ¤",tooltip:"ë°°í¬ ì´ë ¥ì´ ìˆëŠ” ì„œë¹„ìŠ¤ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì„ íƒí•˜ë©´ í•´ë‹¹ ì„œë¹„ìŠ¤ì˜ MTTR ê³„ì‚°ì— ë°˜ì˜ë©ë‹ˆë‹¤.",children:e.jsx(Ee,{placeholder:"ì„œë¹„ìŠ¤ ì„ íƒ (ì„ íƒì‚¬í•­)",allowClear:!0,showSearch:!0,optionFilterProp:"children",filterOption:($,y)=>{var v;return(v=y==null?void 0:y.children)==null?void 0:v.toLowerCase().includes($.toLowerCase())},children:x.map($=>e.jsx(Ee.Option,{value:$.service_id,children:$.service_name},$.service_id))})}),e.jsx(H.Item,{name:"severity",label:"ì‹¬ê°ë„",rules:[{required:!0}],children:e.jsxs(Ee,{children:[e.jsx(Ee.Option,{value:"critical",children:"Critical - ê¸´ê¸‰"}),e.jsx(Ee.Option,{value:"high",children:"High - ë†’ìŒ"}),e.jsx(Ee.Option,{value:"medium",children:"Medium - ë³´í†µ"}),e.jsx(Ee.Option,{value:"low",children:"Low - ë‚®ìŒ"})]})}),e.jsx(H.Item,{name:"description",label:"ì„¤ëª… (ì„ íƒ)",children:e.jsx(jf,{rows:3,placeholder:"ì¥ì• ì— ëŒ€í•œ ìƒì„¸ ì„¤ëª…"})}),e.jsx(H.Item,{style:{marginBottom:0,textAlign:"right"},children:e.jsxs(g,{children:[e.jsx(B,{onClick:()=>n(!1),children:"ì·¨ì†Œ"}),e.jsx(B,{type:"primary",htmlType:"submit",loading:a,children:"ë“±ë¡"})]})})]})}),e.jsx(jg,{incident:d,visible:p,onClose:P,onResolve:L,onAcknowledge:k})]})});_g.displayName="DORAHealthSection";const{Title:wf,Paragraph:oh}=we,so={xs:8,sm:16,md:24,lg:32},Sf={primary:"#1890ff"},vf=3e4,kf=()=>{const[s,t]=o.useState(null),[r,n]=o.useState(!0),[a,i]=o.useState(null),[l,d]=o.useState(null),c=o.useCallback(async(h=!0)=>{try{h&&n(!0),i(null);const x=await Kl.getDashboardSummary();t(x),d(new Date)}catch(x){const _=x instanceof Error?x.message:"ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨";i(_),O.error("ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:",x)}finally{n(!1)}},[]);o.useEffect(()=>{c();const h=setInterval(()=>{c(!1)},vf);return()=>clearInterval(h)},[c]);const p=()=>{c()};return r&&!s?e.jsx("div",{style:{textAlign:"center",padding:so.lg*2},children:e.jsx(gt,{size:"large",tip:"ëŒ€ì‹œë³´ë“œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})}):a&&!s?e.jsx(xe,{message:"ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨",description:a,type:"error",showIcon:!0,action:e.jsx(B,{size:"small",onClick:p,children:"ë‹¤ì‹œ ì‹œë„"})}):e.jsxs("div",{style:{padding:`0 ${so.sm}px`},children:[e.jsxs("div",{style:{marginBottom:so.lg,display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs(wf,{level:2,style:{margin:0,marginBottom:so.xs,color:"#262626"},children:[e.jsx(ii,{style:{marginRight:so.sm,color:Sf.primary}}),"í†µí•© ëŒ€ì‹œë³´ë“œ"]}),e.jsx(oh,{type:"secondary",style:{margin:0,fontSize:"16px"},children:"ì‹œìŠ¤í…œ ì „ë°˜ì˜ ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ì„¸ìš”"})]}),e.jsxs(g,{children:[l&&e.jsxs(oh,{type:"secondary",style:{margin:0,fontSize:"12px"},children:["ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ",l.toLocaleTimeString()]}),e.jsx(B,{icon:e.jsx(zs,{spin:r}),onClick:p,loading:r,children:"ìƒˆë¡œê³ ì¹¨"})]})]}),a&&s&&e.jsx(xe,{message:"ì—…ë°ì´íŠ¸ ì‹¤íŒ¨",description:a,type:"warning",showIcon:!0,closable:!0,style:{marginBottom:so.md}}),s&&e.jsxs(e.Fragment,{children:[e.jsx(xg,{devices:s.devices,runtime:s.runtime,backup:s.backup,services:s.services,database:s.database}),e.jsx(_g,{doraHealth:s.dora,onRefresh:p})]})]})},wg=o.memo(()=>e.jsx("div",{className:"dashboard-container",children:e.jsx(kf,{})}));wg.displayName="Dashboard";const Cf={login:async s=>ee.post("/auth/login",s),signup:async s=>ee.post("/auth/signup",s),logout:async()=>ee.post("/auth/logout"),refreshToken:async()=>ee.post("/auth/refresh"),checkToken:async()=>ee.get("/auth/check"),getCurrentUser:async()=>ee.get("/auth/me")},yu={request:(s,t,r)=>ee.infra(s,t,r),list:()=>ee.infra("list",{}),getById:s=>ee.infra("getById",{id:s}),create:s=>ee.infra("create",s,{showSuccessMessage:!0,successMessage:"ì¸í”„ë¼ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),update:(s,t)=>ee.infra("update",{id:s,...t},{showSuccessMessage:!0,successMessage:"ì¸í”„ë¼ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),delete:s=>ee.infra("delete",{id:s},{showSuccessMessage:!0,successMessage:"ì¸í”„ë¼ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),listServers:s=>ee.infra("list-servers",{infra_id:s}),createServer:s=>ee.infra("create-server",s,{showSuccessMessage:!0,successMessage:"ì„œë²„ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),updateServer:(s,t)=>ee.infra("update-server",{server_id:s,...t},{showSuccessMessage:!0,successMessage:"ì„œë²„ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),deleteServer:s=>ee.infra("delete-server",{server_id:s},{showSuccessMessage:!0,successMessage:"ì„œë²„ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),checkServerStatus:s=>ee.infra("check-server-status",{server_id:s}),getPermissions:s=>ee.infra("getInfraPermissions",{infra_id:s}),addPermission:s=>ee.infra("setInfraPermission",s,{showSuccessMessage:!0,successMessage:"ê¶Œí•œì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."}),removePermission:s=>ee.infra("removeInfraPermission",s,{showSuccessMessage:!0,successMessage:"ê¶Œí•œì´ ì„±ê³µì ìœ¼ë¡œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤."}),getInfrasByUserId:s=>ee.infra("infraUserIdOnly",{userID:s}),testExternalKubernetes:s=>ee.infra("test-external-kubernetes",s),testExternalDocker:s=>ee.infra("test-external-docker",s),validationImportData:(s,t,r,n)=>ee.infra("validationImportData",{runtimeName:s,type:t,hops:r,userId:n}),getResourceUsage:s=>ee.infra("get-resource-usage",{infra_id:s}),getStatusSummary:s=>ee.infra("get-status-summary",{infra_id:s})},ju={request:(s,t,r)=>ee.kubernetes(s,t,r),getNodeStatus:s=>ee.kubernetes("getNodeStatus",s),installLoadBalancer:s=>ee.kubernetes("installLoadBalancer",s,{showSuccessMessage:!0,successMessage:"ë¡œë“œë°¸ëŸ°ì„œ ì„¤ì¹˜ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),installFirstMaster:s=>ee.kubernetes("installFirstMaster",s,{showSuccessMessage:!0,successMessage:"ë§ˆìŠ¤í„° ë…¸ë“œ ì„¤ì¹˜ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),joinMaster:s=>ee.kubernetes("joinMaster",s,{showSuccessMessage:!0,successMessage:"ë§ˆìŠ¤í„° ë…¸ë“œ ì¡°ì¸ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),joinWorker:s=>ee.kubernetes("joinWorker",s,{showSuccessMessage:!0,successMessage:"ì›Œì»¤ ë…¸ë“œ ì¡°ì¸ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),removeNode:s=>ee.kubernetes("removeNode",s,{showSuccessMessage:!0,successMessage:"ë…¸ë“œ ì œê±°ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),startServer:s=>ee.kubernetes("startServer",s,{showSuccessMessage:!0,successMessage:"ì„œë²„ ì‹œì‘ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),stopServer:s=>ee.kubernetes("stopServer",s,{showSuccessMessage:!0,successMessage:"ì„œë²„ ì¤‘ì§€ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),restartServer:s=>ee.kubernetes("restartServer",s,{showSuccessMessage:!0,successMessage:"ì„œë²„ ì¬ì‹œì‘ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),getClusterInfo:s=>ee.kubernetes("calculateResources",s),getNodes:s=>ee.kubernetes("calculateNodes",s),getClusterStatus:s=>ee.kubernetes("getClusterStatus",s),getNamespaceAndPods:s=>ee.kubernetes("getNamespaceAndPodStatus",s),getAllNamespaces:s=>ee.kubernetes("getAllNamespaces",s),createNamespace:s=>ee.kubernetes("createNamespace",s,{showSuccessMessage:!0,successMessage:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),deleteNamespace:s=>ee.kubernetes("deleteNamespace",s,{showSuccessMessage:!0,successMessage:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),getPodLogs:s=>ee.kubernetes("getPodLogs",s),restartPod:s=>ee.kubernetes("restartPod",s,{showSuccessMessage:!0,successMessage:"íŒŒë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì¬ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),deletePod:s=>ee.kubernetes("deletePod",s,{showSuccessMessage:!0,successMessage:"íŒŒë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),getPodDetails:s=>ee.kubernetes("getPodDetails",s),deploy:s=>ee.kubernetes("deployKubernetes",s,{showSuccessMessage:!0,successMessage:"ë°°í¬ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),redeploy:s=>ee.kubernetes("redeployKubernetes",s,{showSuccessMessage:!0,successMessage:"ì¬ë°°í¬ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),getLastDeploymentTime:s=>ee.kubernetes("get-last-deployment-time",s),getDeploymentStatus:s=>ee.kubernetes("getDeploymentStatus",s),rollbackDeployment:s=>ee.kubernetes("rollbackDeployment",s,{showSuccessMessage:!0,successMessage:"ë°°í¬ ë¡¤ë°±ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),getServices:s=>ee.kubernetes("getServices",s),getIngresses:s=>ee.kubernetes("getIngresses",s)},If={request:(s,t)=>ee.service(s,t),list:()=>ee.service("getServices",{}),status:s=>ee.service("status",{service_id:s}),create:s=>ee.service("create",s,{showSuccessMessage:!0,successMessage:"ì„œë¹„ìŠ¤ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),update:(s,t)=>ee.service("update",{service_id:s,...t}),remove:s=>ee.service("delete",{service_id:s}),deploy:s=>ee.service("deploy",{service_id:s.serviceId,infra_id:s.infraId,force:s.force}),start:s=>ee.service("start",{service_id:s}),stop:s=>ee.service("stop",{service_id:s}),restart:s=>ee.service("restart",{service_id:s}),logs:(s,t=100)=>ee.service("logs",{service_id:s,lines:t})},bu={request:(s,t)=>ee.docker(s,t),getServer:s=>ee.docker("getDockerServer",{infra_id:s}),createServer:s=>ee.docker("createDockerServer",s,{showSuccessMessage:!0,successMessage:"ë„ì»¤ ì„œë²„ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),updateServer:s=>ee.docker("updateDockerServer",s,{showSuccessMessage:!0,successMessage:"ë„ì»¤ ì„œë²„ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),checkServerStatus:(s,t)=>ee.docker("checkDockerServerStatus",{server_id:s,hops:t.hops}),getInfo:(s,t)=>ee.docker("getDockerInfo",{server_id:s,...t}),getContainers:(s,t)=>ee.docker("getContainers",{server_id:s,...t}),startContainer:(s,t)=>ee.docker("startContainer",{server_id:s,container_id:t}),controlContainer:(s,t,r,n)=>ee.docker("controlContainer",{server_id:s,container_id:t,action_type:r,hops:n.hops}),removeContainer:(s,t)=>ee.docker("removeContainer",{server_id:s,container_id:t}),installDocker:(s,t)=>ee.docker("installDocker",{id:s,hops:t.hops}),uninstallDocker:(s,t)=>ee.docker("uninstallDocker",{server_id:s,hops:t.hops}),createContainer:s=>ee.docker("createContainer",s),importDockerInfra:s=>ee.docker("importDockerInfra",s),getLogs:(s,t,r,n)=>ee.docker("getDockerLogs",{server_id:s,container_id:t,lines:n||100,hops:r.hops}),getContainerStats:(s,t)=>ee.docker("getContainerStats",{container_id:s,hops:t.hops}),executeCommand:(s,t,r)=>ee.docker("executeDockerCommand",{container_id:s,command:t,hops:r.hops}),redeployCompose:(s,t,r)=>ee.docker("redeployCompose",{compose_project:s,compose_file:t,hops:r.hops}),pruneResources:(s,t)=>ee.docker("pruneDockerResources",{prune_type:s,hops:t.hops}),getSystemInfo:s=>ee.docker("getDockerSystemInfo",{hops:s.hops}),getImages:s=>ee.docker("getDockerImages",{hops:s.hops}),getVolumes:s=>ee.docker("getDockerVolumes",{hops:s.hops}),getNetworks:s=>ee.docker("getDockerNetworks",{hops:s.hops})},ga={request:(s,t,r)=>ee.backup(s,t,r),installMinio:s=>ee.backup("install-minio",s,{showSuccessMessage:!0,successMessage:"MinIO ì„¤ì¹˜ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),installVelero:s=>ee.backup("install-velero",s,{showSuccessMessage:!0,successMessage:"Velero ì„¤ì¹˜ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),checkInstallation:s=>ee.backup("check-installation",{infra_id:s}),getInstallationStatus:s=>ee.backup("check-installation",{infra_id:s}),create:s=>ee.backup("create-backup",s,{showSuccessMessage:!0,successMessage:"ë°±ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."}),list:s=>ee.backup("list-backups",{infra_id:s}),delete:(s,t,r)=>ee.backup("delete-backup",{infra_id:s,name:t,auth_data:r}),listActualBackups:(s,t,r,n)=>ee.backup("list-actual-backups",{infra_id:s,backup_name:t,namespace:r,auth_data:n}),fetchNamespaces:(s,t)=>ee.backup("fetch-namespaces",{infra_id:s,auth_data:t}),createRestore:s=>ee.backup("create-restore",s,{showSuccessMessage:!0,successMessage:"ë³µì›ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),listRestores:s=>ee.backup("list-restores",{infra_id:s}),deleteRestore:(s,t,r)=>ee.backup("delete-restore",{infra_id:s,name:t,auth_data:r}),listMinioStorages:s=>ee.backup("list-minio-storages",{infra_id:s}),listAllMinioStorages:()=>ee.backup("list-all-minio-storages",{}),getEnvironments:s=>ee.backup("get-environments",{type:s}),createBackupStorage:s=>ee.backup("create-backup-storage",s,{showSuccessMessage:!0,successMessage:"ë°±ì—… ìŠ¤í† ë¦¬ì§€ ìƒì„±ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),getVeleroByInfraId:s=>ee.backup("get-velero-by-infra-id",{infra_id:s}).then(t=>t.data),getMinIOByInfraId:(s,t)=>ee.backup("get-minio-by-infra-id",{infra_id:s,endpoint:t}).then(r=>r.data),updateBackupStorage:s=>ee.backup("update-backup-storage",s,{showSuccessMessage:!0,successMessage:"ë°±ì—… ìŠ¤í† ë¦¬ì§€ ì—…ë°ì´íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),deleteEnvironment:s=>ee.backup("delete-environment",{id:s},{showSuccessMessage:!0,successMessage:"ë°±ì—… í™˜ê²½ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),updateBucket:s=>ee.backup("update-bucket",s,{showSuccessMessage:!0,successMessage:"ë²„í‚· ì •ë³´ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤."}),updateBackupLocation:s=>ee.backup("update-backup-location",s,{showSuccessMessage:!0,successMessage:"ë°±ì—… ë¡œì¼€ì´ì…˜ ì •ë³´ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤."}),listExternalStorages:()=>ee.backup("list-external-storages",{}),createExternalStorage:s=>ee.backup("create-external-storage",s,{showSuccessMessage:!0,successMessage:"ì™¸ë¶€ ì €ì¥ì†Œê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤."}),getExternalStorage:s=>ee.backup("get-external-storage",{id:s}),updateExternalStorage:(s,t)=>ee.backup("update-external-storage",{id:s,...t},{showSuccessMessage:!0,successMessage:"ì™¸ë¶€ ì €ì¥ì†Œê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."}),deleteExternalStorage:s=>ee.backup("delete-external-storage",{id:s},{showSuccessMessage:!0,successMessage:"ì™¸ë¶€ ì €ì¥ì†Œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),testExternalStorageConnection:s=>ee.backup("test-external-storage-connection",s),listExternalStorageBackups:s=>ee.backup("list-external-storage-backups",{storage_id:s}),linkInfraToExternalStorage:s=>ee.backup("link-infra-to-external-storage",s,{showSuccessMessage:!0,successMessage:"ì¸í”„ë¼ê°€ ì™¸ë¶€ ì €ì¥ì†Œì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤."}),unlinkInfraFromExternalStorage:(s,t)=>ee.backup("unlink-infra-from-external-storage",{infra_id:s,external_storage_id:t},{showSuccessMessage:!0,successMessage:"ì¸í”„ë¼ì™€ ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²°ì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),getInfraStorageMappings:s=>ee.backup("get-infra-storage-mappings",{infra_id:s}),getBatchInfraStorageMappings:s=>ee.backup("get-batch-infra-storage-mappings",{infra_ids:s}),getBatchBackups:s=>ee.backup("get-batch-backups",{infra_ids:s}),getBatchRestores:s=>ee.backup("get-batch-restores",{infra_ids:s})},Tf={request:(s,t)=>ee.request("/project",s,t),getProjects:()=>ee.request("/project","list-my-gitlab-projects",{}),getProjectBranches:s=>ee.request("/project","list-branches",{projectId:s}),getProjectCommits:(s,t)=>ee.request("/project","list-commits",{projectId:s,branchName:t})},ol={request:(s,t)=>ee.request("/user",s,t),checkGitLabStatus:()=>ee.request("/user","check-gitlab-status",{}),saveGitLabInfo:(s,t)=>ee.request("/user","save-gitlab-info",{gitlabURL:s,accessToken:t}),getAllUsers:()=>ee.request("/user","get-all-users",{})},Ns={addHost:async(s,t,r)=>Wl.post("/awx",{action:"addHost",parameters:{hops:s,awxInventory:t,awxTemplate:r}}),removeHost:async s=>Wl.post("/awx",{action:"removeHost",parameters:{awxHostId:s}}),runPlaybook:async s=>{const t=s.hops,r=s.lbHops?s.lbHops[s.lbHops.length-1].host:"",n=s.lbHops?s.lbHops[s.lbHops.length-1].password:"";let a,i;return s.playbook_target_host==="all"?(a="all",i=""):(a=t[t.length-1].host,i=t[t.length-1].password),Wl.post("/awx",{action:"runPlaybook",parameters:{playbook_to_run:s.playbook_to_run,playbook_target_host:a,ansible_become_pass:i,server_id:s.server_id,infra_id:s.infra_id,master_ip:s.master_ip,main_id:s.main_id,lb_ip:r,lb_password:n,node_type:s.node_type?s.node_type:"",awxTemplate:s.awxTemplate,bucket_name:s.bucket_name?s.bucket_name:"",minio_endpoint:s.minio_endpoint?s.minio_endpoint:"",minio_bucket_name:s.minio_bucket_name?s.minio_bucket_name:"",storage_location:s.storage_location?s.storage_location:"",backup_name:s.backup_name?s.backup_name:"",namespace:s.namespace?s.namespace:"",backup_schedule:s.schedule?s.schedule:"",backup_retention:s.retention?s.retention:"",access_key:s.access_key,secret_key:s.secret_key,minio_port:s.minio_port,console_port:s.console_port,images_to_delete:s.images_to_delete}})}},Ft={auth:Cf,infra:yu,kubernetes:ju,service:If,docker:bu,backup:ga,project:Tf,user:ol,awx:Ns,client:ee,checkHealth:()=>ee.checkHealth(),get:ee.get.bind(ee),post:ee.post.bind(ee),put:ee.put.bind(ee),delete:ee.delete.bind(ee)},Pi=s=>s.map(t=>({host:t.host,port:typeof t.port=="string"?parseInt(t.port,10):t.port,username:t.username||"",password:t.password||""})),cs=s=>({data:{success:s.success,data:s.data,error:s.error,message:s.message,statusCode:s.statusCode}}),ze={checkHealth:async()=>({data:await Ft.checkHealth()}),auth:{login:async s=>{const t=await Ft.auth.login(s);return cs(t)},signup:async s=>{const t=await Ft.auth.signup(s);return cs(t)}},infra:{request:async(s,t)=>{const r=await Ft.infra.request(s,t);return cs(r)},list:async()=>{const s=await Ft.infra.list();return cs(s)},listServers:async s=>{const t=await Ft.infra.listServers(s);return cs(t)},validationImportData:async(s,t,r,n)=>{const a=await Ft.infra.validationImportData(s,t,r,n);return cs(a)}},service:{request:async(s,t)=>{const r=await Ft.client.request("/service",s,t);return cs(r)}},kubernetes:{request:async(s,t)=>{const r=await Ft.kubernetes.request(s,t);return cs(r)},getLastDeploymentTime:async s=>{const t=await Ft.kubernetes.getLastDeploymentTime(s);return cs(t)},testSSHConnection:async s=>{const t=await Ft.kubernetes.request("testSSHConnection",{hops:s});return cs(t)}},docker:{request:async(s,t)=>{const r=await Ft.client.request("/docker",s,t);return cs(r)},testSSHConnection:async s=>{const t=await Ft.client.request("/docker","testSSHConnection",{hops:s});return cs(t)}},backup:{installMinio:async s=>{const t={infra_id:s.infra_id,server_id:s.server_id,access_key:s.access_key,secret_key:s.secret_key,port:s.port,auth_data:s.auth_data?Pi(s.auth_data):[]},r=await Ft.client.request("/backup","install-minio",t);return cs(r)},installVelero:async s=>{const t={infra_id:s.infra_id,minio_endpoint:s.minio_endpoint,access_key:s.access_key,secret_key:s.secret_key,bucket:s.bucket,auth_data:s.auth_data?Pi(s.auth_data):[]};s.external_storage_id&&(t.external_storage_id=s.external_storage_id);const r=await Ft.client.request("/backup","install-velero",t);return cs(r)},checkInstallation:async s=>{const t=await Ft.client.request("/backup","check-installation",{infra_id:s});return cs(t)},createBackup:async s=>{const t=await Ft.client.request("/backup","create-backup",s);return cs(t)},listBackups:async s=>{const t=await Ft.client.request("/backup","list-backups",{infra_id:s});return cs(t)},deleteBackup:async(s,t,r)=>{const n=await Ft.client.request("/backup","delete-backup",{infra_id:s,name:t,auth_data:Pi(r)});return cs(n)},createRestore:async s=>{const t={infra_id:s.infra_id,backup_name:s.backup_name,backup_version:s.backup_version,namespace_mappings:s.namespace_mappings,auth_data:Pi(s.auth_data)},r=await Ft.client.request("/backup","create-restore",t);return cs(r)},listRestores:async s=>{const t=await Ft.client.request("/backup","list-restores",{infra_id:s});return cs(t)},deleteRestore:async(s,t,r)=>{const n=await Ft.client.request("/backup","delete-restore",{infra_id:s,name:t,auth_data:Pi(r)});return cs(n)},listMinioStorages:async s=>{const t=await Ft.client.request("/backup","list-minio-storages",{infra_id:s});return cs(t)},listAllMinioStorages:async()=>{const s=await Ft.client.request("/backup","list-all-minio-storages",{});return cs(s)},fetchNamespaces:async(s,t)=>{const r=await Ft.client.request("/backup","fetch-namespaces",{infra_id:s,auth_data:Pi(t)});return cs(r)},getInstallationStatus:async s=>{const t=await Ft.client.request("/backup","get-installation-status",{infra_id:s});return cs(t)},listActualBackups:async(s,t,r,n,a)=>{const i=await Ft.client.request("/backup","list-actual-backups",{infra_id:s,group_label:t,backup_name:r,namespace:n,auth_data:Pi(a)});return cs(i)},startFullSetup:async s=>{const t=await Ft.client.request("/backup","start-full-setup",s);return cs(t)},getSetupStatus:async s=>{const t=await Ft.client.request("/backup","get-setup-status",{job_id:s});return cs(t)},addInfraBackupLine:async s=>{const t=await Ft.client.request("/backup","add-infra-backup-line",s);return cs(t)},insertBackup:async s=>{const t=await Ft.client.request("/backup","insert-backup",s);return cs(t)},updateBackup:async s=>{const t=await Ft.client.request("/backup","update-backup",s);return cs(t)},removeBackup:async s=>{const t=await Ft.client.request("/backup","remove-backup",s);return cs(t)},getBucketName:async s=>{const t=await Ft.client.request("/backup","get-bucket-name",{infra_id:s});return cs(t).data.data},createBackupStorage:async s=>{const t=await Ft.client.request("/backup","create-backup-storage",s);return cs(t).data}},git:{request:async(s,t)=>{const r=await Ft.client.request("/git-stats",s,t);return cs(r)}},project:{listMyProjects:async()=>{const s=await Ft.client.request("/project","list-my-gitlab-projects",{});return cs(s)},listBranches:async s=>{const t=await Ft.client.request("/project","list-branches",{projectId:s});return cs(t)},listCommits:async(s,t)=>{const r=await Ft.client.request("/project","list-commits",{projectId:s,branchName:t});return cs(r)}},user:{checkGitLabStatus:async()=>{const s=await Ft.client.request("/user","check-gitlab-status",{});return cs(s)},saveGitLabInfo:async s=>{const t=await Ft.client.request("/user","save-gitlab-info",s);return cs(t)},getInitialGitLabPassword:async()=>{const s=await Ft.client.request("/user","getInitialGitLabPassword",{});return cs(s)}},nginx:{request:async(s,t)=>{const r=await Ft.client.request("/nginx",s,t);return cs(r)}},get:Ft.client.get.bind(Ft.client),post:Ft.client.post.bind(Ft.client),put:Ft.client.put.bind(Ft.client),delete:Ft.client.delete.bind(Ft.client)};Ft.client.getAxiosInstance();const{TabPane:_l}=xs,{Text:lh}=we,Sg=({visible:s,infraItem:t,onCancel:r,onSave:n,children:a})=>{const[i]=H.useForm(),[l,d]=o.useState(!1),[c,p]=o.useState("general");o.useEffect(()=>{s&&t&&i.setFieldsValue({name:t.name,type:t.type,info:t.info,status:t.status||"inactive"})},[s,t,i]);const h=async()=>{try{const x=await i.validateFields();if(!t)return;d(!0);const _={...t,name:x.name,type:x.type,info:x.info};await ze.kubernetes.request("updateInfra",{id:_.id,name:_.name,type:_.type,info:_.info}),d(!1),n(_),f.success("ì¸í”„ë¼ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤"),r()}catch(x){O.error("ì„¤ì • ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",x),f.error("ì„¤ì • ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤"),d(!1)}};return t?e.jsx(rt,{title:e.jsxs(g,{children:[`${t.name}`,e.jsx(T,{color:t.status==="active"?"success":"error",children:t.status==="active"?"í™œì„±":"ë¹„í™œì„±"})]}),open:s,onCancel:r,footer:[e.jsx(B,{onClick:r,children:"ì·¨ì†Œ"},"cancel"),e.jsx(B,{type:"primary",loading:l,onClick:h,children:"ì €ì¥"},"save")],width:600,children:e.jsx(gt,{spinning:l,children:e.jsxs(xs,{activeKey:c,onChange:p,children:[e.jsx(_l,{tab:"ê¸°ë³¸ ì •ë³´",children:e.jsxs(H,{form:i,layout:"vertical",children:[e.jsx(H.Item,{label:"ì´ë¦„",name:"name",rules:[{required:!0,message:"ì¸í”„ë¼ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì¸í”„ë¼ ì´ë¦„"})}),e.jsx(H.Item,{label:"ìœ í˜•",name:"type",rules:[{required:!0,message:"ì¸í”„ë¼ ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsxs(Ee,{children:[e.jsx(Ee.Option,{value:"kubernetes",children:"ì¿ ë²„ë„¤í‹°ìŠ¤"}),e.jsx(Ee.Option,{value:"baremetal",children:"ë² ì–´ë©”íƒˆ"}),e.jsx(Ee.Option,{value:"docker",children:"ë„ì»¤"}),e.jsx(Ee.Option,{value:"cloud",children:"í´ë¼ìš°ë“œ"}),e.jsx(Ee.Option,{value:"external_kubernetes",children:"ì™¸ë¶€ ì¿ ë²„ë„¤í‹°ìŠ¤"}),e.jsx(Ee.Option,{value:"external_docker",children:"ì™¸ë¶€ ë„ì»¤"})]})}),e.jsx(H.Item,{label:"êµ¬ì„± ì •ë³´",name:"info",rules:[{required:!0,message:"êµ¬ì„± ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue.TextArea,{rows:5,placeholder:"ì¸í”„ë¼ êµ¬ì„±ì— ëŒ€í•œ ìƒì„¸ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"})})]})},"general"),e.jsx(_l,{tab:"ì ‘ê·¼ ì •ë³´",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsx(lh,{type:"secondary",children:"ì´ ì„¹ì…˜ì—ì„œëŠ” ì¸í”„ë¼ì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ì •ë³´ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¶”í›„ ì‹¤ì œ APIì™€ ì—°ë™í•˜ì—¬ êµ¬í˜„í•  ì˜ˆì •ì…ë‹ˆë‹¤."}),e.jsxs(H,{layout:"vertical",children:[e.jsx(H.Item,{label:"ì ‘ê·¼ URL",children:e.jsx(ue,{placeholder:"https://example.com",disabled:!0})}),e.jsx(H.Item,{label:"ì¸ì¦ í† í°",children:e.jsx(ue.Password,{disabled:!0})})]})]})},"access"),e.jsx(_l,{tab:"ëª¨ë‹ˆí„°ë§",children:e.jsx(g,{direction:"vertical",style:{width:"100%"},children:e.jsx(lh,{type:"secondary",children:"ëª¨ë‹ˆí„°ë§ ì„¤ì •ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤."})})},"monitoring"),a&&e.jsx(_l,{tab:"ìƒì„¸ ì„¤ì •",children:a},"details")]})})}):null},{Option:Rf}=Ee,{TextArea:zf}=ue,Ef=({visible:s,onCancel:t,onSubmit:r,loading:n=!1})=>{const[a]=H.useForm(),i=()=>[{value:"kubernetes"},{value:"docker"},{value:"podman"}],l=async()=>{try{const c=await a.validateFields();await r(c)&&(a.resetFields(),t())}catch(c){O.error("Form validation failed",c)}},d=()=>{a.resetFields(),t()};return e.jsx(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(rr,{}),e.jsx("span",{children:"í™˜ê²½ ì¶”ê°€"})]}),open:s,onCancel:d,footer:[e.jsx(B,{onClick:d,children:"ì·¨ì†Œ"},"cancel"),e.jsx(B,{type:"primary",loading:n,onClick:l,children:"ì¶”ê°€"},"submit")],width:600,children:e.jsxs(H,{form:a,layout:"vertical",initialValues:{type:"kubernetes",minioMode:"new"},children:[e.jsx(H.Item,{name:"name",label:"í™˜ê²½ ì´ë¦„",rules:[{required:!0,message:"í™˜ê²½ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"},{min:2,message:"í™˜ê²½ ì´ë¦„ì€ ìµœì†Œ 2ê¸€ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤"},{max:50,message:"í™˜ê²½ ì´ë¦„ì€ ìµœëŒ€ 50ê¸€ìê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: Production Kubernetes Cluster"})}),e.jsx(H.Item,{name:"type",label:"í™˜ê²½ ìœ í˜•",rules:[{required:!0,message:"í™˜ê²½ ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"í™˜ê²½ ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”",children:i().map(c=>e.jsx(Rf,{value:c.value,children:c.value},c.value))})}),e.jsx(H.Item,{name:"info",label:"í™˜ê²½ ì •ë³´",extra:"í™˜ê²½ì— ëŒ€í•œ ìƒì„¸ ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì„¤ì¹˜ ì •ë³´, ì ‘ì† ë°©ë²•, ìš©ë„ ë“±)",children:e.jsx(zf,{rows:4,placeholder:`ì˜ˆ: ìš´ì˜ í™˜ê²½ìš© Kubernetes í´ëŸ¬ìŠ¤í„°
- ë§ˆìŠ¤í„° ë…¸ë“œ: 3ê°œ
- ì›Œì»¤ ë…¸ë“œ: 5ê°œ
- ë²„ì „: v1.24.0
- ë„¤íŠ¸ì›Œí¬: Flannel CNI`,showCount:!0,maxLength:500})})]})})},{Title:fv}=we,Ra={getDevices:async s=>ee.post("/devices",{action:"getDevices",parameters:{userId:s}}),addDevice:async s=>ee.post("/devices",{action:"addDevice",parameters:s}),modDevice:async s=>ee.post("/devices",{action:"modDevice",parameters:s}),delDevice:async s=>ee.post("/devices",{action:"delDevice",parameters:{id:s}}),checkExistingDevice:async(s,t,r)=>ee.post("/devices",{action:"isExistingDevice",parameters:{name:s,hops:t,userId:r}}),updateDeviceAWXHostId:async(s,t)=>ee.post("/devices",{action:"updateDeviceAWXHostId",parameters:{deviceId:s,awxHostId:t}}),getInstalledRuntime:async s=>ee.post("/devices",{action:"getInstalledRuntime",parameters:{deviceId:s}})},vg=({titleInput:s,visible:t,onClose:r,onCancel:n,onAdd:a,onConfirm:i,loading:l,initialNodeType:d,server_type:c})=>{const[p]=H.useForm(),[h,x]=o.useState(!1),[_,S]=o.useState([]),[L,k]=o.useState(null),[E,P]=o.useState(null),{user:I}=Tn(),$=o.useRef(null),y=se=>{$.current&&(se.preventDefault(),$.current.scrollLeft+=se.deltaY)},v=async se=>{const D=(await Ra.getInstalledRuntime(se)).data||[];return{ha:D.includes("ha"),master:D.includes("master"),worker:D.includes("worker"),docker:D.includes("docker"),podman:D.includes("podman")}},u=async()=>{x(!0);try{const se=await Ra.getDevices(I.id),ce=await Promise.all(se.data.map(async D=>{const M=await v(D.id);return{...D,runtime_installed:M}}));S(ce)}catch(se){console.error("Failed to load devices:",se),f.error("ì¥ë¹„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),S([])}finally{x(!1)}},m=se=>{if(!se)return;const ce=new Map;se.forEach(M=>{ce.set(M.id,{...M,children:[]})});const D=[];return ce.forEach(M=>{var K;if(M.parentId){const J=ce.get(M.parentId);J&&((K=J.children)==null||K.push(M))}else D.push(M)}),D},j=(se,ce)=>se.map(D=>{var te,G,q,oe,be;const M=[];(te=D.runtime_installed)!=null&&te.ha&&M.push("HA"),(G=D.runtime_installed)!=null&&G.master&&M.push("Master"),(q=D.runtime_installed)!=null&&q.worker&&M.push("Worker"),(oe=D.runtime_installed)!=null&&oe.docker&&M.push("Docker"),(be=D.runtime_installed)!=null&&be.podman&&M.push("Podman");const K=M.length>0?` - [${M.join(", ")}]`:"",J=K.toLowerCase().includes(ce);return{title:`${D.name} (${D.ipAddress}:${D.port})${K}`,value:D.id,key:D.id,children:D.children?j(D.children,ce):[],disabled:J}}),b=se=>{let ce=_.find(D=>D.id===se);try{const D=[];do{if(!ce)break;D.unshift({host:ce.ipAddress||"",port:ce.port?parseInt(ce.port.toString(),10):22}),ce.parentId?ce=_.find(M=>M.id===ce.parentId)||null:ce=null}while(ce);P(D)}catch(D){console.error(`ì„œë²„ ${se}ì˜ ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:`,D),P([])}};o.useEffect(()=>{t&&(p.resetFields(),p.setFieldsValue({hops:[{host:"",port:22,username:"",password:""}]}),u(),k(null))},[t,p]);const A=(se,ce)=>{const D=[];let M=ce.find(K=>K.id===se);for(;M&&(D.unshift({host:M.ipAddress||"",port:M.port?parseInt(M.port.toString(),10):22}),!!M.parentId);)M=ce.find(K=>K.id===M.parentId);return D},W=async()=>{var se;try{const ce=await p.validateFields(),D=A(ce.device_id,_);ce.hops=D,c!=null&&(ce.server_type=c),i?i(ce):a&&a(ce),p.resetFields(),(se=r||n)==null||se()}catch(ce){console.error(ce)}},Z=()=>{let se="",ce=null;if(d===void 0)return e.jsx(g,{children:s});switch(d){case"ha":se="HA ë…¸ë“œ ì¶”ê°€",ce=e.jsx(ya,{});break;case"master":se="ë§ˆìŠ¤í„° ë…¸ë“œ ì¶”ê°€",ce=e.jsx(Cn,{});break;case"worker":se="ì›Œì»¤ ë…¸ë“œ ì¶”ê°€",ce=e.jsx(_t,{});break}return e.jsxs(g,{children:[ce," ",se]})};return e.jsx(rt,{title:Z(),open:t,onCancel:r||n,confirmLoading:l,onOk:W,okText:"ì¶”ê°€",cancelText:"ì·¨ì†Œ",width:600,children:e.jsxs(H,{form:p,layout:"vertical",autoComplete:"off",children:[(d==="master"||d==="worker")&&e.jsx(H.Item,{name:"server_name",label:"ì„œë²„ ì´ë¦„",rules:[{required:!0,message:"ì„œë²„ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ê´€ë¦¬í•  ì„œë²„ì˜ ê³ ìœ í•œ ì´ë¦„"})}),e.jsx(xt,{orientation:"left",plain:!0,children:"SSH ì ‘ì† ê²½ë¡œ (Hops)"}),e.jsx(H.Item,{name:"device_id",label:"ì¥ë¹„ ì„ íƒ",rules:[{required:!0,message:"ì¥ë¹„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsx(Up,{style:{width:"100%"},dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:"ì¥ë¹„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”",treeData:j(m(_),c),treeDefaultExpandAll:!1,onChange:b,loading:h,notFoundContent:h?e.jsx(gt,{size:"small"}):"ì‚¬ìš© ê°€ëŠ¥í•œ ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤",showSearch:!0,filterTreeNode:(se,ce)=>{const D=ce.title;return typeof D=="string"?D.toLowerCase().includes(se.toLowerCase()):!1}})}),(E==null?void 0:E.length)>0&&e.jsxs("div",{style:{marginTop:"24px",marginBottom:"16px"},children:[e.jsx(we.Text,{strong:!0,style:{display:"block",marginBottom:"12px"},children:"SSH ì—°ê²° ê²½ë¡œ:"}),e.jsx("div",{ref:$,onWheel:y,style:{padding:"16px",backgroundColor:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:"6px",display:"flex",alignItems:"center",overflowX:"auto",whiteSpace:"nowrap"},children:E.map((se,ce)=>e.jsxs(Ct.Fragment,{children:[e.jsx("div",{children:e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#fff",border:"1px solid #d9d9d9",borderRadius:"6px",minWidth:"150px",marginBottom:"8px"},children:[e.jsx("div",{style:{marginBottom:"6px",fontWeight:"bold",fontSize:"13px"},children:ce===E.length-1?"ìµœì¢… ëª©ì ì§€":`Hop ${ce+1}`}),e.jsxs("div",{style:{fontSize:"12px",color:"#333"},children:[se.host,": ",se.port]})]})}),ce<E.length-1&&e.jsx("span",{style:{margin:"0 12px",fontSize:"18px",color:"#52c41a",fontWeight:"bold"},children:"âœ"})]},ce))})]})]})})},{Text:yv}=we,{Option:td}=Ee,{TextArea:Pf}=ue,{Text:ch}=we,Mf=({visible:s,onCancel:t,onSubmit:r,loading:n=!1})=>{const[a]=H.useForm(),i=async()=>{try{const d=await a.validateFields(),c=Lf(d.hops||[]);if(c.length>0){O.error("Hop validation errors",new Error("Hop validation failed"),{hopErrors:c});return}const p=Af(d.hops||[]),h={name:d.name,type:d.type,info:d.info,hops:p};await r(h)&&(a.resetFields(),t())}catch(d){O.error("Form validation failed",d)}},l=()=>{a.resetFields(),t()};return e.jsx(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(ur,{}),e.jsx("span",{children:"ì™¸ë¶€ í™˜ê²½ ê°€ì ¸ì˜¤ê¸°"})]}),open:s,onCancel:l,footer:[e.jsx(B,{onClick:l,children:"ì·¨ì†Œ"},"cancel"),e.jsx(B,{type:"primary",loading:n,onClick:i,children:"ê°€ì ¸ì˜¤ê¸°"},"submit")],width:1200,children:e.jsxs(H,{form:a,layout:"horizontal",initialValues:{type:"external_kubernetes",hops:[{host:"",port:22,username:"",password:""}]},children:[e.jsx(H.Item,{name:"name",label:"ì™¸ë¶€ í™˜ê²½ ì´ë¦„",rules:[{required:!0,message:"í™˜ê²½ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"},{min:2,message:"í™˜ê²½ ì´ë¦„ì€ ìµœì†Œ 2ê¸€ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: External Production Cluster"})}),e.jsx(H.Item,{name:"type",label:"ì™¸ë¶€ í™˜ê²½ ìœ í˜•",rules:[{required:!0,message:"í™˜ê²½ ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsxs(Ee,{placeholder:"ì™¸ë¶€ í™˜ê²½ ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”",children:[e.jsx(td,{value:"external_kubernetes",children:sd("external_kubernetes")}),e.jsx(td,{value:"external_docker",children:sd("external_docker")}),e.jsx(td,{value:"external_podman",children:sd("external_podman")})]})}),e.jsx(H.Item,{name:"info",label:"Â Â Â ì™¸ë¶€ í™˜ê²½ ì •ë³´",extra:"ì™¸ë¶€ í™˜ê²½ì— ëŒ€í•œ ìƒì„¸ ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì ‘ì† ì •ë³´, ìš©ë„, ì£¼ì˜ì‚¬í•­ ë“±)",children:e.jsx(Pf,{rows:4,placeholder:`ì˜ˆ: ì™¸ë¶€ Kubernetes í´ëŸ¬ìŠ¤í„°
- ì ‘ì† ë°©ë²•: SSH í„°ë„ë§
- ìš©ë„: ê°œë°œ í™˜ê²½
- ì£¼ì˜ì‚¬í•­: ê´€ë¦¬ì ìŠ¹ì¸ í•„ìš”`,showCount:!0,maxLength:500})}),e.jsx(xt,{orientation:"left",children:e.jsxs(g,{children:[e.jsx(Ks,{}),e.jsx(ch,{strong:!0,children:"ì—°ê²° ì„¤ì •"})]})}),e.jsx(xe,{message:"ì—°ê²° ì •ë³´",description:"ì™¸ë¶€ í™˜ê²½ì— ì ‘ì†í•˜ê¸° ìœ„í•œ ì—°ê²° ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. ì—¬ëŸ¬ ë‹¨ê³„ì˜ SSH í„°ë„ë§ì´ í•„ìš”í•œ ê²½ìš° ê° ë‹¨ê³„ë¥¼ ìˆœì„œëŒ€ë¡œ ì¶”ê°€í•˜ì„¸ìš”.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(H.List,{name:"hops",children:(d,{add:c,remove:p})=>e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",plain:!0,children:"ì ‘ì† ì •ë³´"}),e.jsx(H.Item,{children:e.jsx(B,{type:"dashed",onClick:()=>c({host:"",port:22,username:"",password:""},0),block:!0,icon:e.jsx(rr,{}),children:"Hop ì¶”ê°€"})}),d.map(({key:h,name:x,..._},S)=>e.jsx("div",{children:e.jsxs(g,{align:"baseline",style:{display:"flex"},children:[e.jsx("div",{style:{width:50},children:e.jsx(ch,{children:S===d.length-1?"íƒ€ê²Ÿ":`Hop ${x+1}`})}),e.jsx(H.Item,{..._,name:[x,"host"],label:"í˜¸ìŠ¤íŠ¸",rules:[{required:!0,message:"í˜¸ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],style:{flex:1,width:300},children:e.jsx(ue,{placeholder:"ì˜ˆ: 192.168.1.100 ë˜ëŠ” server.example.com"})}),e.jsx(H.Item,{..._,name:[x,"port"],label:"í¬íŠ¸",rules:[{required:!0,message:"í¬íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],style:{width:140},children:e.jsx(ue,{type:"number",placeholder:"22",min:1,max:65535})}),e.jsx(H.Item,{..._,name:[x,"username"],label:"ì‚¬ìš©ìëª…",rules:[{required:!0,message:"ì‚¬ìš©ìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],style:{flex:1},children:e.jsx(ue,{placeholder:"SSH ì‚¬ìš©ìëª…"})}),e.jsx(H.Item,{..._,name:[x,"password"],label:"ë¹„ë°€ë²ˆí˜¸",rules:[{required:!0,message:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],style:{flex:1},children:e.jsx(ue.Password,{placeholder:"SSH ë¹„ë°€ë²ˆí˜¸"})}),d.length>1&&e.jsx(B,{type:"text",danger:!0,icon:e.jsx(gs,{}),onClick:()=>p(x),size:"small",children:"ì œê±°"})]})},h))]})})]})})},sd=s=>{switch(s){case"external_kubernetes":return"ì™¸ë¶€ Kubernetes";case"external_docker":return"ì™¸ë¶€ Docker";case"external_podman":return"ì™¸ë¶€ Podman";default:return s}},Lf=s=>{const t=[];return s.forEach((r,n)=>{r.host||t.push(`Hop ${n+1}: í˜¸ìŠ¤íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤`),(!r.port||r.port<1||r.port>65535)&&t.push(`Hop ${n+1}: ìœ íš¨í•œ í¬íŠ¸ ë²ˆí˜¸ê°€ í•„ìš”í•©ë‹ˆë‹¤`),r.username||t.push(`Hop ${n+1}: ì‚¬ìš©ìëª…ì´ í•„ìš”í•©ë‹ˆë‹¤`),r.password||t.push(`Hop ${n+1}: ë¹„ë°€ë²ˆí˜¸ê°€ í•„ìš”í•©ë‹ˆë‹¤`)}),t},Af=s=>s.map(t=>({host:t.host,port:Number(t.port),username:t.username,password:t.password||""})),Nf={getLastDeploymentTime:s=>ze.kubernetes.getLastDeploymentTime(s)},Bf=async()=>{try{const t=(await ze.kubernetes.request("getInfras",{})).data;return t!=null&&t.success&&Array.isArray(t.data)?t.data:[]}catch(s){return O.error("Failed to fetch infras:",s),[]}},$f=async s=>{var t;try{const r=await ze.kubernetes.request("getInfraStatusById",{id:s});if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì¸í”„ë¼ ìƒì„¸ ì¡°íšŒ ì‹¤íŒ¨:",r),r}},Of=async s=>{var t;try{const r=await ze.kubernetes.request("createInfra",s);if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì¸í”„ë¼ ìƒì„± ì‹¤íŒ¨:",r),r}},Df=async(s,t)=>{var r;try{const n=await ze.kubernetes.request("updateInfra",{id:s,...t});if(!n.data||!n.data.success)throw new Error(((r=n.data)==null?void 0:r.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return n.data.data}catch(n){throw O.error("ì¸í”„ë¼ ìˆ˜ì • ì‹¤íŒ¨:",n),n}},dh=async s=>{var t;try{const r=await ze.kubernetes.request("deleteInfra",{id:s});if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì¸í”„ë¼ ì‚­ì œ ì‹¤íŒ¨:",r),r}},Ff=async(s,t)=>{var r;try{const n=await ze.kubernetes.request("updateLastChecked",{server_id:s,status:t});if(!n.data||!n.data.success)throw new Error(((r=n.data)==null?void 0:r.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return n.data.data||[]}catch(n){throw O.error("ë§ˆì§€ë§‰ í™•ì¸ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:",n),n}},Yl=async s=>{var t;try{const r=await ze.kubernetes.request("getServers",{infra_id:s});if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data||[]}catch(r){throw O.error("ì„œë²„ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",r),r}},Uf=async s=>{var t;try{const r=await ze.kubernetes.request("getMasterNodeByInfraID",{infraId:s});if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì„œë²„ ìƒì„¸ ì¡°íšŒ ì‹¤íŒ¨:",r),r}},ac=async s=>{var t;try{const r=await ze.kubernetes.request("createServer",s);if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì„œë²„ ìƒì„± ì‹¤íŒ¨:",r),r}},Hf=async(s,t)=>{var r;try{const n=await ze.kubernetes.request("updateServer",{id:s,...t});if(!n.data||!n.data.success)throw new Error(((r=n.data)==null?void 0:r.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return n.data.data}catch(n){throw O.error("ì„œë²„ ìˆ˜ì • ì‹¤íŒ¨:",n),n}},Vf=async s=>{var t;try{const r=await ze.kubernetes.request("deleteServer",{id:s});if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì„œë²„ ì‚­ì œ ì‹¤íŒ¨:",r),r}},qf=async s=>{const r=(await ze.kubernetes.request("deleteWorker",s)).data;if(!r.success)throw new Error(r.error||"ì›Œì»¤ ë…¸ë“œ ì‚­ì œ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data},Gf=async s=>{const r=(await ze.kubernetes.request("deleteMaster",s)).data;if(!r.success)throw new Error(r.error||"ë§ˆìŠ¤í„° ë…¸ë“œ ì‚­ì œ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data},Wf=async s=>{var t;try{const r=await ze.kubernetes.request("calculateNodes",{server_id:s.id,hops:s.hops});if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data}catch(r){throw O.error("ë…¸ë“œ ê³„ì‚° ì‹¤íŒ¨:",r),r}},Kf=async s=>{const r=(await ze.kubernetes.request("rebuildWorker",s)).data;if(!r.success)throw new Error(r.error||"ì›Œì»¤ ë…¸ë“œ ì¬êµ¬ì¶• ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data},Yf=async s=>{var t;try{const r=await ze.kubernetes.request("getInfraPermissions",{infra_id:s});if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data||[]}catch(r){throw O.error("ì¸í”„ë¼ ê¶Œí•œ ì¡°íšŒ ì‹¤íŒ¨:",r),r}},Jf=async s=>{var t;try{const r=await ze.kubernetes.request("setInfraPermission",s);if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì¸í”„ë¼ ê¶Œí•œ ì„¤ì • ì‹¤íŒ¨:",r),r}},Zf=async s=>{var t;try{const r=await ze.kubernetes.request("removeInfraPermission",s);if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì¸í”„ë¼ ê¶Œí•œ ì œê±° ì‹¤íŒ¨:",r),r}},Qf=async s=>{var t;try{const r=await ze.kubernetes.request("createTLSSecret",s);if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"TLS Secret ìƒì„± ì‹¤íŒ¨");return r.data.data||{success:!0}}catch(r){throw O.error("TLS Secret ìƒì„± ì‹¤íŒ¨:",r),r}},Xf=async s=>{var t;try{const r=await ze.kubernetes.request("listTLSSecrets",s);if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"TLS Secret ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨");return r.data.data||{secrets:[],namespace:s.namespace}}catch(r){throw O.error("TLS Secret ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",r),r}},ey=async s=>{var t;try{const r=await ze.kubernetes.request("deleteTLSSecret",s);if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"TLS Secret ì‚­ì œ ì‹¤íŒ¨");return r.data.data||{success:!0}}catch(r){throw O.error("TLS Secret ì‚­ì œ ì‹¤íŒ¨:",r),r}},ty=async(s,t,r)=>{var n;try{const a=await ze.kubernetes.request("addServerFromKubernetes",{node:s,infra_id:t,device_id:r});if(!a.data||!a.data.success)throw new Error(((n=a.data)==null?void 0:n.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return a.data}catch(a){throw O.error("ì™¸ë¶€ ëŸ°íƒ€ì„ ì„œë²„ ë“±ë¡ ì‹¤íŒ¨:",a),a}},{Title:jv,Text:bv}=we,{Text:_v}=we,wl=s=>{if(s===0)return"0 B";const t=1024,r=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,n)).toFixed(2))+" "+r[n]},sy=({selectedInfra:s,info:t,infoLoading:r})=>{var a,i,l,d,c;const{Text:n}=we;return o.useEffect(()=>{},[s,t]),e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsx(Ke,{gutter:[16,16],style:{marginBottom:24},children:e.jsx(Y,{span:24,children:e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(Bs,{})," í™˜ê²½ ê¸°ë³¸ ì •ë³´"]}),bordered:!0,style:{height:"100%"},extra:e.jsx(T,{color:"blue",children:s.type.toUpperCase()}),children:e.jsxs(Se,{column:1,size:"small",bordered:!0,children:[e.jsx(Se.Item,{label:"í™˜ê²½ ì´ë¦„",children:e.jsx(n,{strong:!0,children:s.name})}),e.jsx(Se.Item,{label:"ì„¤ëª…",children:e.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:s.info||e.jsx(n,{type:"secondary",italic:!0,children:"ì„¤ëª… ì—†ìŒ"})})}),e.jsx(Se.Item,{label:"ìƒì„±ì¼",children:new Date(s.created_at).toLocaleDateString()})]})})})}),s&&t?e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",style:{borderColor:"#d9d9d9"},children:e.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"ëŸ°íƒ€ì„ ë¦¬ì†ŒìŠ¤ í˜„í™©"})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#f6ffed",border:"1px solid #b7eb8f"},children:e.jsx($e,{title:"ì‹¤í–‰ ì¤‘ì¸ Container",value:t==null?void 0:t.runningContainers,valueStyle:{color:"#3f8600"},prefix:e.jsx(Ze,{}),suffix:`/ ${t==null?void 0:t.totalContainers}`})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#fff1f0",border:"1px solid #ffa39e"},children:e.jsx($e,{title:"ë¹„ì •ìƒ/ì¤‘ì§€ Container",value:(t==null?void 0:t.totalContainers)-(t==null?void 0:t.runningContainers),valueStyle:{color:"#cf1322"},prefix:e.jsx(xo,{})})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#e6f7ff",border:"1px solid #91caff"},children:e.jsx($e,{title:"ì›Œí¬ë¡œë“œ ì´ê³„",value:t==null?void 0:t.totalContainers,valueStyle:{color:"#096dd9"},prefix:e.jsx(Da,{})})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#fff7e6",border:"1px solid #ffd591"},children:e.jsx($e,{title:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€",value:t==null?void 0:t.imageCount,valueStyle:{color:"#d46b08"},prefix:e.jsx(_s,{})})})})]}),e.jsx("div",{style:{margin:"16px 0"}}),e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(_t,{})," ëŸ°íƒ€ì„ ìƒì„¸ ì •ë³´"]}),bordered:!0,style:{marginBottom:16},children:e.jsxs(Se,{column:{xxl:4,xl:4,lg:3,md:2,sm:2,xs:1},size:"small",children:[e.jsx(Se.Item,{label:"ëŸ°íƒ€ì„ ìœ í˜•",children:e.jsx(T,{color:"geekblue",children:t==null?void 0:t.runtimeType})}),e.jsx(Se.Item,{label:"ì•„í‚¤í…ì²˜",children:t==null?void 0:t.architecture}),e.jsx(Se.Item,{label:"ë²„ì „",children:t==null?void 0:t.runtimeVersion}),e.jsx(Se.Item,{label:"API ë²„ì „",children:t==null?void 0:t.apiServerVersion}),e.jsx(Se.Item,{label:"OS",children:t==null?void 0:t.os}),e.jsx(Se.Item,{label:"ì»¤ë„",children:t==null?void 0:t.kernelVersion}),e.jsx(Se.Item,{label:"CPU",children:t==null?void 0:t.totalCpu}),e.jsx(Se.Item,{label:"ë©”ëª¨ë¦¬",children:t==null?void 0:t.totalMemory})]})}),e.jsx(xt,{orientation:"left",style:{borderColor:"#d9d9d9",marginTop:8,marginBottom:16},children:e.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§"})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(mc,{style:{fontSize:20,color:"#1890ff"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"ë””ìŠ¤í¬"}),e.jsx(qt,{type:"circle",percent:((a=t==null?void 0:t.mainNodeStorage)==null?void 0:a.usagePercentage)||0,size:80,strokeColor:(((i=t==null?void 0:t.mainNodeStorage)==null?void 0:i.usagePercentage)||0)>80?"#ff4d4f":(((l=t==null?void 0:t.mainNodeStorage)==null?void 0:l.usagePercentage)||0)>60?"#faad14":"#52c41a",format:p=>`${p}%`}),e.jsx(T,{color:(((d=t==null?void 0:t.mainNodeStorage)==null?void 0:d.usagePercentage)||0)>80?"red":"green",style:{fontSize:11},children:(((c=t==null?void 0:t.mainNodeStorage)==null?void 0:c.usagePercentage)||0)>80?"ì£¼ì˜":"ì–‘í˜¸"})]})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(ii,{style:{fontSize:20,color:"#722ed1"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"CPU"}),e.jsx(qt,{type:"circle",percent:Math.round((t==null?void 0:t.cpuUsage)||0),size:80,strokeColor:((t==null?void 0:t.cpuUsage)||0)>80?"#ff4d4f":((t==null?void 0:t.cpuUsage)||0)>60?"#faad14":"#52c41a",format:p=>`${p}%`}),e.jsx(T,{color:((t==null?void 0:t.cpuUsage)||0)>80?"red":((t==null?void 0:t.cpuUsage)||0)>60?"orange":"green",style:{fontSize:11},children:((t==null?void 0:t.cpuUsage)||0)>80?"ë†’ìŒ":((t==null?void 0:t.cpuUsage)||0)>60?"ë³´í†µ":"ì–‘í˜¸"})]})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(_s,{style:{fontSize:20,color:"#13c2c2"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"ë©”ëª¨ë¦¬"}),e.jsx(qt,{type:"circle",percent:Math.round((t==null?void 0:t.memoryUsage)||0),size:80,strokeColor:((t==null?void 0:t.memoryUsage)||0)>80?"#ff4d4f":((t==null?void 0:t.memoryUsage)||0)>60?"#faad14":"#52c41a",format:p=>`${p}%`}),e.jsxs("div",{style:{fontSize:"10px",color:"#888"},children:[wl((t==null?void 0:t.memoryUsed)||0)," /"," ",wl((t==null?void 0:t.memoryTotal)||0)]})]})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(ou,{style:{fontSize:20,color:"#eb2f96"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"ë„¤íŠ¸ì›Œí¬"}),e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx(fc,{style:{color:"#52c41a",fontSize:12}}),e.jsx(n,{style:{fontSize:11,marginLeft:4},children:wl((t==null?void 0:t.networkRx)||0)})]}),e.jsxs("div",{children:[e.jsx(lu,{style:{color:"#1890ff",fontSize:12}}),e.jsx(n,{style:{fontSize:11,marginLeft:4},children:wl((t==null?void 0:t.networkTx)||0)})]})]}),e.jsx(T,{color:"cyan",style:{fontSize:11},children:"ëˆ„ì "})]})})})]})]}):r?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ëŸ°íƒ€ì„ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤.",style:{marginTop:40}}):e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ë“±ë¡ëœ ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤.",style:{marginTop:40}})]})},kg=async s=>{try{const t=await ze.docker.request("getDockerServer",{infra_id:s});if(!t.data.success)throw new Error(t.data.error||"ë„ì»¤ ì„œë²„ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");const r=t.data.data;return{success:!0,data:{server:(r==null?void 0:r.server)||null}}}catch(t){return O.error("ë„ì»¤ ì„œë²„ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(t)}),{success:!0,data:{server:null}}}},Hd=async(s,t,r)=>{try{const a=(await ze.docker.request("getContainers",{server_id:s,...t,runtimeType:r})).data;if(!a.success)throw new Error(a.error||"ì»¨í…Œì´ë„ˆ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return a.data}catch(n){throw O.error("ì»¨í…Œì´ë„ˆ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(n)}),n}},Cg=async(s,t,r)=>{try{const n=await ze.docker.request("importInfra",{device_id:s,user_id:t,...r});if(!n.data.success)throw new Error(n.data.error||"ì™¸ë¶€ ëŸ°íƒ€ì„ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return n.data}catch(n){throw O.error("ì™¸ë¶€ ëŸ°íƒ€ì„ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨",void 0,{error:String(n)}),n}},Ig=async(s,t,r,n,a)=>{try{const i=await ze.docker.request("controlContainer",{server_id:s,container_id:t,action_type:r,hops:n.hops,runtimeType:a});if(!i.data.success)throw new Error(i.data.error||`ì»¨í…Œì´ë„ˆ ${r} ì‘ì—…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.`);return i.data}catch(i){throw O.error(`ì»¨í…Œì´ë„ˆ ${r} ì‹¤íŒ¨`,void 0,{error:String(i)}),i}},Tg=async(s,t,r,n=100,a)=>{try{const i=await ze.docker.request("getDockerLogs",{server_id:s,container_id:t,lines:n,hops:r.hops,runtimeType:a});if(!i.data.success)throw new Error(i.data.error||"ë„ì»¤ ë¡œê·¸ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return i.data}catch(i){throw O.error("ë„ì»¤ ë¡œê·¸ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(i)}),i}},Rg=async(s,t)=>{try{const r=await ze.docker.request("getAllContainerStats",{hops:s.hops,runtimeType:t});if(!r.data.success)throw new Error(r.data.error||"ì»¨í…Œì´ë„ˆ í†µê³„ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data.data||[]}catch(r){throw O.error("ì»¨í…Œì´ë„ˆ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(r)}),r}},zg=async(s,t)=>{try{const r=await ze.docker.request("getDockerSystemInfo",{hops:s.hops,runtimeType:t});if(!r.data.success)throw new Error(r.data.error||"Docker ì‹œìŠ¤í…œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");const n=r.data.data;if(!n)throw new Error("Docker ì‹œìŠ¤í…œ ì •ë³´ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.");return n}catch(r){throw O.error("Docker ì‹œìŠ¤í…œ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(r)}),r}},Sc=async(s,t,r="docker")=>{try{const n=await ze.docker.request("pruneDockerResources",{prune_type:s,hops:t.hops,runtimeType:r});if(!n.data.success)throw new Error(n.data.error||"ë¦¬ì†ŒìŠ¤ ì •ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");const a=n.data.data;return{message:n.data.message||"ë¦¬ì†ŒìŠ¤ ì •ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",output:(a==null?void 0:a.output)||""}}catch(n){throw O.error("ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì‹¤íŒ¨",void 0,{error:String(n),runtimeType:r}),n}},Eg=async(s,t)=>{try{const r=await ze.docker.request("getDockerImages",{hops:s.hops,runtimeType:t});if(!r.data.success)throw new Error(r.data.error||"Docker ì´ë¯¸ì§€ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");const n=r.data.data;return(n==null?void 0:n.images)||[]}catch(r){throw O.error("Docker ì´ë¯¸ì§€ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(r)}),r}},Pg=async(s,t)=>{try{const r=await ze.docker.request("getDockerVolumes",{hops:s.hops,runtimeType:t});if(!r.data.success)throw new Error(r.data.error||"Docker ë³¼ë¥¨ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");const n=r.data.data;return(n==null?void 0:n.volumes)||[]}catch(r){throw O.error("Docker ë³¼ë¥¨ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(r)}),r}},Mg=async(s,t)=>{try{const r=await ze.docker.request("getDockerNetworks",{hops:s.hops,runtimeType:t});if(!r.data.success)throw new Error(r.data.error||"Docker ë„¤íŠ¸ì›Œí¬ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");const n=r.data.data;return(n==null?void 0:n.networks)||[]}catch(r){throw O.error("Docker ë„¤íŠ¸ì›Œí¬ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(r)}),r}},Lg=async(s,t,r)=>{try{const n=await ze.docker.request("executeDockerCommand",{hops:s.hops,command:t,container_id:r}),a=n.data.data,i=n.data.success&&((a==null?void 0:a.exit_code)===0||(a==null?void 0:a.exit_code)===void 0);let l;return i||(l=(a==null?void 0:a.error)||n.data.error,!l&&(a!=null&&a.output)&&(l=a.output),l||(l="ëª…ë ¹ ì‹¤í–‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")),{success:i,output:i&&(a==null?void 0:a.output)||"",error:l}}catch(n){return O.error("Docker ëª…ë ¹ ì‹¤í–‰ ì‹¤íŒ¨",void 0,{error:String(n),command:t,containerId:r}),{success:!1,output:"",error:String(n)}}},Ag=async s=>{try{const t=await ze.docker.request("createDockerBackup",s);if(!t.data.success)throw new Error(t.data.error||"Docker ë°±ì—… ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data.data}catch(t){throw O.error("Docker ë°±ì—… ìƒì„± ì‹¤íŒ¨",void 0,{error:String(t)}),t}},Ng=async(s,t)=>{try{const r={};t||s&&(r.infra_id=s);const n=await ze.docker.request("getDockerBackups",r);if(!n.data.success)throw new Error(n.data.error||"Docker ë°±ì—… ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");const a=n.data.data;return(a==null?void 0:a.backups)||[]}catch(r){throw O.error("Docker ë°±ì—… ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(r)}),r}},Bg=async s=>{try{const t=await ze.docker.request("getDockerBackup",{backup_id:s});if(!t.data.success)throw new Error(t.data.error||"Docker ë°±ì—… ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data.data}catch(t){throw O.error("Docker ë°±ì—… ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},$g=async(s,t,r=!1)=>{try{const n=await ze.docker.request("deleteDockerBackup",{backup_id:s,hops:t,hard_delete:r});if(!n.data.success)throw new Error(n.data.error||"Docker ë°±ì—… ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(n){throw O.error("Docker ë°±ì—… ì‚­ì œ ì‹¤íŒ¨",void 0,{error:String(n)}),n}},Og=async s=>{try{const t=await ze.docker.request("restoreDockerBackup",s);if(!t.data.success)throw new Error(t.data.error||"Docker ë°±ì—… ë³µêµ¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data.data}catch(t){throw O.error("Docker ë°±ì—… ë³µêµ¬ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},Dg=async s=>{try{const t=await ze.docker.request("getDockerRestores",{infra_id:s});if(!t.data.success)throw new Error(t.data.error||"Docker ë³µêµ¬ ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");const r=t.data.data;return(r==null?void 0:r.restores)||[]}catch(t){throw O.error("Docker ë³µêµ¬ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},ry=Object.freeze(Object.defineProperty({__proto__:null,controlContainer:Ig,createDockerBackup:Ag,deleteDockerBackup:$g,executeCommand:Lg,getAllContainerStats:Rg,getContainers:Hd,getDockerBackup:Bg,getDockerBackups:Ng,getDockerImages:Eg,getDockerLogs:Tg,getDockerNetworks:Mg,getDockerRestores:Dg,getDockerServer:kg,getDockerSystemInfo:zg,getDockerVolumes:Pg,importInfra:Cg,pruneDockerResources:Sc,restoreDockerBackup:Og},Symbol.toStringTag,{value:"Module"})),ny=({runtimeDetails:s,selectedInfra:t,onLoading:r,getStoredAuthHops:n,setRuntimeDetails:a})=>{var y,v;const[i,l]=o.useState([]),[d,c]=o.useState(!1),[p,h]=o.useState(!1),[x,_]=o.useState(""),{user:S}=Tn(),L=o.useMemo(()=>{if(!(s!=null&&s.images))return[];if(!x.trim())return s.images;const u=x.toLowerCase();return s.images.filter(m=>m.repository.toLowerCase().includes(u)||m.tag.toLowerCase().includes(u)||m.id.toLowerCase().includes(u))},[s==null?void 0:s.images,x]),k=async()=>{if(i.length===0){f.info("ì‚­ì œí•  ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}const u=s==null?void 0:s.images.filter(A=>i.includes(A.id)).map(A=>`${A.repository}:${A.tag}`);if(!u||u.length===0){f.error("ì‚­ì œí•  ì´ë¯¸ì§€ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}c(!0),f.info(`${u.length}ê°œì˜ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤...`);const m=n(JSON.parse(t.nodes[0].hops)),j=t.type.includes("docker")?"docker":"podman";if((await Ns.runPlaybook({playbook_to_run:`delete_${j}_images`,hops:m,awxTemplate:S==null?void 0:S.awx_template,images_to_delete:u})).data.status!=="failed"){f.success("ì„ íƒí•œ ì´ë¯¸ì§€ë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.");const A=s==null?void 0:s.images.filter(W=>!i.includes(W.id));a({...s,images:A,image_count:A.length}),l([])}else f.error("ì´ë¯¸ì§€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. SSH ì ‘ì† ì •ë³´ë‚˜ ì´ë¯¸ì§€ ì‚¬ìš© ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");c(!1)},E=async()=>{var u,m;h(!0),f.info("ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤...");try{const j=n(JSON.parse(t.nodes[0].hops)),b=await Sc("images",{hops:j},"docker");f.success(b.message||"ì´ë¯¸ì§€ ì •ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");const A=new Set(((u=s==null?void 0:s.containers)==null?void 0:u.map(Z=>Z.image))||[]),W=((m=s==null?void 0:s.images)==null?void 0:m.filter(Z=>{const se=`${Z.repository}:${Z.tag}`;return A.has(se)||A.has(Z.repository)||A.has(Z.id)}))||[];a({...s,images:W,image_count:W.length}),l([])}catch(j){f.error("ì´ë¯¸ì§€ ì •ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{h(!1)}},I={selectedRowKeys:i,onChange:u=>{l(u)}},$=i.length>0;return e.jsxs("div",{children:[e.jsx(ie,{title:e.jsxs(g,{align:"center",children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ì»¨í…Œì´ë„ˆ ëª©ë¡"}),e.jsx(T,{children:(s==null?void 0:s.container_count)||0})]}),style:{marginBottom:16},size:"small",children:r?e.jsx(gt,{}):e.jsx(e.Fragment,{children:s!=null&&s.containers&&(s==null?void 0:s.containers.length)>0?e.jsx(wt,{dataSource:s==null?void 0:s.containers,columns:[{title:"ì»¨í…Œì´ë„ˆëª…",dataIndex:"name",key:"name",ellipsis:!0},{title:"ì´ë¯¸ì§€",dataIndex:"image",key:"image",ellipsis:!0},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:100,render:u=>{const m={running:"green",stopped:"red",paused:"orange",exited:"gray"};return e.jsx(T,{color:m[u]||"default",children:u})}},{title:"í¬íŠ¸",dataIndex:"ports",key:"ports",width:150,ellipsis:!0}],rowKey:"id",pagination:{pageSize:5,size:"small"},size:"small",scroll:{x:600}}):e.jsx(Je,{description:"ì»¨í…Œì´ë„ˆê°€ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})}),e.jsx(ie,{title:e.jsxs(g,{align:"center",style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[e.jsxs(g,{children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ì´ë¯¸ì§€ ëª©ë¡"}),e.jsxs(T,{children:[L.length,x?` / ${(s==null?void 0:s.image_count)||0}`:""]})]}),e.jsxs(g,{children:[e.jsx(ue,{placeholder:"ê²€ìƒ‰...",prefix:e.jsx(Fi,{}),value:x,onChange:u=>_(u.target.value),style:{width:150},allowClear:!0,size:"small"}),e.jsx(Kt,{title:"ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ì •ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:"ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ê°€ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤.",onConfirm:E,okText:"ì •ë¦¬",cancelText:"ì·¨ì†Œ",disabled:p,children:e.jsx(B,{icon:e.jsx($a,{}),size:"small",disabled:p||d,loading:p,children:"ë¯¸ì‚¬ìš© ì •ë¦¬"})}),e.jsx(Kt,{title:`${i.length}ê°œì˜ ì´ë¯¸ì§€ë¥¼ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,onConfirm:k,okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",disabled:!$||d,children:e.jsx(B,{type:"primary",danger:!0,size:"small",disabled:!$||d,loading:d&&$,children:"ì‚­ì œ"})})]})]}),style:{marginBottom:16},size:"small",children:r?e.jsx(gt,{}):e.jsx(e.Fragment,{children:L.length>0?e.jsx(wt,{rowSelection:I,dataSource:L,columns:[{title:"ì´ë¯¸ì§€ëª…",dataIndex:"repository",key:"repository",ellipsis:!0,render:(u,m)=>u&&u.includes(":")?u:m.tag&&m.tag.length<20?`${u}:${m.tag}`:u},{title:"ID",dataIndex:"tag",key:"tag",width:110,ellipsis:!0,render:(u,m)=>{const j=u&&u.length>=12?u:m.id;return j?j.substring(0,12):"-"}},{title:"í¬ê¸°",dataIndex:"size",key:"size",width:90,render:(u,m)=>(!u||u==="0B"||u==="0")&&m.created&&/\d+(\.\d+)?\s*(B|KB|MB|GB|TB)/i.test(m.created)?m.created:u||"-"}],rowKey:"id",pagination:{pageSize:5,size:"small"},size:"small",scroll:{x:500}}):e.jsx(Je,{description:x?`'${x}' ê²°ê³¼ ì—†ìŒ`:"ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,lg:12,children:e.jsx(ie,{title:e.jsxs(g,{align:"center",children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ë³¼ë¥¨ ëª©ë¡"}),e.jsx(T,{children:((y=s==null?void 0:s.volumes)==null?void 0:y.length)||0})]}),style:{height:"100%"},size:"small",children:r?e.jsx(gt,{}):e.jsx(e.Fragment,{children:s!=null&&s.volumes&&(s==null?void 0:s.volumes.length)>0?e.jsx(wt,{dataSource:s==null?void 0:s.volumes,columns:[{title:"ë³¼ë¥¨ëª…",dataIndex:"name",key:"name",ellipsis:!0},{title:"ì»¨í…Œì´ë„ˆ",dataIndex:"usedBy",key:"usedBy",ellipsis:!0}],rowKey:u=>`${u.name}-${u.usedBy}`,pagination:!1,size:"small",scroll:{y:180}}):e.jsx(Je,{description:"ë³¼ë¥¨ì´ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})})}),e.jsx(Y,{xs:24,lg:12,children:e.jsx(ie,{title:e.jsxs(g,{align:"center",children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ë„¤íŠ¸ì›Œí¬ ëª©ë¡"}),e.jsx(T,{children:((v=s==null?void 0:s.networks)==null?void 0:v.length)||0})]}),style:{height:"100%"},size:"small",children:r?e.jsx(gt,{}):e.jsx(e.Fragment,{children:s!=null&&s.networks&&(s==null?void 0:s.networks.length)>0?e.jsx(wt,{dataSource:s==null?void 0:s.networks,columns:[{title:"ë„¤íŠ¸ì›Œí¬ëª…",dataIndex:"name",key:"name",ellipsis:!0},{title:"ì„œë¸Œë„·",dataIndex:"subnet",key:"subnet",ellipsis:!0},{title:"ì»¨í…Œì´ë„ˆ",dataIndex:"container_count",key:"container_count",width:80}],rowKey:"name",pagination:!1,size:"small",scroll:{y:180}}):e.jsx(Je,{description:"ë„¤íŠ¸ì›Œí¬ê°€ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})})})]})]})},uh=s=>{let t;const r=new Set,n=(p,h)=>{const x=typeof p=="function"?p(t):p;if(!Object.is(x,t)){const _=t;t=(h!=null?h:typeof x!="object"||x===null)?x:Object.assign({},t,x),r.forEach(S=>S(t,_))}},a=()=>t,d={setState:n,getState:a,getInitialState:()=>c,subscribe:p=>(r.add(p),()=>r.delete(p))},c=t=s(n,a,d);return d},ay=s=>s?uh(s):uh,iy=s=>s;function oy(s,t=iy){const r=Ct.useSyncExternalStore(s.subscribe,Ct.useCallback(()=>t(s.getState()),[s,t]),Ct.useCallback(()=>t(s.getInitialState()),[s,t]));return Ct.useDebugValue(r),r}const ly=s=>{const t=ay(s),r=n=>oy(t,n);return Object.assign(r,t),r},Fg=s=>ly;function Ug(s,t){let r;try{r=s()}catch(a){return}return{getItem:a=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),d=(i=r.getItem(a))!=null?i:null;return d instanceof Promise?d.then(l):l(d)},setItem:(a,i)=>r.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>r.removeItem(a)}}const Vd=s=>t=>{try{const r=s(t);return r instanceof Promise?r:{then(n){return Vd(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Vd(n)(r)}}}},cy=(s,t)=>(r,n,a)=>{let i={storage:Ug(()=>localStorage),partialize:k=>k,version:0,merge:(k,E)=>({...E,...k}),...t},l=!1;const d=new Set,c=new Set;let p=i.storage;if(!p)return s((...k)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...k)},n,a);const h=()=>{const k=i.partialize({...n()});return p.setItem(i.name,{state:k,version:i.version})},x=a.setState;a.setState=(k,E)=>(x(k,E),h());const _=s((...k)=>(r(...k),h()),n,a);a.getInitialState=()=>_;let S;const L=()=>{var k,E;if(!p)return;l=!1,d.forEach(I=>{var $;return I(($=n())!=null?$:_)});const P=((E=i.onRehydrateStorage)==null?void 0:E.call(i,(k=n())!=null?k:_))||void 0;return Vd(p.getItem.bind(p))(i.name).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==i.version){if(i.migrate){const $=i.migrate(I.state,I.version);return $ instanceof Promise?$.then(y=>[!0,y]):[!0,$]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,I.state];return[!1,void 0]}).then(I=>{var $;const[y,v]=I;if(S=i.merge(v,($=n())!=null?$:_),r(S,!0),y)return h()}).then(()=>{P==null||P(S,void 0),S=n(),l=!0,c.forEach(I=>I(S))}).catch(I=>{P==null||P(void 0,I)})};return a.persist={setOptions:k=>{i={...i,...k},k.storage&&(p=k.storage)},clearStorage:()=>{p==null||p.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>L(),hasHydrated:()=>l,onHydrate:k=>(d.add(k),()=>{d.delete(k)}),onFinishHydration:k=>(c.add(k),()=>{c.delete(k)})},i.skipHydration||L(),S||_},dy=cy,Gs=Fg()(dy((s,t)=>({imageRegistry:[],sourceRepository:[],serverlist:[],upsertImageRegistry:r=>{const n=t().imageRegistry,a=n.findIndex(i=>i.registryUrl===r.registryUrl);if(a>=0){const i=n.slice();i[a]=r,s({imageRegistry:i})}else s({imageRegistry:[r,...n]})},removeImageRegistry:r=>{s({imageRegistry:t().imageRegistry.filter(n=>n.registryUrl!==r)})},upsertSourceRepository:r=>{const n=t().sourceRepository,a=n.findIndex(i=>i.baseUrl===r.baseUrl);if(a>=0){const i=n.slice();i[a]={...i[a],...r},s({sourceRepository:i})}else s({sourceRepository:[r,...n]})},removeSourceRepository:r=>{s({sourceRepository:t().sourceRepository.filter(n=>n.baseUrl!==r)})},updateSecurityState:(r,n,a,i)=>{const l=t().sourceRepository,d=l.findIndex(c=>c.baseUrl===r&&(i!==void 0?c.serviceId===i:c.serviceId===void 0));if(d>=0){const c=[...l],p=c[d],h=`${n}State`;c[d]={...p,[h]:a},s({sourceRepository:c})}else{const c=`${n}State`,p=i!==void 0?l.find(x=>x.baseUrl===r&&x.serviceId===void 0):void 0,h=p?{...p,serviceId:i,[c]:a}:{baseUrl:r,serviceId:i,token:"",userId:"",[c]:a};s({sourceRepository:[...l,h]})}},updateSecurityLastUpdate:(r,n,a,i)=>{const l=t().sourceRepository,d=l.findIndex(c=>c.baseUrl===r&&(i!==void 0?c.serviceId===i:c.serviceId===void 0));if(d>=0){const c=[...l],p=c[d],h=`${n}LastUpdate`;c[d]={...p,[h]:a},s({sourceRepository:c})}else{const c=`${n}LastUpdate`,p=i!==void 0?l.find(x=>x.baseUrl===r&&x.serviceId===void 0):void 0,h=p?{...p,serviceId:i,[c]:a}:{baseUrl:r,serviceId:i,token:"",userId:"",[c]:a};s({sourceRepository:[...l,h]})}},getSecurityState:(r,n,a)=>{let i=t().sourceRepository.find(c=>c.baseUrl===r&&(a!==void 0?c.serviceId===a:c.serviceId===void 0));if(!i&&a!==void 0){const c=t().sourceRepository.find(p=>p.baseUrl===r&&p.serviceId===void 0);if(c){const p={...c,serviceId:a},h=t().sourceRepository;s({sourceRepository:[...h,p]}),i=p}}if(!i)return"null";const l=`${n}State`;return i[l]||"null"},getSecurityLastUpdate:(r,n,a)=>{let i=t().sourceRepository.find(d=>d.baseUrl===r&&(a!==void 0?d.serviceId===a:d.serviceId===void 0));if(!i&&a!==void 0&&(i=t().sourceRepository.find(d=>d.baseUrl===r&&d.serviceId===void 0)),!i)return null;const l=`${n}LastUpdate`;return i[l]||null},addServer:r=>s({serverlist:[r,...t().serverlist]}),upsertServerByHostPort:r=>{const n=d=>{var c;return((c=d==null?void 0:d.trim())==null?void 0:c.toLowerCase())||""},a=d=>d!=null?d:22,i=t().serverlist;let l=i.findIndex(d=>{const c=n(d.host)===n(r.host),p=a(d.port)===a(r.port),h=d.userId===r.userId;return!c||!p||!h?!1:r.infraId!==void 0&&r.serviceId!==void 0&&r.hopOrder!==void 0?d.infraId===r.infraId&&d.serviceId===r.serviceId&&d.hopOrder===r.hopOrder:r.infraId!==void 0&&r.serviceId!==void 0?d.infraId===r.infraId&&d.serviceId===r.serviceId:r.infraId!==void 0?d.infraId===r.infraId:d.infraId===void 0});if(l<0&&r.infraId!==void 0&&(l=-1),l>=0){const d=i.slice();d[l]={...d[l],userId:r.userId,password:r.password,infraId:r.infraId,serviceId:r.serviceId,hopOrder:r.hopOrder},s({serverlist:d})}else s({serverlist:[r,...i]})},updateServer:(r,n)=>{const a=t().serverlist.slice();r>=0&&r<a.length&&(a[r]={...a[r],...n},s({serverlist:a}))},removeServer:r=>{const n=t().serverlist.slice();r>=0&&r<n.length&&(n.splice(r,1),s({serverlist:n}))},clearAll:()=>s({imageRegistry:[],sourceRepository:[],serverlist:[]})}),{name:"creds-store",storage:Ug(()=>localStorage),partialize:s=>({imageRegistry:s.imageRegistry,sourceRepository:s.sourceRepository,serverlist:s.serverlist})})),Vo=Object.freeze(Object.defineProperty({__proto__:null,useCredsStore:Gs},Symbol.toStringTag,{value:"Module"})),Hi=({visible:s,onClose:t,onComplete:r,hops:n,infraId:a,serviceId:i,serviceName:l,isRetry:d=!1})=>{const[c]=H.useForm(),{serverlist:p,upsertServerByHostPort:h}=Gs(),[x,_]=o.useState([]);o.useEffect(()=>{if(!s)return;const k=[],E={};n.forEach((P,I)=>{let $=p.find(y=>y.host===P.host&&(y.port===P.port||!y.port&&P.port===22)&&y.userId===P.username&&a!==void 0&&y.infraId===a&&i!==void 0&&y.serviceId===i&&y.hopOrder===I);!$&&a!==void 0&&($=p.find(y=>y.host===P.host&&(y.port===P.port||!y.port&&P.port===22)&&y.userId===P.username&&y.infraId===a)),E[`username_${I}`]=P.username,$&&$.password&&!d?E[`password_${I}`]=$.password:(E[`password_${I}`]="",k.push(P))}),_(n),O.info("SSH Credential Modal opened",{totalHops:n.length,hopsNeedingPassword:k.length,infraId:a,serviceId:i,isRetry:d},"SshCredentialModal","open"),c.setFieldsValue(E),k.length===0&&!d&&(O.info("All SSH credentials found in localStorage, auto-submitting",{infraId:a,serviceId:i},"SshCredentialModal","auto-submit"),setTimeout(()=>{S()},100))},[s,n,p,a,i,d,c]);const S=async()=>{try{const k=await c.validateFields();O.debug("Form validation passed",{fieldCount:Object.keys(k).length},"SshCredentialModal","handleSubmit"),x.forEach((P,I)=>{const $=k[`username_${I}`]||P.username,y=k[`password_${I}`];if(y){const v={host:P.host,port:P.port,userId:$,password:y,infraId:a,serviceId:i,hopOrder:I};h(v),O.info("SSH credential saved",{host:P.host,port:P.port,username:$,infraId:a,serviceId:i,hopOrder:I},"SshCredentialModal","save")}});const E=n.map(P=>{const I=x.findIndex(v=>v.host===P.host&&v.port===P.port&&v.username===P.username);if(I>=0){const v=k[`username_${I}`]||P.username,u=k[`password_${I}`];return{...P,username:v,password:u||""}}const $=n.findIndex(v=>v.host===P.host&&v.port===P.port&&v.username===P.username);let y=p.find(v=>v.host===P.host&&(v.port===P.port||!v.port&&P.port===22)&&v.userId===P.username&&a!==void 0&&v.infraId===a&&i!==void 0&&v.serviceId===i&&$>=0&&v.hopOrder===$);return!y&&a!==void 0&&i!==void 0&&(y=p.find(v=>v.host===P.host&&(v.port===P.port||!v.port&&P.port===22)&&v.userId===P.username&&v.infraId===a&&v.serviceId===i)),!y&&a!==void 0&&(y=p.find(v=>v.host===P.host&&(v.port===P.port||!v.port&&P.port===22)&&v.userId===P.username&&v.infraId===a)),!y&&a===void 0&&(y=p.find(v=>v.host===P.host&&(v.port===P.port||!v.port&&P.port===22)&&v.userId===P.username&&v.infraId===void 0)),y||(y=p.find(v=>v.host===P.host&&(v.port===P.port||!v.port&&P.port===22)&&v.userId===P.username),y&&O.warn("Using credential without exact match",{host:P.host,port:P.port,username:P.username,requestedInfraId:a,requestedServiceId:i,foundInfraId:y.infraId,foundServiceId:y.serviceId},"SshCredentialModal","fallback")),{...P,password:(y==null?void 0:y.password)||""}});O.info("SSH credentials completed",{totalHops:E.length},"SshCredentialModal","complete"),r(E),c.resetFields(),t()}catch(k){O.error("Form validation failed",k,{},"SshCredentialModal","handleSubmit")}},L=()=>{O.info("SSH credential input cancelled",{},"SshCredentialModal","cancel"),c.resetFields(),t()};return e.jsxs(rt,{title:"SSH ì ‘ì† ì •ë³´ ì…ë ¥",open:s,onCancel:L,width:600,footer:[e.jsx(B,{onClick:L,children:"ì·¨ì†Œ"},"cancel"),e.jsx(B,{type:"primary",onClick:S,children:"í™•ì¸"},"submit")],children:[d&&e.jsx(xe,{message:"ì¸ì¦ ì‹¤íŒ¨",description:"ì´ì „ì— ì…ë ¥í•˜ì‹  SSH ì ‘ì† ì •ë³´ë¡œ ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx(xe,{message:"SSH ì ‘ì† ì •ë³´ í•„ìš”",description:l?`'${l}' ì„œë¹„ìŠ¤ì˜ Docker ì»¨í…Œì´ë„ˆì— ì ‘ì†í•˜ê¸° ìœ„í•´ SSH ì ‘ì† ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì…ë ¥í•˜ì‹  ì •ë³´ëŠ” ë¸Œë¼ìš°ì €ì˜ LocalStorageì— ì•ˆì „í•˜ê²Œ ì €ì¥ë©ë‹ˆë‹¤.`:"Docker ì»¨í…Œì´ë„ˆì— ì ‘ì†í•˜ê¸° ìœ„í•´ SSH ì ‘ì† ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì…ë ¥í•˜ì‹  ì •ë³´ëŠ” ë¸Œë¼ìš°ì €ì˜ LocalStorageì— ì•ˆì „í•˜ê²Œ ì €ì¥ë©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:20}}),e.jsx(H,{form:c,layout:"vertical",children:x.map((k,E)=>e.jsxs("div",{children:[E>0&&e.jsx(xt,{}),e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs("div",{style:{fontSize:"14px",fontWeight:500,color:"#1890ff"},children:[e.jsx(ur,{})," SSH Hop ",E+1]}),e.jsxs("div",{style:{fontSize:"12px",color:"#666",marginLeft:24},children:[e.jsxs("div",{children:["Host: ",k.host]}),e.jsxs("div",{children:["Port: ",k.port]})]}),e.jsx(H.Item,{name:`username_${E}`,label:"Username",rules:[{required:!0,message:"Usernameì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],initialValue:k.username,style:{marginBottom:8},children:e.jsx(ue,{prefix:e.jsx(Un,{}),placeholder:"Username",autoComplete:"off"})}),e.jsx(H.Item,{name:`password_${E}`,label:"Password",rules:[{required:!0,message:"Passwordë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],style:{marginBottom:E===x.length-1?0:16},children:e.jsx(ue.Password,{prefix:e.jsx(Qn,{}),placeholder:"Password",autoComplete:"new-password"})})]})]},`${k.host}:${k.port}`))})]})},hh=({runtimeDetails:s,selectedInfra:t,onLoading:r,getStoredAuthHops:n,setRuntimeDetails:a})=>{const[i,l]=o.useState(!1),[d,c]=o.useState(!1),[p,h]=o.useState(null),[x,_]=o.useState([]),[S,L]=o.useState(null),[k,E]=o.useState(!1),P=y=>{},I=o.useCallback(async()=>{var y,v,u;if(L(null),!!t&&t.nodes.length!==0){E(!0);try{const m=n(JSON.parse(t.nodes[0].hops));m.filter(D=>!D.username||!D.password).length>0&&(_(m),c(!0),l(!0));const b=await bu.request("getSingleHostInfo",{hops:m,infra_id:t.id,type:t.type}),A=(y=b.data.storageResult)==null?void 0:y.split(`
`)[0].split(" "),W=((v=b.data.memoryDetailResult)==null?void 0:v.split(" "))||["0","0"],Z=Number(W[0])||0,se=Number(W[1])||0,ce={runningContainers:Number(b.data.runningContainersResult),totalContainers:Number(b.data.totalContainersResult),failedOrStoppedContainers:Number(b.data.stopContainersResult),workloadCount:Number(b.data.workloadsResult),imageCount:b.data.imagesResult.split(" ").filter(D=>D.trim().length!==0).length,runtimeType:"docker",architecture:b.data.architectureResult,runtimeVersion:b.data.runtimeVersionResult,apiServerVersion:b.data.apiVersionResult,os:b.data.osResult,kernelVersion:b.data.kernalResult,totalCpu:b.data.cpuCoreResult,totalMemory:b.data.memoryResult,mainNodeStorage:{usagePercentage:Number((u=A[2])==null?void 0:u.split("%")[0]),total:Number(A[0]),used:Number(A[1])},cpuUsage:Number(b.data.cpuUsageResult)||0,memoryUsage:Number(b.data.memoryUsageResult)||0,memoryUsed:Z,memoryTotal:se,networkRx:Number(b.data.networkRxResult)||0,networkTx:Number(b.data.networkTxResult)||0};L(ce)}catch(m){if(console.error(m),m instanceof Error&&m.message.includes("SSH ì—°ê²° ê²€ì¦ ì‹¤íŒ¨")){const j=t.nodes.filter(A=>A.type==="master"||typeof A.type=="string"&&A.type.includes("master")),b=n(JSON.parse(j[0].hops));_(b),c(!0),l(!0)}}finally{E(!1)}}},[t,n]);o.useEffect(()=>{I()},[I]);const $=[{key:"runtimeInfo",label:"ê°œìš”",children:e.jsx(sy,{selectedInfra:t,info:S,infoLoading:k})},{key:"runtimeDetails",label:"ëŸ°íƒ€ì„ í™˜ê²½",children:e.jsx(ny,{runtimeDetails:s,selectedInfra:t,onLoading:r,getStoredAuthHops:n,setRuntimeDetails:a})}];return e.jsxs(e.Fragment,{children:[e.jsx(xs,{defaultActiveKey:"runtimeInfo",items:$}),e.jsx(Hi,{visible:i,onClose:()=>{l(!1),c(!1),h(null)},onComplete:P,hops:x.map(y=>({...y,username:y.username||""})),infraId:p==null?void 0:p.infraId,isRetry:d})]})},uy=({runtimeDetails:s,onLoading:t})=>{var r,n,a;return e.jsx(e.Fragment,{children:t?e.jsx(gt,{children:"ëŸ°íƒ€ì„ ë¦¬ì†ŒìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤."}):e.jsxs("div",{children:[e.jsx(ie,{title:e.jsxs(g,{align:"center",children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"Pod ëª©ë¡"}),e.jsx(T,{children:((r=s==null?void 0:s.pods)==null?void 0:r.length)||0})]}),style:{marginBottom:16},size:"small",children:s!=null&&s.pods&&s.pods.length>0?e.jsx(wt,{dataSource:s.pods,columns:[{title:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤",dataIndex:"namespace",key:"namespace",width:120,ellipsis:!0},{title:"Podëª…",dataIndex:"name",key:"name",ellipsis:!0},{title:"ë…¸ë“œ",dataIndex:"node",key:"node",width:120,ellipsis:!0},{title:"IP",dataIndex:"ip",key:"ip",width:130},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:120,render:i=>{const l={Running:"green",Pending:"orange",Succeeded:"blue",Failed:"red",Unknown:"gray",CrashLoopBackOff:"magenta"};return e.jsx(T,{color:l[i]||"default",children:i})}}],rowKey:i=>`${i.namespace}-${i.name}`,pagination:{pageSize:5,size:"small"},size:"small",scroll:{x:700}}):e.jsx(Je,{description:"Podê°€ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,lg:12,children:e.jsx(ie,{title:e.jsxs(g,{align:"center",children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ë³¼ë¥¨(PVC) ëª©ë¡"}),e.jsx(T,{children:((n=s==null?void 0:s.volumes_pvc)==null?void 0:n.length)||0})]}),style:{height:"100%"},size:"small",children:s!=null&&s.volumes_pvc&&s.volumes_pvc.length>0?e.jsx(wt,{dataSource:s.volumes_pvc,columns:[{title:"PVCëª…",dataIndex:"pvc_name",key:"pvc_name",ellipsis:!0},{title:"ìš©ëŸ‰",dataIndex:"capacity",key:"capacity",width:80},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:80,render:i=>{const l=i==="Bound"?"green":i==="Available"?"blue":"orange";return e.jsx(T,{color:l,children:i})}}],rowKey:i=>`${i.namespace}-${i.pvc_name}`,pagination:!1,size:"small",scroll:{y:180}}):e.jsx(Je,{description:"PVC ë³¼ë¥¨ì´ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})}),e.jsx(Y,{xs:24,lg:12,children:e.jsx(ie,{title:e.jsxs(g,{align:"center",children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ë„¤íŠ¸ì›Œí¬(Service) ëª©ë¡"}),e.jsx(T,{children:((a=s==null?void 0:s.network_svc)==null?void 0:a.length)||0})]}),style:{height:"100%"},size:"small",children:s!=null&&s.network_svc&&s.network_svc.length>0?e.jsx(wt,{dataSource:s.network_svc,columns:[{title:"ì„œë¹„ìŠ¤ëª…",dataIndex:"name",key:"name",ellipsis:!0},{title:"íƒ€ì…",dataIndex:"type",key:"type",width:90},{title:"Cluster IP",dataIndex:"cluster_ip",key:"cluster_ip",width:110,ellipsis:!0}],rowKey:i=>`${i.namespace}-${i.name}`,pagination:!1,size:"small",scroll:{y:180}}):e.jsx(Je,{description:"ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})})]})]})})},{Text:wv}=we,hy=s=>{switch(s){case"running":return e.jsx(Ze,{style:{color:"#52c41a"}});case"stopped":return e.jsx(Es,{style:{color:"#ff4d4f"}});case"preparing":case"installing":case"building":return e.jsx(wr,{style:{color:"#fadb14"},spin:!0});case"error":case"failed":return e.jsx(Tr,{style:{color:"#ff4d4f"}});case"unknown":case"not_installed":default:return e.jsx(Hp,{style:{color:"#d9d9d9"}})}},py=s=>{switch(s){case"running":return"ì‹¤í–‰ ì¤‘";case"stopped":return"ì¤‘ì§€ë¨";case"preparing":case"installing":return"ì„¤ì¹˜ ì¤‘";case"building":return"êµ¬ì¶• ì¤‘";case"error":return"ì—ëŸ¬";case"failed":return"ì‹¤íŒ¨";case"unknown":return"ì•Œ ìˆ˜ ì—†ìŒ";case"not_installed":return"ë¯¸ì„¤ì¹˜";default:return"ì•Œ ìˆ˜ ì—†ìŒ"}},{Text:Sv}=we,{TabPane:vv}=xs,{Text:kv}=we,{Text:Cv}=we,gy="modulepreload",xy=function(s){return"/"+s},ph={},vn=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),d=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=xy(c),c in ph)return;ph[c]=!0;const p=c.endsWith(".css"),h=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const x=document.createElement("link");if(x.rel=p?"stylesheet":gy,p||(x.as="script"),x.crossOrigin="",x.href=c,d&&x.setAttribute("nonce",d),document.head.appendChild(x),p)return new Promise((_,S)=>{x.addEventListener("load",_),x.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=l,window.dispatchEvent(d),!d.defaultPrevented)throw l}return a.then(l=>{for(const d of l||[])d.status==="rejected"&&i(d.reason);return t().catch(i)})};function my(s){if(!s)return"";try{const t=new URL(s);return`${t.protocol}//${t.host}${t.pathname.replace(/\/$/,"")}`}catch(t){try{const r=new URL(`https://${s}`);return`${r.protocol}//${r.host}${r.pathname.replace(/\/$/,"")}`}catch(r){return s}}}function gh(s){return s.trim().toLowerCase()}function Oi(s){return s!=null?s:22}async function qd(s,t){const r=gh(s),n=Oi(t),{serverlist:a}=Gs.getState(),i=a.find(l=>{const d=gh(l.host),c=Oi(l.port);return d===r&&c===n});return i?{userId:i.userId,password:i.password}:null}async function fy(s,t){const r=[],n=[];for(let a=0;a<s.length;a++){const i=s[a],l=await qd(i.host,Oi(i.port));l&&l.userId&&l.password?r.push({host:i.host,port:i.port,username:l.userId,password:l.password}):(r.push({host:i.host,port:i.port,username:"",password:""}),n.push(a))}return n.length===0?(await t(r),!0):!1}const yy=({selectedInfra:s})=>{var je,Pe;const{user:t}=Tn(),r=Gs(),{Text:n}=we,[a,i]=o.useState([]),[l,d]=o.useState(0),[c,p]=o.useState("ha"),[h,x]=o.useState(new Set),[_,S]=o.useState({visible:!1,node:null,hops:[],isRetry:!1}),[L,k]=o.useState(!1),[E,P]=o.useState([]),[I,$]=o.useState(null),y=w=>{const R=[],U=w.filter(ae=>ae.nodeType==="master"||typeof ae.nodeType=="string"&&ae.nodeType.includes("master")),V=U.filter(ae=>ae.status.master==="running");V.length===0&&U.length>0&&R.push("ì‹¤í–‰ ì¤‘ì¸ ë§ˆìŠ¤í„° ë…¸ë“œê°€ ì—†ìŠµë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„°ê°€ ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."),V.length===1&&R.push("ë§ˆìŠ¤í„° ë…¸ë“œê°€ 1ê°œë§Œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤. ê³ ê°€ìš©ì„±ì„ ìœ„í•´ ì¶”ê°€ ë§ˆìŠ¤í„° ë…¸ë“œë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.");const X=w.filter(ae=>ae.nodeType==="ha"||typeof ae.nodeType=="string"&&ae.nodeType.includes("ha")).filter(ae=>ae.status.ha==="running");U.length>1&&X.length===0&&R.push("ë‹¤ì¤‘ ë§ˆìŠ¤í„° êµ¬ì„±ì—ì„œ HA ë…¸ë“œê°€ ì‹¤í–‰ë˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤.");const de=w.filter(ae=>ae.nodeType==="worker"||typeof ae.nodeType=="string"&&ae.nodeType.includes("worker"));return de.filter(ae=>ae.status.worker==="running").length===0&&de.length>0&&R.push("ì‹¤í–‰ ì¤‘ì¸ ì›Œì»¤ ë…¸ë“œê°€ ì—†ìŠµë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ê°€ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤."),{valid:R.length===0,warnings:R}},v=w=>{const R=typeof w.hops=="string"?w.hops:JSON.stringify(w.hops||[]);let U=w.ip||"",V=w.port?String(w.port):"";if(!U&&R)try{const X=JSON.parse(R);if(Array.isArray(X)&&X.length>0){const de=X[X.length-1];U=de.host,V=String(de.port)}}catch(X){console.warn(`Hops parsing failed for server ${w.id}`,X)}const F=w.nodeType||w.node_type||w.type||"worker";return{id:String(w.id),nodeType:F,ip:U,port:V,server_name:w.server_name,join_command:w.join_command,certificate_key:w.certificate_key,last_checked:w.last_checked,status:{},hops:R,updated_at:w.updated_at,ha:w.ha}},u=a.filter(w=>typeof w.nodeType=="string"?w.nodeType.includes(",")?w.nodeType.split(",").map(R=>R.trim()).includes("ha"):w.nodeType==="ha":!1)||[],m=a.filter(w=>typeof w.nodeType=="string"?w.nodeType.includes(",")?w.nodeType.split(",").map(R=>R.trim()).includes("master"):w.nodeType==="master":!1)||[],j=a.filter(w=>typeof w.nodeType=="string"?w.nodeType.includes(",")?w.nodeType.split(",").map(R=>R.trim()).includes("worker"):w.nodeType==="worker":!1)||[],b=o.useCallback((w,R)=>{const U=w.trim().toLowerCase(),V=R||22;return r.serverlist.find(F=>F.host.trim().toLowerCase()===U&&(F.port||22)===V)},[r.serverlist]),A=o.useCallback(w=>w.map(R=>{const U=b(R.host,R.port);return{...R,username:(U==null?void 0:U.userId)||R.username||"",password:(U==null?void 0:U.password)||""}}),[b]),W=o.useCallback(w=>{w.forEach(R=>{r.upsertServerByHostPort({host:R.host,port:R.port,userId:R.username,password:R.password})})},[r]),Z=(w,R)=>{x(V=>new Set([...Array.from(V),w])),["delete","build","restart"].includes(R)&&d(V=>V+1);const U=`${w}-${R}-${Date.now()}`;return P(V=>[...V,{id:U,type:R,node:w,timestamp:Date.now(),status:"in_progress"}]),U},se=(w,R,U,V)=>{x(F=>{const X=new Set(F);return X.delete(w),X}),["delete","build","restart"].includes(R)&&d(F=>Math.max(0,F-1)),P(F=>F.map(X=>X.id===U?{...X,status:V?"success":"failed"}:X))},ce=o.useCallback(async(w,R)=>{x(U=>new Set(U).add(R.id)),i(U=>U.map(V=>V.id===R.id?{...V,status:{...V.status,[c]:"checking"}}:V));try{const U=await ju.getNodeStatus({infra_id:s.id,server_id:Number(R.id),hops:w,type:c}),V=U.data.status.installed?U.data.status.running?"running":"unknown":"not_installed",F=U.data.lastChecked||new Date().toISOString();i(X=>X.map(de=>de.id===R.id?{...de,status:{...de.status,[c]:V},last_checked:F}:de)),W(w),S({..._,actionType:null}),f.success(`${R.server_name||R.ip} ìƒíƒœ í™•ì¸ ì™„ë£Œ`)}catch(U){console.error(U),i(V=>V.map(F=>F.id===R.id?{...F,status:{...F.status,[c]:"error"}}:F)),f.error("ë…¸ë“œ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨"),S({visible:!0,node:R,hops:w,isRetry:!0,actionType:"STATUS"})}finally{x(U=>{const V=new Set(U);return V.delete(R.id),V})}},[s.id,W,c,_]),D=o.useCallback(async()=>{try{if(!s)return rt.error({title:"ì˜¤ë¥˜",content:"ì¸í”„ë¼ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.",okText:"í™•ì¸"}),[];const R=await Yl(s.id)||[];if(!Array.isArray(R))return i([]),[];const U=R.map(v);return i(U),U}catch(w){return console.error(w),rt.error({title:"ë…¸ë“œ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨",content:"ë…¸ë“œ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",okText:"í™•ì¸"}),i([]),[]}},[s]),M=async w=>{if(h.has(w))return;const R=a.find(U=>U.id===w);if(!R){f.error("ë…¸ë“œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}try{const U=JSON.parse(R.hops||"[]"),V=A(U);V.every(X=>X.username&&X.password)?await ce(V,R):S({visible:!0,node:R,hops:V,isRetry:!1,actionType:"STATUS"})}catch(U){console.error("Hops parsing error",U),f.error("ì ‘ì† ì •ë³´ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.")}},K=async w=>{const{node:R,actionType:U}=_;R&&(S(V=>({...V,visible:!1})),U==="STATUS"&&await ce(w,R))},J=w=>{const R=a.find(V=>V.id===w);if(!R){rt.error({title:"ì˜¤ë¥˜",content:"ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",okText:"í™•ì¸"});return}const U=y(a.filter(V=>V.id!==w));if(U.warnings.length>0){rt.warning({title:"í´ëŸ¬ìŠ¤í„° ë¬´ê²°ì„± ê²½ê³ ",content:e.jsxs("div",{children:[e.jsx("p",{children:"ì´ ë…¸ë“œë¥¼ ì‚­ì œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:"}),e.jsx("ul",{children:U.warnings.map((V,F)=>e.jsx("li",{style:{color:"#faad14",marginBottom:"4px"},children:V},F))}),e.jsx("p",{style:{marginTop:"12px",fontWeight:"bold"},children:"ì •ë§ë¡œ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"})]}),okText:"ìœ„í—˜ ê°ìˆ˜í•˜ê³  ì‚­ì œ",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},onOk:()=>te(R)});return}te(R)},te=w=>{w.status[c]==="ë¯¸ì„¤ì¹˜"?rt.confirm({title:"ì„œë²„ ì‚­ì œ í™•ì¸",content:e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:w.server_name||w.ip})," ì„œë²„ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"]}),e.jsx("p",{children:"ì•„ì§ êµ¬ì¶•ë˜ì§€ ì•Šì€ ë…¸ë“œì…ë‹ˆë‹¤. ì„œë²„ ì •ë³´ë§Œ ì‚­ì œë©ë‹ˆë‹¤."})]}),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},onOk:async()=>{const R=Z(w.id,"delete");try{f.loading(`${w.server_name||w.ip} ì„œë²„ ì‚­ì œ ì¤‘...`),await Vf(parseInt(w.id));const U=a.filter(V=>V.id!==V.id);i(U),f.success(`${w.server_name||w.ip} ì„œë²„ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`),se(w.id,"delete",R,!0)}catch(U){rt.error({title:"ì„œë²„ ì‚­ì œ ì‹¤íŒ¨",content:`ì„œë²„ë¥¼ ì‚­ì œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (${U||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"})`,okText:"í™•ì¸"}),se(w.id,"delete",R,!1)}}}):w.nodeType==="worker"||typeof w.nodeType=="string"&&w.nodeType.includes("worker")?$({type:"worker",stage:"target",targetNode:w}):w.nodeType==="master"||typeof w.nodeType=="string"&&w.nodeType.includes("master")?$({type:"master",stage:"target",targetNode:w}):typeof w.nodeType=="string"&&w.nodeType.includes("ha")&&f.warning("HA ë…¸ë“œëŠ” ì§ì ‘ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë§ˆìŠ¤í„° ë…¸ë“œë¥¼ ì‚­ì œí•˜ë©´ ê´€ë ¨ ì •ë³´ê°€ ì •ë¦¬ë©ë‹ˆë‹¤.")},G=o.useCallback(async()=>{if(!I){f.error("ì‚­ì œì— í•„ìš”í•œ ì¸ì¦ ì •ë³´ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤."),$(null);return}const{targetNode:w}=I,R=a.find(F=>F.join_command&&F.certificate_key);if(!R){f.error("ë©”ì¸ ë§ˆìŠ¤í„° ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),$(null);return}const U=Z(w.id,"delete"),V=a;i(F=>F.filter(X=>X.id!==w.id)),f.loading({content:`ì›Œì»¤ ë…¸ë“œ ${w.server_name||w.ip} ì‚­ì œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...`,key:w.id});try{const F=A(JSON.parse(w.hops)),X=A(JSON.parse(R.hops)),de=await qf({id:Number(w.id),infra_id:s.id,main_id:Number(R.id),hops:F,main_hops:X,password:F[F.length-1].password,main_password:X[X.length-1].password});f.success({content:de.message,key:w.id,duration:5}),se(w.id,"delete",U,!0)}catch(F){f.error({content:"ì›Œì»¤ ë…¸ë“œ ì‚­ì œ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: "+F,key:w.id,duration:4}),i(V),se(w.id,"delete",U,!1)}finally{$(null)}},[I,a,s,A]),q=o.useCallback(async()=>{if(!I){f.error("ì‚­ì œì— í•„ìš”í•œ ì¸ì¦ ì •ë³´ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤."),$(null);return}const{targetNode:w}=I,R=Z(w.id,"delete");f.loading({content:`ë§ˆìŠ¤í„° ë…¸ë“œ ${w.server_name||w.ip} ì‚­ì œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...`,key:w.id});try{const U=A(JSON.parse(w.hops)),V=a.find(ae=>ae.join_command&&ae.certificate_key),F=A(JSON.parse(V.hops)),X=a.filter(ae=>ae.nodeType.includes("ha")),de=A(JSON.parse(X[0].hops)),Ne=await Gf({id:Number(w.id),infra_id:s.id,hops:U,main_hops:F,lb_hops:de,password:U[U.length-1].password,main_password:F[F.length-1].password,lb_password:de?de[de.length-1].password:void 0});f.success({content:Ne.message,key:w.id,duration:5}),se(w.id,"delete",R,!0)}catch(U){f.error({content:"ë§ˆìŠ¤í„° ë…¸ë“œ ì‚­ì œ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: "+U,key:w.id,duration:4}),se(w.id,"delete",R,!1)}finally{$(null)}},[I,a,s,A]);o.useEffect(()=>{if(!I)return;const{type:w}=I;w==="worker"?G():w==="master"&&q(),D()},[I,q,G,a,D]);const oe=async w=>{const R=JSON.parse(w.hops||"[]");R.length>0&&await fy(R,async()=>{try{be(w)}catch(V){console.error(V)}})},be=async w=>{const R=JSON.parse(w.hops||"[]");if(R.length>0){const U=A(R);U.every(F=>F.username&&F.password)?(await ne(U,"build",w),W(U)):S({visible:!0,hops:U,isRetry:!0,node:w,actionType:"BUILD"})}},ne=async(w,R,U)=>{if(!U){console.error("êµ¬ì¶• ëŒ€ìƒ ë…¸ë“œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const V=Z(U.id,"build"),F=parseInt(U.id),X=s.id;f.loading({content:`${U.server_name||U.ip} ì„œë²„ ì‘ì—… ì‹œì‘...`,key:U.id});try{let de={success:!1,message:"ì‘ì—…ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."};switch(c){case"ha":if(de=await Ns.runPlaybook({hops:w,playbook_to_run:"install_haproxy",awxTemplate:(t==null?void 0:t.awx_template)||0}),!de.success)throw new Error(de.message||"HA êµ¬ì¶• ì‹¤íŒ¨");break;case"master":const Ne=!a.some(Oe=>Oe.id!==U.id&&Oe.nodeType.includes("master")&&Oe.status[c]==="running"),ae=a.filter(Oe=>Oe.nodeType.includes("ha"));let pe=null;if(ae.length>0){const Oe=ae[0];pe=A(JSON.parse(Oe.hops)),pe.every(Mt=>Mt.username&&Mt.password)&&S({visible:!0,hops:pe,isRetry:!0,node:Oe,actionType:"BUILD"})}if(Ne){if(ae.length>0&&!pe)throw new Error("HA í´ëŸ¬ìŠ¤í„°ì—ëŠ” HA ë…¸ë“œ ì¸ì¦ ì •ë³´ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤.");if(de=await Ns.runPlaybook({playbook_to_run:"install_kubernetes",hops:w,awxTemplate:(t==null?void 0:t.awx_template)||0}),!de.success)throw new Error(de.message||"Kubernetes ì„¤ì¹˜ ì‹¤íŒ¨");if(ae.length>0&&(de=await Ns.runPlaybook({playbook_to_run:"haproxy_update",hops:pe,lbHops:pe||void 0,master_ip:w[w.length-1].host,server_id:F,infra_id:X,awxTemplate:(t==null?void 0:t.awx_template)||0}),!de.success))throw new Error(de.message||"HAProxy ì—…ë°ì´íŠ¸ ì‹¤íŒ¨");if(de=await Ns.runPlaybook({playbook_to_run:"init_k8s_master",hops:w,lbHops:pe||void 0,server_id:F,awxTemplate:(t==null?void 0:t.awx_template)||0}),!de.success)throw new Error(de.message||"ë§ˆìŠ¤í„° ì´ˆê¸°í™” ì‹¤íŒ¨")}else{const Oe=a.find(Ve=>Ve.join_command&&Ve.certificate_key);if(!Oe)throw new Error("ë©”ì¸ ë§ˆìŠ¤í„° ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");if(ae.length>0&&!pe)throw new Error("ë§ˆìŠ¤í„° ì¡°ì¸ì— í•„ìš”í•œ HA ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");let Mt=await Ns.runPlaybook({playbook_to_run:"install_kubernetes",hops:w,awxTemplate:(t==null?void 0:t.awx_template)||0});if(!Mt.success)throw new Error(Mt.message||"Kubernetes ì„¤ì¹˜ ì‹¤íŒ¨");if(ae.length>0&&(Mt=await Ns.runPlaybook({playbook_to_run:"haproxy_update",hops:pe,lbHops:pe||void 0,master_ip:w[w.length-1].host,server_id:F,infra_id:X,awxTemplate:(t==null?void 0:t.awx_template)||0}),!Mt.success))throw new Error(Mt.message||"HAProxy ì—…ë°ì´íŠ¸ ì‹¤íŒ¨");if(de=await Ns.runPlaybook({playbook_to_run:"join_k8s_master",hops:w,lbHops:pe||void 0,main_id:parseInt(Oe.id),master_ip:Oe.ip,server_id:F,awxTemplate:(t==null?void 0:t.awx_template)||0}),!de.success)throw new Error(de.message||"ë§ˆìŠ¤í„° ì¡°ì¸ ì‹¤íŒ¨")}break;case"worker":let Xe=a.find(Oe=>Oe.nodeType==="master"||typeof Oe.nodeType=="string"&&Oe.nodeType.includes("master"));const Nt=a.filter(Oe=>(Oe.nodeType==="master"||typeof Oe.nodeType=="string"&&Oe.nodeType.includes("master"))&&Oe.status.master==="running");if(Nt.length>0&&(Xe=Nt[0]),!Xe)throw new Error("ë©”ì¸ ë§ˆìŠ¤í„° ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");const Fe=JSON.parse(Xe.hops||"[]"),Le=A(Fe);if(!Le.every(Oe=>Oe.username&&Oe.password))throw new Error(`ë§ˆìŠ¤í„° ë…¸ë“œ(${Xe.server_name})ì˜ ì¸ì¦ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë§ˆìŠ¤í„° ë…¸ë“œ ìƒíƒœ í™•ì¸ì„ ë¨¼ì € ìˆ˜í–‰í•´ì£¼ì„¸ìš”.`);if(!Xe.join_command||!Xe.certificate_key){f.loading({content:`ë§ˆìŠ¤í„° ë…¸ë“œ(${Xe.server_name})ì—ì„œ ì¡°ì¸ í† í°ì„ ê°±ì‹  ì¤‘ì…ë‹ˆë‹¤...`,key:U.id});const Oe=await Ns.runPlaybook({playbook_to_run:"refresh_k8s_token",hops:Le,server_id:parseInt(Xe.id),awxTemplate:(t==null?void 0:t.awx_template)||0});if(!Oe.success)throw new Error("ë§ˆìŠ¤í„° í† í° ê°±ì‹  ì‹¤íŒ¨: "+Oe.message)}if(f.loading({content:`ì›Œì»¤ ë…¸ë“œ ${U.server_name||U.ip} ì„¤ì¹˜ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...`,key:U.id}),de=await Ns.runPlaybook({playbook_to_run:"install_kubernetes",hops:w,awxTemplate:(t==null?void 0:t.awx_template)||0}),!de.success)throw new Error(de.message||"Kubernetes ì„¤ì¹˜ ì‹¤íŒ¨");if(de=await Ns.runPlaybook({playbook_to_run:"join_k8s_worker",hops:w,main_id:parseInt(Xe.id),server_id:F,awxTemplate:(t==null?void 0:t.awx_template)||0}),!de.success)throw new Error(de.message||"ì›Œì»¤ ì¡°ì¸ ì‹¤íŒ¨");break}f.destroy(U.id),rt.success({title:"ì‘ì—… ì‹œì‘ë¨",content:de.message||"êµ¬ì¶• ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),D(),se(U.id,"build",V,!0)}catch(de){f.destroy(U.id),rt.error({title:"ì‘ì—… ì‹œì‘ ì‹¤íŒ¨",content:`ë…¸ë“œ ì‘ì—… ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${de instanceof Error?de.message:String(de)}`}),se(U.id,"build",V,!1)}finally{}},ye=async w=>{if(w.nodeType==="worker"&&!a.find(F=>(F.nodeType==="master"||typeof F.nodeType=="string"&&F.nodeType.includes("master"))&&F.join_command&&F.certificate_key)){rt.error({title:"ë©”ì¸ ë§ˆìŠ¤í„° ë…¸ë“œ ì—†ìŒ",content:"ì›Œì»¤ ë…¸ë“œë¥¼ ì¬êµ¬ì¶•í•˜ë ¤ë©´ ë¨¼ì € ë©”ì¸ ë§ˆìŠ¤í„° ë…¸ë“œê°€ êµ¬ì¶•ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤."});return}const U=JSON.parse(w.hops||"[]");if(U.length>0){const V=A(U);V.every(X=>X.username&&X.password)?(await Ue(V,w),W(V)):S({visible:!0,hops:V,isRetry:!0,node:w,actionType:"BUILD"})}},Ue=async(w,R)=>{if(!R){f.error("ì¬êµ¬ì¶• ëŒ€ìƒ ë…¸ë“œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const U=Z(R.id,"rebuild");f.loading({content:`${R.server_name||R.ip} ë…¸ë“œ ì¬êµ¬ì¶•ì„ ì‹œì‘í•©ë‹ˆë‹¤...`,key:R.id});try{let V={success:!1,message:"ì‘ì—…ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."};const F=w.length>0?w[w.length-1].password:"",X=a.find(de=>de.join_command&&de.certificate_key);if(c==="ha"&&R.nodeType.includes("ha")){if(V=await Ns.runPlaybook({playbook_to_run:"uninstall_haproxy",hops:w,awxTemplate:(t==null?void 0:t.awx_template)||0}),!V.success)throw new Error(V.message||"HAProxy ì‚­ì œ ì‹¤íŒ¨");if(V=await Ns.runPlaybook({playbook_to_run:"install_haproxy",hops:w,awxTemplate:(t==null?void 0:t.awx_template)||0}),!V.success)throw new Error(V.message||"HAProxy ì„¤ì¹˜ ì‹¤íŒ¨")}else if(c==="master"&&R.nodeType.includes("master")){const de=a.some(pe=>pe.nodeType.includes("ha"));let Ne=null;if(u.length>0){const pe=u[0];Ne=A(JSON.parse(pe.hops)),Ne.every(Xe=>Xe.username&&Xe.password)&&S({visible:!0,hops:Ne,isRetry:!0,node:pe,actionType:"BUILD"})}if(V=await Ns.runPlaybook({playbook_to_run:"uninstall_kubernetes",hops:w,awxTemplate:(t==null?void 0:t.awx_template)||0}),!V.success)throw new Error(V.message||"Kubernetes ì‚­ì œ ì‹¤íŒ¨");if(!a.some(pe=>pe.id!==R.id&&pe.nodeType.includes("master")&&pe.status[c]==="running")){if(V=await Ns.runPlaybook({playbook_to_run:"install_kubernetes",hops:w,awxTemplate:(t==null?void 0:t.awx_template)||0}),!V.success)throw new Error("Kubernetes ì„¤ì¹˜ ì‹¤íŒ¨");if(de&&(V=await Ns.runPlaybook({playbook_to_run:"haproxy_update",hops:Ne,lbHops:Ne||void 0,master_ip:w[w.length-1].host,server_id:parseInt(R.id),awxTemplate:(t==null?void 0:t.awx_template)||0}),!V.success))throw new Error("HAProxy ì—…ë°ì´íŠ¸ ì‹¤íŒ¨");if(V=await Ns.runPlaybook({playbook_to_run:"init_k8s_master",hops:w,lbHops:Ne||void 0,server_id:parseInt(R.id),awxTemplate:(t==null?void 0:t.awx_template)||0}),!V.success)throw new Error("ë§ˆìŠ¤í„° ì´ˆê¸°í™” ì‹¤íŒ¨")}else{if(!X)throw new Error("ë©”ì¸ ë§ˆìŠ¤í„° ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");if(V=await Ns.runPlaybook({playbook_to_run:"install_kubernetes",hops:w,awxTemplate:(t==null?void 0:t.awx_template)||0}),!V.success)throw new Error("Kubernetes ì„¤ì¹˜ ì‹¤íŒ¨");if(de&&(V=await Ns.runPlaybook({playbook_to_run:"haproxy_update",hops:Ne,lbHops:Ne||void 0,master_ip:w[w.length-1].host,server_id:parseInt(R.id),infra_id:s.id,awxTemplate:(t==null?void 0:t.awx_template)||0}),!V.success))throw new Error("HAProxy ì—…ë°ì´íŠ¸ ì‹¤íŒ¨");if(V=await Ns.runPlaybook({playbook_to_run:"join_k8s_master",hops:w,lbHops:Ne||void 0,main_id:parseInt(X.id),master_ip:X.ip,server_id:parseInt(R.id),awxTemplate:(t==null?void 0:t.awx_template)||0}),!V.success)throw new Error("ë§ˆìŠ¤í„° ì¡°ì¸ ì‹¤íŒ¨")}}else if(c==="worker"&&R.nodeType.includes("worker")){if(!X)throw new Error("ë©”ì¸ ë§ˆìŠ¤í„° ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");V=await Kf({id:parseInt(R.id),infra_id:s.id,hops:w,password:F,main_id:parseInt(X.id)})}f.destroy(R.id),rt.success({title:"ì‘ì—… ì‹œì‘ë¨",content:V.message||"ì¬êµ¬ì¶• ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."}),D(),se(R.id,"rebuild",U,!0)}catch(V){f.destroy(R.id),rt.error({title:"ì‘ì—… ì‹œì‘ ì‹¤íŒ¨",content:`ë…¸ë“œ ì¬êµ¬ì¶• ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${V instanceof Error?V.message:String(V)}`}),se(R.id,"rebuild",U,!1)}finally{}},N=async w=>{if(!s){f.error("ì¸í”„ë¼ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}try{const V=A(w.hops);await ze.kubernetes.testSSHConnection(V),f.success("SSH ì—°ê²° í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí–ˆìŠµë‹ˆë‹¤.")}catch(V){console.error("SSH ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:",V),f.error("SSH ì—°ê²° í…ŒìŠ¤íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì—°ê²° ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."),S({visible:!0,node:null,hops:w.hops,isRetry:!0,actionType:"ADD"});return}const R=w.hops[w.hops.length-1],U=a.find(V=>{try{const F=JSON.parse(V.hops),X=F[F.length-1];return X.host===R.host&&X.port===R.port}catch(F){return!1}});if(U){const V=U.nodeType.split(",").map(de=>de.trim());if(V.includes(c)){f.info(`ì´ë¯¸ ${c} íƒ€ì…ìœ¼ë¡œ ë“±ë¡ëœ ì„œë²„ì…ë‹ˆë‹¤.`);return}const F=[...V,c].join(","),X={id:parseInt(U.id),type:F,infra_id:s.id};c!=="ha"&&!U.server_name&&w.server_name&&(X.server_name=w.server_name),await Hf(parseInt(U.id),X),f.success(`ê¸°ì¡´ ì„œë²„ì— ${c} íƒ€ì…ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`)}else{const V=w.hops.map(F=>({host:F.host,port:F.port,username:F.username}));if(c==="ha"){const F={infra_id:s.id,type:c,status:"ë“±ë¡",ip:R.host,port:R.port,hops:V,device_id:w.device_id};await ac(F),f.success(`HA ë…¸ë“œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. (IP: ${R.host})`);try{await Ns.addHost(w.hops,t.awx_inventory,t.awx_template)}catch(X){console.warn("AWX í˜¸ìŠ¤íŠ¸ ì¶”ê°€ ì‹¤íŒ¨:",X)}}else{if(!w.server_name){f.error("ë§ˆìŠ¤í„°/ì›Œì»¤ ë…¸ë“œëŠ” ì„œë²„ ì´ë¦„ì´ í•„ìˆ˜ì…ë‹ˆë‹¤.");return}const F={infra_id:s.id,type:c,name:w.server_name,status:"ë“±ë¡",ip:R.host,port:R.port,hops:V,device_id:w.device_id};await ac(F);const X=c==="master"?"ë§ˆìŠ¤í„°":"ì›Œì»¤";f.success(`${X} ë…¸ë“œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. (ì´ë¦„: ${w.server_name})`),D();try{await Ns.addHost(w.hops,t.awx_inventory,t.awx_template)}catch(de){console.warn("AWX í˜¸ìŠ¤íŠ¸ ì¶”ê°€ ì‹¤íŒ¨:",de)}}}};o.useEffect(()=>{const w=s.nodes.map(R=>v(R));i(w)},[s]);const ge=[{title:"ë…¸ë“œ ID",dataIndex:"id",key:"id",width:80},{title:"ì„œë²„ ì´ë¦„",dataIndex:"server_name",key:"server_name",width:120},{title:"ìœ í˜•",dataIndex:"nodeType",key:"nodeType",width:120,render:(w,R)=>{if(typeof w=="string"&&w.includes(",")){const F=w.split(",").map(X=>X.trim());return e.jsxs(g,{size:2,style:{display:"flex",flexDirection:"row",flexWrap:"nowrap"},children:[F.includes("ha")&&e.jsx(T,{style:{backgroundColor:"#e6f4ff",color:"#1677ff",border:"1px solid #91caff",borderRadius:"4px",padding:"0 4px",fontSize:"11px",width:"42px",textAlign:"center",margin:"0 1px",height:"20px",lineHeight:"18px"},children:"ha"}),F.includes("master")&&e.jsx(T,{style:{backgroundColor:"#f0f9eb",color:"#52c41a",border:"1px solid #b7eb8f",borderRadius:"4px",padding:"0 4px",fontSize:"11px",width:R.join_command&&R.certificate_key?"80px":"42px",textAlign:"center",margin:"0 1px",height:"20px",lineHeight:"18px"},children:R.join_command&&R.certificate_key?"main master":"master"}),F.includes("worker")&&e.jsx(T,{style:{backgroundColor:"#fff2e8",color:"#fa541c",border:"1px solid #ffbb96",borderRadius:"4px",padding:"0 4px",fontSize:"11px",width:"42px",textAlign:"center",margin:"0 1px",height:"20px",lineHeight:"18px"},children:"worker"})]})}let U={},V="";return c==="ha"||w==="ha"?(V="ha",U={backgroundColor:"#e6f4ff",color:"#1677ff",border:"1px solid #91caff",borderRadius:"4px",padding:"0 4px",fontSize:"11px",width:"42px",textAlign:"center",margin:"0 auto",height:"20px",lineHeight:"18px"}):c==="master"||w==="master"?(V=R.join_command&&R.certificate_key?"main master":"master",U={backgroundColor:"#f0f9eb",color:"#52c41a",border:"1px solid #b7eb8f",borderRadius:"4px",padding:"0 4px",fontSize:"11px",width:R.join_command&&R.certificate_key?"80px":"42px",textAlign:"center",margin:"0 auto",height:"20px",lineHeight:"18px"}):(c==="worker"||w==="worker")&&(V="worker",U={backgroundColor:"#fff2e8",color:"#fa541c",border:"1px solid #ffbb96",borderRadius:"4px",padding:"0 4px",fontSize:"11px",width:"42px",textAlign:"center",margin:"0 auto",height:"20px",lineHeight:"18px"}),e.jsx(T,{style:U,children:V})}},{title:"ì ‘ì† ê²½ë¡œ",dataIndex:"hops",key:"hops",width:300,render:w=>{try{const R=JSON.parse(w);if(!Array.isArray(R)||R.length===0)return"-";const U=R.map(V=>`${V.host}:${V.port}`).join(" â†’ ");return e.jsx(Ie,{title:U,placement:"topLeft",children:e.jsx(g,{size:4,wrap:!0,children:R.map((V,F)=>e.jsxs(Ct.Fragment,{children:[e.jsxs(T,{color:F===R.length-1?"blue":"default",children:[V.host,":",V.port]}),F<R.length-1&&e.jsx(Md,{style:{color:"#bfbfbf"}})]},F))})})}catch(R){return e.jsx(n,{type:"danger",children:"ê²½ë¡œ ì˜¤ë¥˜"})}}},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:120,render:w=>{const R=w[c]||"unknown";return e.jsxs(g,{children:[hy(R),e.jsx("span",{children:py(R)})]})}},{title:"ìµœê·¼ ìƒíƒœ ì¡°íšŒ",dataIndex:"last_checked",key:"last_checked",width:150,render:w=>{if(!w)return"-";try{return new Date(w).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).replace(/\s+/g," ")}catch(R){return w}}},{title:"ì‘ì—…",key:"action",width:300,render:(w,R)=>Ce(R)}],Ce=w=>{const R=[],U=h.has(w.id);if(R.push(e.jsx(B,{size:"small",icon:e.jsx(Fi,{}),onClick:()=>M(w.id),disabled:U,loading:U&&w.status[c]==="checking",children:"ìƒíƒœ í™•ì¸"},"check")),!w.last_checked)return e.jsx(g,{children:R});const V=w.nodeType.includes("ha"),F=w.nodeType.includes("master"),X=w.nodeType.includes("worker"),de=F&&w.join_command&&w.certificate_key,Ne=F&&!a.some(ae=>ae.id!==w.id&&ae.nodeType.includes("master")&&ae.status[c]==="active");if(F&&c==="master"){const ae=a.filter(Fe=>Fe.id!==w.id&&Fe.nodeType.includes("master")).length,pe=a.filter(Fe=>Fe.nodeType.includes("worker")).length;(!de||de&&ae===0&&pe===0)&&R.push(e.jsx(B,{size:"small",icon:e.jsx(gs,{}),danger:!0,onClick:()=>J(w.id),loading:U,children:"ì‚­ì œ"},"delete"))}switch(X&&c==="worker"&&R.push(e.jsx(B,{size:"small",icon:e.jsx(gs,{}),danger:!0,onClick:()=>J(w.id),children:"ì‚­ì œ"},"delete")),w.status[c]){case"running":if(c===w.nodeType||w.nodeType.includes(c)){let ae="ì¬êµ¬ì¶•",pe=e.jsx(fa,{});V&&c==="ha"?ae="HA ì¬êµ¬ì¶•":F&&c==="master"?(ae="ë§ˆìŠ¤í„° ì¬êµ¬ì¶•",pe=e.jsx(Cn,{})):X&&c==="worker"&&(ae="ì›Œì»¤ ì¬êµ¬ì¶•",pe=e.jsx(_t,{})),R.push(e.jsx(Kt,{title:"ë…¸ë“œ ì¬êµ¬ì¶• í™•ì¸",description:e.jsxs("div",{style:{maxWidth:"350px"},children:[e.jsx("p",{style:{margin:0,marginBottom:"8px",fontWeight:"bold",color:"#ff4d4f"},children:"ğŸ”¥ ì¬êµ¬ì¶• ì‹œ ì™„ì „íˆ ì‚­ì œë˜ëŠ” ë°ì´í„°:"}),e.jsx("p",{style:{margin:0,marginBottom:"4px",fontSize:"12px"},children:"â€¢ ëª¨ë“  Podì™€ ì‹¤í–‰ ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜"}),e.jsx("p",{style:{margin:0,marginBottom:"4px",fontSize:"12px"},children:"â€¢ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì™€ ë¦¬ì†ŒìŠ¤"}),e.jsx("p",{style:{margin:0,marginBottom:"4px",fontSize:"12px"},children:"â€¢ ConfigMap, Secret ë“± ì„¤ì • ë°ì´í„°"}),e.jsx("p",{style:{margin:0,marginBottom:"4px",fontSize:"12px"},children:"â€¢ Ingress, Service ì„¤ì •"}),e.jsx("p",{style:{margin:0,marginBottom:"8px",fontSize:"12px"},children:"â€¢ ê¸°ì¡´ í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ/í† í°"}),e.jsx("p",{style:{margin:0,fontSize:"12px",fontWeight:"bold",color:"#1890ff"},children:"ğŸ’¾ PV ë°ì´í„°ëŠ” ë³´ì¡´ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})]}),onConfirm:()=>ye(w),okText:"ë°ì´í„° ì‚­ì œí•˜ê³  ì¬êµ¬ì¶•",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(B,{size:"small",icon:pe,type:"primary",loading:U,children:ae},"rebuild")},"rebuild-confirm"))}break;case"stopped":break;case"preparing":break;case"not_installed":if(c===w.nodeType||w.nodeType.includes(c)){let ae="êµ¬ì¶•",pe=e.jsx(fa,{});V&&c==="ha"?ae="HA êµ¬ì¶•":F&&c==="master"?(ae=Ne?"ì²« ë§ˆìŠ¤í„° êµ¬ì¶•":"ë§ˆìŠ¤í„° ì¡°ì¸",pe=e.jsx(Cn,{})):X&&c==="worker"&&(ae="ì›Œì»¤ êµ¬ì¶•",pe=e.jsx(_t,{})),R.push(e.jsx(B,{size:"small",icon:pe,onClick:()=>oe(w),loading:U,children:ae},"build"))}break}return e.jsx(g,{children:R})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"infra-content-wrapper",children:e.jsxs("div",{className:"node-settings-container",children:[(()=>{const w=y(a);return w.warnings.length>0?e.jsx(xe,{message:"í´ëŸ¬ìŠ¤í„° ìƒíƒœ ê²½ê³ ",description:e.jsx("ul",{style:{margin:0,paddingLeft:"20px"},children:w.warnings.map((R,U)=>e.jsx("li",{children:R},U))}),type:"warning",showIcon:!0,closable:!0,style:{marginBottom:"16px"}}):null})(),l>0&&e.jsx(xe,{message:`${l}ê°œì˜ ì¤‘ìš” ì‘ì—…ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤`,description:"ë™ì‹œì— ë„ˆë¬´ ë§ì€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©´ ì‹œìŠ¤í…œì´ ë¶ˆì•ˆì •í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,closable:!0,style:{marginBottom:"16px"}}),e.jsx("div",{className:"infra-stats-container",children:e.jsxs("div",{className:"node-stat-group",children:[e.jsxs("div",{className:"node-stat-item",children:[e.jsx(_t,{className:"node-stat-icon"}),e.jsxs("div",{children:[e.jsx(n,{className:"node-stat-label",children:"ì´ ë…¸ë“œ ìˆ˜"}),e.jsxs(n,{className:"node-stat-number",children:[s.nodes.length,"ê°œ"]})]})]}),e.jsxs("div",{className:"node-stat-item ha-stat",children:[e.jsx(ya,{className:"node-stat-icon",style:{color:"#1677ff"}}),e.jsxs("div",{children:[e.jsx(n,{className:"node-stat-label",children:"HA ë…¸ë“œ"}),e.jsxs(n,{className:"node-stat-number",children:[u.length,"ê°œ"]})]})]}),e.jsxs("div",{className:"node-stat-item master-stat",children:[e.jsx(Cn,{className:"node-stat-icon",style:{color:"#52c41a"}}),e.jsxs("div",{children:[e.jsx(n,{className:"node-stat-label",children:"ë§ˆìŠ¤í„° ë…¸ë“œ"}),e.jsxs(n,{className:"node-stat-number",children:[m.length,"ê°œ"]})]})]}),e.jsxs("div",{className:"node-stat-item worker-stat",children:[e.jsx(_t,{className:"node-stat-icon",style:{color:"#fa541c"}}),e.jsxs("div",{children:[e.jsx(n,{className:"node-stat-label",children:"ì›Œì»¤ ë…¸ë“œ"}),e.jsxs(n,{className:"node-stat-number",children:[j.length,"ê°œ"]})]})]})]})}),e.jsx(xt,{orientation:"left",children:"ë…¸ë“œ ëª©ë¡"}),e.jsxs(xs,{defaultActiveKey:"ha",style:{marginBottom:16},onChange:w=>p(w),activeKey:c,children:[e.jsx(Zc,{tab:"HA ë…¸ë“œ",children:e.jsx(wt,{columns:ge.filter(w=>w.key!=="server_name"),dataSource:u,rowKey:"id",pagination:!1,size:"small",className:"infra-node-table",locale:{emptyText:"HA ë…¸ë“œê°€ ì—†ìŠµë‹ˆë‹¤. ì„¤ì • ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë…¸ë“œë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”."}})},"ha"),e.jsx(Zc,{tab:"ë§ˆìŠ¤í„° ë…¸ë“œ",children:e.jsx(wt,{columns:ge,dataSource:m,rowKey:"id",pagination:!1,size:"small",className:"infra-node-table",locale:{emptyText:"ë§ˆìŠ¤í„° ë…¸ë“œê°€ ì—†ìŠµë‹ˆë‹¤. ì„¤ì • ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë…¸ë“œë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”."}})},"master"),e.jsx(Zc,{tab:"ì›Œì»¤ ë…¸ë“œ",children:e.jsx(wt,{columns:ge,dataSource:j,rowKey:"id",pagination:!1,size:"small",className:"infra-node-table",locale:{emptyText:"ì›Œì»¤ ë…¸ë“œê°€ ì—†ìŠµë‹ˆë‹¤. ì„¤ì • ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë…¸ë“œë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”."}})},"worker")]})]})}),E.length>0&&e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx(xt,{orientation:"left",children:"ìµœê·¼ ì‘ì—… íˆìŠ¤í† ë¦¬"}),e.jsx(ar,{size:"small",dataSource:E.slice(-5).reverse(),renderItem:w=>{const R=s.nodes.find(X=>X.id===w.node),U=(R==null?void 0:R.server_name)||(R==null?void 0:R.ip)||w.node,V=Math.round((Date.now()-w.timestamp)/1e3),F=V<60?`${V}ì´ˆ ì „`:V<3600?`${Math.round(V/60)}ë¶„ ì „`:`${Math.round(V/3600)}ì‹œê°„ ì „`;return e.jsx(ar.Item,{children:e.jsxs(g,{children:[w.status==="success"&&e.jsx(Ze,{style:{color:"#52c41a"}}),w.status==="failed"&&e.jsx(Es,{style:{color:"#ff4d4f"}}),w.status==="in_progress"&&e.jsx(Pt,{spin:!0,style:{color:"#1890ff"}}),e.jsxs(n,{children:[e.jsx("strong",{children:U})," -"," ",w.type==="rebuild"?"ì¬êµ¬ì¶•":w.type==="build"?"êµ¬ì¶•":w.type==="renew_certificate"?"ì¸ì¦ì„œ ê°±ì‹ ":w.type==="delete"?"ì‚­ì œ":w.type,w.status==="success"&&(w.type==="rebuild"||w.type==="build"||w.type==="renew_certificate"?" ì‹œì‘ë¨":" ì™„ë£Œ"),w.status==="failed"&&" ì‹¤íŒ¨",w.status==="in_progress"&&" ì§„í–‰ ì¤‘"]}),e.jsx(n,{type:"secondary",style:{fontSize:"12px"},children:F})]})})},style:{background:"#fafafa",padding:"12px",borderRadius:"6px",maxHeight:"200px",overflowY:"auto"}})]}),e.jsx("div",{style:{marginTop:24,textAlign:"right"},children:e.jsx(g,{children:e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:()=>{k(!0)},size:"middle",shape:"round",children:"ë…¸ë“œ ì¶”ê°€"})})}),e.jsx(vg,{visible:L,onCancel:()=>k(!1),onAdd:N,loading:!1,initialNodeType:c}),e.jsx(Hi,{visible:_.visible,onClose:()=>S(w=>({...w,visible:!1})),onComplete:K,hops:_.hops,infraId:s.id,isRetry:_.isRetry,serviceName:((je=_.node)==null?void 0:je.server_name)||((Pe=_.node)==null?void 0:Pe.ip)})]})},Sl=s=>{if(s===0)return"0 B";const t=1024,r=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,n)).toFixed(2))+" "+r[n]},jy=({selectedInfra:s,info:t,infoLoading:r})=>{var a,i,l,d,c;const{Text:n}=we;return e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsx(Ke,{gutter:[16,16],style:{marginBottom:24},children:e.jsx(Y,{span:24,children:e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(Bs,{})," í™˜ê²½ ê¸°ë³¸ ì •ë³´"]}),bordered:!0,style:{height:"100%"},extra:e.jsx(T,{color:"blue",children:s.type.toUpperCase()}),children:e.jsxs(Se,{column:1,size:"small",bordered:!0,children:[e.jsx(Se.Item,{label:"í™˜ê²½ ì´ë¦„",children:e.jsx(n,{strong:!0,children:s.name})}),e.jsx(Se.Item,{label:"ì„¤ëª…",children:e.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:s.info||e.jsx(n,{type:"secondary",italic:!0,children:"ì„¤ëª… ì—†ìŒ"})})}),e.jsx(Se.Item,{label:"ìƒì„±ì¼",children:new Date(s.created_at).toLocaleDateString()}),e.jsxs(Se.Item,{label:"ë“±ë¡ëœ ë…¸ë“œ",children:[s.nodes.length," ê°œ"]})]})})})}),s&&t?e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",style:{borderColor:"#d9d9d9"},children:e.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"ëŸ°íƒ€ì„ ë¦¬ì†ŒìŠ¤ í˜„í™©"})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#f6ffed",border:"1px solid #b7eb8f"},children:e.jsx($e,{title:"ì‹¤í–‰ ì¤‘ì¸ Pod",value:t==null?void 0:t.runningPods,valueStyle:{color:"#3f8600"},prefix:e.jsx(Ze,{}),suffix:`/ ${t==null?void 0:t.totalPods}`})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#fff1f0",border:"1px solid #ffa39e"},children:e.jsx($e,{title:"ë¹„ì •ìƒ/ì¤‘ì§€ Pod",value:(t==null?void 0:t.totalPods)-(t==null?void 0:t.runningPods),valueStyle:{color:"#cf1322"},prefix:e.jsx(xo,{})})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#e6f7ff",border:"1px solid #91caff"},children:e.jsx($e,{title:"ì›Œí¬ë¡œë“œ ì´ê³„",value:t==null?void 0:t.totalPods,valueStyle:{color:"#096dd9"},prefix:e.jsx(Da,{})})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#fff7e6",border:"1px solid #ffd591"},children:e.jsx($e,{title:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€",value:t==null?void 0:t.imageCount,valueStyle:{color:"#d46b08"},prefix:e.jsx(_s,{})})})})]}),e.jsx("div",{style:{margin:"16px 0"}}),e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(_t,{})," ëŸ°íƒ€ì„ ìƒì„¸ ì •ë³´"]}),bordered:!0,style:{marginBottom:16},children:e.jsxs(Se,{column:{xxl:4,xl:4,lg:3,md:2,sm:2,xs:1},size:"small",children:[e.jsx(Se.Item,{label:"ëŸ°íƒ€ì„ ìœ í˜•",children:e.jsx(T,{color:"geekblue",children:t==null?void 0:t.runtimeType})}),e.jsx(Se.Item,{label:"ì•„í‚¤í…ì²˜",children:t==null?void 0:t.architecture}),e.jsx(Se.Item,{label:"ë²„ì „",children:t==null?void 0:t.runtimeVersion}),e.jsx(Se.Item,{label:"API ë²„ì „",children:t==null?void 0:t.apiServerVersion}),e.jsx(Se.Item,{label:"OS",children:t==null?void 0:t.os}),e.jsx(Se.Item,{label:"ì»¤ë„",children:t==null?void 0:t.kernelVersion}),e.jsx(Se.Item,{label:"CPU",children:t==null?void 0:t.totalCpu}),e.jsx(Se.Item,{label:"ë©”ëª¨ë¦¬",children:t==null?void 0:t.totalMemory})]})}),e.jsx(xt,{orientation:"left",style:{borderColor:"#d9d9d9",marginTop:8,marginBottom:16},children:e.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§"})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(mc,{style:{fontSize:20,color:"#1890ff"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"ë””ìŠ¤í¬"}),e.jsx(qt,{type:"circle",percent:((a=t==null?void 0:t.mainNodeStorage)==null?void 0:a.usagePercentage)||0,size:80,strokeColor:(((i=t==null?void 0:t.mainNodeStorage)==null?void 0:i.usagePercentage)||0)>80?"#ff4d4f":(((l=t==null?void 0:t.mainNodeStorage)==null?void 0:l.usagePercentage)||0)>60?"#faad14":"#52c41a",format:p=>`${p}%`}),e.jsx(T,{color:(((d=t==null?void 0:t.mainNodeStorage)==null?void 0:d.usagePercentage)||0)>80?"red":"green",style:{fontSize:11},children:(((c=t==null?void 0:t.mainNodeStorage)==null?void 0:c.usagePercentage)||0)>80?"ì£¼ì˜":"ì–‘í˜¸"})]})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(ii,{style:{fontSize:20,color:"#722ed1"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"CPU"}),e.jsx(qt,{type:"circle",percent:Math.round((t==null?void 0:t.cpuUsage)||0),size:80,strokeColor:((t==null?void 0:t.cpuUsage)||0)>80?"#ff4d4f":((t==null?void 0:t.cpuUsage)||0)>60?"#faad14":"#52c41a",format:p=>`${p}%`}),e.jsx(T,{color:((t==null?void 0:t.cpuUsage)||0)>80?"red":((t==null?void 0:t.cpuUsage)||0)>60?"orange":"green",style:{fontSize:11},children:((t==null?void 0:t.cpuUsage)||0)>80?"ë†’ìŒ":((t==null?void 0:t.cpuUsage)||0)>60?"ë³´í†µ":"ì–‘í˜¸"})]})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(_s,{style:{fontSize:20,color:"#13c2c2"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"ë©”ëª¨ë¦¬"}),e.jsx(qt,{type:"circle",percent:Math.round((t==null?void 0:t.memoryUsage)||0),size:80,strokeColor:((t==null?void 0:t.memoryUsage)||0)>80?"#ff4d4f":((t==null?void 0:t.memoryUsage)||0)>60?"#faad14":"#52c41a",format:p=>`${p}%`}),e.jsxs("div",{style:{fontSize:"10px",color:"#888"},children:[Sl((t==null?void 0:t.memoryUsed)||0)," /"," ",Sl((t==null?void 0:t.memoryTotal)||0)]})]})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(ou,{style:{fontSize:20,color:"#eb2f96"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"ë„¤íŠ¸ì›Œí¬"}),e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx(fc,{style:{color:"#52c41a",fontSize:12}}),e.jsx(n,{style:{fontSize:11,marginLeft:4},children:Sl((t==null?void 0:t.networkRx)||0)})]}),e.jsxs("div",{children:[e.jsx(lu,{style:{color:"#1890ff",fontSize:12}}),e.jsx(n,{style:{fontSize:11,marginLeft:4},children:Sl((t==null?void 0:t.networkTx)||0)})]})]}),e.jsx(T,{color:"cyan",style:{fontSize:11},children:"ëˆ„ì "})]})})})]})]}):r?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ëŸ°íƒ€ì„ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤.",style:{marginTop:40}}):e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ë“±ë¡ëœ ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤.",style:{marginTop:40}})]})},ic=async(s,t)=>{var r,n;try{const a={service_id:s};t&&(a.ssh_hops=t);const i=await ze.kubernetes.request("getK8sResources",a);if(!((r=i.data)!=null&&r.success))throw new Error(((n=i.data)==null?void 0:n.error)||"K8s ë¦¬ì†ŒìŠ¤ ì¡°íšŒ ì‹¤íŒ¨");return i.data.data}catch(a){throw O.error("K8s ë¦¬ì†ŒìŠ¤ ì¡°íšŒ ì‹¤íŒ¨:",a),a}},Hg=async s=>{var t,r;try{const n=await ze.kubernetes.request("getK8sResourceYaml",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"K8s ë¦¬ì†ŒìŠ¤ YAML ì¡°íšŒ ì‹¤íŒ¨");return n.data.data.yaml}catch(n){throw O.error("K8s ë¦¬ì†ŒìŠ¤ YAML ì¡°íšŒ ì‹¤íŒ¨:",n),n}},by=async s=>{var t,r;try{const n=await ze.kubernetes.request("applyK8sResource",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"K8s ë¦¬ì†ŒìŠ¤ ì ìš© ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("K8s ë¦¬ì†ŒìŠ¤ ì ìš© ì‹¤íŒ¨:",n),n}},_y=async s=>{var t,r;try{const n=await ze.kubernetes.request("deleteK8sResource",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"K8s ë¦¬ì†ŒìŠ¤ ì‚­ì œ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("K8s ë¦¬ì†ŒìŠ¤ ì‚­ì œ ì‹¤íŒ¨:",n),n}},xh=async s=>{var t,r;try{const n=await ze.kubernetes.request("scaleDeployment",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Deployment ìŠ¤ì¼€ì¼ë§ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Deployment ìŠ¤ì¼€ì¼ë§ ì‹¤íŒ¨:",n),n}},wy=async(s,t)=>{var r,n;try{const a={service_id:s};t&&t.length>0&&(a.ssh_hops=t);const i=await ze.kubernetes.request("getHPA",a);if(!((r=i.data)!=null&&r.success))throw new Error(((n=i.data)==null?void 0:n.error)||"HPA ì¡°íšŒ ì‹¤íŒ¨");return i.data.data}catch(a){throw O.error("HPA ì¡°íšŒ ì‹¤íŒ¨:",a),a}},Sy=async s=>{var t,r;try{const n=await ze.kubernetes.request("createHPA",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"HPA ìƒì„± ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("HPA ìƒì„± ì‹¤íŒ¨:",n),n}},vy=async s=>{var t,r,n;try{const a=await ze.kubernetes.request("deleteHPA",s);if(!((t=a.data)!=null&&t.success)){const i=new Error(((r=a.data)==null?void 0:r.error)||"HPA ì‚­ì œ ì‹¤íŒ¨");throw i.code=(n=a.data)==null?void 0:n.code,i}return{message:a.data.message||"HPAê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",...a.data.data}}catch(a){throw O.error("HPA ì‚­ì œ ì‹¤íŒ¨:",a),a}},ky=async s=>{var t,r;try{const n=await ze.kubernetes.request("getRolloutHistory",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Rollout íˆìŠ¤í† ë¦¬ ì¡°íšŒ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Rollout íˆìŠ¤í† ë¦¬ ì¡°íšŒ ì‹¤íŒ¨:",n),n}},Cy=async s=>{var t,r;try{const n=await ze.kubernetes.request("rolloutUndo",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Rollout Undo ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Rollout Undo ì‹¤íŒ¨:",n),n}},mh=async s=>{var t,r;try{const n=await ze.kubernetes.request("deletePod",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Pod ì‚­ì œ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Pod ì‚­ì œ ì‹¤íŒ¨:",n),n}},Iy=async s=>{var t,r;try{const n=await ze.kubernetes.request("createIngress",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Ingress ìƒì„± ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Ingress ìƒì„± ì‹¤íŒ¨:",n),n}},Gd=async s=>{try{return(await ze.kubernetes.request("checkIngressController",{service_id:s})).data.data}catch(t){throw O.error("Ingress Controller ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:",t),t}},Ty=async s=>{var t;try{const r=await ze.kubernetes.request("installIngressController",{service_id:s});return{installed:((t=r.data.data)==null?void 0:t.installed)||!1,message:r.data.message||"ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"}}catch(r){throw O.error("Ingress Controller ì„¤ì¹˜ ì‹¤íŒ¨:",r),r}},fh=async(s,t)=>{try{const r={service_id:s};return t&&t.length>0&&(r.hops=t),(await ze.kubernetes.request("checkMetricsServer",r)).data.data}catch(r){throw O.error("Metrics Server ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:",r),r}},Ry=async(s,t)=>{var r,n;try{const a={service_id:s};t&&t.length>0&&(a.hops=t);const l=(await ze.kubernetes.request("installMetricsServer",a)).data;return{message:l.message||"ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤",output:l.output||((r=l.data)==null?void 0:r.output),pod_status:l.pod_status||((n=l.data)==null?void 0:n.pod_status)}}catch(a){throw console.error("[installMetricsServer API] ì‹¤íŒ¨",a),O.error("Metrics Server ì„¤ì¹˜ ì‹¤íŒ¨:",a),a}},zy=async(s,t)=>{try{const r={service_id:s};t&&t.length>0&&(r.hops=t);const n=await ze.kubernetes.request("getMetricsServerStatus",r);return{status:n.data.data.status,diagnostics:n.data.data.diagnostics}}catch(r){throw O.error("Metrics Server ìƒì„¸ ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨:",r),r}},Ey=async s=>{var t,r;try{const n=await ze.kubernetes.request("cleanMetricsServerNode",{service_id:s});return{message:n.data.message||"ì´ë¯¸ì§€ ìºì‹œ ì •ë¦¬ ì™„ë£Œ",nodeName:(t=n.data.data)==null?void 0:t.node_name,podName:(r=n.data.data)==null?void 0:r.pod_name}}catch(n){throw O.error("Metrics Server ë…¸ë“œ ì´ë¯¸ì§€ ìºì‹œ ì •ë¦¬ ì‹¤íŒ¨:",n),n}},Py=async(s,t)=>{var r,n;try{const a={service_id:s};t&&t.length>0&&(a.hops=t);const i=await ze.kubernetes.request("getPodMetrics",a);if(!((r=i.data)!=null&&r.success))throw new Error(((n=i.data)==null?void 0:n.error)||"Pod ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ ì‹¤íŒ¨");return i.data.data}catch(a){throw O.error("Pod ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ ì‹¤íŒ¨:",a),a}},My=async s=>{var t,r;try{const n=await ze.kubernetes.request("describePod",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Pod ìƒì„¸ ì¡°íšŒ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Pod ìƒì„¸ ì¡°íšŒ ì‹¤íŒ¨:",n),n}},Ly=async s=>{var t,r;try{const n=await ze.kubernetes.request("cleanupReplicaSets",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"ReplicaSet ì •ë¦¬ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("ReplicaSet ì •ë¦¬ ì‹¤íŒ¨:",n),n}},Ay=async s=>{var t,r;try{const n=await ze.kubernetes.request("nodeDrain",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"ë…¸ë“œ Drain ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("ë…¸ë“œ Drain ì‹¤íŒ¨:",n),n}},Ny=async s=>{var t,r;try{const n=await ze.kubernetes.request("nodeCordon",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"ë…¸ë“œ Cordon ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("ë…¸ë“œ Cordon ì‹¤íŒ¨:",n),n}},By=async s=>{var t,r;try{const n=await ze.kubernetes.request("nodeUncordon",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"ë…¸ë“œ Uncordon ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("ë…¸ë“œ Uncordon ì‹¤íŒ¨:",n),n}},$y=async s=>{var t,r;try{const n=await ze.kubernetes.request("getPVCStatus",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"PVC ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("PVC ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨:",n),n}},Vg=async s=>{var t,r;try{const n=await ze.kubernetes.request("getNodeList",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"ë…¸ë“œ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("ë…¸ë“œ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",n),n}},Oy=async s=>{var t,r;try{const n=await ze.kubernetes.request("cleanupEvictedPods",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Evicted Pod ì •ë¦¬ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Evicted Pod ì •ë¦¬ ì‹¤íŒ¨:",n),n}},Dy=async s=>{var t,r;try{const n=await ze.kubernetes.request("cleanupFailedPods",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Failed Pod ì •ë¦¬ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Failed Pod ì •ë¦¬ ì‹¤íŒ¨:",n),n}},Fy=async s=>{var t,r;try{const n=await ze.kubernetes.request("cleanupCompletedPods",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Completed Pod ì •ë¦¬ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Completed Pod ì •ë¦¬ ì‹¤íŒ¨:",n),n}},Uy=async s=>{var t,r;try{const n=await ze.kubernetes.request("cleanupDockerResources",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Docker ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Docker ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì‹¤íŒ¨:",n),n}},Hy=async s=>{var t,r;try{const n=await ze.kubernetes.request("cleanupDiskSpace",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"ë””ìŠ¤í¬ ê³µê°„ í™•ë³´ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("ë””ìŠ¤í¬ ê³µê°„ í™•ë³´ ì‹¤íŒ¨:",n),n}},Vy=async s=>{var t,r;try{const n=await ze.kubernetes.request("cleanupPodLogs",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"Pod ë¡œê·¸ ì •ë¦¬ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("Pod ë¡œê·¸ ì •ë¦¬ ì‹¤íŒ¨:",n),n}},qy=async s=>{var t,r;try{const n=await ze.kubernetes.request("checkCertExpiration",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"K8s ì¸ì¦ì„œ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("K8s ì¸ì¦ì„œ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:",n),n}},Gy=async s=>{var t,r;try{const n=await ze.kubernetes.request("renewK8sCertificates",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"K8s ì¸ì¦ì„œ ê°±ì‹  ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("K8s ì¸ì¦ì„œ ê°±ì‹  ì‹¤íŒ¨:",n),n}},Wy=async s=>{var t,r;try{const n=await ze.kubernetes.request("renewK8sCertificate",s);if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"ì¸ì¦ì„œ ê°±ì‹  ì‹¤íŒ¨");return n.data.data}catch(n){throw O.error("ì¸ì¦ì„œ ê°±ì‹  ì‹¤íŒ¨:",n),n}},Ky=async s=>{var t,r;try{const n=await ze.kubernetes.request("getDomainsForService",{service_id:s});if(!((t=n.data)!=null&&t.success))throw new Error(((r=n.data)==null?void 0:r.error)||"ì„œë¹„ìŠ¤ ë„ë©”ì¸ ì¡°íšŒ ì‹¤íŒ¨");return n.data.data||[]}catch(n){throw O.error("ì„œë¹„ìŠ¤ ë„ë©”ì¸ ì¡°íšŒ ì‹¤íŒ¨:",n),n}},{Text:Pr,Title:Yy,Paragraph:yh}=we,{Panel:Jy}=nr,vl={"admin.conf":{title:"kubectl ê´€ë¦¬ì ì„¤ì •",description:"kubectl ëª…ë ¹ì–´ë¡œ í´ëŸ¬ìŠ¤í„°ì— ì ‘ê·¼í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ê´€ë¦¬ì ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"kubectl ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ ì‚¬ìš©"},apiserver:{title:"API ì„œë²„ ì¸ì¦ì„œ",description:"Kubernetes API ì„œë²„ì˜ TLS ì¸ì¦ì„œì…ë‹ˆë‹¤. ëª¨ë“  í´ëŸ¬ìŠ¤í„° í†µì‹ ì˜ ì¤‘ì‹¬ì´ ë©ë‹ˆë‹¤.",usage:"API ì„œë²„ HTTPS í†µì‹  ë³´ì•ˆ"},"apiserver-etcd-client":{title:"API ì„œë²„ â†’ etcd í´ë¼ì´ì–¸íŠ¸",description:"API ì„œë²„ê°€ etcd ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"API ì„œë²„ì˜ etcd ì—°ê²° ì¸ì¦"},"apiserver-kubelet-client":{title:"API ì„œë²„ â†’ Kubelet í´ë¼ì´ì–¸íŠ¸",description:"API ì„œë²„ê°€ ê° ë…¸ë“œì˜ kubeletê³¼ í†µì‹ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"Pod ë¡œê·¸ ì¡°íšŒ, exec ëª…ë ¹ ë“±"},"controller-manager.conf":{title:"Controller Manager ì„¤ì •",description:"Kubernetes Controller Managerê°€ API ì„œë²„ì™€ í†µì‹ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"ReplicaSet, Deployment ì»¨íŠ¸ë¡¤ëŸ¬ ë™ì‘"},"front-proxy-client":{title:"Front Proxy í´ë¼ì´ì–¸íŠ¸",description:"API ì§‘ê³„(aggregation) ê³„ì¸µì—ì„œ í™•ì¥ API ì„œë²„ì™€ í†µì‹ í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.",usage:"Metrics Server ë“± í™•ì¥ API ì—°ë™"},"scheduler.conf":{title:"Scheduler ì„¤ì •",description:"Kubernetes Schedulerê°€ API ì„œë²„ì™€ í†µì‹ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"Pod ìŠ¤ì¼€ì¤„ë§ ê²°ì • ë° ì ìš©"},"etcd/ca":{title:"etcd CA ì¸ì¦ì„œ",description:"etcd í´ëŸ¬ìŠ¤í„°ì˜ ì¸ì¦ ê¸°ê´€(CA) ë£¨íŠ¸ ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"etcd ê´€ë ¨ ëª¨ë“  ì¸ì¦ì„œ ì„œëª…"},"etcd/server":{title:"etcd ì„œë²„ ì¸ì¦ì„œ",description:"etcd ì„œë²„ì˜ TLS ì¸ì¦ì„œì…ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ ì—°ê²°ì„ ì•”í˜¸í™”í•©ë‹ˆë‹¤.",usage:"etcd ì„œë²„ HTTPS í†µì‹ "},"etcd/peer":{title:"etcd í”¼ì–´ ì¸ì¦ì„œ",description:"etcd í´ëŸ¬ìŠ¤í„° ë…¸ë“œ ê°„ í†µì‹ ì— ì‚¬ìš©ë˜ëŠ” ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"etcd í´ëŸ¬ìŠ¤í„° ë…¸ë“œ ê°„ ë™ê¸°í™”"},"etcd/healthcheck-client":{title:"etcd í—¬ìŠ¤ì²´í¬ í´ë¼ì´ì–¸íŠ¸",description:"etcdì˜ ìƒíƒœë¥¼ í™•ì¸í•˜ëŠ” í—¬ìŠ¤ì²´í¬ì— ì‚¬ìš©ë˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"etcd í´ëŸ¬ìŠ¤í„° ìƒíƒœ ëª¨ë‹ˆí„°ë§"},"super-admin.conf":{title:"ìŠˆí¼ ê´€ë¦¬ì ì„¤ì •",description:"í´ëŸ¬ìŠ¤í„°ì˜ ìµœê³  ê¶Œí•œì„ ê°€ì§„ ìŠˆí¼ ê´€ë¦¬ììš© ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"í´ëŸ¬ìŠ¤í„° ìµœê³  ê´€ë¦¬ì ì ‘ê·¼"},"kubelet.conf":{title:"Kubelet ì„¤ì •",description:"ê° ë…¸ë“œì˜ kubeletì´ API ì„œë²„ì™€ í†µì‹ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"ë…¸ë“œ ìƒíƒœ ë³´ê³  ë° Pod ê´€ë¦¬"}},rd=s=>{if(vl[s])return vl[s];if(s.startsWith("etcd/")||s.includes("etcd")){const t=Object.keys(vl).find(r=>r.startsWith("etcd/")&&s.includes(r.replace("etcd/","")));if(t)return vl[t]}return{title:s,description:"Kubernetes PKI ì¸ì¦ì„œì…ë‹ˆë‹¤.",usage:"í´ëŸ¬ìŠ¤í„° ì»´í¬ë„ŒíŠ¸ ê°„ ë³´ì•ˆ í†µì‹ "}},Zy=({hops:s,infraId:t,onCertificateRefresh:r})=>{const[n,a]=o.useState(!1),[i,l]=o.useState([]),[d,c]=o.useState(null),[p,h]=o.useState(""),[x,_]=o.useState(!1),[S,L]=o.useState(null),[k,E]=o.useState(!1),[P,I]=o.useState(null),[$,y]=o.useState(1),v=o.useRef(1),u=M=>{y(M),v.current=M},m=[{value:1,label:"1ë…„ (ê¸°ë³¸ê°’)"},{value:2,label:"2ë…„"},{value:3,label:"3ë…„"},{value:5,label:"5ë…„"},{value:10,label:"10ë…„"}],j=M=>{switch(M){case"valid":return{color:"success",icon:e.jsx(Ze,{}),text:"ì •ìƒ"};case"warning":return{color:"warning",icon:e.jsx(Yt,{}),text:"ì£¼ì˜"};case"critical":return{color:"error",icon:e.jsx(Tr,{}),text:"ìœ„í—˜"};case"expired":return{color:"default",icon:e.jsx(Es,{}),text:"ë§Œë£Œë¨"};default:return{color:"default",icon:e.jsx(Ks,{}),text:"ì•Œ ìˆ˜ ì—†ìŒ"}}},b=M=>M<0||M<=30?"#ff4d4f":M<=90?"#faad14":"#52c41a",A=M=>M.map(K=>({host:K.host,port:K.port||22,username:K.username||"",password:K.password||""})),W=o.useCallback(async()=>{if(!s||s.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}a(!0);try{const M=A(s),K=await qy({hops:M});l(K.certificates||[]),c(K.caInfo||null),h(K.rawOutput||""),I(new Date);const J=(K.certificates||[]).filter(te=>te.status==="critical"||te.status==="expired");J.length>0&&at.warning({message:"ì¸ì¦ì„œ ë§Œë£Œ ê²½ê³ ",description:`${J.length}ê°œì˜ ì¸ì¦ì„œê°€ 30ì¼ ì´ë‚´ì— ë§Œë£Œë©ë‹ˆë‹¤. ê°±ì‹ ì„ ê¶Œì¥í•©ë‹ˆë‹¤.`,duration:10})}catch(M){const K=M;at.error({message:"ì¸ì¦ì„œ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨",description:K.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{a(!1)}},[s]);o.useEffect(()=>{s&&s.length>0&&W()},[W,s]);const Z=async()=>{if(!s||s.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}rt.confirm({title:"ëª¨ë“  ì¸ì¦ì„œ ê°±ì‹ ",icon:e.jsx(Tr,{}),content:e.jsxs("div",{children:[e.jsx(yh,{children:"ëª¨ë“  Kubernetes PKI ì¸ì¦ì„œë¥¼ ê°±ì‹ í•©ë‹ˆë‹¤."}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(Pr,{strong:!0,style:{display:"block",marginBottom:8},children:"ì¸ì¦ì„œ ìœ íš¨ê¸°ê°„:"}),e.jsx(Ee,{defaultValue:$,onChange:u,style:{width:"100%"},options:m}),e.jsx(xe,{message:"ìœ íš¨ê¸°ê°„ ì„ íƒ ì‹œ í•´ë‹¹ ê¸°ê°„ìœ¼ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤",type:"info",showIcon:!0,style:{marginTop:8}})]}),e.jsx(xe,{type:"warning",message:"ì£¼ì˜ì‚¬í•­",description:e.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[e.jsx("li",{children:"ê°±ì‹  í›„ kubelet ì„œë¹„ìŠ¤ê°€ ìë™ìœ¼ë¡œ ì¬ì‹œì‘ë©ë‹ˆë‹¤."}),e.jsx("li",{children:"ê°±ì‹  ì¤‘ ì¼ì‹œì ì¸ í´ëŸ¬ìŠ¤í„° ì—°ê²° ëŠê¹€ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),e.jsx("li",{children:"ëª¨ë“  Control Plane ë…¸ë“œì—ì„œ ë™ì¼í•œ ì‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})]}),showIcon:!0,style:{marginTop:12}})]}),okText:"ê°±ì‹  ì‹œì‘",cancelText:"ì·¨ì†Œ",okType:"primary",width:500,onOk:async()=>{const M=v.current;_(!0);try{const K=A(s),J=await Gy({hops:K,validityYears:M});at.success({message:"ì¸ì¦ì„œ ê°±ì‹  ì™„ë£Œ",description:J.message||"ëª¨ë“  ì¸ì¦ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ê°±ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤.",duration:5}),J.certificates&&l(J.certificates),r==null||r(),setTimeout(()=>{W()},2e3)}catch(K){const J=K;at.error({message:"ì¸ì¦ì„œ ê°±ì‹  ì‹¤íŒ¨",description:J.message||"ì¸ì¦ì„œ ê°±ì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{_(!1)}}})},se=M=>{if(!s||s.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}const K=rd(M);rt.confirm({title:"ì¸ì¦ì„œ ê°±ì‹ ",icon:e.jsx(Bs,{style:{color:"#1890ff"}}),content:e.jsxs("div",{children:[e.jsxs(yh,{children:[e.jsx(Pr,{strong:!0,children:M})," ì¸ì¦ì„œë¥¼ ê°±ì‹ í•©ë‹ˆë‹¤."]}),e.jsx(Pr,{type:"secondary",style:{display:"block",marginBottom:16},children:K.description}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(Pr,{strong:!0,style:{display:"block",marginBottom:8},children:"ì¸ì¦ì„œ ìœ íš¨ê¸°ê°„:"}),e.jsx(Ee,{defaultValue:$,onChange:u,style:{width:"100%"},options:m}),e.jsx(xe,{message:"ìœ íš¨ê¸°ê°„ ì„ íƒ ì‹œ í•´ë‹¹ ê¸°ê°„ìœ¼ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤",type:"info",showIcon:!0,style:{marginTop:8}})]}),e.jsx(xe,{type:"warning",message:"ê°±ì‹  í›„ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ê°€ ì¬ì‹œì‘ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",showIcon:!0})]}),okText:"ê°±ì‹ ",cancelText:"ì·¨ì†Œ",okType:"primary",width:450,onOk:async()=>{const J=v.current;L(M);try{const te=A(s);await Wy({hops:te,certName:M,validityYears:J}),at.success({message:"ì¸ì¦ì„œ ê°±ì‹  ì™„ë£Œ",description:`${M} ì¸ì¦ì„œê°€ ${J}ë…„ ìœ íš¨ê¸°ê°„ìœ¼ë¡œ ê°±ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤.`,duration:5}),await W()}catch(te){const G=te;at.error({message:"ì¸ì¦ì„œ ê°±ì‹  ì‹¤íŒ¨",description:G.message||"ì¸ì¦ì„œ ê°±ì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{L(null)}}})},ce=[{title:"ì¸ì¦ì„œ",dataIndex:"name",key:"name",width:200,render:M=>{const K=rd(M);return e.jsx(Ie,{title:e.jsxs("div",{children:[e.jsx("div",{children:e.jsx("strong",{children:K.title})}),e.jsx("div",{style:{marginTop:4},children:K.description}),e.jsxs("div",{style:{marginTop:4,color:"#91d5ff"},children:[e.jsx("strong",{children:"ìš©ë„:"})," ",K.usage]})]}),placement:"right",children:e.jsxs(g,{children:[e.jsx(Bs,{style:{color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx(Pr,{strong:!0,style:{display:"block"},children:M}),e.jsx(Pr,{type:"secondary",style:{fontSize:11},children:K.title})]})]})})}},{title:"ì„¤ëª…",key:"description",width:220,render:(M,K)=>{const J=rd(K.name);return e.jsx("div",{children:e.jsx(Pr,{style:{fontSize:12},children:J.usage})})}},{title:"ë§Œë£Œì¼",dataIndex:"expirationDate",key:"expirationDate",width:150,render:M=>e.jsxs(Pr,{type:"secondary",style:{fontSize:12},children:[e.jsx(wr,{style:{marginRight:4}}),M||"-"]})},{title:"ë‚¨ì€ ê¸°ê°„",dataIndex:"remainingDays",key:"remainingDays",width:150,render:M=>{const K=Math.max(0,Math.min(100,M/365*100));return e.jsx(Ie,{title:`${M}ì¼ ë‚¨ìŒ`,children:e.jsx("div",{style:{width:120},children:e.jsx(qt,{percent:K,size:"small",strokeColor:b(M),format:()=>`${M}ì¼`})})})}},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:90,render:M=>{const K=j(M);return e.jsx(T,{color:K.color,icon:K.icon,children:K.text})}},{title:"CA",dataIndex:"caName",key:"caName",width:80,render:M=>e.jsx(Pr,{type:"secondary",style:{fontSize:12},children:M||"-"})},{title:"ì‘ì—…",key:"action",width:80,render:(M,K)=>e.jsx(Ie,{title:"ì´ ì¸ì¦ì„œë§Œ ê°±ì‹ ",children:e.jsx(B,{type:"link",size:"small",icon:e.jsx(Pt,{spin:S===K.name}),onClick:()=>se(K.name),loading:S===K.name,disabled:x,children:"ê°±ì‹ "})})}],D={total:i.length,valid:i.filter(M=>M.status==="valid").length,warning:i.filter(M=>M.status==="warning").length,critical:i.filter(M=>M.status==="critical").length,expired:i.filter(M=>M.status==="expired").length};return!s||s.length===0?e.jsx(xe,{message:"SSH ì—°ê²° ì •ë³´ í•„ìš”",description:"ì¸ì¦ì„œ ì •ë³´ë¥¼ ì¡°íšŒí•˜ë ¤ë©´ ë§ˆìŠ¤í„° ë…¸ë“œì— ëŒ€í•œ SSH ì—°ê²° ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.",type:"warning",showIcon:!0}):e.jsxs("div",{style:{padding:"0 4px"},children:[e.jsx(ie,{size:"small",style:{marginBottom:16},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(g,{children:[e.jsx(Bs,{style:{fontSize:24,color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx(Yy,{level:5,style:{margin:0},children:"Kubernetes PKI ì¸ì¦ì„œ ê´€ë¦¬"}),e.jsxs(Pr,{type:"secondary",children:["í´ëŸ¬ìŠ¤í„° ì¸ì¦ì„œ ë§Œë£Œì¼ ì¡°íšŒ ë° ê°±ì‹ ",P&&e.jsxs("span",{style:{marginLeft:8},children:["(ë§ˆì§€ë§‰ ì¡°íšŒ: ",P.toLocaleTimeString(),")"]})]})]})]}),e.jsxs(g,{children:[e.jsx(B,{icon:e.jsx(zs,{}),onClick:W,loading:n,children:"ìƒˆë¡œê³ ì¹¨"}),e.jsx(B,{type:"primary",icon:e.jsx(Pt,{}),onClick:Z,loading:x,disabled:n||i.length===0,danger:D.critical>0||D.expired>0,children:"ëª¨ë“  ì¸ì¦ì„œ ê°±ì‹ "})]})]})}),i.length>0&&e.jsx(ie,{size:"small",style:{marginBottom:16},children:e.jsxs(g,{size:"large",children:[e.jsxs(Pr,{children:[e.jsx(Pr,{strong:!0,children:"ì „ì²´:"})," ",D.total,"ê°œ"]}),e.jsxs(Pr,{children:[e.jsx(Ze,{style:{color:"#52c41a",marginRight:4}}),e.jsx(Pr,{strong:!0,children:"ì •ìƒ:"})," ",D.valid,"ê°œ"]}),e.jsxs(Pr,{children:[e.jsx(Yt,{style:{color:"#faad14",marginRight:4}}),e.jsx(Pr,{strong:!0,children:"ì£¼ì˜:"})," ",D.warning,"ê°œ"]}),e.jsxs(Pr,{children:[e.jsx(Tr,{style:{color:"#ff4d4f",marginRight:4}}),e.jsx(Pr,{strong:!0,children:"ìœ„í—˜:"})," ",D.critical,"ê°œ"]}),e.jsxs(Pr,{children:[e.jsx(Es,{style:{color:"#8c8c8c",marginRight:4}}),e.jsx(Pr,{strong:!0,children:"ë§Œë£Œ:"})," ",D.expired,"ê°œ"]})]})}),d&&e.jsxs(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(Bs,{style:{color:"#722ed1"}}),e.jsx(Pr,{strong:!0,children:"CA ì¸ì¦ì„œ (ë£¨íŠ¸ ì¸ì¦ ê¸°ê´€)"})]}),style:{marginBottom:16},children:[e.jsxs(Se,{size:"small",column:4,children:[e.jsx(Se.Item,{label:"ë§Œë£Œì¼",children:d.expirationDate||"-"}),e.jsxs(Se.Item,{label:"ë‚¨ì€ ê¸°ê°„",children:[d.remainingDays,"ì¼"]}),e.jsx(Se.Item,{label:"ìƒíƒœ",children:(()=>{const M=j(d.status);return e.jsx(T,{color:M.color,icon:M.icon,children:M.text})})()}),e.jsx(Se.Item,{label:"ìœ íš¨ê¸°ê°„",children:"ì•½ 10ë…„"})]}),e.jsx(xe,{message:"CA ì¸ì¦ì„œëŠ” kubeadm certs renewë¡œ ê°±ì‹ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",description:"CA ì¸ì¦ì„œ ê°±ì‹ ì´ í•„ìš”í•œ ê²½ìš° ë³„ë„ì˜ ì ˆì°¨ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ 10ë…„ì˜ ìœ íš¨ê¸°ê°„ì„ ê°€ì§‘ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginTop:12}})]}),e.jsx(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(Bs,{}),e.jsx(Pr,{strong:!0,children:"ì¸ì¦ì„œ ëª©ë¡"})]}),children:e.jsx(gt,{spinning:n,children:e.jsx(wt,{columns:ce,dataSource:i,rowKey:"name",size:"small",pagination:!1,locale:{emptyText:'ì¸ì¦ì„œ ì •ë³´ë¥¼ ì¡°íšŒí•˜ë ¤ë©´ "ìƒˆë¡œê³ ì¹¨" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.'},rowClassName:M=>M.status==="expired"?"ant-table-row-expired":M.status==="critical"?"ant-table-row-critical":M.status==="warning"?"ant-table-row-warning":""})})}),p&&e.jsx(nr,{style:{marginTop:16},children:e.jsx(Jy,{header:e.jsxs(g,{children:[e.jsx(Ks,{}),e.jsx(Pr,{children:"kubeadm certs check-expiration ì›ë³¸ ì¶œë ¥"})]}),children:e.jsx("pre",{style:{background:"#f5f5f5",padding:12,borderRadius:4,maxHeight:300,overflow:"auto",fontSize:12},children:p})},"raw")}),e.jsx(xe,{message:"ì¸ì¦ì„œ ê°±ì‹  ì•ˆë‚´",description:e.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[e.jsx("li",{children:"Kubernetes ì¸ì¦ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 1ë…„ê°„ ìœ íš¨í•©ë‹ˆë‹¤."}),e.jsx("li",{children:"ê°±ì‹  í›„ì—ëŠ” kubelet ì„œë¹„ìŠ¤ê°€ ìë™ìœ¼ë¡œ ì¬ì‹œì‘ë©ë‹ˆë‹¤."}),e.jsx("li",{children:"HA í´ëŸ¬ìŠ¤í„°ì˜ ê²½ìš° ëª¨ë“  Control Plane ë…¸ë“œì—ì„œ ê°±ì‹  ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤."}),e.jsx("li",{children:"ê°±ì‹ ëœ ì¸ì¦ì„œë¥¼ ì ìš©í•˜ë ¤ë©´ API ì„œë²„, Controller Manager, Schedulerë¥¼ ì¬ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤."}),e.jsx("li",{children:"CA ì¸ì¦ì„œëŠ” ë³„ë„ë¡œ ê°±ì‹ í•´ì•¼ í•˜ë©°, ì¼ë°˜ì ìœ¼ë¡œ 10ë…„ì˜ ìœ íš¨ê¸°ê°„ì„ ê°€ì§‘ë‹ˆë‹¤."})]}),type:"info",showIcon:!0,style:{marginTop:16}}),e.jsx("style",{children:`
        .ant-table-row-expired {
          background-color: #fff1f0 !important;
        }
        .ant-table-row-critical {
          background-color: #fff2e8 !important;
        }
        .ant-table-row-warning {
          background-color: #fffbe6 !important;
        }
      `})]})},jh=({selectedInfra:s,runtimeDetails:t,onLoading:r,getStoredAuthHops:n})=>{const[a,i]=o.useState(!1),[l,d]=o.useState(!1),[c,p]=o.useState(null),[h,x]=o.useState([]),[_,S]=o.useState(null),[L,k]=o.useState(!1),E=v=>{},P=o.useCallback(v=>{const u=v.filter(m=>{const j=typeof m.type=="string"?m.type.toLowerCase():"";return j.includes("master")||j.includes("control-plane")||j.includes("control_plane")});return u.length>0?u[0]:v[0]},[]),I=o.useCallback(async()=>{var v,u,m;if(S(null),!!s&&s.nodes.length!==0){k(!0);try{const j=P(s.nodes),b=n(JSON.parse(j.hops));b.filter(J=>!J.username||!J.password).length>0&&(x(b),d(!0),i(!0));const W=await ju.request("getRuntimeInfo",{hops:b,infra_id:s.id}),Z=(v=W.data.storageResult)==null?void 0:v.split(`
`)[0].split(" "),se=((u=W.data.memoryDetailResult)==null?void 0:u.split(" "))||["0Ki","0Ki"],ce=J=>{const te=J.replace(/Ki$/,"");return(Number(te)||0)*1024},D=ce(se[0]||"0Ki"),M=ce(se[1]||"0Ki"),K={runningPods:W.data.runningPodsResult.split(`
`).filter(J=>J.trim().length!==0).length,totalPods:W.data.totalPodsResult.split(`
`).filter(J=>J.trim().length!==0).length,failedOrStoppedPods:W.data.stopPodsResult.split(`
`).filter(J=>J.trim().length!==0).length,workloadCount:W.data.workloadsResult.split(`
`).filter(J=>J.trim().length!==0).length,imageCount:W.data.imagesResult.split(`
`).filter(J=>J.trim().length!==0).length,runtimeType:W.data.runtimeResult.split("://")[0],architecture:W.data.architectureResult,runtimeVersion:W.data.runtimeResult.split("://")[1],apiServerVersion:W.data.apiVersionResult.split(`
`)[0],os:W.data.osResult,kernelVersion:W.data.kernalResult,totalCpu:W.data.cpuCoreResult,totalMemory:W.data.memoryResult,mainNodeStorage:{usagePercentage:Number((m=Z[2])==null?void 0:m.split("%")[0]),total:Number(Z[0]),used:Number(Z[1])},cpuUsage:Number(W.data.cpuUsageResult)||0,memoryUsage:Number(W.data.memoryUsageResult)||0,memoryUsed:D,memoryTotal:M,networkRx:Number(W.data.networkRxResult)||0,networkTx:Number(W.data.networkTxResult)||0};S(K)}catch(j){if(console.error(j),j instanceof Error&&j.message.includes("SSH ì—°ê²° ê²€ì¦ ì‹¤íŒ¨")){const b=P(s.nodes),A=n(JSON.parse(b.hops));x(A),d(!0),i(!0)}}finally{k(!1)}}},[s,n,P]);o.useEffect(()=>{I()},[I]);const $=o.useMemo(()=>{if(!s||s.nodes.length===0)return[];const v=P(s.nodes);if(!v||!v.hops)return[];try{const u=JSON.parse(v.hops);return n(u)}catch(u){return[]}},[s,P,n]),y=[{key:"runtimeInfo",label:"ê°œìš”",children:e.jsx(jy,{selectedInfra:s,info:_,infoLoading:L})},{key:"nodeSetting",label:"ë…¸ë“œ ëª©ë¡",children:e.jsx(yy,{selectedInfra:s})},{key:"runtimeDetails",label:"ëŸ°íƒ€ì„ í™˜ê²½",children:e.jsx(uy,{runtimeDetails:t,onLoading:r})},{key:"certificates",label:e.jsxs("span",{children:[e.jsx(Bs,{style:{marginRight:8}}),"ì¸ì¦ì„œ ê´€ë¦¬"]}),children:e.jsx(Zy,{hops:$,infraId:s==null?void 0:s.id,onCertificateRefresh:()=>{I()}})}];return e.jsxs(e.Fragment,{children:[e.jsx(xs,{defaultActiveKey:"runtimeInfo",items:y}),e.jsx(Hi,{visible:a,onClose:()=>{i(!1),d(!1),p(null)},onComplete:E,hops:h.map(v=>({...v,username:v.username||""})),infraId:c==null?void 0:c.infraId,isRetry:l})]})},{Option:Iv}=Ee,Qy=({runtimeDetails:s,selectedInfra:t,onLoading:r,getStoredAuthHops:n,setRuntimeDetails:a})=>{var y,v;const[i,l]=o.useState([]),[d,c]=o.useState(!1),[p,h]=o.useState(!1),[x,_]=o.useState(""),{user:S}=Tn(),L=o.useMemo(()=>{if(!(s!=null&&s.images))return[];if(!x.trim())return s.images;const u=x.toLowerCase();return s.images.filter(m=>m.repository.toLowerCase().includes(u)||m.tag.toLowerCase().includes(u)||m.id.toLowerCase().includes(u))},[s==null?void 0:s.images,x]),k=async()=>{if(i.length===0){f.info("ì‚­ì œí•  ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}const u=s==null?void 0:s.images.filter(b=>i.includes(b.id)).map(b=>`${b.repository}:${b.tag}`);if(!u||u.length===0){f.error("ì‚­ì œí•  ì´ë¯¸ì§€ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}c(!0),f.info(`${u.length}ê°œì˜ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤...`);const m=n(JSON.parse(t.nodes[0].hops));if((await Ns.runPlaybook({playbook_to_run:"delete_podman_images",hops:m,awxTemplate:S==null?void 0:S.awx_template,images_to_delete:u})).data.status!=="failed"){f.success("ì„ íƒí•œ ì´ë¯¸ì§€ë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.");const b=s==null?void 0:s.images.filter(A=>!i.includes(A.id));a({...s,images:b,image_count:b.length}),l([])}else f.error("ì´ë¯¸ì§€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. SSH ì ‘ì† ì •ë³´ë‚˜ ì´ë¯¸ì§€ ì‚¬ìš© ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");c(!1)},E=async()=>{var u,m;h(!0),f.info("ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤...");try{const j=n(JSON.parse(t.nodes[0].hops)),b=await Sc("images",{hops:j},"podman");f.success(b.message||"ì´ë¯¸ì§€ ì •ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");const A=new Set(((u=s==null?void 0:s.containers)==null?void 0:u.map(Z=>Z.image))||[]),W=((m=s==null?void 0:s.images)==null?void 0:m.filter(Z=>{const se=`${Z.repository}:${Z.tag}`;return A.has(se)||A.has(Z.repository)||A.has(Z.id)}))||[];a({...s,images:W,image_count:W.length}),l([])}catch(j){f.error("ì´ë¯¸ì§€ ì •ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{h(!1)}},I={selectedRowKeys:i,onChange:u=>{l(u)}},$=i.length>0;return e.jsxs("div",{children:[e.jsx(ie,{title:e.jsxs(g,{align:"center",children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ì»¨í…Œì´ë„ˆ ëª©ë¡"}),e.jsx(T,{children:(s==null?void 0:s.container_count)||0})]}),style:{marginBottom:16},size:"small",children:r?e.jsx(gt,{}):e.jsx(e.Fragment,{children:s!=null&&s.containers&&(s==null?void 0:s.containers.length)>0?e.jsx(wt,{dataSource:s==null?void 0:s.containers,columns:[{title:"ì»¨í…Œì´ë„ˆëª…",dataIndex:"name",key:"name",ellipsis:!0},{title:"ì´ë¯¸ì§€",dataIndex:"image",key:"image",ellipsis:!0},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:100,render:u=>{const m={running:"green",stopped:"red",paused:"orange",exited:"gray"};return e.jsx(T,{color:m[u]||"default",children:u})}},{title:"í¬íŠ¸",dataIndex:"ports",key:"ports",width:150,ellipsis:!0}],rowKey:"id",pagination:{pageSize:5,size:"small"},size:"small",scroll:{x:600}}):e.jsx(Je,{description:"ì»¨í…Œì´ë„ˆê°€ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})}),e.jsx(ie,{title:e.jsxs(g,{align:"center",style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[e.jsxs(g,{children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ì´ë¯¸ì§€ ëª©ë¡"}),e.jsxs(T,{children:[L.length,x?` / ${(s==null?void 0:s.image_count)||0}`:""]})]}),e.jsxs(g,{children:[e.jsx(ue,{placeholder:"ê²€ìƒ‰...",prefix:e.jsx(Fi,{}),value:x,onChange:u=>_(u.target.value),style:{width:150},allowClear:!0,size:"small"}),e.jsx(Kt,{title:"ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ì •ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:"ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ê°€ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤.",onConfirm:E,okText:"ì •ë¦¬",cancelText:"ì·¨ì†Œ",disabled:p,children:e.jsx(B,{icon:e.jsx($a,{}),size:"small",disabled:p||d,loading:p,children:"ë¯¸ì‚¬ìš© ì •ë¦¬"})}),e.jsx(Kt,{title:`${i.length}ê°œì˜ ì´ë¯¸ì§€ë¥¼ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,onConfirm:k,okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",disabled:!$||d,children:e.jsx(B,{type:"primary",danger:!0,size:"small",disabled:!$||d,loading:d&&$,children:"ì‚­ì œ"})})]})]}),style:{marginBottom:16},size:"small",children:r?e.jsx(gt,{}):e.jsx(e.Fragment,{children:L.length>0?e.jsx(wt,{rowSelection:I,dataSource:L,columns:[{title:"ì´ë¯¸ì§€ëª…",dataIndex:"repository",key:"repository",ellipsis:!0,render:(u,m)=>u&&u.includes(":")?u:m.tag&&m.tag.length<20?`${u}:${m.tag}`:u},{title:"ID",dataIndex:"tag",key:"tag",width:110,ellipsis:!0,render:(u,m)=>{const j=u&&u.length>=12?u:m.id;return j?j.substring(0,12):"-"}},{title:"í¬ê¸°",dataIndex:"size",key:"size",width:90,render:(u,m)=>(!u||u==="0B"||u==="0")&&m.created&&/\d+(\.\d+)?\s*(B|KB|MB|GB|TB)/i.test(m.created)?m.created:u||"-"}],rowKey:"id",pagination:{pageSize:5,size:"small"},size:"small",scroll:{x:500}}):e.jsx(Je,{description:x?`'${x}' ê²°ê³¼ ì—†ìŒ`:"ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,lg:12,children:e.jsx(ie,{title:e.jsxs(g,{align:"center",children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ë³¼ë¥¨ ëª©ë¡"}),e.jsx(T,{children:((y=s==null?void 0:s.volumes)==null?void 0:y.length)||0})]}),style:{height:"100%"},size:"small",children:r?e.jsx(gt,{}):e.jsx(e.Fragment,{children:s!=null&&s.volumes&&(s==null?void 0:s.volumes.length)>0?e.jsx(wt,{dataSource:s==null?void 0:s.volumes,columns:[{title:"ë³¼ë¥¨ëª…",dataIndex:"name",key:"name",ellipsis:!0},{title:"ì»¨í…Œì´ë„ˆ",dataIndex:"usedBy",key:"usedBy",ellipsis:!0}],rowKey:u=>`${u.name}-${u.usedBy}`,pagination:!1,size:"small",scroll:{y:180}}):e.jsx(Je,{description:"ë³¼ë¥¨ì´ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})})}),e.jsx(Y,{xs:24,lg:12,children:e.jsx(ie,{title:e.jsxs(g,{align:"center",children:[e.jsx(we.Title,{level:5,style:{margin:0},children:"ë„¤íŠ¸ì›Œí¬ ëª©ë¡"}),e.jsx(T,{children:((v=s==null?void 0:s.networks)==null?void 0:v.length)||0})]}),style:{height:"100%"},size:"small",children:r?e.jsx(gt,{}):e.jsx(e.Fragment,{children:s!=null&&s.networks&&(s==null?void 0:s.networks.length)>0?e.jsx(wt,{dataSource:s==null?void 0:s.networks,columns:[{title:"ë„¤íŠ¸ì›Œí¬ëª…",dataIndex:"name",key:"name",ellipsis:!0},{title:"ì„œë¸Œë„·",dataIndex:"subnet",key:"subnet",ellipsis:!0},{title:"ì»¨í…Œì´ë„ˆ",dataIndex:"container_count",key:"container_count",width:80}],rowKey:"name",pagination:!1,size:"small",scroll:{y:180}}):e.jsx(Je,{description:"ë„¤íŠ¸ì›Œí¬ê°€ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})})})]})]})},kl=s=>{if(s===0)return"0 B";const t=1024,r=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,n)).toFixed(2))+" "+r[n]},Xy=({selectedInfra:s,info:t,infoLoading:r})=>{var a,i,l,d,c;const{Text:n}=we;return o.useEffect(()=>{},[t]),e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsx(Ke,{gutter:[16,16],style:{marginBottom:24},children:e.jsx(Y,{span:24,children:e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(Bs,{})," í™˜ê²½ ê¸°ë³¸ ì •ë³´"]}),bordered:!0,style:{height:"100%"},extra:e.jsx(T,{color:"blue",children:s.type.toUpperCase()}),children:e.jsxs(Se,{column:1,size:"small",bordered:!0,children:[e.jsx(Se.Item,{label:"í™˜ê²½ ì´ë¦„",children:e.jsx(n,{strong:!0,children:s.name})}),e.jsx(Se.Item,{label:"ì„¤ëª…",children:e.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:s.info||e.jsx(n,{type:"secondary",italic:!0,children:"ì„¤ëª… ì—†ìŒ"})})}),e.jsx(Se.Item,{label:"ìƒì„±ì¼",children:new Date(s.created_at).toLocaleDateString()})]})})})}),s&&t?e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",style:{borderColor:"#d9d9d9"},children:e.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"ëŸ°íƒ€ì„ ë¦¬ì†ŒìŠ¤ í˜„í™©"})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#f6ffed",border:"1px solid #b7eb8f"},children:e.jsx($e,{title:"ì‹¤í–‰ ì¤‘ì¸ Container",value:t==null?void 0:t.runningContainers,valueStyle:{color:"#3f8600"},prefix:e.jsx(Ze,{}),suffix:`/ ${t==null?void 0:t.totalContainers}`})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#fff1f0",border:"1px solid #ffa39e"},children:e.jsx($e,{title:"ë¹„ì •ìƒ/ì¤‘ì§€ Container",value:(t==null?void 0:t.totalContainers)-(t==null?void 0:t.runningContainers),valueStyle:{color:"#cf1322"},prefix:e.jsx(xo,{})})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#e6f7ff",border:"1px solid #91caff"},children:e.jsx($e,{title:"ì›Œí¬ë¡œë“œ ì´ê³„",value:t==null?void 0:t.totalContainers,valueStyle:{color:"#096dd9"},prefix:e.jsx(Da,{})})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!1,style:{background:"#fff7e6",border:"1px solid #ffd591"},children:e.jsx($e,{title:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€",value:t==null?void 0:t.imageCount,valueStyle:{color:"#d46b08"},prefix:e.jsx(_s,{})})})})]}),e.jsx("div",{style:{margin:"16px 0"}}),e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(_t,{})," ëŸ°íƒ€ì„ ìƒì„¸ ì •ë³´"]}),bordered:!0,style:{marginBottom:16},children:e.jsxs(Se,{column:{xxl:4,xl:4,lg:3,md:2,sm:2,xs:1},size:"small",children:[e.jsx(Se.Item,{label:"ëŸ°íƒ€ì„ ìœ í˜•",children:e.jsx(T,{color:"geekblue",children:t==null?void 0:t.runtimeType})}),e.jsx(Se.Item,{label:"ì•„í‚¤í…ì²˜",children:t==null?void 0:t.architecture}),e.jsx(Se.Item,{label:"ë²„ì „",children:t==null?void 0:t.runtimeVersion}),e.jsx(Se.Item,{label:"API ë²„ì „",children:t==null?void 0:t.apiServerVersion}),e.jsx(Se.Item,{label:"OS",children:t==null?void 0:t.os}),e.jsx(Se.Item,{label:"ì»¤ë„",children:t==null?void 0:t.kernelVersion}),e.jsx(Se.Item,{label:"CPU",children:t==null?void 0:t.totalCpu}),e.jsx(Se.Item,{label:"ë©”ëª¨ë¦¬",children:t==null?void 0:t.totalMemory})]})}),e.jsx(xt,{orientation:"left",style:{borderColor:"#d9d9d9",marginTop:8,marginBottom:16},children:e.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§"})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(mc,{style:{fontSize:20,color:"#1890ff"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"ë””ìŠ¤í¬"}),e.jsx(qt,{type:"circle",percent:((a=t==null?void 0:t.mainNodeStorage)==null?void 0:a.usagePercentage)||0,size:80,strokeColor:(((i=t==null?void 0:t.mainNodeStorage)==null?void 0:i.usagePercentage)||0)>80?"#ff4d4f":(((l=t==null?void 0:t.mainNodeStorage)==null?void 0:l.usagePercentage)||0)>60?"#faad14":"#52c41a",format:p=>`${p}%`}),e.jsx(T,{color:(((d=t==null?void 0:t.mainNodeStorage)==null?void 0:d.usagePercentage)||0)>80?"red":"green",style:{fontSize:11},children:(((c=t==null?void 0:t.mainNodeStorage)==null?void 0:c.usagePercentage)||0)>80?"ì£¼ì˜":"ì–‘í˜¸"})]})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(ii,{style:{fontSize:20,color:"#722ed1"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"CPU"}),e.jsx(qt,{type:"circle",percent:Math.round((t==null?void 0:t.cpuUsage)||0),size:80,strokeColor:((t==null?void 0:t.cpuUsage)||0)>80?"#ff4d4f":((t==null?void 0:t.cpuUsage)||0)>60?"#faad14":"#52c41a",format:p=>`${p}%`}),e.jsx(T,{color:((t==null?void 0:t.cpuUsage)||0)>80?"red":((t==null?void 0:t.cpuUsage)||0)>60?"orange":"green",style:{fontSize:11},children:((t==null?void 0:t.cpuUsage)||0)>80?"ë†’ìŒ":((t==null?void 0:t.cpuUsage)||0)>60?"ë³´í†µ":"ì–‘í˜¸"})]})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(_s,{style:{fontSize:20,color:"#13c2c2"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"ë©”ëª¨ë¦¬"}),e.jsx(qt,{type:"circle",percent:Math.round((t==null?void 0:t.memoryUsage)||0),size:80,strokeColor:((t==null?void 0:t.memoryUsage)||0)>80?"#ff4d4f":((t==null?void 0:t.memoryUsage)||0)>60?"#faad14":"#52c41a",format:p=>`${p}%`}),e.jsxs("div",{style:{fontSize:"10px",color:"#888"},children:[kl((t==null?void 0:t.memoryUsed)||0)," /"," ",kl((t==null?void 0:t.memoryTotal)||0)]})]})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",bordered:!0,style:{textAlign:"center",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(ou,{style:{fontSize:20,color:"#eb2f96"}}),e.jsx(n,{strong:!0,style:{fontSize:12},children:"ë„¤íŠ¸ì›Œí¬"}),e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx(fc,{style:{color:"#52c41a",fontSize:12}}),e.jsx(n,{style:{fontSize:11,marginLeft:4},children:kl((t==null?void 0:t.networkRx)||0)})]}),e.jsxs("div",{children:[e.jsx(lu,{style:{color:"#1890ff",fontSize:12}}),e.jsx(n,{style:{fontSize:11,marginLeft:4},children:kl((t==null?void 0:t.networkTx)||0)})]})]}),e.jsx(T,{color:"cyan",style:{fontSize:11},children:"ëˆ„ì "})]})})})]})]}):r?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ëŸ°íƒ€ì„ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤.",style:{marginTop:40}}):e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ë“±ë¡ëœ ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤.",style:{marginTop:40}})]})},bh=({runtimeDetails:s,selectedInfra:t,onLoading:r,getStoredAuthHops:n,setRuntimeDetails:a})=>{const[i,l]=o.useState(!1),[d,c]=o.useState(!1),[p,h]=o.useState(null),[x,_]=o.useState([]),[S,L]=o.useState(null),[k,E]=o.useState(!1),P=y=>{},I=o.useCallback(async()=>{var y,v,u;if(L(null),!!t&&t.nodes.length!==0){E(!0);try{const m=n(JSON.parse(t.nodes[0].hops));m.filter(D=>!D.username||!D.password).length>0&&(_(m),c(!0),l(!0));const b=await bu.request("getSingleHostInfo",{hops:m,infra_id:t.id,type:t.type}),A=(y=b.data.storageResult)==null?void 0:y.split(`
`)[0].split(" "),W=((v=b.data.memoryDetailResult)==null?void 0:v.split(" "))||["0","0"],Z=Number(W[0])||0,se=Number(W[1])||0,ce={runningContainers:Number(b.data.runningContainersResult),totalContainers:Number(b.data.totalContainersResult),failedOrStoppedContainers:Number(b.data.stopContainersResult),workloadCount:Number(b.data.workloadsResult),imageCount:b.data.imagesResult.split(" ").filter(D=>D.trim().length!==0).length,runtimeType:"podman",architecture:b.data.architectureResult,runtimeVersion:b.data.runtimeVersionResult,apiServerVersion:b.data.apiVersionResult,os:b.data.osResult,kernelVersion:b.data.kernalResult,totalCpu:b.data.cpuCoreResult,totalMemory:b.data.memoryResult,mainNodeStorage:{usagePercentage:Number((u=A[2])==null?void 0:u.split("%")[0]),total:Number(A[0]),used:Number(A[1])},cpuUsage:Number(b.data.cpuUsageResult)||0,memoryUsage:Number(b.data.memoryUsageResult)||0,memoryUsed:Z,memoryTotal:se,networkRx:Number(b.data.networkRxResult)||0,networkTx:Number(b.data.networkTxResult)||0};L(ce)}catch(m){if(console.error(m),m instanceof Error&&m.message.includes("SSH ì—°ê²° ê²€ì¦ ì‹¤íŒ¨")){const j=t.nodes.filter(A=>A.type==="master"||typeof A.type=="string"&&A.type.includes("master")),b=n(JSON.parse(j[0].hops));_(b),c(!0),l(!0)}}finally{E(!1)}}},[t,n]);o.useEffect(()=>{I()},[I]);const $=[{key:"runtimeInfo",label:"ê°œìš”",children:e.jsx(Xy,{selectedInfra:t,info:S,infoLoading:k})},{key:"runtimeDetails",label:"ëŸ°íƒ€ì„ í™˜ê²½",children:e.jsx(Qy,{runtimeDetails:s,selectedInfra:t,onLoading:r,getStoredAuthHops:n,setRuntimeDetails:a})}];return e.jsxs(e.Fragment,{children:[e.jsx(xs,{defaultActiveKey:"runtimeInfo",items:$}),e.jsx(Hi,{visible:i,onClose:()=>{l(!1),c(!1),h(null)},onComplete:P,hops:x.map(y=>({...y,username:y.username||""})),infraId:p==null?void 0:p.infraId,isRetry:d})]})},ej=({onAuthSuccess:s,onAuthCancel:t})=>{const[r,n]=Ct.useState(!1),[a,i]=Ct.useState([]),[l,d]=Ct.useState([]),[c,p]=Ct.useState(""),[h,x]=Ct.useState(null),[_]=H.useForm(),S=Gs(),L=Ct.useCallback((j,b)=>b.map((A,W)=>({host:A.host,port:A.port,username:j[`ssh_username_${W}`],password:j[`ssh_password_${W}`]})),[]),k=Ct.useCallback(async(j,b,A)=>{const W=[],Z={};for(let ce=0;ce<j.length;ce++){const D=j[ce],M=await qd(D.host,Oi(D.port));M?(Z[`ssh_username_${ce}`]=M.userId,Z[`ssh_password_${ce}`]=M.password,W.push({host:D.host,port:D.port,username:M.userId,password:M.password})):W.push({host:D.host,port:D.port,username:"",password:""})}if(W.every(ce=>ce.username&&ce.password)){s(W,b,A);return}i(j),p(b),x(A),n(!0),Object.keys(Z).length>0&&setTimeout(()=>_.setFieldsValue(Z),0)},[_,s]),E=Ct.useCallback((j,b="namespace",A)=>{k(j,b,A)},[k]),P=Ct.useCallback((j,b="setup",A)=>{k(j,b,A)},[k]);Ct.useEffect(()=>{const j=c==="setup"?l:a;!r||j.length===0||(async()=>{const b={};for(let A=0;A<j.length;A++){const W=j[A],Z=await qd(W.host,Oi(W.port));Z&&(b[`ssh_username_${A}`]=Z.userId,b[`ssh_password_${A}`]=Z.password)}Object.keys(b).length>0&&_.setFieldsValue(b)})().catch(()=>{})},[r,c,l,a,_]);const I=Ct.useCallback(async()=>{try{const j=await _.validateFields(),A=L(j,c==="setup"?l:a);A.forEach(W=>{S.serverlist.find(se=>se.host.trim().toLowerCase()===W.host.trim().toLowerCase()&&Oi(se.port)===Oi(W.port))||S.addServer({host:W.host,port:W.port,userId:W.username,password:W.password})}),s(A,c,h),n(!1),i([]),d([]),p(""),x(null),_.resetFields()}catch(j){O.error("Auth form validation failed:",j)}},[_,c,l,a,L,s,h,S]),$=Ct.useCallback(()=>{n(!1),i([]),d([]),p(""),x(null),_.resetFields(),t()},[_,t]),y=Ct.useCallback(j=>e.jsxs(e.Fragment,{children:[e.jsxs(xt,{orientation:"left",plain:!0,children:[e.jsx(_t,{})," ì„œë²„ ì ‘ì† ì •ë³´ (SSH)"]}),j.map((b,A)=>e.jsxs("div",{style:{marginBottom:"16px",padding:"12px",border:"1px solid #f0f0f0",borderRadius:"4px"},children:[e.jsxs("p",{style:{fontWeight:500,margin:"-12px -12px 12px -12px",padding:"8px 12px",background:"#fafafa",borderBottom:"1px solid #f0f0f0"},children:[`Hop ${A+1}: ${b.host}:${b.port}`,A===j.length-1&&" (ìµœì¢… ëª©ì ì§€)"]}),e.jsx(H.Item,{name:`ssh_username_${A}`,label:"ì‚¬ìš©ì ì´ë¦„",rules:[{required:!0,message:"SSH ì‚¬ìš©ì ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{prefix:e.jsx(Un,{}),placeholder:"ì‚¬ìš©ì ì´ë¦„",autoComplete:"username"})}),e.jsx(H.Item,{name:`ssh_password_${A}`,label:"ë¹„ë°€ë²ˆí˜¸",rules:[{required:!0,message:"SSH ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue.Password,{prefix:e.jsx(za,{}),placeholder:"ë¹„ë°€ë²ˆí˜¸",autoComplete:"current-password"})})]},A))]}),[]),v=Ct.useCallback(()=>{switch(c){case"namespace":return"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì¡°íšŒ ì¸ì¦";case"setup":return"ë°±ì—… í™˜ê²½ êµ¬ì¶• ì¸ì¦";case"backup":return"ë°±ì—… ìƒì„± ì¸ì¦";case"restore":return"ë°±ì—… ë³µêµ¬ ì¸ì¦";case"delete":return"ë°±ì—… ì‚­ì œ ì¸ì¦";default:return"ì„œë²„ ì¸ì¦"}},[c]),u=Ct.useCallback(()=>{switch(c){case"namespace":return"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ëª©ë¡ì„ ì¡°íšŒí•˜ê¸° ìœ„í•´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì ‘ì† ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.";case"setup":return"ë°±ì—… í™˜ê²½ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì ‘ì† ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.";case"backup":return"ë°±ì—…ì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì ‘ì† ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.";case"restore":return"ë°±ì—…ì„ ë³µêµ¬í•˜ê¸° ìœ„í•´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì ‘ì† ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.";case"delete":return"ë°±ì—…ì„ ì‚­ì œí•˜ê¸° ìœ„í•´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì ‘ì† ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.";default:return"ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì„œë²„ ì ‘ì† ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤."}},[c]),m=Ct.useCallback(()=>{const j=c==="setup"?l:a;return e.jsxs(rt,{title:v(),open:r,onOk:I,onCancel:$,width:600,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",className:"backup-auth-modal",children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx("p",{style:{color:"#666",fontSize:"14px"},children:u()})}),e.jsx(H,{form:_,layout:"vertical",autoComplete:"off",children:y(j)})]})},[c,l,a,r,v,u,I,$,_,y]);return{isNamespaceAuthModalVisible:r,currentAuthHops:a,setupHops:l,authPurpose:c,requestNamespaceAuth:E,requestSetupAuth:P,handleAuthSubmit:I,handleAuthCancel:$,formatAuthData:L,renderAuthFields:y,AuthModal:m}},{Option:Tv}=Ee,{TabPane:Rv}=xs,{Text:zv}=we,{Text:Ev}=we,{TabPane:Pv}=xs,tj=({infra:s,visible:t,onClose:r})=>{const[n,a]=o.useState([]),[i,l]=o.useState(!1),[d]=H.useForm(),c=o.useCallback(async()=>{if(s){l(!0);try{const x=await Yf(s.id);a(x||[])}catch(x){f.error("ê¶Œí•œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{l(!1)}}},[s]);o.useEffect(()=>{t&&c()},[t,s,c]);const p=async x=>{var _,S;l(!0);try{await Jf({infra_id:s.id,email:x.email}),f.success("ê¶Œí•œì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."),d.resetFields(),c()}catch(L){f.error(((S=(_=L==null?void 0:L.response)==null?void 0:_.data)==null?void 0:S.error)||"ê¶Œí•œ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{l(!1)}},h=async x=>{var _,S;l(!0);try{await Zf({infra_id:s.id,user_id:x}),f.success("ê¶Œí•œì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),c()}catch(L){f.error(((S=(_=L==null?void 0:L.response)==null?void 0:_.data)==null?void 0:S.error)||"ê¶Œí•œ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{l(!1)}};return e.jsx(rt,{title:`${s.name} - ê¶Œí•œ ê´€ë¦¬`,open:t,onCancel:r,footer:null,width:600,children:e.jsxs(gt,{spinning:i,children:[e.jsxs(H,{form:d,layout:"inline",onFinish:p,style:{marginBottom:24},children:[e.jsx(H.Item,{name:"email",rules:[{required:!0,message:"ì‚¬ìš©ì ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"},{type:"email",message:"ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤."}],style:{flex:1},children:e.jsx(ue,{prefix:e.jsx(cu,{}),placeholder:"ì¶”ê°€í•  ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥"})}),e.jsx(H.Item,{children:e.jsx(B,{type:"primary",htmlType:"submit",icon:e.jsx(rr,{}),children:"ì¶”ê°€"})})]}),e.jsx(ar,{header:e.jsx("div",{children:"í˜„ì¬ ê¶Œí•œì ëª©ë¡"}),bordered:!0,dataSource:n,renderItem:x=>e.jsx(ar.Item,{actions:[x.role!=="admin"?e.jsx(Kt,{title:`${x.user_email} ì‚¬ìš©ìì˜ ê¶Œí•œì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,onConfirm:()=>h(x.user_id),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{type:"text",danger:!0,icon:e.jsx(gs,{})})},`remove-${x.user_id}`):[]],children:e.jsx(ar.Item.Meta,{avatar:e.jsx(Vp,{icon:e.jsx(Un,{})}),title:x.user_email,description:e.jsx(T,{color:x.role==="admin"?"blue":"green",children:x.role==="admin"?"ê´€ë¦¬ì":"ê¶Œí•œì"})})})})]})})},{Text:Mv}=we,{TabPane:Lv}=xs,sj=async()=>{var s;try{const t=await ze.kubernetes.request("getInfras",{});return(s=t==null?void 0:t.data)!=null&&s.success?t.data.data||[]:[]}catch(t){return O.error("Failed to fetch infras:",t),[]}},rj=async s=>{var t;try{const r=await ze.kubernetes.request("createInfra",s);if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì¸í”„ë¼ ìƒì„± ì‹¤íŒ¨:",r),r}},nj=async s=>{var t;try{const r=await ze.kubernetes.request("deleteInfra",{id:s});if(!r.data||!r.data.success)throw new Error(((t=r.data)==null?void 0:t.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return r.data.data}catch(r){throw O.error("ì¸í”„ë¼ ì‚­ì œ ì‹¤íŒ¨:",r),r}},aj=async(s,t,r)=>{var n;try{const a=await ze.kubernetes.request("importKubernetesInfra",{device_id:s,user_id:t,...r});if(!a.data||!a.data.success)throw new Error(((n=a.data)==null?void 0:n.error)||"ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");return a.data}catch(a){throw O.error("Kubernetes ì¸í”„ë¼ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:",a),a}},qg=()=>{const[s,t]=o.useState([]),[r,n]=o.useState(!0),[a,i]=o.useState(!1),[l,d]=f.useMessage(),c=o.useCallback(async()=>{try{n(!0);const S=await sj();t(S||[])}catch(S){O.error("Infrastructure data fetch failed:",S),l.error("ì¸í”„ë¼ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),t([])}finally{n(!1)}},[l]),p=o.useCallback(async()=>{i(!0),await c(),i(!1),l.success("ì¸í”„ë¼ ë°ì´í„°ê°€ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤.")},[c,l]),h=o.useCallback(async S=>{try{return await rj(S),l.success("ì¸í”„ë¼ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."),await c(),!0}catch(L){return O.error("Infrastructure creation failed:",L),l.error("ì¸í”„ë¼ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),!1}},[c,l]),x=o.useCallback(async(S,L,k)=>{try{let E;if(L.type==="kubernetes"||L.type==="external_kubernetes")E=await aj(S,k,{name:L.name,type:L.type,info:L.info,hops:L.hops});else if(L.type==="docker"||L.type==="external_docker"||L.type==="podman"||L.type==="external_podman")E=await Cg(S,k,{name:L.name,type:L.type,info:L.info,hops:L.hops});else throw new Error("Unsupported infrastructure type");if(E&&"success"in E&&E.success)return l.success("ì™¸ë¶€ ëŸ°íƒ€ì„ì„ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤."),"registered_services"in E&&E.registered_services&&Array.isArray(E.registered_services)&&E.registered_services.length>0&&l.info(`${E.registered_services.length}ê°œì˜ ì„œë¹„ìŠ¤ê°€ ìë™ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`),await c(),!0;throw new Error(E&&"message"in E&&E.message||"Import failed")}catch(E){return O.error("Infrastructure import failed:",E),l.error(E instanceof Error?E.message:"ì™¸ë¶€ í™˜ê²½ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),!1}},[c,l]),_=o.useCallback(async S=>{try{return await nj(S),l.success("ì¸í”„ë¼ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),await c(),!0}catch(L){return O.error("Infrastructure deletion failed:",L),l.error("ì¸í”„ë¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),!1}},[c,l]);return{infraData:s,loading:r,refreshing:a,fetchInfraData:c,refreshInfraData:p,createInfrastructure:h,importInfrastructure:x,deleteInfrastructure:_,contextHolder:d}},ij=s=>{if(!s)return"";const t=s.startsWith("external_")?s.substring(9):s;switch(t.toLowerCase()){case"kubernetes":return"Kubernetes";case"docker":return"Docker";case"podman":return"Podman";case"baremetal":return"Baremetal";case"cloud":return"Cloud";default:return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}},oj=({onShowSettings:s,onShowPermissions:t,onDeleteInfra:r})=>[{title:"ì¸í”„ë¼ ì´ë¦„",dataIndex:"name",key:"name",render:(n,a)=>{var i;return e.jsxs(g,{children:[(i=a.type)!=null&&i.includes("external")?e.jsx(ur,{style:{color:"#1890ff"}}):e.jsx(_s,{style:{color:"#52c41a"}}),e.jsx("span",{style:{fontWeight:"bold"},children:n})]})}},{title:"ìœ í˜•",dataIndex:"type",key:"type",render:n=>e.jsx(T,{color:n!=null&&n.includes("kubernetes")?"blue":"green",children:ij(n)})},{title:"ì •ë³´",dataIndex:"info",key:"info",render:n=>e.jsx(Ie,{title:n,placement:"topLeft",children:e.jsx("div",{style:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n})})},{title:"ì—­í• ",dataIndex:"user_role",key:"user_role",align:"center",render:n=>{if(!n)return e.jsx(T,{children:"Unknown"});const a=n.charAt(0).toUpperCase()+n.slice(1),i=n==="admin"?"volcano":"green";return e.jsx(T,{color:i,children:a})}},{title:"ìƒì„±ì¼",dataIndex:"created_at",key:"created_at",align:"center",render:n=>n?new Date(n).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}):"-"},{title:"ì‘ì—…",key:"actions",render:(n,a)=>e.jsxs(g,{size:"small",children:[e.jsx(Ie,{title:"ì¸í”„ë¼ ì„¤ì •",children:e.jsx(B,{type:"text",icon:e.jsx(rn,{}),onClick:()=>s(a)})}),e.jsx(Ie,{title:"ê¶Œí•œ ê´€ë¦¬",children:e.jsx(B,{type:"text",icon:e.jsx(du,{}),onClick:()=>t(a)})}),e.jsx(Ie,{title:"ì¸í”„ë¼ ì‚­ì œ",children:e.jsx(B,{type:"text",danger:!0,icon:e.jsx(gs,{}),onClick:()=>{rt.confirm({title:"ì¸í”„ë¼ ì‚­ì œ",content:`"${a.name}" ì¸í”„ë¼ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,okText:"ì‚­ì œ",okType:"danger",cancelText:"ì·¨ì†Œ",onOk:()=>r(a.id)})}})})]})}],{Title:lj}=we,cj=()=>{al();const{infraData:s,loading:t,refreshing:r,fetchInfraData:n,refreshInfraData:a,deleteInfrastructure:i,contextHolder:l}=qg(),[d,c]=o.useState(!1),[p,h]=o.useState(!1),[x,_]=o.useState(null),[S,L]=o.useState(null);o.useEffect(()=>{n()},[n]);const I=oj({onShowSettings:$=>{_($),c(!0)},onShowPermissions:$=>{L($),h(!0)},onDeleteInfra:async $=>{await i($)}});return e.jsxs("div",{className:"infra-manage management-page",children:[l,e.jsxs(ie,{children:[e.jsxs("div",{className:"infra-manage-header",children:[e.jsx("div",{className:"header-left",children:e.jsxs(g,{align:"center",children:[e.jsx(_t,{style:{fontSize:24,color:"#1890ff"}}),e.jsx(lj,{level:3,style:{margin:0},children:"ì¸í”„ë¼ ê´€ë¦¬"})]})}),e.jsx("div",{className:"header-right",children:e.jsx(g,{children:e.jsx(B,{icon:e.jsx(zs,{}),onClick:a,loading:r,children:"ìƒˆë¡œê³ ì¹¨"})})})]}),e.jsx(gt,{spinning:t,children:s.length>0?e.jsx(wt,{dataSource:s,columns:I,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:($,y)=>`${y[0]}-${y[1]} / ${$}ê°œ í•­ëª©`},className:"infra-table"}):!t&&e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ë“±ë¡ëœ ì¸í”„ë¼ê°€ ì—†ìŠµë‹ˆë‹¤",style:{margin:"40px 0"}})})]}),x&&e.jsx(Sg,{visible:d,infraItem:{...x,nodes:[]},onCancel:()=>{c(!1),_(null)},onSave:()=>{n(),c(!1),_(null)}}),S&&e.jsx(tj,{visible:p,infra:S,onClose:()=>{h(!1),L(null)}})]})},dj=({infraData:s,selectedInfra:t,onInfraSelect:r,onRefresh:n,onStatusUpdate:a,setInfraData:i})=>{const[l,d]=o.useState(!1),[c,p]=o.useState(!1),[h,x]=o.useState([]);//! ëª¨ë‹¬ì— ì „ë‹¬í•  Hop ì •ë³´
const[_,S]=o.useState(null),[L,k]=o.useState(!1),[E,P]=o.useState(null),[I,$]=o.useState(!1),[y,v]=o.useState(!1),[u,m]=o.useState(!1),{user:j}=Tn(),b=Gs(),A=o.useCallback((F,X)=>{const de=F.trim().toLowerCase(),Ne=X||22;return b.serverlist.find(ae=>ae.host.trim().toLowerCase()===de&&(ae.port||22)===Ne)},[b.serverlist]),W=o.useCallback(F=>F.map(X=>{const de=A(X.host,X.port);return{...X,username:(de==null?void 0:de.userId)||X.username||"",password:(de==null?void 0:de.password)||""}}),[A]),Z=o.useCallback(F=>{if(F.length===0)return null;const X=F.filter(de=>{const Ne=typeof de.type=="string"?de.type.toLowerCase():"";return Ne.includes("master")||Ne.includes("control-plane")||Ne.includes("control_plane")});return X.length>0?X[0]:F[0]},[]),se=F=>{},ce=async F=>{var X,de;if($(!0),k(!0),r(F.id),F.type==="docker"||F.type==="podman"){if(F.nodes.length===0){$(!1);return}const Ne=W(JSON.parse(F.nodes[0].hops)),pe=(await Ns.runPlaybook({playbook_to_run:`status_${F.type}`,hops:Ne,awxTemplate:j==null?void 0:j.awx_template})).data.awx_job_result.details;let Xe;pe.version==="ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ"?Xe="uninstalled":pe.socket_status==="í™œì„±"&&pe.info_status==="ì •ìƒ"?Xe="active":pe.socket_status==="ë¹„í™œì„±"||pe.info_status==="ë¹„ì •ìƒ"?Xe="inactive":Xe="unknown";const Nt=pe.all_containers.slice(1)||[],Fe=pe.images.slice(1)||[],Le=pe.volumes||[],Oe=pe.networks||[],Mt=Me=>{const ot=Me.toLowerCase();return ot.startsWith("up")?"running":ot.startsWith("exited")?"exited":ot.includes("paused")?"paused":"stopped"},Ve={container_count:Nt.length,containers:Nt.map(Me=>{const ot=Me.trim().split(/\s{2,}/);return{id:ot[0]+"",name:ot[ot.length-1]||"",image:ot[1]||"",status:Mt(ot[4]||""),created:ot[3]||"",command:ot[2]||"",ports:ot[5]?[ot[5]]:[]}}),collection_time:pe.collection_time,images:Fe.map(Me=>{const ot=Me.trim().split(/\s{2,}/);return{id:ot[2]||"",repository:ot[0]||"",tag:ot[1]||"",size:ot[4]||"0B",created:ot[3]||""}}),image_count:Fe.length,version:pe.version,status:Xe,volumes:Le.flatMap(Me=>!Me.containers||Me.containers.length===0?[{name:Me.volume_name,usedBy:"-",mountpoint:"-",rowSpan:1}]:Me.containers.map((ot,Bt)=>({name:Me.volume_name,usedBy:ot.name,mountpoint:ot.mountpoint,rowSpan:Bt===0?Me.containers.length:0}))),networks:Oe.map(Me=>({name:Me.name,subnet:Me.subnet,gateway:Me.gateway,container_count:Me.container_count}))};P(Ve)}else{const Ne=Z(F.nodes);if(!Ne){console.error("ë§ˆìŠ¤í„°/ì»¨íŠ¸ë¡¤í”Œë ˆì¸ ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),P(null),$(!1);return}try{const ae=W(JSON.parse(Ne.hops)),pe=await Ns.runPlaybook({playbook_to_run:"status_kubernetes2",hops:ae,awxTemplate:j==null?void 0:j.awx_template}),Xe=(de=(X=pe.data)==null?void 0:X.awx_job_result)==null?void 0:de.details;if(!Xe){console.error("AWX playbook ì‘ë‹µì— detailsê°€ ì—†ìŠµë‹ˆë‹¤:",pe),f.error("ëŸ°íƒ€ì„ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. SSH ì—°ê²° ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."),P(null),$(!1);return}const Nt=["kube-system","kube-public","kube-node-lease"],Fe={namespace:Xe.namespace||[],pods:(Xe.pods||[]).filter(Le=>!Nt.includes(Le.namespace)),network_svc:(Xe.network_svc||[]).filter(Le=>!Nt.includes(Le.namespace)),volumes_pvc:(Xe.volumes_pvc||[]).filter(Le=>!Nt.includes(Le.namespace))};P(Fe)}catch(ae){console.error("ì¿ ë²„ë„¤í‹°ìŠ¤ ëŸ°íƒ€ì„ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:",ae),f.error("ëŸ°íƒ€ì„ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. SSH ì—°ê²° ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."),P(null)}}$(!1)},D=async(F,X,de)=>{if(F.stopPropagation(),X==="edit"){await te();return}if(X==="delete"){await J(de);return}if(r(de.id),de.type==="docker"||de.type==="podman"){const Ne=JSON.parse(de.nodes[0].hops),ae=W(Ne),pe={server_id:de.nodes[0].id,infraId:de.id,action:X,runtimeType:de.type,playbook_to_run:`${X}_${de.type}`,hops:ae,awxTemplate:j==null?void 0:j.awx_template};S(pe),M(pe)}else(de.type==="kubernetes"||de.type==="external_kubernetes")&&f.info("ë¯¸êµ¬í˜„")},M=async F=>{if((await Ns.runPlaybook(F)).data.status==="failed")f.error(`${F.runtimeType} ${F.action}ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ‘ì† ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`),x(F.hops),p(!0),d(!0);else{f.success(`${F.runtimeType}ì´ ì„±ê³µì ìœ¼ë¡œ ${F.action}ë˜ì—ˆìŠµë‹ˆë‹¤.`);const de=F.action==="restart"?"active":"inactive";await Ff(Number(F.server_id),de),n(),a(F.server_id,de),S(null)}},K=()=>{k(!1),P(null)},J=async F=>{try{await dh(F.id),i(s.filter(X=>X.id!==F.id)),f.success("ëŸ°íƒ€ì„ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");//! ì¶”í›„ ê¸°ëŠ¥ ë¶„ë¦¬ë¥¼ ìœ„í•´ ì„ì‹œ ì£¼ì„ ì²˜ë¦¬
}catch(X){console.error(X)}},te=async F=>{},G=F=>JSON.parse(F).map(Ne=>`${Ne.host}:${Ne.port}`).join(" â†’ "),q=F=>({kubernetes:e.jsx(Cn,{style:{color:"#1890ff"}}),podman:e.jsx(_t,{style:{color:"#59ad30ff"}}),docker:e.jsx(Qr,{style:{color:"#722ed1"}}),cloud:e.jsx(Dp,{style:{color:"#fa8c16"}})})[F]||e.jsx(il,{}),oe=F=>({active:"green",inactive:"orange",uninstalled:"red",unknown:"gray"})[F]||"default",be=F=>({active:"í™œì„±",inactive:"ë¹„í™œì„±",uninstalled:"ë¯¸ì„¤ì¹˜",unknown:"ì•Œ ìˆ˜ ì—†ìŒ"})[F]||"ì•Œ ìˆ˜ ì—†ìŒ",ne=async F=>{m(!0),f.info(`${F.server_type} ì„¤ì¹˜ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.`);const X=W(F.hops);await Ns.runPlaybook({playbook_to_run:`install_${F.server_type}`,hops:X,awxTemplate:j==null?void 0:j.awx_template});const de=F.hops.map(ae=>({host:ae.host,port:ae.port,username:ae.username})),Ne={name:t.name,hops:de,type:F.server_type,infra_id:t.id,device_id:F.device_id};await ac(Ne),f.success(`${F.server_type} ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`),n(),m(!1)},ye=F=>[{key:"view",icon:e.jsx(xa,{}),label:"ìƒì„¸ë³´ê¸°",onClick:()=>void ce(F)},{type:"divider"},{key:"restart",icon:e.jsx(zs,{}),label:"ì¬ì‹œì‘",onClick:X=>{X.domEvent.stopPropagation(),D(X.domEvent,"restart",F)}},{key:"stop",icon:e.jsx(vm,{}),label:"ì¤‘ì§€",danger:!0,onClick:X=>{X.domEvent.stopPropagation(),D(X.domEvent,"stop",F)}},{type:"divider"},{key:"edit",icon:e.jsx(ln,{}),label:"í¸ì§‘",onClick:X=>{X.domEvent.stopPropagation(),D(X.domEvent,"edit",F)}}],Ue=e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx("span",{children:"ëŸ°íƒ€ì„ í™˜ê²½ ëª©ë¡"}),e.jsxs(T,{color:"blue",children:[s.length,"ê°œ"]})]}),[N,ge]=o.useState(!1),[Ce,je]=o.useState(!1),[Pe,w]=o.useState(null);o.useEffect(()=>{var F;(t==null?void 0:t.type)==="podman"&&((F=E==null?void 0:E.containers)==null?void 0:F.length)===0?ge(!0):ge(!1)},[E,t]);const R=async()=>{const F=W(JSON.parse(t.nodes[0].hops)),X=F[F.length-1],de=await Uf(Pe);W(JSON.parse(de.hops));try{const Ne={infra_id:Pe,type:"worker",name:t.nodes[0].server_name,status:"ë“±ë¡",ip:X.host,port:X.port,hops:JSON.parse(t.nodes[0].hops),device_id:t.nodes[0].device_id};await ac(Ne),await dh(t.id),n()}catch(Ne){console.error(Ne)}finally{je(!1)}},U=e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:"20px"},children:[e.jsx("span",{children:t==null?void 0:t.name}),N&&e.jsx(B,{type:"primary",size:"small",onClick:()=>je(!0),children:"ì¿ ë²„ë„¤í‹°ìŠ¤ ì›Œì»¤ë¡œ ì „í™˜"})]}),V=F=>{w(F)};return e.jsxs(e.Fragment,{children:[e.jsx(ie,{title:Ue,className:"runtime-list-card",children:e.jsx("div",{className:"runtime-list-container",children:s.length===0?e.jsx(Je,{description:"ë“±ë¡ëœ ëŸ°íƒ€ì„ í™˜ê²½ì´ ì—†ìŠµë‹ˆë‹¤."}):s.map(F=>e.jsxs("div",{role:"button",tabIndex:0,className:`runtime-item ${(t==null?void 0:t.id)===F.id?"selected":""}`,onClick:()=>void ce(F),onKeyDown:X=>{(X.key==="Enter"||X.key===" ")&&ce(F)},children:[e.jsxs("div",{className:"runtime-item-main",children:[e.jsx("div",{className:"runtime-item-icon",children:q(F.type)}),e.jsxs("div",{className:"runtime-item-content",children:[e.jsxs("div",{className:"runtime-item-header",children:[e.jsx("span",{className:"runtime-item-name",children:F.name}),e.jsx(T,{color:"geekblue",className:"runtime-type-tag",children:F.type}),e.jsx(T,{color:oe(F.status),className:"runtime-status-tag",children:be(F.status)})]}),e.jsx("div",{className:"runtime-item-description",children:F.info||"ì„¤ëª… ì—†ìŒ"}),e.jsx("div",{className:"runtime-item-meta",children:F.type==="kubernetes"||F.type==="external_kubernetes"?e.jsxs("span",{className:"runtime-meta-info",children:[e.jsx(Cn,{})," ì´ ",F.nodes.length,"ë…¸ë“œ (Master"," ",F.nodes.filter(X=>X.type.includes("master")).length,", Worker"," ",F.nodes.filter(X=>X.type.includes("worker")).length,")"]}):F.nodes.length>0?e.jsxs("span",{className:"runtime-meta-info",children:[e.jsx(ur,{})," ",G(F.nodes[0].hops)]}):e.jsx(B,{size:"small",type:"link",disabled:u,onClick:X=>{X.stopPropagation(),r(F.id),v(!0)},children:"+ ì„œë²„ ì¶”ê°€"})})]})]}),e.jsxs("div",{className:"runtime-item-actions",children:[e.jsx(uu,{menu:{items:ye(F)},trigger:["click"],placement:"bottomRight",children:e.jsx(B,{type:"text",icon:e.jsx(qp,{}),onClick:X=>X.stopPropagation(),className:"action-menu-btn"})}),e.jsx(Ie,{title:"ì‚­ì œ",children:e.jsx(Kt,{title:"ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:"ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",onConfirm:X=>void D(X,"delete",F),okText:"ì˜ˆ",cancelText:"ì•„ë‹ˆì˜¤",onCancel:X=>X==null?void 0:X.stopPropagation(),icon:e.jsx(xc,{style:{color:"red"}}),children:e.jsx(B,{type:"text",danger:!0,icon:e.jsx(gs,{}),onClick:X=>X.stopPropagation(),className:"action-delete-btn"})})})]})]},F.id))})}),e.jsx(rt,{title:U,width:"80%",style:{maxWidth:1200},open:L,onCancel:K,footer:"",children:{docker:e.jsx(hh,{runtimeDetails:E,selectedInfra:t,onLoading:I,getStoredAuthHops:W,setRuntimeDetails:P}),external_docker:e.jsx(hh,{runtimeDetails:E,selectedInfra:t,onLoading:I,getStoredAuthHops:W,setRuntimeDetails:P}),podman:e.jsx(bh,{runtimeDetails:E,selectedInfra:t,onLoading:I,getStoredAuthHops:W,setRuntimeDetails:P}),external_podman:e.jsx(bh,{runtimeDetails:E,selectedInfra:t,onLoading:I,getStoredAuthHops:W,setRuntimeDetails:P}),kubernetes:e.jsx(jh,{runtimeDetails:E,selectedInfra:t,onLoading:I,getStoredAuthHops:W}),external_kubernetes:e.jsx(jh,{runtimeDetails:E,selectedInfra:t,onLoading:I,getStoredAuthHops:W})}[t==null?void 0:t.type]}),e.jsx(Hi,{visible:l,onClose:()=>{d(!1),p(!1),S(null)},onComplete:se,hops:h.map(F=>({...F,username:F.username||""})),infraId:_==null?void 0:_.infraId,isRetry:c}),e.jsx(vg,{titleInput:"ì„œë²„ ì¶”ê°€",visible:y,onCancel:()=>v(!1),onAdd:ne,loading:!1,server_type:t==null?void 0:t.type}),e.jsxs(rt,{title:"k8s í™˜ê²½ ì„ íƒ",open:Ce,onCancel:()=>je(!1),onOk:R,okText:"ì „í™˜",cancelText:"ì·¨ì†Œ",children:[e.jsx("div",{style:{marginBottom:"8px"},children:"ëŒ€ìƒ í™˜ê²½ì„ ì„ íƒí•´ì£¼ì„¸ìš”:"}),e.jsx(Ee,{style:{width:"100%"},placeholder:"Kubernetes í™˜ê²½ ì„ íƒ",onChange:V,value:Pe,children:s.filter(F=>F.type==="kubernetes").map(F=>e.jsxs(Ee.Option,{value:F.id,children:[F.name," (ID: ",F.id,")"]},F.id))}),s.filter(F=>F.type==="kubernetes").length===0&&e.jsx("p",{style:{color:"red",marginTop:"10px"},children:"ì„ íƒ ê°€ëŠ¥í•œ Kubernetes í™˜ê²½ì´ ì—†ìŠµë‹ˆë‹¤."})]})]})},_h=()=>{const[s,t]=o.useState([]),[r,n]=o.useState(!0),[a,i]=o.useState(null),[l,d]=o.useState(!1),[c,p]=o.useState(null),[h,x]=f.useMessage(),{infraId:_}=nu(),{user:S}=Tn(),[L,k]=o.useState(!1),[E,P]=o.useState(!1),{createInfrastructure:I,importInfrastructure:$}=qg(),y=o.useCallback(async()=>{n(!0);try{const oe=await Bf()||[],be=await Promise.all(oe.map(async ye=>{try{const Ue=await Yl(ye.id),N=await $f(ye.id);return{...ye,nodes:Ue,status:N}}catch(Ue){return O.error(`ì¸í”„ë¼ ID ${ye.id} ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨`,Ue),{...ye,status:"unknown"}}})),ne=await Promise.all(be.map(async ye=>{if(ye.type==="kubernetes"||ye.type==="external_kubernetes")try{const N=await Yl(ye.id)||[];let ge=!1,Ce=!1,je=!1;const Pe=N.map(w=>(w.type.includes("external_kubernetes")&&(je=!0),w.type.includes("master")&&(ge=!0),w.type.includes("worker")&&(Ce=!0),{...w,id:String(w.id),nodeType:w.node_type}));return{...ye,nodes:Pe,status:ge&&Ce||je?ye.status:"uninstalled"}}catch(Ue){return O.error(`ì¸í”„ë¼ ID ${ye.id} ì„œë²„ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:`,Ue),{...ye,nodes:[]}}return ye}));t(ne)}catch(q){O.error("ì¸í”„ë¼ ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨",q),h.error("ì¸í”„ë¼ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{n(!1)}},[h]),v=(q,oe)=>{t(be=>be.map(ne=>ne.id===q?{...ne,status:oe}:ne))},u=async()=>{await y(),h.success("ë°ì´í„°ê°€ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤.")},m=(q,oe)=>{const be=Gs.getState(),ne=q.trim().toLowerCase(),ye=oe||22;return be.serverlist.find(Ue=>Ue.host.trim().toLowerCase()===ne&&(Ue.port||22)===ye)},j=q=>q.map(oe=>{const be=m(oe.host,oe.port);return{...oe,username:(be==null?void 0:be.userId)||"",password:(be==null?void 0:be.password)||""}}),b=async q=>{i(q);const oe=s.find(be=>be.id===q);if(oe&&(oe.nodes=await Yl(oe.id),oe.nodes&&oe.nodes.length>0))for(const be of oe.nodes)try{const ne=JSON.parse(be.hops||"[]");if(ne.length>0){const Ue=j(ne).every(N=>N.username&&N.password)}}catch(ne){console.error(ne)}p(oe||null)},A=q=>{p(q),d(!0)},W=()=>{d(!1)},Z=async q=>{try{await Df(q.id,q),h.success("ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."),d(!1),p(q),await y()}catch(oe){O.error("ì„¤ì • ì €ì¥ ì‹¤íŒ¨",oe),h.error("ì„¤ì • ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},se=()=>{k(!0)},ce=()=>{P(!0)},D=async q=>{try{let oe=!1;if(q.type==="backup")q.user_id=(S==null?void 0:S.id)+""||"",oe=(await ze.backup.addInfraBackupLine(q)).data.success;else{const be={name:q.name,type:q.type,info:q.info||""};oe=await I(be)}return oe&&(k(!1),await y()),oe}catch(oe){return O.error("ì¸í”„ë¼ ì¶”ê°€ ì‹¤íŒ¨",oe),!1}},M=async q=>{try{let oe=q.type;if(q.type==="external_docker"&&(oe="docker"),q.type==="external_podman"&&(oe="podman"),(await ze.infra.validationImportData(q.name,oe,q.hops,S==null?void 0:S.id)).data.success)f.success("ë°ì´í„° ê²€ì¦ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤.");else{f.error("ë°ì´í„° ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì…ë ¥ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");return}if(q.type==="external_kubernetes"){const ye=(await Wf({hops:q.hops.map(N=>({host:N.host||"",port:N.port||22,username:N.username||"",password:N.password||""}))})).data.list,Ue=await Of({name:q.name,type:q.type,info:q.info});try{for(const N of ye){const ge=await Ra.checkExistingDevice(N.name,N.ip,S==null?void 0:S.id);if(ge.data){const Ce=await Ns.addHost(N.ip,S.awx_inventory,S.awx_template);await Ra.updateDeviceAWXHostId(ge.data.id,Ce.data.id)}await ty(N,Ue.id,ge.data.id)}return P(!1),await y(),!0}catch(N){console.error(N)}}else{const ne=await Ra.checkExistingDevice(q.name,q.hops,S==null?void 0:S.id);if(ne.data){const N=await Ns.addHost(q.hops,S.awx_inventory,S.awx_template);await Ra.updateDeviceAWXHostId(ne.data.id,N.data.id)}const ye=ne.data.id,Ue=await $(ye,q,S==null?void 0:S.id);return Ue&&(P(!1),await y()),Ue}}catch(oe){return O.error("ì™¸ë¶€ ëŸ°íƒ€ì„ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨",oe),!1}};if(o.useEffect(()=>{y()},[y]),o.useEffect(()=>{if(_&&s.length>0){const q=parseInt(_),oe=s.find(be=>be.id===q);oe&&(i(q),p(oe))}},[_,s]),o.useEffect(()=>{},[a]),r)return e.jsxs("div",{style:{textAlign:"center",padding:"50px"},children:[e.jsx(gt,{size:"large"}),e.jsx("div",{style:{marginTop:"16px"},children:"ì¸í”„ë¼ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]});const K=s.filter(q=>q.status==="active").length,J=s.filter(q=>q.type==="kubernetes"||q.type==="external_kubernetes").length,te=s.filter(q=>q.type==="docker"||q.type==="external_docker").length,G=s.filter(q=>q.type==="podman"||q.type==="external_podman").length;return e.jsxs("div",{className:"infra-settings management-page",children:[x,e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"page-header-title",children:[e.jsx(_t,{style:{fontSize:28,color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx("h1",{children:"ëŸ°íƒ€ì„ í™˜ê²½"}),e.jsx("p",{className:"page-header-description",children:"Kubernetes, Docker, Podman ì¸í”„ë¼ë¥¼ ê´€ë¦¬í•˜ê³  ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤"})]})]}),e.jsxs("div",{className:"page-header-actions",children:[e.jsx(B,{icon:e.jsx(zs,{}),onClick:u,loading:r,children:"ìƒˆë¡œê³ ì¹¨"}),e.jsx(B,{icon:e.jsx(rr,{}),onClick:se,children:"ëŸ°íƒ€ì„ ì¶”ê°€"}),e.jsx(B,{type:"primary",icon:e.jsx(_t,{}),onClick:ce,children:"ì™¸ë¶€ ëŸ°íƒ€ì„ ê°€ì ¸ì˜¤ê¸°"})]})]}),e.jsxs(Ke,{gutter:16,className:"stats-row",children:[e.jsx(Y,{xs:24,sm:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon blue",children:e.jsx(_t,{})}),e.jsx($e,{title:"ì „ì²´ ëŸ°íƒ€ì„",value:s.length,suffix:"ê°œ"})]})})}),e.jsx(Y,{xs:24,sm:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon green",children:e.jsx(Ze,{})}),e.jsx($e,{title:"í™œì„± ëŸ°íƒ€ì„",value:K,suffix:`/ ${s.length}`})]})})}),e.jsx(Y,{xs:24,sm:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon purple",children:e.jsx(Cn,{})}),e.jsx($e,{title:"Kubernetes",value:J,suffix:"ê°œ"})]})})}),e.jsx(Y,{xs:24,sm:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon cyan",children:e.jsx(Qr,{})}),e.jsx($e,{title:"Docker / Podman",value:te+G,suffix:"ê°œ"})]})})})]}),e.jsx("div",{className:"main-card",children:e.jsx(ie,{bordered:!1,children:e.jsx(dj,{infraData:s,selectedInfra:c,onInfraSelect:b,onShowSettings:A,onRefresh:u,onStatusUpdate:v,setInfraData:t})})}),e.jsx(Ef,{visible:L,onCancel:()=>k(!1),onSubmit:D}),e.jsx(Mf,{visible:E,onCancel:()=>P(!1),onSubmit:M}),c&&e.jsx(Sg,{visible:l,infraItem:c,onCancel:W,onSave:Z})]})},uj=()=>{var q,oe,be,ne,ye,Ue,N,ge,Ce,je,Pe,w,R,U,V,F,X,de,Ne,ae,pe,Xe,Nt;const[s,t]=o.useState([]),[r,n]=o.useState(!1),[a,i]=o.useState(!1),[l,d]=o.useState(!1),[c,p]=o.useState(!1),[h,x]=o.useState(null),[_,S]=o.useState(null),[L,k]=o.useState(!1),[E,P]=o.useState(null),[I]=H.useForm(),{user:$}=Tn(),y=o.useRef(null),v=o.useCallback(async()=>{n(!0);try{const Fe=await Ra.getDevices($.id);t(Fe.data)}catch(Fe){console.error(Fe),f.error("ì¥ë¹„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),t([])}finally{n(!1)}},[$.id]),u=async Fe=>{p(!0);try{f.info(`ì¥ë¹„: ${Fe.ipAddress}ì˜ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...`);const Oe=(await Ns.runPlaybook({playbook_to_run:"get_serverInfo",hops:[{host:Fe.ipAddress,port:22,username:"",password:""}],awxTemplate:($==null?void 0:$.awx_template)||0})).data.awx_job_result.hosts_data;Fe.os=Oe[0].server_details.os.name,Fe.cpu=parseFloat(Oe[0].server_details.cpu.usage_percent.replace("%","")),Fe.memory=parseFloat(Oe[0].server_details.memory.used_percent.replace("%","")),Fe.disk=parseFloat(Oe[0].server_details.disks.used_percent.replace("%","")),Fe.runtime_cluster=Oe[0].server_details.runtime_cluster,x(Fe),f.info(`ì¥ë¹„: ${Fe.ipAddress}ì˜ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`)}catch(Le){console.error(Le),f.error("ì¥ë¹„ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}p(!1)},m=()=>{S(null),I.resetFields(),P(null),i(!0)},j=Fe=>{S(Fe),I.setFieldsValue(Fe);const Le=s.find(Oe=>Oe.id==Fe.parentId);Le&&(P(Le),I.setFieldsValue({parentDevice:{ipAddress:Le.ipAddress,port:Le.port}})),i(!0)},b=Fe=>{const Le=[];let Oe=Fe;for(;Oe&&(Le.push({host:Oe.ipAddress,port:Number(Oe.port)}),!!Oe.parentId);)Oe=s.find(Mt=>Mt.id===Oe.parentId);return Le.reverse()},A=async()=>{try{const Fe=await I.validateFields();if(_)Fe.id=_.id,await Ra.modDevice(Fe),t(s.map(Le=>Le.id===_.id?{...Le,...Fe}:Le)),f.success("ì¥ë¹„ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");else{const Le=b(Fe),Oe=await Ns.addHost(Le,$.awx_inventory,$.awx_template),Mt={...Fe,organization_id:$.organization_id,awxHostId:Number(Oe.data.id)},Ve=await Ra.addDevice(Mt);Mt.id=Ve.data.id,Mt.name=Ve.data.name,t([...s||[],Mt]),f.success("ìƒˆ ì¥ë¹„ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.")}i(!1)}catch(Fe){console.error(Fe)}},W=Fe=>{rt.confirm({title:"ì¥ë¹„ ì‚­ì œ",content:"ì •ë§ë¡œ ì´ ì¥ë¹„ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",onOk:async()=>{const Le=s.find(Oe=>Oe.id===Fe).awxHostId;Le!==0&&await Ns.removeHost(Le),await Ra.delDevice(Fe),t(s.filter(Oe=>Oe.id!==Fe)),f.success("ì¥ë¹„ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")}})},Z=Fe=>{if(Fe===0){P(null),I.setFieldsValue({parentId:null,parentDevice:void 0});return}const Le=s.find(Oe=>Oe.id==Fe);P(Le),I.setFieldsValue({parentId:Le.id,parentDevice:{ipAddress:Le.ipAddress,port:Le.port}})},se=Fe=>{if(!Fe)return;const Le=new Map;Fe.forEach(Mt=>{Le.set(Mt.id,{...Mt,children:[]})});const Oe=[];return Le.forEach(Mt=>{var Ve;if(Mt.parentId){const Me=Le.get(Mt.parentId);Me&&((Ve=Me.children)==null||Ve.push(Mt))}else Oe.push(Mt)}),Oe},ce=Fe=>Fe.map(Le=>({title:`${Le.name} (${Le.ipAddress}:${Le.port})`,value:Le.id,key:Le.id,children:Le.children?ce(Le.children):[]})),D=Fe=>{y.current&&(Fe.preventDefault(),y.current.scrollLeft+=Fe.deltaY)};o.useEffect(()=>{v()},[v]);const M=[{title:"ì¥ë¹„ëª…",dataIndex:"name",key:"name",width:"25%",ellipsis:!0},{title:"IP ì£¼ì†Œ",dataIndex:"ipAddress",key:"ipAddress",width:"20%",ellipsis:!0,render:Fe=>e.jsx(g,{children:e.jsx(T,{children:Fe})})},{title:"ìœ„ì¹˜",dataIndex:"location",key:"location",width:"20%",ellipsis:!0},{title:"ì„¤ëª…",dataIndex:"description",key:"description",width:"25%",ellipsis:!0},{title:"ì‘ì—…",key:"actions",width:"10%",render:(Fe,Le)=>e.jsxs(g,{size:"small",children:[e.jsx(Ie,{title:"ìƒì„¸ë³´ê¸°",children:e.jsx(B,{type:"text",icon:e.jsx(xa,{}),size:"small",onClick:()=>{u(Le),d(!0)}})}),e.jsx(Ie,{title:"ìˆ˜ì •",children:e.jsx(B,{type:"text",icon:e.jsx(ln,{}),size:"small",onClick:()=>j(Le)})}),e.jsx(Ie,{title:"ì‚­ì œ",children:e.jsx(B,{type:"text",icon:e.jsx(gs,{}),size:"small",danger:!0,onClick:()=>W(Le.id)})})]})}],K=s.filter(Fe=>!Fe.parentId),J=new Set(s.filter(Fe=>Fe.parentId).map(Fe=>Fe.parentId)),te=K.filter(Fe=>J.has(Fe.id)).length,G=K.length-te;return e.jsxs("div",{className:"device-management management-page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"page-header-title",children:[e.jsx(km,{style:{fontSize:24,color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx("h1",{children:"ì¥ë¹„ ê´€ë¦¬"}),e.jsx("div",{className:"page-header-description",children:"ì„œë²„ ë° ì¥ë¹„ ëª©ë¡ì„ ê´€ë¦¬í•©ë‹ˆë‹¤"})]})]}),e.jsxs("div",{className:"page-header-actions",children:[e.jsx(B,{icon:e.jsx(zs,{}),onClick:v,loading:r,children:"ìƒˆë¡œê³ ì¹¨"}),e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:()=>m(),children:"ì¥ë¹„ ì¶”ê°€"})]})]}),e.jsxs(Ke,{gutter:16,className:"stats-row",children:[e.jsx(Y,{xs:24,sm:8,children:e.jsx("div",{className:"stat-card",children:e.jsxs(g,{align:"start",children:[e.jsx("div",{className:"stat-card-icon blue",children:e.jsx(_t,{})}),e.jsx($e,{title:"ì „ì²´ ì¥ë¹„",value:s.length,suffix:"ëŒ€"})]})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx("div",{className:"stat-card",children:e.jsxs(g,{align:"start",children:[e.jsx("div",{className:"stat-card-icon green",children:e.jsx(Cn,{})}),e.jsx($e,{title:"ì í”„ ì„œë²„",value:te,suffix:"ëŒ€"})]})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx("div",{className:"stat-card",children:e.jsxs(g,{align:"start",children:[e.jsx("div",{className:"stat-card-icon orange",children:e.jsx(il,{})}),e.jsx($e,{title:"ë‹¨ì¼ ì„œë²„",value:G,suffix:"ëŒ€"})]})})})]}),e.jsx(ie,{className:"main-card",title:e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx("span",{children:"ì¥ë¹„ ëª©ë¡"}),e.jsxs(T,{color:"blue",children:[s.length,"ëŒ€"]})]}),children:e.jsx(wt,{columns:M,dataSource:se(s),rowKey:(Fe,Le)=>Fe.id||`row-${Le}`,loading:r,expandable:{expandIcon:({expanded:Fe,onExpand:Le,record:Oe})=>!Oe.children||Oe.children.length===0?e.jsx("span",{style:{display:"inline-block",width:28}}):Fe?e.jsxs(g,{children:[e.jsx(Cm,{onClick:Mt=>Le(Oe,Mt),style:{color:"#1890ff",fontSize:16}}),"Â "]}):e.jsxs(g,{children:[e.jsx(yc,{onClick:Mt=>Le(Oe,Mt),style:{color:"#1890ff",fontSize:16}}),"Â "]})},pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(Fe,Le)=>`${Le[0]}-${Le[1]} / ${Fe}ê°œ ì¥ë¹„`}})}),e.jsx(rt,{title:_?"ì¥ë¹„ ì •ë³´ ìˆ˜ì •":"ìƒˆ ì¥ë¹„ ì¶”ê°€",open:a,onOk:A,onCancel:()=>{i(!1),I.resetFields()},okText:_?"ìˆ˜ì •":"ì¶”ê°€",cancelText:"ì·¨ì†Œ",width:600,children:e.jsxs(H,{form:I,layout:"vertical",children:[e.jsx(xt,{children:"ì¥ë¹„ ì •ë³´"}),e.jsx(Ke,{gutter:16,children:e.jsx(Y,{span:24,children:e.jsx(H.Item,{name:"parentId",label:"ìƒìœ„ ì¥ë¹„ ID",tooltip:"ì´ ì¥ë¹„ì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ìƒìœ„ ì¥ë¹„ë¥¼ ì„ íƒí•˜ì„¸ìš”. (ì—†ì„ ê²½ìš° ë¹ˆì¹¸ìœ¼ë¡œ ë‘ì„¸ìš”)",children:e.jsx(Up,{style:{width:"100%"},value:h==null?void 0:h.id,dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:"ìƒìœ„ ì¥ë¹„ ì„ íƒ",treeData:ce(se(s)),treeDefaultExpandAll:!1,onChange:Z,showSearch:!0,filterTreeNode:(Fe,Le)=>{const Oe=Le.title;return typeof Oe=="string"?Oe.toLowerCase().includes(Fe.toLowerCase()):!1}})})})}),E&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx(we.Text,{strong:!0,style:{display:"block",marginBottom:"12px"},children:"SSH ì—°ê²° ê²½ë¡œ:"}),e.jsx("div",{ref:y,onWheel:D,style:{padding:"16px",backgroundColor:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:"6px",display:"flex",alignItems:"center",overflowX:"auto",whiteSpace:"nowrap"},children:b(E).map((Fe,Le)=>e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#fff",border:"1px solid #d9d9d9",borderRadius:"6px",minWidth:"150px",marginBottom:"8px"},children:[e.jsx("div",{style:{marginBottom:"6px",fontWeight:"bold",fontSize:"13px"},children:`Hop ${Le+1}`}),e.jsxs("div",{style:{fontSize:"12px",color:"#333"},children:[Fe.host,": ",Fe.port]})]})},Le),e.jsx("span",{style:{margin:"0 12px",fontSize:"18px",color:"#52c41a",fontWeight:"bold"},children:"âœ"})]}))})]}),e.jsx(Ke,{gutter:16,children:e.jsx(Y,{span:24,children:e.jsx(H.Item,{name:"name",label:"ì¥ë¹„ëª…",tooltip:"ì¥ë¹„ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ ë³„ì¹­ì„ ì…ë ¥í•˜ì„¸ìš”.",rules:[{required:!0,message:"ì¥ë¹„ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì¥ë¹„ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"})})})}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"ipAddress",label:"IP ì£¼ì†Œ",rules:[{required:!0,message:"IP ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"192.168.1.100"})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"port",label:"í¬íŠ¸",rules:[{required:!0,message:"í¬íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(xn,{style:{width:"100%"},placeholder:"22"})})})]}),e.jsx(xt,{style:{cursor:"pointer",userSelect:"none",textAlign:"center"},children:e.jsx(g,{onClick:()=>k(!L),onKeyDown:Fe=>{(Fe.key==="Enter"||Fe.key===" ")&&(Fe.preventDefault(),k(!L))},role:"button",tabIndex:0,children:L?"ìˆ¨ê¸°ê¸° â–²":"ë”ë³´ê¸° â–¼"})}),L&&e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"location",label:"ìœ„ì¹˜",children:e.jsx(ue,{placeholder:"ì„œìš¸ ë³¸ì‚¬"})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"description",label:"ì„¤ëª…",children:e.jsx(ue,{placeholder:"ì¥ë¹„ì— ëŒ€í•œ ì„¤ëª…"})})})]})]})}),e.jsxs(rt,{title:h?`${h==null?void 0:h.name} (${h==null?void 0:h.ipAddress}) ì¥ë¹„ ì •ë³´`:"ì¥ë¹„ ì •ë³´ ë¡œë”© ì¤‘",open:l,onCancel:()=>{d(!1),x(null)},loading:c,footer:[],width:600,children:[e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:8,children:e.jsx(ie,{title:"cpu",children:e.jsx(qt,{percent:h==null?void 0:h.cpu,size:"small",showInfo:!0})})}),e.jsx(Y,{span:8,children:e.jsx(ie,{title:"memory",children:e.jsx(qt,{percent:h==null?void 0:h.memory,size:"small",showInfo:!0})})}),e.jsx(Y,{span:8,children:e.jsx(ie,{title:"disk",children:e.jsx(qt,{percent:h==null?void 0:h.disk,size:"small",showInfo:!0})})})]}),e.jsx(ie,{title:"ì„¤ì¹˜ëœ ëŸ°íƒ€ì„ ëª©ë¡",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[((oe=(q=h==null?void 0:h.runtime_cluster)==null?void 0:q.docker)==null?void 0:oe.installed)&&e.jsx("div",{children:e.jsxs(T,{color:(ne=(be=h==null?void 0:h.runtime_cluster)==null?void 0:be.docker)!=null&&ne.installed&&(Ue=(ye=h==null?void 0:h.runtime_cluster)==null?void 0:ye.docker)!=null&&Ue.running?"green":"default",icon:e.jsx(Im,{}),style:{marginRight:8},children:["Docker",(ge=(N=h==null?void 0:h.runtime_cluster)==null?void 0:N.docker)!=null&&ge.running?" (ì‹¤í–‰ ì¤‘)":" (ì¤‘ì§€)"]})}),((je=(Ce=h==null?void 0:h.runtime_cluster)==null?void 0:Ce.kubernetes)==null?void 0:je.node)!==!1&&e.jsx("div",{children:e.jsxs(T,{color:((w=(Pe=h==null?void 0:h.runtime_cluster)==null?void 0:Pe.kubernetes)==null?void 0:w.role.trim())!=="master"?"blue":"default",icon:e.jsx(Tm,{}),style:{marginRight:8},children:["Kubernetes",`(${((V=(U=(R=h==null?void 0:h.runtime_cluster)==null?void 0:R.kubernetes)==null?void 0:U.role)==null?void 0:V.trim())||"ì•Œ ìˆ˜ ì—†ìŒ"})`]})}),((X=(F=h==null?void 0:h.runtime_cluster)==null?void 0:F.podman)==null?void 0:X.installed)&&e.jsx("div",{children:e.jsxs(T,{color:(Ne=(de=h==null?void 0:h.runtime_cluster)==null?void 0:de.podman)!=null&&Ne.installed&&(pe=(ae=h==null?void 0:h.runtime_cluster)==null?void 0:ae.podman)!=null&&pe.running?"green":"default",icon:e.jsx(_t,{}),style:{marginRight:8},children:["Podman",(Nt=(Xe=h==null?void 0:h.runtime_cluster)==null?void 0:Xe.podman)!=null&&Nt.running?" (ì‹¤í–‰ ì¤‘)":" (ì¤‘ì§€)"]})})]})})]})]})},hj=({backups:s,restores:t})=>{const r=o.useCallback(p=>{switch(p){case"InProgress":case"Running":return{color:"processing",text:"ì§„í–‰ì¤‘"};case"Completed":return{color:"success",text:"ì™„ë£Œ"};case"Failed":return{color:"error",text:"ì‹¤íŒ¨"};case"PartiallyFailed":return{color:"warning",text:"ë¶€ë¶„ ì‹¤íŒ¨"};case"New":return{color:"default",text:"ëŒ€ê¸°"};default:return{color:"default",text:p}}},[]),n=o.useCallback(p=>{switch(p){case"InProgress":case"Running":return{color:"processing",text:"ë³µêµ¬ì¤‘"};case"Completed":return{color:"success",text:"ë³µêµ¬ì™„ë£Œ"};case"Failed":return{color:"error",text:"ë³µêµ¬ì‹¤íŒ¨"};case"PartiallyFailed":return{color:"warning",text:"ë¶€ë¶„ ë³µêµ¬"};case"New":return{color:"default",text:"ëŒ€ê¸°"};default:return{color:"default",text:p}}},[]),a=o.useMemo(()=>{const p=s.some(x=>x.status==="InProgress"||x.status==="Running"),h=t.some(x=>x.status==="InProgress"||x.status==="Running");return p||h},[s,t]),i=o.useCallback(()=>({description:""}),[]),l=o.useCallback(p=>{},[]),d=o.useCallback((p,h)=>{},[]),c=o.useCallback(()=>{},[]);return{pollingBackupId:null,pollingRestoreId:null,pollingJobId:null,jobStatus:null,isSetupPolling:!1,isBackupCreating:!1,creatingBackupName:null,backupProgress:null,hasOperationsInProgress:a,startJobPolling:l,startBackupCreatingPolling:d,stopBackupCreatingPolling:c,getBackupStatusDisplay:r,getRestoreStatusDisplay:n,getSetupProgress:i}},pj=({selectedInfraId:s,onBackupsUpdate:t,onRestoresUpdate:r,onInstallStatusUpdate:n,onMinioStoragesUpdate:a,onNamespacesUpdate:i})=>{var M;const[l,d]=Ct.useState(!1),[c,p]=Ct.useState([]),[h,x]=Ct.useState([]),[_,S]=Ct.useState(!1),L=Ct.useRef(null),k=Ct.useRef(!1),E=Ct.useRef(!1),P=Ct.useCallback(async()=>{var K,J;try{const G=(J=(K=(await ze.infra.list()).data)==null?void 0:K.data)!=null?J:[];p(G),x([])}catch(te){O.error("Failed to load infrastructures:",te instanceof Error?te:new Error(String(te))),f.error("ì¸í”„ë¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}},[]),I=Ct.useCallback(async K=>{var J,te;if(!k.current&&!(L.current===K&&h.length>0))try{k.current=!0;const q=(te=(J=(await ze.infra.listServers(K)).data)==null?void 0:J.data)!=null?te:[];x(q),L.current=K}catch(G){O.error(`Failed to load servers for infra ${K}:`,G),f.error("ì„œë²„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),x([])}finally{k.current=!1}},[]),$=Ct.useCallback(async K=>{var J,te;try{d(!0);const q=(te=(J=(await ze.backup.listBackups(K)).data)==null?void 0:J.data)!=null?te:[];t(q)}catch(G){O.error("Failed to load backups:",G instanceof Error?G:new Error(String(G))),f.error("ë°±ì—… ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),t([])}finally{d(!1)}},[t]),y=Ct.useCallback(async K=>{var J,te;try{const q=(te=(J=(await ze.backup.listRestores(K)).data)==null?void 0:J.data)!=null?te:[];r(q)}catch(G){O.error("Failed to load restores:",G instanceof Error?G:new Error(String(G))),f.error("ë³µêµ¬ ì´ë ¥ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),r([])}},[r]),v=Ct.useCallback(async K=>{var J,te;try{S(!0);const G=await ze.backup.getInstallationStatus(K);(te=(J=G.data)==null?void 0:J.data)!=null&&te.summary?n(G.data.data):(O.warn("Failed to get a valid backup status:",G),n(null))}catch(G){O.error("Failed to load backup status:",G instanceof Error?G:new Error(String(G))),n(null)}finally{S(!1)}},[n]),u=Ct.useCallback(async()=>{var K,J;try{const G=(J=(K=(await ze.backup.listAllMinioStorages()).data)==null?void 0:K.data)!=null?J:[];a(G)}catch(te){O.error("Failed to load MinIO storages:",te instanceof Error?te:new Error(String(te)))}},[a]),m=Ct.useCallback(async K=>{try{const J=h.find(G=>{if(G.infra_id!==K)return!1;const q=G.type;return q==="master"||typeof q=="string"&&q.includes("master")});if(!(J!=null&&J.hops))return[];const te=typeof J.hops=="string"?JSON.parse(J.hops):J.hops;return Array.isArray(te)?te:[te]}catch(J){return O.error("Failed to get master node hops:",J instanceof Error?J:new Error(String(J))),[]}},[h]),j=Ct.useCallback(async(K,J)=>{var te,G,q;try{const be=(q=(G=(te=(await ze.backup.fetchNamespaces(K,J)).data)==null?void 0:te.data)==null?void 0:G.namespaces)!=null?q:[];return i(be),be}catch(oe){throw O.error("Failed to fetch namespaces:",oe instanceof Error?oe:new Error(String(oe))),oe}},[i]),b=Ct.useCallback(async K=>{var J,te,G;try{const q={...K,infra_id:Number(s)};q.hops&&(q.auth_data=q.hops,delete q.hops);const oe=await ze.backup.createBackup(q);if((te=(J=oe.data)==null?void 0:J.data)!=null&&te.id)return f.success("ë°±ì—… ìƒì„±ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì™„ë£Œë˜ë©´ ëª©ë¡ì— í‘œì‹œë©ë‹ˆë‹¤."),s&&await $(Number(s)),oe.data.data;throw new Error(((G=oe.data)==null?void 0:G.error)||"ë°±ì—… ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(q){throw O.error("Failed to create backup:",q instanceof Error?q:new Error(String(q))),q}},[s,$]),A=Ct.useCallback(async(K,J)=>{var te,G,q;try{const oe=await ze.backup.deleteBackup(K.infra_id,K.name,J);if((te=oe.data)!=null&&te.success)return f.success("ë°±ì—…ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),s&&await $(Number(s)),(G=oe.data)==null?void 0:G.data;throw new Error(((q=oe.data)==null?void 0:q.error)||"ë°±ì—… ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(oe){throw O.error("Failed to delete backup:",oe instanceof Error?oe:new Error(String(oe))),oe}},[s,$]),W=Ct.useCallback(async K=>{var J,te,G;try{const q=await ze.backup.createRestore({infra_id:K.infra_id,backup_name:K.backup_name,backup_version:K.backup_version,namespace_mappings:K.namespace_mappings||(K.namespace?{[K.namespace]:K.namespace}:void 0),auth_data:K.auth_data});if((J=q.data)!=null&&J.success)return f.success("ë³µêµ¬ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."),s&&await y(Number(s)),(te=q.data)==null?void 0:te.data;throw new Error(((G=q.data)==null?void 0:G.error)||"ë³µêµ¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(q){throw O.error("Failed to restore backup:",q instanceof Error?q:new Error(String(q))),q}},[s,y]),Z=Ct.useCallback(async K=>{const{mode:J,formData:te,minioAuthData:G,veleroAuthData:q,minioStorage:oe}=K;try{if(J==="minio"){if(!G||G.length===0)throw new Error("MinIO ì„œë²„ ì¸ì¦ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");f.loading({content:"MinIO ì„¤ì¹˜ë¥¼ ìš”ì²­í•˜ëŠ” ì¤‘...",key:"install"});const be={infra_id:te.storageInfra,server_id:te.storageServer,auth_data:G},ne=await ze.backup.installMinio(be);if(!ne.data.data)throw new Error(ne.data.error||"MinIO ì„¤ì¹˜ ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return ne.data.data}else if(J==="velero"){if(!q||q.length===0)throw new Error("Velero ì„œë²„ ì¸ì¦ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");if(!oe)throw new Error("Velero ì„¤ì¹˜ì— í•„ìš”í•œ MinIO ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");f.loading({content:"Velero ì„¤ì¹˜ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...",key:"install-velero"});const be={infra_id:Number(te.k8sInfra),minio_endpoint:oe.endpoint,access_key:oe.access_key,secret_key:oe.secret_key,bucket:`velero-bucket-${te.k8sInfra}`,auth_data:q},ne=await ze.backup.installVelero(be);if(!ne.data.data)throw new Error(ne.data.error||"Velero ì„¤ì¹˜ ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return f.success({content:"Velero ì„¤ì¹˜ ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",key:"install-velero",duration:2}),ne.data.data}}catch(be){const ne=be instanceof Error?be.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";throw f.error({content:`í™˜ê²½ êµ¬ì¶• ì‹¤íŒ¨: ${ne}`,key:"install",duration:5}),be}},[]),se=Ct.useCallback(async(K,J)=>{try{if(!J||J.length===0)throw new Error("MinIO ì„œë²„ ì¸ì¦ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");f.loading({content:"MinIO ì„¤ì¹˜ë¥¼ ìš”ì²­í•˜ëŠ” ì¤‘...",key:"install"});const te={infra_id:K.storageInfra,server_id:K.storageServer,auth_data:J},G=await ze.backup.installMinio(te);if(!G.data.data)throw new Error(G.data.error||"MinIO ì„¤ì¹˜ ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return G.data.data}catch(te){const G=te instanceof Error?te.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";throw f.error({content:`MinIO ì„¤ì¹˜ ìš”ì²­ ì‹¤íŒ¨: ${G}`,key:"install",duration:5}),te}},[]),ce=Ct.useCallback(async(K,J,te)=>{try{f.loading({content:"Velero ì„¤ì¹˜ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...",key:"install-velero"});const G={infra_id:K,minio_endpoint:te.endpoint,access_key:te.access_key,secret_key:te.secret_key,bucket:`velero-bucket-${K}`,auth_data:J},q=await ze.backup.installVelero(G);if(!q.data.data)throw new Error(q.data.error||"Velero ì„¤ì¹˜ ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return f.success({content:"Velero ì„¤ì¹˜ ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",key:"install-velero",duration:2}),q.data.data}catch(G){const q=G instanceof Error?G.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";throw f.error({content:`Velero ì„¤ì¹˜ ìš”ì²­ ì‹¤íŒ¨: ${q}`,key:"install",duration:5}),G}},[]),D=Ct.useCallback(async K=>{var J,te,G;try{f.loading({content:"ë°±ì—… í™˜ê²½ êµ¬ì¶• ìš”ì²­ì„ ë³´ë‚´ëŠ” ì¤‘...",key:"setup"});const q=await ze.backup.startFullSetup(K);if((te=(J=q.data)==null?void 0:J.data)!=null&&te.job_id)return f.success({content:"ë°±ì—… í™˜ê²½ êµ¬ì¶• ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.",key:"setup",duration:3}),q.data.data.job_id;throw new Error(((G=q.data)==null?void 0:G.error)||"ì„¤ì¹˜ ì‘ì—… ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(q){const oe=q instanceof Error?q.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";throw f.error({content:`ìš”ì²­ ì‹¤íŒ¨: ${oe}`,key:"setup",duration:5}),q}},[]);return Ct.useEffect(()=>{E.current||(E.current=!0,P(),u())},[P,u]),{isLoading:l,isLoadingStatus:_,infrastructures:c,servers:h,loadBackups:$,loadServers:I,loadRestores:y,loadBackupStatus:v,loadAllMinioStorages:u,getMasterNodeHops:m,fetchNamespaces:j,createBackup:b,deleteBackup:A,restoreBackup:W,installBackupSystem:Z,installMinio:se,installVelero:ce,startBackupEnvironmentSetup:D,selectedInfra:c.find(K=>K.id===Number(s)),isAdmin:((M=c.find(K=>K.id===Number(s)))==null?void 0:M.user_role)==="admin"}},{Option:Av}=Ee,Wd=async()=>{var s;try{return((s=(await ze.infra.request("list",{})).data)==null?void 0:s.data)||[]}catch(t){throw O.error("ì¸í”„ë¼ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},vc=async s=>{var t;try{const r=await ze.infra.request("list-servers",{infra_id:s});return(t=r.data)!=null&&t.data?r.data.data:[]}catch(r){throw O.error("ì„œë²„ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",r),r}},Gg=async()=>{var s;try{const t=await ze.infra.request("list-build-infras",{});return(s=t.data)!=null&&s.data?t.data.data:[]}catch(t){throw O.error("ë¹Œë“œ ì¸í”„ë¼ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},Wg=async s=>{var t;try{const r=await ze.infra.request("get-server-hops",{server_id:s});return(t=r.data)!=null&&t.data?r.data.data:[]}catch(r){throw O.error("ì„œë²„ hops ì¡°íšŒ ì‹¤íŒ¨:",r),r}},gj=async s=>{try{const t=await ze.infra.request("testGitLabAuth",s);if(!t.data.success)throw new Error(t.data.error||"GitLab ì¸ì¦ ì‹¤íŒ¨");return t.data.data}catch(t){throw O.error("GitLab ì¸ì¦ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:",t),t}},xj=async s=>{try{const t=await ze.infra.request("testRegistryAuth",s);if(!t.data.success)throw new Error(t.data.error||"Registry ì¸ì¦ ì‹¤íŒ¨")}catch(t){throw O.error("Registry ì¸ì¦ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:",t),t}},nd=Object.freeze(Object.defineProperty({__proto__:null,getBuildInfras:Gg,getInfrastructures:Wd,getServerHops:Wg,getServers:vc,testGitLabAuthentication:gj,testRegistryAuthentication:xj},Symbol.toStringTag,{value:"Module"})),{Option:wh}=Ee,mj=({visible:s,onCancel:t,onSubmit:r,loading:n,namespaces:a,onRequestNamespaces:i,onFetchNamespacesWithAuth:l,selectedInfra:d,infrastructures:c,onRequestVeleroInstall:p,onRefreshVeleroStatus:h})=>{var Fe,Le,Oe,Mt;const[x]=H.useForm(),[_,S]=o.useState(d==null?void 0:d.id),[L,k]=o.useState(!1),[E,P]=o.useState(!1),[I,$]=o.useState("daily"),[y,v]=o.useState("full"),[u,m]=o.useState(null),[j,b]=o.useState(!1),[A,W]=o.useState(null),[Z,se]=o.useState("minio"),[ce,D]=o.useState([]),[M,K]=o.useState([]),[J,te]=o.useState(!1),[G,q]=o.useState([]),[oe,be]=o.useState(!1),[ne,ye]=o.useState(!1),[Ue,N]=o.useState([{host:"",port:22,username:""}]),[ge,Ce]=o.useState(!1),je=o.useMemo(()=>c.find(Ve=>Ve.id===_),[c,_]),Pe=o.useMemo(()=>(je==null?void 0:je.type)==="kubernetes"||(je==null?void 0:je.type)==="external_kubernetes",[je]),w=o.useMemo(()=>(je==null?void 0:je.type)==="docker"||(je==null?void 0:je.type)==="podman"||(je==null?void 0:je.type)==="external_docker"||(je==null?void 0:je.type)==="external_podman",[je]);ce.length+M.length;const R=o.useCallback(async Ve=>{te(!0);try{const Me=await ga.getInfraStorageMappings(Ve);Me.data&&Me.data.length>0?K(Me.data.map(Bt=>({id:Bt.external_storage_id,name:Bt.storage_name||`ì €ì¥ì†Œ ${Bt.external_storage_id}`,endpoint:Bt.storage_endpoint||"",bucket:"velero"}))):K([]);const ot=await ga.listAllMinioStorages();ot.data&&D(ot.data)}catch(Me){K([])}finally{te(!1)}},[]),U=o.useCallback(async Ve=>{be(!0);try{const Me=await vc(Ve),ot=Me==null?void 0:Me.find(Bt=>Bt.infra_id===Ve);if(ot!=null&&ot.hops){const Bt=typeof ot.hops=="string"?JSON.parse(ot.hops):ot.hops;Array.isArray(Bt)&&Bt.length>0&&q(Bt.map(Ps=>({host:Ps.host||Ps.ip||"",port:Ps.port||22,username:Ps.username||""})))}}catch(Me){q([])}finally{be(!1)}},[]),V=o.useCallback(async Ve=>{var Me,ot,Bt,Ps,ir,Ut;b(!0),m(null),W(null);try{const et=(Me=(await ze.backup.getInstallationStatus(Ve)).data)==null?void 0:Me.data,tt=((ot=et==null?void 0:et.summary)==null?void 0:ot.can_create_backup)===!0,Vt=((Bt=et==null?void 0:et.velero)==null?void 0:Bt.installed)===!0||((Ps=et==null?void 0:et.velero)==null?void 0:Ps.status)==="active",lt=((ir=et==null?void 0:et.summary)==null?void 0:ir.has_external_storage)===!0||((Ut=et==null?void 0:et.external_storage)==null?void 0:Ut.connected)===!0;m(Vt),W(!!(tt||Vt&&lt))}catch(Ge){console.error("[BackupFormModal] Velero status check failed:",Ge),m(!1),W(!1)}finally{b(!1)}},[]),F=o.useCallback(async()=>{if(!_||!l)return;const Ve=x.getFieldsValue(),Me=Ue.map((Bt,Ps)=>({host:Ve[`k8s_ssh_host_${Ps}`]||Bt.host,port:Ve[`k8s_ssh_port_${Ps}`]||Bt.port||22,username:Ve[`k8s_ssh_username_${Ps}`]||"",password:Ve[`k8s_ssh_password_${Ps}`]||""}));if(Me.every(Bt=>Bt.host&&Bt.username&&Bt.password)){Ce(!0);try{await l(_,Me)}finally{Ce(!1)}}},[_,l,x,Ue]),X=o.useCallback(()=>{N(Ve=>[...Ve,{host:"",port:22,username:""}])},[]),de=o.useCallback(Ve=>{N(Me=>Me.filter((ot,Bt)=>Bt!==Ve))},[]);o.useEffect(()=>{s||(x.resetFields(),S(d==null?void 0:d.id),k(!1),P(!1),v("full"),m(null),b(!1),W(null),se("minio"),D([]),K([]),q([]),ye(!1),N([{host:"",port:22,username:""}]),Ce(!1))},[s,x,d]),o.useEffect(()=>{if(s&&d){R(d.id);const Ve=d.type;if(Ve==="kubernetes"||Ve==="external_kubernetes"){V(d.id);const Me=hr().format("YYYYMMDD-HHmmss");x.setFieldsValue({backupName:`${d.name}-${Me}`})}else if(Ve==="docker"||Ve==="podman"||Ve==="external_docker"||Ve==="external_podman"){U(d.id);const Me=hr().format("YYYYMMDD-HHmmss");x.setFieldsValue({backupName:`${d.name}-${Me}`})}}},[s,d,V,U,R,x]);const Ne=Ve=>{S(Ve),x.setFieldsValue({namespace:void 0});const Me=c.find(ot=>ot.id===Ve);if(Me&&!E){const ot=hr().format("YYYYMMDD-HHmmss");x.setFieldsValue({backupName:`${Me.name}-${ot}`})}Me&&(Me.type==="kubernetes"||Me.type==="external_kubernetes")?(V(Ve),q([])):Me&&(Me.type==="docker"||Me.type==="podman"||Me.type==="external_docker"||Me.type==="external_podman")?(m(null),b(!1),U(Ve),x.setFieldsValue({storageType:"minio"})):(m(null),b(!1),q([]))},ae=Ve=>{if(!E&&Ve){const Me=hr().format("YYYYMMDD");x.setFieldsValue({backupName:`${Ve}-${Me}`})}},pe=()=>{x.validateFields().then(Ve=>{if(!_||!je)return;const Me={infraId:_,infraType:je.type,backupName:Ve.backupName};if(Pe){if(Me.namespace=Ve.namespace,Ve.selector&&Ve.selector.trim()!==""&&(Me.selector=Ve.selector),L){const{minute:ot,hour:Bt,dayOfMonth:Ps,dayOfWeek:ir}=Ve.scheduleParts||{};let Ut="";switch(I){case"daily":Ut=`${ot||0} ${Bt||2} * * *`;break;case"weekly":Ut=`${ot||0} ${Bt||2} * * ${ir||1}`;break;case"monthly":Ut=`${ot||0} ${Bt||2} ${Ps||1} * *`;break}Me.schedule=Ut,Me.retention=Ve.retention}if(Me.storageType=Ve.k8sStorageType||Z,Me.storageType==="minio"&&Ve.k8sStorageId){const ot=String(Ve.k8sStorageId);ot.startsWith("ext-")?Me.externalStorageId=parseInt(ot.replace("ext-",""),10):ot.startsWith("infra-")&&(Me.storageId=parseInt(ot.replace("infra-",""),10))}ne&&Ue.length>0&&(Me.sshCredentials=Ue.map((ot,Bt)=>({host:Ve[`k8s_ssh_host_${Bt}`]||"",port:parseInt(Ve[`k8s_ssh_port_${Bt}`],10)||22,username:Ve[`k8s_ssh_username_${Bt}`]||"",password:Ve[`k8s_ssh_password_${Bt}`]||""})))}if(w){if(Me.backupType=Ve.backupType||y,Ve.composeProject&&(Me.composeProject=Ve.composeProject),Me.storageType=Ve.storageType||Z,Me.storageType==="minio"&&Ve.storageId){const ot=String(Ve.storageId);ot.startsWith("ext-")?Me.externalStorageId=parseInt(ot.replace("ext-",""),10):ot.startsWith("infra-")&&(Me.storageId=parseInt(ot.replace("infra-",""),10))}G.length>0&&(Me.sshCredentials=G.map((ot,Bt)=>({host:ot.host,port:ot.port||22,username:Ve[`ssh_username_${Bt}`]||ot.username||"",password:Ve[`ssh_password_${Bt}`]||""})))}r(Me)}).catch(()=>{})},Xe=Ve=>({kubernetes:{label:"K8s",color:"blue",icon:e.jsx(Cn,{})},external_kubernetes:{label:"K8s",color:"geekblue",icon:e.jsx(Cn,{})},docker:{label:"Docker",color:"cyan",icon:e.jsx(Qr,{})},external_docker:{label:"Docker",color:"cyan",icon:e.jsx(Qr,{})},podman:{label:"Podman",color:"purple",icon:e.jsx(Qr,{})},external_podman:{label:"Podman",color:"purple",icon:e.jsx(Qr,{})}})[Ve]||{label:Ve,color:"default",icon:null},Nt=[{value:"full",label:"ì „ì²´ ë°±ì—…",description:"ë³¼ë¥¨ + ì»¨í…Œì´ë„ˆ ì„¤ì • + Compose íŒŒì¼"},{value:"volume",label:"ë³¼ë¥¨ë§Œ",description:"ë°ì´í„° ë³¼ë¥¨ë§Œ ë°±ì—…"},{value:"config",label:"ì„¤ì •ë§Œ",description:"ì»¨í…Œì´ë„ˆ ì„¤ì •ë§Œ ë°±ì—…"},{value:"compose",label:"Compose íŒŒì¼ë§Œ",description:"docker-compose.yml íŒŒì¼ë§Œ ë°±ì—…"}];return e.jsx(rt,{title:e.jsxs(g,{children:[e.jsx(Ui,{}),"ìƒˆ ë°±ì—… ìƒì„±"]}),open:s,onCancel:t,onOk:pe,confirmLoading:n,width:650,okText:"ë°±ì—… ìƒì„±",cancelText:"ì·¨ì†Œ",okButtonProps:{disabled:!_||Pe&&(j||u===!1)},children:e.jsx("div",{className:"backup-form-modal",children:e.jsxs(H,{form:x,layout:"vertical",initialValues:{retention:"30d",backupType:"full"},children:[e.jsx(H.Item,{name:"infraId",label:"ë°±ì—…í•  ì¸í”„ë¼",rules:[{required:!0,message:"ì¸í”„ë¼ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}],initialValue:d==null?void 0:d.id,children:e.jsx(Ee,{placeholder:"ì¸í”„ë¼ë¥¼ ì„ íƒí•˜ì„¸ìš”",size:"large",onChange:Ne,value:_,children:c.map(Ve=>{const Me=Xe(Ve.type);return e.jsx(wh,{value:Ve.id,children:e.jsxs(g,{children:[Me.icon,e.jsx("span",{children:Ve.name}),e.jsx(T,{color:Me.color,children:Me.label})]})},Ve.id)})})}),je&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{style:{margin:"16px 0"}}),e.jsx(xe,{message:Pe?"Kubernetes ë°±ì—… (Velero)":"Docker/Podman ë°±ì—…",description:Pe?"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ Veleroë¥¼ í†µí•´ ë°±ì—…í•©ë‹ˆë‹¤.":"ì»¨í…Œì´ë„ˆ ë³¼ë¥¨, ì„¤ì •, Compose íŒŒì¼ì„ ë°±ì—…í•©ë‹ˆë‹¤.",type:Pe?"info":"success",showIcon:!0,style:{marginBottom:16}}),e.jsx(H.Item,{name:"backupName",label:"ë°±ì—… ì´ë¦„",rules:[{required:!0,message:"ë°±ì—… ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: my-app-20250821",size:"large",onChange:()=>P(!0)})}),Pe&&e.jsxs(e.Fragment,{children:[j&&e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(gt,{size:"small"}),e.jsx("span",{children:"Velero ì„¤ì¹˜ ìƒíƒœ í™•ì¸ ì¤‘..."})]}),type:"info",style:{marginBottom:16}}),!j&&u===!1&&e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(Yt,{}),e.jsx("span",{children:"Velero ì„¤ì¹˜ í•„ìš”"}),e.jsx(T,{color:"orange",children:je==null?void 0:je.name})]}),description:e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:8},children:"Kubernetes ë°±ì—…ì„ ìƒì„±í•˜ë ¤ë©´ ë¨¼ì € Veleroë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤."}),e.jsxs(g,{wrap:!0,children:[p&&_&&e.jsx(B,{type:"primary",icon:e.jsx(fa,{}),onClick:()=>{const Ve=_;t(),setTimeout(()=>{p(Ve)},100)},children:"Velero ì„¤ì¹˜í•˜ê¸°"}),e.jsx(B,{icon:e.jsx(zs,{}),onClick:()=>_&&V(_),children:"ìƒíƒœ ìƒˆë¡œê³ ì¹¨"})]}),e.jsx("p",{style:{marginTop:8,marginBottom:0,fontSize:12,color:"#888"},children:'ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤ë©´ "ìƒíƒœ ìƒˆë¡œê³ ì¹¨" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.'})]}),type:"warning",showIcon:!1,style:{marginBottom:16}}),!j&&u===!0&&A===!1&&e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(Yt,{}),e.jsx("span",{children:"ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²° í•„ìš”"}),e.jsx(T,{color:"orange",children:je==null?void 0:je.name})]}),description:e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:8},children:"ì´ ì¸í”„ë¼ì— ì™¸ë¶€ ì €ì¥ì†Œê°€ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë°±ì—…ì„ ìƒì„±í•˜ë ¤ë©´ ë¨¼ì € ì™¸ë¶€ ì €ì¥ì†Œë¥¼ ì—°ê²°í•´ì£¼ì„¸ìš”."}),e.jsxs("p",{style:{margin:0,color:"#888"},children:[e.jsx("strong",{children:"ë°±ì—… ê´€ë¦¬"})," â†’"," ",e.jsx("strong",{children:"ì¸í”„ë¼ ì—°ê²°"})," íƒ­ì—ì„œ ì´ ì¸í”„ë¼ë¥¼ ì™¸ë¶€ ì €ì¥ì†Œì— ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]}),e.jsx(B,{icon:e.jsx(zs,{}),onClick:()=>_&&V(_),style:{marginTop:8},size:"small",children:"ìƒíƒœ ìƒˆë¡œê³ ì¹¨"})]}),type:"warning",showIcon:!1,style:{marginBottom:16}}),!j&&u===!0&&A===!0&&e.jsxs(e.Fragment,{children:[M.length>0&&e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx("span",{children:"ë°±ì—… ì €ì¥ì†Œ"})]}),description:e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx("span",{children:(Fe=M[0])==null?void 0:Fe.name}),e.jsx(T,{color:"blue",children:(Le=M[0])==null?void 0:Le.endpoint})]}),type:"info",showIcon:!1,style:{marginBottom:16}}),e.jsx(H.Item,{name:"namespace",label:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[e.jsx("span",{children:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤"}),e.jsxs(g,{children:[!ne&&e.jsx(B,{type:"link",size:"small",onClick:()=>_&&i(_),icon:e.jsx(zs,{}),children:"ê°€ì ¸ì˜¤ê¸°"}),e.jsx(B,{type:"link",size:"small",onClick:()=>ye(!ne),children:ne?"SSH ì…ë ¥ ì·¨ì†Œ":"ì§ì ‘ SSH ì…ë ¥"})]})]}),rules:[{required:!0,message:"ë°±ì—…í•  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:a.length>0?"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì„ íƒ":"ë¨¼ì € ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ì„¸ìš”",size:"large",onChange:ae,children:(a||[]).map(Ve=>e.jsx(wh,{value:Ve,children:Ve},Ve))})}),ne&&e.jsxs(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(Qn,{}),e.jsx("span",{children:"ë§ˆìŠ¤í„° ë…¸ë“œ SSH ì ‘ì† ì •ë³´"})]}),style:{marginBottom:16},children:[e.jsx(xe,{message:"ë§ˆìŠ¤í„° ë…¸ë“œ ì •ë³´ê°€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤",description:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ë ¤ë©´ Kubernetes ë§ˆìŠ¤í„° ë…¸ë“œì˜ SSH ì ‘ì† ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.",type:"info",showIcon:!0,style:{marginBottom:16}}),Ue.map((Ve,Me)=>e.jsxs("div",{style:{marginBottom:Me<Ue.length-1?16:0},children:[Ue.length>1&&e.jsxs("div",{style:{marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:500},children:Me===0?"ê²Œì´íŠ¸ì›¨ì´":Me===Ue.length-1?"ë§ˆìŠ¤í„° ë…¸ë“œ":`ì¤‘ê°„ ì„œë²„ ${Me}`}),Ue.length>1&&e.jsx(B,{type:"text",size:"small",danger:!0,icon:e.jsx(Hp,{}),onClick:()=>de(Me)})]}),e.jsxs(Ke,{gutter:8,children:[e.jsx(Y,{span:8,children:e.jsx(H.Item,{name:`k8s_ssh_host_${Me}`,rules:[{required:!0,message:"í˜¸ìŠ¤íŠ¸ í•„ìˆ˜"}],style:{marginBottom:8},children:e.jsx(ue,{placeholder:"í˜¸ìŠ¤íŠ¸ (ì˜ˆ: 192.168.1.100)"})})}),e.jsx(Y,{span:4,children:e.jsx(H.Item,{name:`k8s_ssh_port_${Me}`,initialValue:22,style:{marginBottom:8},children:e.jsx(ue,{type:"number",placeholder:"í¬íŠ¸"})})}),e.jsx(Y,{span:6,children:e.jsx(H.Item,{name:`k8s_ssh_username_${Me}`,rules:[{required:!0,message:"ì‚¬ìš©ìëª… í•„ìˆ˜"}],style:{marginBottom:8},children:e.jsx(ue,{placeholder:"ì‚¬ìš©ìëª…"})})}),e.jsx(Y,{span:6,children:e.jsx(H.Item,{name:`k8s_ssh_password_${Me}`,rules:[{required:!0,message:"ë¹„ë°€ë²ˆí˜¸ í•„ìˆ˜"}],style:{marginBottom:8},children:e.jsx(ue.Password,{placeholder:"ë¹„ë°€ë²ˆí˜¸"})})})]})]},Me)),e.jsxs(g,{style:{marginTop:8},children:[e.jsx(B,{type:"dashed",size:"small",icon:e.jsx(rr,{}),onClick:X,children:"SSH hop ì¶”ê°€ (ë‹¤ì¤‘ í™‰)"}),l&&e.jsx(B,{type:"primary",size:"small",icon:e.jsx(zs,{}),loading:ge,onClick:F,children:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê°€ì ¸ì˜¤ê¸°"})]})]})]})]}),w&&e.jsxs(e.Fragment,{children:[M.length>0&&e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx("span",{children:"ë°±ì—… ì €ì¥ì†Œ"})]}),description:e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx("span",{children:(Oe=M[0])==null?void 0:Oe.name}),e.jsx(T,{color:"blue",children:(Mt=M[0])==null?void 0:Mt.endpoint})]}),type:"info",showIcon:!1,style:{marginBottom:16}}),!J&&M.length===0&&e.jsx(xe,{message:"ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²° í•„ìš”",description:e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:8},children:"ë°±ì—…ì„ ìƒì„±í•˜ë ¤ë©´ ì™¸ë¶€ ì €ì¥ì†Œë¥¼ ì—°ê²°í•´ì£¼ì„¸ìš”."}),e.jsxs("p",{style:{margin:0,color:"#888"},children:[e.jsx("strong",{children:"ë°±ì—… ê´€ë¦¬"})," â†’"," ",e.jsx("strong",{children:"ì¸í”„ë¼ ì—°ê²°"})," íƒ­ì—ì„œ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]})]}),type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx(H.Item,{name:"backupType",label:"ë°±ì—… ìœ í˜•",rules:[{required:!0,message:"ë°±ì—… ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}],initialValue:"full",children:e.jsx(aa.Group,{value:y,onChange:Ve=>v(Ve.target.value),children:e.jsx(g,{direction:"vertical",style:{width:"100%"},children:Nt.map(Ve=>e.jsx(aa,{value:Ve.value,children:e.jsxs(g,{direction:"vertical",size:0,children:[e.jsx("span",{style:{fontWeight:500},children:Ve.label}),e.jsx("span",{style:{fontSize:12,color:"#888"},children:Ve.description})]})},Ve.value))})})}),e.jsx(H.Item,{name:"composeProject",label:"Compose í”„ë¡œì íŠ¸ (ì„ íƒ)",tooltip:"íŠ¹ì • Docker Compose í”„ë¡œì íŠ¸ë§Œ ë°±ì—…í•˜ë ¤ë©´ í”„ë¡œì íŠ¸ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”",children:e.jsx(ue,{placeholder:"ì˜ˆ: my-app (ë¹„ì›Œë‘ë©´ ì¸í”„ë¼ ì „ì²´ ë°±ì—…)",size:"large"})}),G.length>0&&e.jsxs(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(Qn,{}),e.jsx("span",{children:"ì„œë²„ SSH ì¸ì¦"}),oe&&e.jsx(gt,{size:"small"})]}),style:{marginTop:16},children:[e.jsx(xe,{message:"ë°±ì—… ì‹¤í–‰ì„ ìœ„í•´ ì„œë²„ ì ‘ì† ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”",type:"info",showIcon:!0,style:{marginBottom:16}}),G.map((Ve,Me)=>e.jsxs("div",{style:{marginBottom:Me<G.length-1?16:0},children:[G.length>1&&e.jsx("div",{style:{marginBottom:8,fontWeight:500},children:Me===0?"ê²Œì´íŠ¸ì›¨ì´":Me===G.length-1?"ëŒ€ìƒ ì„œë²„":`ì¤‘ê°„ ì„œë²„ ${Me}`}),e.jsxs(Ke,{gutter:8,children:[e.jsx(Y,{span:8,children:e.jsx(H.Item,{style:{marginBottom:0},children:e.jsx(ue,{value:`${Ve.host}:${Ve.port}`,disabled:!0,prefix:e.jsx("span",{style:{color:"#888"},children:"í˜¸ìŠ¤íŠ¸"})})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{name:`ssh_username_${Me}`,initialValue:Ve.username,rules:[{required:!0,message:"ì‚¬ìš©ìëª… í•„ìˆ˜"}],style:{marginBottom:0},children:e.jsx(ue,{placeholder:"ì‚¬ìš©ìëª…"})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{name:`ssh_password_${Me}`,rules:[{required:!0,message:"ë¹„ë°€ë²ˆí˜¸ í•„ìˆ˜"}],style:{marginBottom:0},children:e.jsx(ue.Password,{placeholder:"ë¹„ë°€ë²ˆí˜¸"})})})]})]},Me))]}),oe&&e.jsx("div",{style:{textAlign:"center",padding:20},children:e.jsx(gt,{tip:"ì„œë²„ ì •ë³´ ë¡œë”© ì¤‘..."})})]})]})]})})})},{Option:Nv}=Ee,{TabPane:Bv}=xs,{Option:$v}=Ee,{Option:Ov}=Ee,{TextArea:Dv}=ue,{Text:Fv}=we,{Option:Uv}=Ee,fj=({visible:s,selectedBackup:t,isDeleting:r,onCancel:n})=>{const[a]=H.useForm();return e.jsx(rt,{title:"ë°±ì—… ì‚­ì œ",open:s,onCancel:n,onOk:()=>a.submit(),confirmLoading:r,width:500,className:"backup-modal",okText:"ì‚­ì œ",okButtonProps:{danger:!0},cancelText:"ì·¨ì†Œ",children:e.jsxs("div",{className:"delete-backup-content",children:[e.jsx(xe,{message:"ë°±ì—… ì‚­ì œ í™•ì¸",description:e.jsxs("div",{children:[e.jsx("div",{children:"ë‹¤ìŒ ë°±ì—…ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"}),e.jsxs("div",{style:{marginTop:8},children:["ë°±ì—… ì´ë¦„: ",e.jsx("b",{children:t==null?void 0:t.name})]}),e.jsxs("div",{children:["ë„¤ì„ìŠ¤í˜ì´ìŠ¤: ",e.jsx("b",{children:t==null?void 0:t.namespace})]}),e.jsx("div",{style:{marginTop:8,color:"#d46b08"},children:"ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})]}),type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsxs(H,{form:a,layout:"vertical",children:[e.jsx(H.Item,{name:"username",label:"ì„œë²„ ì ‘ì† ê³„ì •",rules:[{required:!0,message:"ì„œë²„ ì ‘ì† ê³„ì •ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: root"})}),e.jsx(H.Item,{name:"password",label:"ì„œë²„ ì ‘ì† ë¹„ë°€ë²ˆí˜¸",rules:[{required:!0,message:"ì„œë²„ ì ‘ì† ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue.Password,{})})]})]})})},yj=({visible:s,onCancel:t,onSuccess:r,loading:n,selectedInfra:a,sshHops:i})=>{const[l]=H.useForm(),[d,c]=o.useState(!1),[p,h]=o.useState("full"),[x,_]=o.useState(null),[S,L]=o.useState(!1),[k,E]=o.useState(null),[P,I]=o.useState([]),[$,y]=o.useState(!1),[v,u]=o.useState([]),[m,j]=o.useState("all"),[b,A]=o.useState(!1),[W,Z]=o.useState([]),{serverlist:se}=Gs(),ce=o.useRef(a);o.useEffect(()=>{a&&(ce.current=a)},[a]);const D=o.useCallback(async()=>{if(a){L(!0),E(null);try{const ye=(await ga.getInfraStorageMappings(a.id)).data||[],Ue=ye.length>0;if(_(Ue),Ue&&ye[0]){const N=ye[0];E({id:N.external_storage_id||0,name:N.storage_name||"ì™¸ë¶€ ì €ì¥ì†Œ",endpoint:N.storage_endpoint||"",bucket:"velero",type:"minio"})}}catch(ne){console.error("[DockerBackupFormModal] ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²° ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:",ne),_(!1)}finally{L(!1)}}},[a]),M=o.useCallback(()=>!i||i.length===0?[]:i.map((ne,ye)=>{if(ne.password&&ne.password.length>0)return ne;const Ue=se.find(N=>N.host===ne.host&&(N.port===ne.port||!N.port&&ne.port===22)&&N.userId===ne.username&&(a==null?void 0:a.id)!==void 0&&N.infraId===a.id);return Ue!=null&&Ue.password?{...ne,password:Ue.password}:ne}),[i,se,a]),K=o.useCallback(()=>{const ne=M();return ne.length===0?!1:ne.every(ye=>ye.password&&ye.password.length>0)},[M]),J=o.useCallback(async(ne,ye)=>{const Ue=ne||ce.current||a,N=ye||(W.length>0?W:M());if(!Ue)return;const ge=N;if(ge.length===0||!ge.every(Ce=>Ce.password)){I([]);return}y(!0);try{const Ce=Ue.type==="podman"||Ue.type==="external_podman"?"podman":"docker",je=await ze.docker.request("getContainers",{hops:ge,runtimeType:Ce}),Pe=je.data;if(Pe&&!Pe.success){console.error("[DockerBackupFormModal] API ì‘ë‹µ ì‹¤íŒ¨:",Pe.error||Pe.message),f.error(Pe.error||Pe.message||"ì»¨í…Œì´ë„ˆ ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),I([]),y(!1);return}const w=U=>typeof U=="string"?U:typeof U=="number"||typeof U=="boolean"?String(U):"";let R=[];if(Pe!=null&&Pe.data&&typeof Pe.data=="object"){const U=Pe.data;Array.isArray(U.containers)&&(R=U.containers)}if(R.length===0&&Pe&&typeof Pe=="object"){const U=Pe;Array.isArray(U.containers)&&(R=U.containers)}if(R.length===0&&Array.isArray(je)&&(R=je),R.length>0){const U=R.map(V=>({id:w(V.id||V.Id||V.ID),name:w(V.name||V.Name||V.Names),image:w(V.image||V.Image),status:w(V.status||V.Status||V.State),ports:w(V.ports||V.Ports),size:w(V.size||V.Size),created:w(V.created||V.Created)}));I(U)}else console.warn("[DockerBackupFormModal] ì»¨í…Œì´ë„ˆ ë°ì´í„° ì—†ìŒ"),I([])}catch(Ce){console.error("[DockerBackupFormModal] ì»¨í…Œì´ë„ˆ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",Ce),f.error("ì»¨í…Œì´ë„ˆ ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. SSH ì¸ì¦ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."),I([])}finally{y(!1)}},[a,W,M]),te=o.useCallback(()=>{if(K()){const ne=M();Z(ne),j("selected")}else A(!0)},[K,M]),G=o.useCallback(ne=>{const ye=ce.current;Z(ne),j("selected"),A(!1),ye?J(ye,ne):console.error("[DockerBackupFormModal] currentInfraê°€ ì—†ìŠµë‹ˆë‹¤ (refì—ì„œë„ undefined)")},[J]);o.useEffect(()=>{if(s&&a){const ne=`${a.name}-${hr().format("YYYYMMDD-HHmmss")}`;l.setFieldsValue({backupName:ne,backupType:"full"}),D()}},[s,a,l,D]),o.useEffect(()=>{s&&m==="selected"&&W.length>0&&J()},[s,m,W,J]),o.useEffect(()=>{s||(l.resetFields(),h("full"),_(null),E(null),I([]),u([]),j("all"),Z([]),A(!1),ce.current=void 0)},[s,l]);const q=async()=>{var ne;try{const ye=await l.validateFields(),Ue=ce.current;if(!Ue){f.error("ì¸í”„ë¼ê°€ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."),console.error("[DockerBackupFormModal] handleSubmit - currentInfra undefined",{refValue:(ne=ce.current)==null?void 0:ne.id,propValue:a==null?void 0:a.id});return}if(!i||i.length===0){f.error("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ì¸í”„ë¼ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.");return}if(!x){f.error("ì™¸ë¶€ ì €ì¥ì†Œê°€ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë¨¼ì € ì €ì¥ì†Œë¥¼ ì—°ê²°í•´ì£¼ì„¸ìš”.");return}if(m==="selected"&&v.length===0){f.error("ë°±ì—…í•  ì»¨í…Œì´ë„ˆë¥¼ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.");return}c(!0);const N=W.length>0?W:M();if(!N.every(Pe=>Pe.password&&Pe.password.length>0)){f.error("SSH ì¸ì¦ ì •ë³´ê°€ ì™„ì „í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. SSH ì ‘ì† ì •ë³´ë¥¼ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”."),c(!1),A(!0);return}const ge=await Ag({infra_id:Ue.id,hops:N,name:ye.backupName,backup_type:ye.backupType,trigger_type:"manual",containers:m==="selected"?v:void 0,storage_type:"minio"}),Ce=m==="selected"?` (${v.length}ê°œ ì»¨í…Œì´ë„ˆ)`:" (ì „ì²´)",je=k?` â†’ ${k.name}`:" (ì™¸ë¶€ ì €ì¥ì†Œ)";f.success(`ë°±ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤: ${ge.name}${Ce}${je}`),r(),t()}catch(ye){f.error(`ë°±ì—… ìƒì„± ì‹¤íŒ¨: ${ye instanceof Error?ye.message:String(ye)}`)}finally{c(!1)}},oe=[{value:"full",label:"ì „ì²´ ë°±ì—…",description:"ë³¼ë¥¨ + ì»¨í…Œì´ë„ˆ ì„¤ì •",icon:e.jsx(Rm,{})},{value:"volume",label:"ë³¼ë¥¨ë§Œ",description:"ë°ì´í„° ë³¼ë¥¨ë§Œ ë°±ì—…",icon:e.jsx(_s,{})},{value:"config",label:"ì„¤ì •ë§Œ",description:"ì»¨í…Œì´ë„ˆ ì„¤ì •ë§Œ ë°±ì—…",icon:e.jsx(Fr,{})}],be=x===!0;return e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(Ui,{}),"Docker/Podman ë°±ì—… ìƒì„±"]}),open:s,onCancel:t,onOk:q,confirmLoading:d||n,width:650,okText:"ë°±ì—… ì‹œì‘",cancelText:"ì·¨ì†Œ",okButtonProps:{disabled:!be||S},children:[e.jsxs("div",{className:"docker-backup-form-modal",children:[a&&e.jsx(xe,{message:`ë°±ì—… ëŒ€ìƒ: ${a.name} (${a.type==="podman"?"Podman":"Docker"})`,type:"info",showIcon:!0,style:{marginBottom:24}}),S&&e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(gt,{tip:"ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²° ìƒíƒœ í™•ì¸ ì¤‘..."})}),!S&&x===!1&&e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(Yt,{}),e.jsx("span",{children:"ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²° í•„ìš”"})]}),description:e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:12},children:"ì´ ì¸í”„ë¼ì— ì™¸ë¶€ ì €ì¥ì†Œê°€ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë°±ì—…ì„ ìƒì„±í•˜ë ¤ë©´ ë¨¼ì € ì™¸ë¶€ ì €ì¥ì†Œë¥¼ ì—°ê²°í•´ì•¼ í•©ë‹ˆë‹¤."}),e.jsxs("p",{style:{marginBottom:16,color:"#666"},children:[e.jsx("strong",{children:"ì—°ê²° ë°©ë²•:"})," ë°±ì—… ê´€ë¦¬ > ì¸í”„ë¼ ì—°ê²° íƒ­ì—ì„œ ì´ ì¸í”„ë¼ë¥¼ ì™¸ë¶€ ì €ì¥ì†Œì™€ ì—°ê²°í•˜ì„¸ìš”."]}),e.jsxs(g,{children:[e.jsx(B,{type:"primary",icon:e.jsx(Ea,{}),onClick:()=>{t(),window.location.href="/backup?tab=infra-link"},children:"ì¸í”„ë¼ ì—°ê²°í•˜ëŸ¬ ê°€ê¸°"}),e.jsx(B,{icon:e.jsx(zs,{}),onClick:D,children:"ìƒíƒœ ìƒˆë¡œê³ ì¹¨"})]})]}),type:"warning",showIcon:!1,style:{marginBottom:24}}),be&&e.jsxs(H,{form:l,layout:"vertical",initialValues:{backupType:"full"},children:[e.jsx(H.Item,{name:"backupName",label:"ë°±ì—… ì´ë¦„",rules:[{required:!0,message:"ë°±ì—… ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: my-service-20251212"})}),e.jsx(H.Item,{name:"backupType",label:"ë°±ì—… ìœ í˜•",rules:[{required:!0,message:"ë°±ì—… ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsx(Ee,{value:p,onChange:ne=>h(ne),options:oe.map(ne=>({value:ne.value,label:e.jsxs(g,{children:[ne.icon,e.jsx("span",{children:ne.label}),e.jsxs("span",{style:{color:"#888",fontSize:12},children:["- ",ne.description]})]})}))})}),e.jsx(H.Item,{label:e.jsxs(g,{children:[e.jsx("span",{children:"ë°±ì—… ë²”ìœ„"}),e.jsx(Ie,{title:"ì „ì²´ ì¸í”„ë¼ë¥¼ ë°±ì—…í•˜ê±°ë‚˜, íŠ¹ì • ì»¨í…Œì´ë„ˆë§Œ ì„ íƒí•˜ì—¬ ë°±ì—…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",children:e.jsx(Ks,{style:{color:"#1890ff"}})})]}),children:e.jsx(Ee,{value:m,onChange:ne=>{ne==="selected"?te():(j("all"),u([]))},options:[{value:"all",label:e.jsxs(g,{children:[e.jsx(Da,{}),e.jsx("span",{children:"ì „ì²´ ì¸í”„ë¼ ë°±ì—…"})]})},{value:"selected",label:e.jsxs(g,{children:[e.jsx(Qr,{}),e.jsx("span",{children:"ì„ íƒí•œ ì»¨í…Œì´ë„ˆë§Œ ë°±ì—…"})]})}]})}),m==="selected"&&e.jsx(H.Item,{label:"ì»¨í…Œì´ë„ˆ ì„ íƒ",children:$?e.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[e.jsx(gt,{size:"small"}),e.jsx("span",{style:{marginLeft:8,color:"#888"},children:"ì»¨í…Œì´ë„ˆ ëª©ë¡ ì¡°íšŒ ì¤‘..."})]}):P.length===0?e.jsx(xe,{message:"ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",description:"ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆê°€ ì—†ê±°ë‚˜ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",type:"warning",showIcon:!0}):e.jsxs("div",{style:{maxHeight:200,overflowY:"auto",border:"1px solid #d9d9d9",borderRadius:6,padding:8},children:[e.jsx(Vr.Group,{value:v,onChange:ne=>u(ne),style:{width:"100%"},children:e.jsx(g,{direction:"vertical",style:{width:"100%"},children:P.map(ne=>e.jsx(Vr,{value:ne.name,style:{width:"100%"},children:e.jsxs(g,{size:4,children:[e.jsx(T,{color:ne.status.includes("Up")?"green":"default",children:ne.status.includes("Up")?"Running":"Stopped"}),e.jsx("strong",{children:ne.name}),e.jsxs("span",{style:{color:"#888",fontSize:12},children:["(",ne.image,")"]})]})},ne.name))})}),v.length>0&&e.jsx("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px solid #f0f0f0"},children:e.jsxs(T,{color:"blue",children:[v.length,"ê°œ ì„ íƒë¨"]})})]})})]}),be&&k&&e.jsx(ie,{size:"small",style:{marginTop:16,background:"#f6ffed",border:"1px solid #b7eb8f"},children:e.jsxs(g,{children:[e.jsx(Ze,{style:{color:"#52c41a"}}),e.jsx("span",{children:"ë°±ì—… ì €ì¥ì†Œ ì—°ê²°ë¨"}),e.jsx(T,{color:"blue",icon:e.jsx(_t,{}),children:k.name}),e.jsx(T,{color:"cyan",children:k.endpoint})]})})]}),e.jsx(Hi,{visible:b,onClose:()=>A(!1),onComplete:G,hops:i,infraId:a==null?void 0:a.id,serviceName:a==null?void 0:a.name})]})},{Text:pa,Title:Cl}=we,jj=({visible:s,backup:t,restores:r,onClose:n})=>{const a=c=>({pending:{color:"default",icon:e.jsx(wr,{}),text:"ëŒ€ê¸° ì¤‘"},in_progress:{color:"processing",icon:e.jsx(Pt,{spin:!0}),text:"ì§„í–‰ ì¤‘"},completed:{color:"success",icon:e.jsx(Ze,{}),text:"ì™„ë£Œ"},failed:{color:"error",icon:e.jsx(Es,{}),text:"ì‹¤íŒ¨"}})[c]||{color:"default",icon:null,text:c},i=[{title:"ë³µêµ¬ ID",dataIndex:"id",key:"id",width:80,render:c=>e.jsxs(pa,{code:!0,children:["#",c]})},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:100,render:c=>{const p=a(c);return e.jsx(T,{color:p.color,icon:p.icon,children:p.text})}},{title:"ë³µêµ¬ ì˜µì…˜",key:"options",width:140,render:(c,p)=>e.jsxs(g,{size:4,children:[p.restore_volumes&&e.jsx(Ie,{title:"ë³¼ë¥¨ ë³µêµ¬",children:e.jsx(T,{icon:e.jsx(Wo,{}),color:"blue",children:"ë³¼ë¥¨"})}),p.restore_config&&e.jsx(Ie,{title:"ì„¤ì • ë³µêµ¬",children:e.jsx(T,{icon:e.jsx(rn,{}),color:"orange",children:"ì„¤ì •"})})]})},{title:"ì‹œì‘ ì‹œê°„",dataIndex:"created_at",key:"created_at",width:160,render:c=>new Date(c).toLocaleString("ko-KR")},{title:"ì™„ë£Œ ì‹œê°„",dataIndex:"completed_at",key:"completed_at",width:160,render:c=>c?new Date(c).toLocaleString("ko-KR"):"-"},{title:"ì†Œìš” ì‹œê°„",key:"duration",width:100,render:(c,p)=>{if(!p.completed_at)return"-";const h=new Date(p.created_at).getTime(),x=new Date(p.completed_at).getTime(),_=Math.round((x-h)/1e3);return _<=0?"-":_<60?`${_}ì´ˆ`:_<3600?`${Math.floor(_/60)}ë¶„ ${_%60}ì´ˆ`:`${Math.floor(_/3600)}ì‹œê°„ ${Math.floor(_%3600/60)}ë¶„`}}],l=r.filter(c=>c.status==="failed"&&c.error_message),d={total:r.length,completed:r.filter(c=>c.status==="completed").length,failed:r.filter(c=>c.status==="failed").length,inProgress:r.filter(c=>c.status==="in_progress"||c.status==="pending").length};return t?e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(mo,{}),"Docker ë³µêµ¬ ì´ë ¥"]}),open:s,onCancel:n,footer:null,width:900,styles:{body:{maxHeight:"70vh",overflowY:"auto"}},children:[e.jsxs(Se,{bordered:!0,size:"small",style:{marginBottom:16},children:[e.jsx(Se.Item,{label:"ë°±ì—… ì´ë¦„",span:2,children:e.jsx(pa,{strong:!0,children:t.name})}),e.jsx(Se.Item,{label:"ë°±ì—… ìœ í˜•",children:e.jsx(T,{color:"blue",children:t.backup_type})}),e.jsx(Se.Item,{label:"Compose í”„ë¡œì íŠ¸",span:2,children:t.compose_project||"ì „ì²´ ì¸í”„ë¼"}),e.jsx(Se.Item,{label:"ë°±ì—… ìƒì„±ì¼",children:new Date(t.created_at).toLocaleString("ko-KR")})]}),e.jsxs("div",{style:{display:"flex",gap:24,marginBottom:16,padding:"12px 16px",background:"#fafafa",borderRadius:8},children:[e.jsxs("div",{children:[e.jsx(pa,{type:"secondary",children:"ì´ ë³µêµ¬"}),e.jsxs(Cl,{level:4,style:{margin:0},children:[d.total,"íšŒ"]})]}),e.jsxs("div",{children:[e.jsx(pa,{type:"secondary",children:"ì„±ê³µ"}),e.jsx(Cl,{level:4,style:{margin:0,color:"#52c41a"},children:d.completed})]}),e.jsxs("div",{children:[e.jsx(pa,{type:"secondary",children:"ì‹¤íŒ¨"}),e.jsx(Cl,{level:4,style:{margin:0,color:"#ff4d4f"},children:d.failed})]}),d.inProgress>0&&e.jsxs("div",{children:[e.jsx(pa,{type:"secondary",children:"ì§„í–‰ ì¤‘"}),e.jsx(Cl,{level:4,style:{margin:0,color:"#1890ff"},children:d.inProgress})]})]}),l.length>0&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(pa,{strong:!0,style:{display:"block",marginBottom:8},children:"ì‹¤íŒ¨í•œ ë³µêµ¬ ìƒì„¸:"}),l.map(c=>e.jsx(xe,{type:"error",message:`ë³µêµ¬ #${c.id} ì‹¤íŒ¨`,description:c.error_message,style:{marginBottom:8},showIcon:!0},c.id))]}),r.length>0?e.jsx(wt,{columns:i,dataSource:r,rowKey:"id",pagination:r.length>10?{pageSize:10,size:"small"}:!1,size:"small",bordered:!0}):e.jsx(Je,{description:"ë³µêµ¬ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤",style:{padding:"40px 0"}}),r.length>0&&e.jsxs("div",{style:{marginTop:24},children:[e.jsx(pa,{strong:!0,style:{display:"block",marginBottom:12},children:"ìµœê·¼ ë³µêµ¬ íƒ€ì„ë¼ì¸:"}),e.jsx(zm,{items:r.slice(0,5).map(c=>{const p=a(c.status);return{color:p.color==="success"?"green":p.color==="error"?"red":p.color==="processing"?"blue":"gray",children:e.jsxs("div",{children:[e.jsxs(pa,{strong:!0,children:["ë³µêµ¬ #",c.id]}),e.jsx(pa,{type:"secondary",style:{marginLeft:8},children:new Date(c.created_at).toLocaleString("ko-KR")}),e.jsxs("div",{children:[e.jsx(T,{color:p.color,style:{fontSize:11},children:p.text}),c.restore_volumes&&e.jsx(T,{style:{fontSize:11},children:"ë³¼ë¥¨"}),c.restore_config&&e.jsx(T,{style:{fontSize:11},children:"ì„¤ì •"}),c.target_compose_project&&e.jsxs(pa,{type:"secondary",style:{fontSize:12},children:["â†’ ",c.target_compose_project]})]}),c.status==="failed"&&c.error_message&&e.jsx(pa,{type:"danger",style:{fontSize:12},children:c.error_message})]})}})})]})]}):null},{Text:Hv}=we,{Option:Vv}=Ee,{Text:ro}=we,{Option:ad}=Ee,{TextArea:bj}=ue,_j=({visible:s,onCancel:t,onSubmit:r,loading:n=!1,initialValues:a,isEdit:i=!1})=>{const[l]=H.useForm(),[d,c]=o.useState(0),[p,h]=o.useState("idle"),[x,_]=o.useState(""),[S,L]=o.useState(!1),[k,E]=o.useState(!1);o.useEffect(()=>{s&&(a?(l.setFieldsValue(a),E(a.sshEnabled||!1),c(1)):(l.resetFields(),E(!1),c(0)),h("idle"),_(""),L(!1))},[s,l,a]);const P=async()=>{var v,u;try{const m=k?["sshGatewayHost","sshGatewayPort","sshGatewayUser","sshGatewayPassword","sshTargetHost","sshTargetPort","sshTargetUser","sshTargetPassword"]:[],j=await l.validateFields(["endpoint","accessKey","secretKey","bucket","useSSL",...m]);if(h("testing"),_(""),!/^https?:\/\/.+/.test(j.endpoint))throw new Error("ì—”ë“œí¬ì¸íŠ¸ëŠ” http:// ë˜ëŠ” https://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.");const A={endpoint:j.endpoint,access_key:j.accessKey,secret_key:j.secretKey,bucket:j.bucket,use_ssl:j.useSSL||!1};k&&(A.ssh_enabled=!0,A.ssh_gateway_host=j.sshGatewayHost,A.ssh_gateway_port=j.sshGatewayPort||22,A.ssh_gateway_user=j.sshGatewayUser,A.ssh_gateway_password=j.sshGatewayPassword,A.ssh_target_host=j.sshTargetHost,A.ssh_target_port=j.sshTargetPort||22,A.ssh_target_user=j.sshTargetUser,A.ssh_target_password=j.sshTargetPassword);const W=await ga.testExternalStorageConnection(A);if(W.success&&((v=W.data)!=null&&v.connected))h("success"),c(2),f.success("ì €ì¥ì†Œ ì—°ê²° í…ŒìŠ¤íŠ¸ ì„±ê³µ!");else throw new Error(((u=W.data)==null?void 0:u.message)||W.error||"ì—°ê²° í…ŒìŠ¤íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(m){h("failed");const j=m instanceof Error?m.message:"ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨";_(j),O.error("ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:",m)}},I=async()=>{try{const v=await l.validateFields();L(!0);const u={name:v.name,description:v.description,type:v.type||"minio",endpoint:v.endpoint,accessKey:v.accessKey,secretKey:v.secretKey,bucket:v.bucket||"velero",region:v.region||"minio",useSSL:v.useSSL||!1,sshEnabled:k,sshGatewayHost:k?v.sshGatewayHost:void 0,sshGatewayPort:k?v.sshGatewayPort||22:void 0,sshGatewayUser:k?v.sshGatewayUser:void 0,sshGatewayPassword:k?v.sshGatewayPassword:void 0,sshTargetHost:k?v.sshTargetHost:void 0,sshTargetPort:k?v.sshTargetPort||22:void 0,sshTargetUser:k?v.sshTargetUser:void 0,sshTargetPassword:k?v.sshTargetPassword:void 0};await r(u),f.success(i?"ì €ì¥ì†Œê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.":"ì™¸ë¶€ ì €ì¥ì†Œê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤."),t()}catch(v){const u=v instanceof Error?v.message:"ì €ì¥ì†Œ ë“±ë¡ ì‹¤íŒ¨";f.error(u),O.error("ì™¸ë¶€ ì €ì¥ì†Œ ë“±ë¡ ì‹¤íŒ¨:",v)}finally{L(!1)}},$=async()=>{try{await l.validateFields(["name","type"]),c(1)}catch(v){}},y=()=>{switch(p){case"testing":return e.jsx(xe,{message:"ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...",description:"ì™¸ë¶€ ì €ì¥ì†Œì— ì—°ê²°ì„ ì‹œë„í•˜ê³  ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,icon:e.jsx(gt,{size:"small"})});case"success":return e.jsx(xe,{message:"ì—°ê²° ì„±ê³µ",description:"ì™¸ë¶€ ì €ì¥ì†Œì— ì„±ê³µì ìœ¼ë¡œ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.",type:"success",showIcon:!0,icon:e.jsx(Ze,{})});case"failed":return e.jsx(xe,{message:"ì—°ê²° ì‹¤íŒ¨",description:x||"ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì…ë ¥ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",type:"error",showIcon:!0,icon:e.jsx(Tr,{})});default:return null}};return e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx("span",{children:i?"ì™¸ë¶€ ì €ì¥ì†Œ ìˆ˜ì •":"ì™¸ë¶€ ì €ì¥ì†Œ ë“±ë¡"})]}),open:s,onCancel:t,destroyOnClose:!0,width:650,footer:[e.jsx(B,{onClick:t,children:"ì·¨ì†Œ"},"back"),d===0&&e.jsx(B,{type:"primary",onClick:$,children:"ë‹¤ìŒ"},"next"),d>=1&&d<2&&e.jsx(B,{type:"default",onClick:P,loading:p==="testing",children:"ì—°ê²° í…ŒìŠ¤íŠ¸"},"test"),d>=1&&e.jsx(B,{type:"primary",loading:n||S,onClick:I,disabled:!i&&p!=="success",children:i?"ìˆ˜ì •":"ì €ì¥ì†Œ ë“±ë¡"},"submit")].filter(Boolean),children:[e.jsx(So,{size:"small",current:d,style:{marginBottom:24},items:[{title:"ê¸°ë³¸ ì •ë³´",icon:e.jsx(_s,{}),description:e.jsx(ro,{type:"secondary",style:{fontSize:11},children:"ì´ë¦„/íƒ€ì…"})},{title:"ì—°ê²° ì •ë³´",icon:e.jsx(za,{}),description:e.jsx(ro,{type:"secondary",style:{fontSize:11},children:"ì¸ì¦ ì„¤ì •"})},{title:"ë“±ë¡ ì™„ë£Œ",icon:e.jsx(Ze,{}),description:e.jsx(ro,{type:"secondary",style:{fontSize:11},children:"í™•ì¸"})}]}),e.jsxs(H,{form:l,layout:"vertical",initialValues:{type:"minio",bucket:"velero",region:"minio",useSSL:!1,sshEnabled:!1,sshGatewayPort:22,sshTargetPort:22},children:[e.jsx(xe,{message:"ì™¸ë¶€ ë°±ì—… ì €ì¥ì†Œ ë“±ë¡",description:e.jsxs("div",{children:[e.jsx("p",{children:"ì¡°ì§ ë ˆë²¨ì˜ ì™¸ë¶€ ì €ì¥ì†Œë¥¼ ë“±ë¡í•˜ì—¬ ì—¬ëŸ¬ ì¸í”„ë¼ì˜ ë°±ì—…ì„ ì¤‘ì•™ì—ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),e.jsxs("p",{style:{marginTop:8,color:"#666"},children:[e.jsx("strong",{children:"íŠ¹ì§•:"})," ì¸í”„ë¼ì™€ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬ë˜ë©°, ë“±ë¡ í›„ ì›í•˜ëŠ” ì¸í”„ë¼ì— ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(xt,{orientation:"left",plain:!0,children:e.jsxs(g,{children:[e.jsx(_s,{}),"ê¸°ë³¸ ì •ë³´"]})}),e.jsx(H.Item,{name:"name",label:"ì €ì¥ì†Œ ì´ë¦„",rules:[{required:!0,message:"ì €ì¥ì†Œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue,{prefix:e.jsx(_t,{}),placeholder:"ì˜ˆ: íšŒì‚¬ ì¤‘ì•™ MinIO, Production S3"})}),e.jsx(H.Item,{name:"description",label:"ì„¤ëª… (ì„ íƒ)",children:e.jsx(bj,{rows:2,placeholder:"ì €ì¥ì†Œì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"})}),e.jsx(H.Item,{name:"type",label:"ì €ì¥ì†Œ íƒ€ì…",rules:[{required:!0,message:"ì €ì¥ì†Œ íƒ€ì…ì„ ì„ íƒí•´ì£¼ì„¸ìš”."}],children:e.jsxs(Ee,{children:[e.jsx(ad,{value:"minio",children:e.jsxs(g,{children:[e.jsx(_t,{}),"MinIO"]})}),e.jsx(ad,{value:"s3",children:e.jsxs(g,{children:[e.jsx(_t,{}),"AWS S3"]})}),e.jsx(ad,{value:"nfs",disabled:!0,children:e.jsxs(g,{children:[e.jsx(_t,{}),"NFS (ì¤€ë¹„ ì¤‘)"]})})]})}),d>=1&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",plain:!0,children:e.jsxs(g,{children:[e.jsx(ya,{}),"ì—°ê²° ì •ë³´"]})}),e.jsx(H.Item,{name:"endpoint",label:"ì—”ë“œí¬ì¸íŠ¸ URL",rules:[{required:!0,message:"ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."},{pattern:/^https?:\/\/.+/,message:"http:// ë˜ëŠ” https://ë¡œ ì‹œì‘í•˜ëŠ” URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue,{prefix:e.jsx(Ea,{}),placeholder:"ì˜ˆ: http://192.168.0.100:9000"})}),e.jsx(H.Item,{name:"accessKey",label:"Access Key",rules:[{required:!0,message:"Access Keyë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue,{prefix:e.jsx(za,{}),placeholder:"MinIO/S3 Access Key"})}),e.jsx(H.Item,{name:"secretKey",label:"Secret Key",rules:[{required:!0,message:"Secret Keyë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue.Password,{prefix:e.jsx(za,{}),placeholder:"MinIO/S3 Secret Key"})}),e.jsx(H.Item,{name:"bucket",label:"ë²„í‚· ì´ë¦„",rules:[{required:!0,message:"ë²„í‚· ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."},{pattern:/^[a-z0-9][a-z0-9.-]{1,61}[a-z0-9]$/,message:"ìœ íš¨í•œ ë²„í‚· ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆ, ì  í—ˆìš©)."}],children:e.jsx(ue,{prefix:e.jsx(_s,{}),placeholder:"ì˜ˆ: velero, backups"})}),e.jsx(H.Item,{name:"region",label:"ë¦¬ì „",tooltip:"S3ì˜ ê²½ìš° ë¦¬ì „ì„ ì§€ì •í•´ì£¼ì„¸ìš”. MinIOëŠ” ê¸°ë³¸ê°’ ì‚¬ìš©",children:e.jsx(ue,{placeholder:"ì˜ˆ: minio, ap-northeast-2"})}),e.jsx(H.Item,{name:"useSSL",label:"SSL ì‚¬ìš©",valuePropName:"checked",children:e.jsx(Zr,{checkedChildren:e.jsx(pr,{}),unCheckedChildren:"OFF"})}),e.jsx(xt,{orientation:"left",plain:!0,children:e.jsxs(g,{children:[e.jsx(Qn,{}),"SSH í„°ë„ë§ (ë‚´ë¶€ë§ ì ‘ê·¼)"]})}),e.jsx(xe,{message:"SSH í„°ë„ë§",description:"MinIOê°€ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì— ìˆì–´ ì§ì ‘ ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•œ ê²½ìš°, SSH í„°ë„ì„ í†µí•´ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(H.Item,{name:"sshEnabled",label:"SSH í„°ë„ë§ ì‚¬ìš©",valuePropName:"checked",children:e.jsx(Zr,{checkedChildren:e.jsx(Qn,{}),unCheckedChildren:"OFF",onChange:v=>{E(v),h("idle")}})}),k&&e.jsx(nr,{defaultActiveKey:["gateway","target"],style:{marginBottom:16},items:[{key:"gateway",label:e.jsxs(g,{children:[e.jsx(ur,{style:{color:"#1890ff"}}),e.jsx(ro,{strong:!0,children:"ê²Œì´íŠ¸ì›¨ì´ ì„œë²„ (ì™¸ë¶€ ì ‘ì†ì )"})]}),children:e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:16,children:e.jsx(H.Item,{name:"sshGatewayHost",label:"í˜¸ìŠ¤íŠ¸",rules:[{required:k,message:"ê²Œì´íŠ¸ì›¨ì´ í˜¸ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue,{placeholder:"ì˜ˆ: 210.217.121.39"})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{name:"sshGatewayPort",label:"í¬íŠ¸",rules:[{required:k,message:"í¬íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(xn,{min:1,max:65535,style:{width:"100%"},placeholder:"5022"})})})]}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"sshGatewayUser",label:"ì‚¬ìš©ì",rules:[{required:k,message:"ì‚¬ìš©ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue,{placeholder:"ì˜ˆ: lw"})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"sshGatewayPassword",label:"ë¹„ë°€ë²ˆí˜¸",rules:[{required:k,message:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue.Password,{placeholder:"SSH ë¹„ë°€ë²ˆí˜¸"})})})]})]})},{key:"target",label:e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#52c41a"}}),e.jsx(ro,{strong:!0,children:"MinIO ì„œë²„ (ë‚´ë¶€ë§)"})]}),children:e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:16,children:e.jsx(H.Item,{name:"sshTargetHost",label:"í˜¸ìŠ¤íŠ¸",rules:[{required:k,message:"MinIO ì„œë²„ í˜¸ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue,{placeholder:"ì˜ˆ: 192.168.0.100"})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{name:"sshTargetPort",label:"SSH í¬íŠ¸",rules:[{required:k,message:"í¬íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(xn,{min:1,max:65535,style:{width:"100%"},placeholder:"22"})})})]}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"sshTargetUser",label:"ì‚¬ìš©ì",rules:[{required:k,message:"ì‚¬ìš©ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue,{placeholder:"ì˜ˆ: tomcat"})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"sshTargetPassword",label:"ë¹„ë°€ë²ˆí˜¸",rules:[{required:k,message:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue.Password,{placeholder:"SSH ë¹„ë°€ë²ˆí˜¸"})})})]}),e.jsx(xe,{message:"MinIO ì—”ë“œí¬ì¸íŠ¸",description:e.jsx(ro,{type:"secondary",children:"ìœ„ì—ì„œ ì…ë ¥í•œ ì—”ë“œí¬ì¸íŠ¸ URL (ì˜ˆ: http://192.168.0.100:9000)ì€ SSH í„°ë„ì„ í†µí•´ ì ‘ê·¼ë©ë‹ˆë‹¤."}),type:"warning",showIcon:!0,style:{marginTop:8}})]})}]}),e.jsx("div",{style:{marginTop:16},children:y()})]}),d>=2&&p==="success"&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",plain:!0,children:e.jsxs(g,{children:[e.jsx(Ze,{style:{color:"#52c41a"}}),"ë“±ë¡ ì¤€ë¹„ ì™„ë£Œ"]})}),e.jsx(xe,{message:"ì €ì¥ì†Œ ë“±ë¡ ì¤€ë¹„ ì™„ë£Œ",description:e.jsxs("div",{children:[e.jsxs("p",{children:["ì•„ë˜ ",e.jsx("strong",{children:"[ì €ì¥ì†Œ ë“±ë¡]"})," ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì™¸ë¶€ ì €ì¥ì†Œë¥¼ ë“±ë¡í•˜ì„¸ìš”."]}),e.jsx("p",{style:{marginTop:8,color:"#666"},children:"ë“±ë¡ í›„ ì¸í”„ë¼ì™€ ì—°ê²°í•˜ì—¬ ë°±ì—…ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})]}),type:"success",showIcon:!0,icon:e.jsx(Ze,{})})]})]})]})},{Option:qv}=Ee,{Text:Gv}=we,{Text:Wv}=we,wj=({selectedInfra:s,installStatus:t,isLoadingStatus:r,externalStorages:n=[],selectedInfraStorageMappings:a=[],onRefresh:i})=>{var S,L,k,E,P;if(!s)return e.jsx(xe,{message:"ìƒë‹¨ì—ì„œ ì¸í”„ë¼ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.",type:"info"});if(r&&!t)return e.jsx(gt,{tip:"ì„¤ì¹˜ ìƒíƒœë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."});const l=(s==null?void 0:s.type)==="docker"||(s==null?void 0:s.type)==="podman"||(s==null?void 0:s.type)==="external_docker"||(s==null?void 0:s.type)==="external_podman",d=(s==null?void 0:s.type)==="kubernetes"||(s==null?void 0:s.type)==="external_kubernetes",c=a.map(I=>{const $=n.find(y=>y.id===I.external_storage_id);return{...I,storage:$}}).filter(I=>I.storage),p=c.length>0,h=((S=t==null?void 0:t.velero)==null?void 0:S.status)==="active",x=l?!0:p&&h,_=[{title:"ì €ì¥ì†Œ ì´ë¦„",dataIndex:["storage","name"],key:"name",render:(I,$)=>{var y,v,u;return e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx("span",{style:{fontWeight:500},children:I}),e.jsx(T,{color:((y=$.storage)==null?void 0:y.type)==="minio"?"purple":"orange",children:(u=(v=$.storage)==null?void 0:v.type)==null?void 0:u.toUpperCase()})]})}},{title:"Endpoint",dataIndex:["storage","endpoint"],key:"endpoint",render:I=>e.jsx(T,{color:"green",children:I})},{title:"BSL ì´ë¦„",dataIndex:"bsl_name",key:"bsl_name",render:I=>e.jsx(T,{color:"cyan",children:I})},{title:"ê¸°ë³¸",dataIndex:"is_default",key:"is_default",width:60,render:I=>I?e.jsx(T,{color:"success",children:"ê¸°ë³¸"}):"-"}];return e.jsxs("div",{style:{maxWidth:900,margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsxs("h2",{style:{margin:0},children:["ë°±ì—… ì‹œìŠ¤í…œ ìƒíƒœ: ",s.name]}),e.jsx(B,{icon:e.jsx(Pt,{}),onClick:i,loading:r,children:"ìƒíƒœ ìƒˆë¡œê³ ì¹¨"})]}),e.jsxs(g,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(Ea,{style:{color:"#1890ff"}}),"ì—°ê²°ëœ ì™¸ë¶€ ì €ì¥ì†Œ",p&&e.jsxs(T,{color:"success",children:[c.length,"ê°œ ì—°ê²°ë¨"]})]}),children:c.length>0?e.jsx(wt,{columns:_,dataSource:c,rowKey:"id",pagination:!1,size:"small"}):e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsxs("span",{children:["ì—°ê²°ëœ ì™¸ë¶€ ì €ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤.",e.jsx("br",{}),e.jsx("span",{style:{color:"#999",fontSize:12},children:"'ì €ì¥ì†Œ ê´€ë¦¬' íƒ­ì—ì„œ ì™¸ë¶€ ì €ì¥ì†Œë¥¼ ì¶”ê°€í•˜ê³  ì—°ê²°í•˜ì„¸ìš”."})]})})}),d&&e.jsx(ie,{title:"ğŸš€ ë°±ì—… ì—”ì§„ (Velero)",children:e.jsxs(Se,{bordered:!0,column:1,size:"small",children:[e.jsx(Se.Item,{label:"ìƒíƒœ",children:e.jsx(T,{color:h?"green":"red",children:h?"í™œì„±":"ë¹„í™œì„±"})}),e.jsx(Se.Item,{label:"ì—°ê²°ëœ ì €ì¥ì†Œ",children:p?(k=(L=c[0])==null?void 0:L.storage)==null?void 0:k.endpoint:"ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²° í•„ìš”"}),e.jsx(Se.Item,{label:"ì„¤ì¹˜ëœ ì¸í”„ë¼",children:s.name})]})}),l&&e.jsx(ie,{title:"ğŸ“¦ ë°±ì—… ì €ì¥ì†Œ",children:e.jsxs(Se,{bordered:!0,column:1,size:"small",children:[e.jsx(Se.Item,{label:"ì €ì¥ ìœ„ì¹˜",children:e.jsxs(g,{children:[e.jsx(T,{color:"blue",children:"ë¡œì»¬ ì €ì¥ì†Œ"}),p&&e.jsxs(T,{color:"purple",children:["ì™¸ë¶€ ì €ì¥ì†Œ (",c.length,"ê°œ)"]})]})}),e.jsx(Se.Item,{label:"ìƒíƒœ",children:e.jsx(T,{color:"success",children:"ì‚¬ìš© ê°€ëŠ¥"})})]})}),x?e.jsx(xe,{message:"ë°±ì—… ì‹œìŠ¤í…œì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.",description:e.jsxs(e.Fragment,{children:["ì´ì œ ",e.jsx("strong",{children:s.name})," ì¸í”„ë¼ì— ëŒ€í•œ ì‹ ê·œ ë°±ì—… ìƒì„±ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.",e.jsx("ul",{style:{marginTop:8,paddingLeft:20,marginBottom:0},children:l?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"ì €ì¥ ë°©ì‹: ë¡œì»¬ ì €ì¥ì†Œ (ê¸°ë³¸)"}),p&&e.jsxs("li",{children:["ì™¸ë¶€ ì €ì¥ì†Œ:"," ",e.jsx("strong",{children:c.map(I=>{var $;return($=I.storage)==null?void 0:$.name}).join(", ")}),"ì— ì—°ê²°ë¨"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:["ë°±ì—… ì—”ì§„: ",e.jsx("strong",{children:s.name}),"ì— ì„¤ì¹˜ë¨"]}),e.jsxs("li",{children:["ë°±ì—… ì €ì¥ì†Œ:"," ",e.jsx("strong",{children:(P=(E=c[0])==null?void 0:E.storage)==null?void 0:P.name})," ","ì™¸ë¶€ ì €ì¥ì†Œì— ì—°ê²°ë¨"]})]})})]}),type:"success",showIcon:!0,icon:e.jsx(Ze,{})}):e.jsx(xe,{message:"ë°±ì—… ì‹œìŠ¤í…œ ì¤€ë¹„ ë¯¸ì™„ë£Œ",description:d?"ë°±ì—…ì„ ìƒì„±í•˜ë ¤ë©´ ì™¸ë¶€ ì €ì¥ì†Œ ì—°ê²°ê³¼ Velero ì—”ì§„ì´ ëª¨ë‘ 'í™œì„±' ìƒíƒœì—¬ì•¼ í•©ë‹ˆë‹¤.":"ë°±ì—…ì„ ìƒì„±í•˜ë ¤ë©´ ì €ì¥ì†Œ ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤.",type:"warning",showIcon:!0,icon:e.jsx(Yt,{})})]})]})},{Text:ka}=we,{Option:Sj}=Ee,vj=({visible:s,backup:t,onCancel:r,onSubmit:n,loading:a,masterHops:i,infraType:l})=>{var D;const[d]=H.useForm(),[c,p]=o.useState(!1),[h,x]=o.useState(!1),[_,S]=o.useState([]),[L,k]=o.useState([]),[E,P]=o.useState(!1),[I,$]=o.useState(null),[y,v]=o.useState(!1),[u,m]=o.useState("all"),[j,b]=o.useState([]),A=l==="docker"||l==="external_docker"||l==="podman"||l==="external_podman",W=((D=t==null?void 0:t.name)==null?void 0:D.includes("-immediate"))||!(t!=null&&t.schedule),Z=o.useCallback(async()=>{if(!(!t||!A)){v(!0);try{const M=await Bg(t.id);$(M),M!=null&&M.containers&&M.containers.length>0&&b(M.containers)}catch(M){O.error("Docker ë°±ì—… ìƒì„¸ ì¡°íšŒ ì‹¤íŒ¨:",M),$(null)}finally{v(!1)}}},[t,A]);o.useEffect(()=>{s&&t&&(d.resetFields(),p(!1),S([]),k([]),m("all"),b([]),$(null),W&&!A&&S([{name:t.name,createdAt:t.created_at||new Date().toISOString(),status:t.status||"Completed"}]),P(A||W),A&&Z())},[s,t,d,A,W,Z]);const se=async()=>{var K,J;if(!t)return;const M=i.flatMap((te,G)=>[`ssh_username_${G}`,`ssh_password_${G}`]);try{const te=await d.validateFields(M);x(!0);const G=i.map((be,ne)=>({host:be.host,port:be.port,username:te[`ssh_username_${ne}`],password:te[`ssh_password_${ne}`]}));k(G);const oe=(J=(K=(await ze.backup.listActualBackups(t.infra_id,t.group_label||t.name,t.name,t.namespace,G)).data)==null?void 0:K.data)!=null?J:[];oe.length===0?f.info("ì‚¬ìš© ê°€ëŠ¥í•œ ë°±ì—… ë²„ì „ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."):f.success(`ë°±ì—… ë²„ì „ ${oe.length}ê°œë¥¼ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.`),S(oe),P(!0)}catch(te){const G=te;G&&G.errorFields?O.error("ì¸ì¦ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨:",te):(O.error("ë°±ì—… ë²„ì „ API í˜¸ì¶œ ì‹¤íŒ¨:",te),f.error("ë°±ì—… ë²„ì „ì„ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì¸ì¦ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."),P(!1))}finally{x(!1)}},ce=async()=>{var M,K,J,te;try{const G=await d.validateFields();if(!t){f.error("ë°±ì—… ì •ë³´ê°€ ì—†ì–´ ë³µêµ¬ë¥¼ ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}if(A&&u==="selected"&&j.length===0){f.error("ë³µêµ¬í•  ì»¨í…Œì´ë„ˆë¥¼ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.");return}let q=L;(A||W)&&i.length>0&&(q=i.map((be,ne)=>({host:be.host||be.ip||"",port:be.port||22,username:G[`ssh_username_${ne}`],password:G[`ssh_password_${ne}`]})));const oe={originalNamespace:t.namespace,targetNamespace:c?G.targetNamespace:t.namespace,backupVersion:A?t.name:G.backupVersion,authData:q,restoreVolumes:A?(M=G.restoreVolumes)!=null?M:!0:void 0,restoreConfig:A?(K=G.restoreConfig)!=null?K:!0:void 0,redeployCompose:A?(J=G.redeployCompose)!=null?J:!1:void 0,stopExisting:A?(te=G.stopExisting)!=null?te:!1:void 0,restoreScope:A?u:void 0,containers:A&&u==="selected"?j:void 0};await n(oe)}catch(G){O.error("ë³µêµ¬ ì œì¶œ ì‹¤íŒ¨ (ì „ì²´ í¼ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨):",G)}};return t?e.jsxs(rt,{title:e.jsxs(e.Fragment,{children:[e.jsx(hu,{})," ë°±ì—… ë³µêµ¬"]}),open:s,onCancel:r,destroyOnClose:!0,footer:[e.jsx(B,{onClick:r,children:"ì·¨ì†Œ"},"back"),e.jsx(B,{type:"primary",loading:a,onClick:ce,disabled:!E||a,children:"ë³µêµ¬ ì‹œì‘"},"submit")],width:650,children:[e.jsx(So,{size:"small",current:A||W?E?1:0:E&&_.length>0?2:E?1:0,style:{marginBottom:24},items:A||W?[{title:"SSH ì¸ì¦",icon:e.jsx(za,{}),description:e.jsx(ka,{type:"secondary",style:{fontSize:11},children:"ì„œë²„ ì ‘ì†"})},{title:"ë³µêµ¬ ì‹œì‘",icon:e.jsx(In,{}),description:e.jsx(ka,{type:"secondary",style:{fontSize:11},children:"ë°±ì—… ë³µì›"})}]:[{title:"SSH ì¸ì¦",icon:e.jsx(za,{}),description:e.jsx(ka,{type:"secondary",style:{fontSize:11},children:"ì„œë²„ ì ‘ì†"})},{title:"ë²„ì „ ì„ íƒ",icon:e.jsx(Em,{}),description:e.jsx(ka,{type:"secondary",style:{fontSize:11},children:"ë³µêµ¬ ëŒ€ìƒ ì„ íƒ"})},{title:"ë³µêµ¬ ì‹œì‘",icon:e.jsx(In,{}),description:e.jsx(ka,{type:"secondary",style:{fontSize:11},children:"ë°±ì—… ë³µì›"})}]}),e.jsxs(H,{form:d,layout:"vertical",children:[e.jsxs(Se,{bordered:!0,size:"small",style:{marginBottom:16},children:[e.jsx(Se.Item,{label:"ë°±ì—… ì´ë¦„",span:3,children:t.name}),e.jsx(Se.Item,{label:A?"ë°±ì—… íƒ€ì…/í”„ë¡œì íŠ¸":"ì›ë³¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤",span:3,children:t.namespace})]}),A||W?e.jsx(xe,{message:E?"ë³µêµ¬ ì¤€ë¹„ ì™„ë£Œ":"SSH ì¸ì¦ ì •ë³´ ì…ë ¥",description:E?"ì•„ë˜ [ë³µêµ¬ ì‹œì‘] ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë°±ì—…ì„ ë³µêµ¬í•©ë‹ˆë‹¤. ê¸°ì¡´ ë°ì´í„°ê°€ ë®ì–´ì“°ì—¬ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.":"ì„œë²„ì— ì ‘ì†í•˜ê¸° ìœ„í•œ SSH ì¸ì¦ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.",type:E?"success":"info",showIcon:!0,icon:E?e.jsx(Ze,{}):void 0,style:{marginBottom:16}}):e.jsx(xe,{message:E&&_.length>0?"ë³µêµ¬ ì¤€ë¹„ ì™„ë£Œ":E?"2ë‹¨ê³„: ë°±ì—… ë²„ì „ ì„ íƒ":"1ë‹¨ê³„: SSH ì¸ì¦ ì •ë³´ ì…ë ¥",description:E&&_.length>0?"ì•„ë˜ì—ì„œ ë²„ì „ì„ ì„ íƒí•˜ê³  [ë³µêµ¬ ì‹œì‘] ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.":E?"ì•„ë˜ [ë°±ì—… ë²„ì „ ê°€ì ¸ì˜¤ê¸°] ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë³µêµ¬ ê°€ëŠ¥í•œ ë²„ì „ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì„¸ìš”.":"ë¨¼ì € ì„œë²„ì— ì ‘ì†í•˜ê¸° ìœ„í•œ SSH ì¸ì¦ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.",type:E&&_.length>0?"success":"info",showIcon:!0,icon:E&&_.length>0?e.jsx(Ze,{}):void 0,style:{marginBottom:16}}),e.jsxs(xt,{orientation:"left",plain:!0,children:[e.jsx(_t,{})," ì„œë²„ ì ‘ì† ì •ë³´ (SSH)"]}),i.map((M,K)=>e.jsxs("div",{style:{marginBottom:16,padding:"12px 16px",background:"#fafafa",borderRadius:8,border:"1px solid #e8e8e8"},children:[e.jsx("div",{style:{marginBottom:12},children:e.jsxs("span",{style:{fontWeight:500,color:"#1890ff",fontSize:13},children:["ì„œë²„ ",K+1,": ",M.host||M.ip||"(í˜¸ìŠ¤íŠ¸ ì •ë³´ ì—†ìŒ)",":",M.port||22]})}),e.jsx(H.Item,{name:`ssh_username_${K}`,label:"ì‚¬ìš©ì ì´ë¦„",rules:[{required:!0,message:"ì‚¬ìš©ì ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."}],initialValue:M.username||"root",style:{marginBottom:8},children:e.jsx(ue,{placeholder:"SSH ì ‘ì† ì‚¬ìš©ì ì´ë¦„"})}),e.jsx(H.Item,{name:`ssh_password_${K}`,label:"ë¹„ë°€ë²ˆí˜¸",rules:[{required:!0,message:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],style:{marginBottom:0},children:e.jsx(ue.Password,{placeholder:"SSH ì ‘ì† ë¹„ë°€ë²ˆí˜¸"})})]},K)),A&&e.jsxs(e.Fragment,{children:[e.jsxs(xt,{orientation:"left",plain:!0,children:[e.jsx(rn,{})," ë³µêµ¬ ì˜µì…˜"]}),e.jsx(xe,{message:"Docker/Podman ë³µêµ¬ ì•ˆë‚´",description:e.jsxs("ul",{style:{margin:"8px 0 0 0",paddingLeft:20},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"ë³¼ë¥¨ ë³µêµ¬"}),": ë°±ì—…ëœ ë³¼ë¥¨ ë°ì´í„°ë¥¼ ë³µì›í•©ë‹ˆë‹¤."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"ì„¤ì • ë³µêµ¬"}),": Compose íŒŒì¼ ë° ì»¨í…Œì´ë„ˆ ì„¤ì •ì„ ë³µì›í•©ë‹ˆë‹¤."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"ì„œë¹„ìŠ¤ ì¬ë°°í¬"}),": ë³µì›ëœ Compose íŒŒì¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì¬ì‹œì‘í•©ë‹ˆë‹¤. ì´ ì˜µì…˜ì„ ì„ íƒí•˜ë©´ ì‹¤ì œ ì„œë¹„ìŠ¤ê°€ ë¡¤ë°±ë©ë‹ˆë‹¤."]})]}),type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx(H.Item,{name:"restoreVolumes",valuePropName:"checked",initialValue:!0,style:{marginBottom:8},children:e.jsxs(Vr,{defaultChecked:!0,children:[e.jsx("strong",{children:"ë³¼ë¥¨ ë°ì´í„° ë³µêµ¬"}),e.jsx(ka,{type:"secondary",style:{marginLeft:8},children:"ë°±ì—…ëœ ë³¼ë¥¨ ë°ì´í„°ë¥¼ ë³µì›í•©ë‹ˆë‹¤"})]})}),e.jsx(H.Item,{name:"restoreConfig",valuePropName:"checked",initialValue:!0,style:{marginBottom:8},children:e.jsxs(Vr,{defaultChecked:!0,children:[e.jsx("strong",{children:"ì„¤ì • íŒŒì¼ ë³µêµ¬"}),e.jsx(ka,{type:"secondary",style:{marginLeft:8},children:"Compose íŒŒì¼ ë° ì»¨í…Œì´ë„ˆ ì„¤ì •ì„ ë³µì›í•©ë‹ˆë‹¤"})]})}),e.jsx(H.Item,{name:"redeployCompose",valuePropName:"checked",initialValue:!1,style:{marginBottom:8},children:e.jsxs(Vr,{children:[e.jsx("strong",{children:"ì„œë¹„ìŠ¤ ì¬ë°°í¬ (ë¡¤ë°±)"}),e.jsx(ka,{type:"secondary",style:{marginLeft:8},children:"ë³µì›ëœ Compose íŒŒì¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì¬ì‹œì‘í•©ë‹ˆë‹¤"})]})}),e.jsx(H.Item,{name:"stopExisting",valuePropName:"checked",initialValue:!1,style:{marginBottom:16},children:e.jsxs(Vr,{children:[e.jsx("strong",{children:"ê¸°ì¡´ ì„œë¹„ìŠ¤ ì¤‘ì§€"}),e.jsx(ka,{type:"secondary",style:{marginLeft:8},children:"ì¬ë°°í¬ ì „ ê¸°ì¡´ ì„œë¹„ìŠ¤ë¥¼ ë¨¼ì € ì¤‘ì§€í•©ë‹ˆë‹¤"})]})}),e.jsxs(xt,{orientation:"left",plain:!0,children:[e.jsx(Qr,{})," ë³µêµ¬ ë²”ìœ„ ì„ íƒ"]}),y?e.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[e.jsx(gt,{size:"small"}),e.jsx("span",{style:{marginLeft:8,color:"#888"},children:"ë°±ì—… ì •ë³´ ì¡°íšŒ ì¤‘..."})]}):I!=null&&I.containers&&I.containers.length>0?e.jsxs(e.Fragment,{children:[e.jsx(H.Item,{label:e.jsxs(g,{children:[e.jsx("span",{children:"ë³µêµ¬ ë²”ìœ„"}),e.jsx(Ie,{title:"ì „ì²´ ë°±ì—…ì„ ë³µêµ¬í•˜ê±°ë‚˜, íŠ¹ì • ì»¨í…Œì´ë„ˆë§Œ ì„ íƒí•˜ì—¬ ë³µêµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šìœ¼ë ¤ë©´ íŠ¹ì • ì»¨í…Œì´ë„ˆë§Œ ì„ íƒí•˜ì„¸ìš”.",children:e.jsx(Ks,{style:{color:"#1890ff"}})})]}),children:e.jsx(aa.Group,{value:u,onChange:M=>{m(M.target.value),M.target.value==="all"&&(I!=null&&I.containers)&&b(I.containers)},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsx(aa,{value:"all",children:e.jsxs(g,{direction:"vertical",size:0,children:[e.jsxs("span",{style:{fontWeight:500},children:[e.jsx(Da,{style:{marginRight:4}}),"ì „ì²´ ë°±ì—… ë³µêµ¬"]}),e.jsxs("span",{style:{fontSize:12,color:"#888"},children:["ë°±ì—…ëœ ëª¨ë“  ì»¨í…Œì´ë„ˆì™€ ë°ì´í„°ë¥¼ ë³µêµ¬í•©ë‹ˆë‹¤ (",I.containers.length,"ê°œ)"]})]})}),e.jsx(aa,{value:"selected",children:e.jsxs(g,{direction:"vertical",size:0,children:[e.jsxs("span",{style:{fontWeight:500},children:[e.jsx(Qr,{style:{marginRight:4}}),"ì„ íƒí•œ ì»¨í…Œì´ë„ˆë§Œ ë³µêµ¬"]}),e.jsx("span",{style:{fontSize:12,color:"#888"},children:"ì•„ë˜ì—ì„œ ë³µêµ¬í•  ì»¨í…Œì´ë„ˆë¥¼ ì„ íƒí•˜ì„¸ìš”"})]})})]})})}),u==="selected"&&e.jsx(H.Item,{label:"ë³µêµ¬í•  ì»¨í…Œì´ë„ˆ ì„ íƒ",children:e.jsxs("div",{style:{maxHeight:200,overflowY:"auto",border:"1px solid #d9d9d9",borderRadius:6,padding:8},children:[e.jsx(Vr.Group,{value:j,onChange:M=>b(M),style:{width:"100%"},children:e.jsx(g,{direction:"vertical",style:{width:"100%"},children:I.containers.map(M=>e.jsx(Vr,{value:M,style:{width:"100%"},children:e.jsxs(g,{size:4,children:[e.jsx(T,{color:"blue",children:"ì»¨í…Œì´ë„ˆ"}),e.jsx("strong",{children:M})]})},M))})}),j.length>0&&e.jsx("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px solid #f0f0f0"},children:e.jsxs(T,{color:"green",children:[j.length,"ê°œ ì„ íƒë¨"]})})]})})]}):e.jsx(xe,{message:"ë°±ì—…ëœ ì»¨í…Œì´ë„ˆ ì •ë³´ ì—†ìŒ",description:"ì´ ë°±ì—…ì—ëŠ” ê°œë³„ ì»¨í…Œì´ë„ˆ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ì „ì²´ ë°±ì—…ì´ ë³µêµ¬ë©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}})]}),!A&&e.jsxs(e.Fragment,{children:[!W&&e.jsx(B,{onClick:se,loading:h,style:{margin:"16px 0"},children:"ë°±ì—… ë²„ì „ ê°€ì ¸ì˜¤ê¸°"}),e.jsx(gt,{spinning:h,tip:"ë²„ì „ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",children:e.jsx(H.Item,{name:"backupVersion",label:"ë³µêµ¬í•  ë°±ì—… ë²„ì „",rules:[{required:!0,message:"ë³µêµ¬í•  ë²„ì „ì„ ì„ íƒí•´ì£¼ì„¸ìš”."}],initialValue:W&&t?t.name:void 0,children:e.jsx(Ee,{placeholder:W?"ë°±ì—… ë²„ì „ì´ ìë™ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤":"ë¨¼ì € 'ë°±ì—… ë²„ì „ ê°€ì ¸ì˜¤ê¸°'ë¥¼ ì‹¤í–‰í•´ì£¼ì„¸ìš”",disabled:!E||W,defaultValue:W&&t?t.name:void 0,children:_.map(M=>e.jsxs(Sj,{value:M.name,children:[M.name," (ìƒì„±: ",new Date(M.createdAt).toLocaleString(),")"]},M.name))})})}),W&&e.jsx(xe,{message:"ì¦‰ì‹œ ë°±ì—…",description:"ì´ ë°±ì—…ì€ ì¦‰ì‹œ ë°±ì—…ìœ¼ë¡œ ìƒì„±ë˜ì–´ í•´ë‹¹ ë²„ì „ìœ¼ë¡œ ë°”ë¡œ ë³µêµ¬ë©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(xt,{orientation:"left",plain:!0,style:{marginTop:16},children:e.jsx(ka,{type:"secondary",style:{fontSize:12},children:"ê³ ê¸‰ ì˜µì…˜"})}),e.jsx(H.Item,{name:"isDifferentNamespace",valuePropName:"checked",noStyle:!0,children:e.jsx(Vr,{checked:c,onChange:M=>p(M.target.checked),children:e.jsx(ka,{type:"secondary",children:"ë‹¤ë¥¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ë³µêµ¬ (í…ŒìŠ¤íŠ¸/DRìš©)"})})}),c&&e.jsx(H.Item,{name:"targetNamespace",label:"ìƒˆ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì´ë¦„",rules:[{required:!0,message:"ìƒˆ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."},{pattern:/^[a-z0-9]([-a-z0-9]*[a-z0-9])?$/,message:"ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆ(-)ë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë©°, ì‹œì‘ê³¼ ëì€ ì˜ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤."}],style:{marginTop:16},children:e.jsx(ue,{placeholder:"ì˜ˆ: my-restored-app"})})]})]})]}):null},kj=({visible:s,servers:t,selectedInfraId:r,onStorageInfraChange:n,onStartInstallation:a,onSubmit:i})=>{const[l]=H.useForm(),[d,c]=o.useState(0),[p,h]=o.useState("new"),[x,_]=o.useState(!1),[S,L]=o.useState([]),[k,E]=o.useState([]);o.useEffect(()=>{s&&(l.resetFields(),c(0),h("new"),L([]),E([]))},[s,l]);const P=m=>{n(m),l.setFieldsValue({storageServer:void 0}),L([])},I=m=>{n(m)};o.useEffect(()=>{const m=l.getFieldValue("k8sInfra");if(d!==1||!m){k.length>0&&E([]);return}const b=t.filter(A=>A.infra_id===m).find(A=>{var W;return(W=A.type)==null?void 0:W.includes("master")});if(b&&b.hops)try{const A=JSON.parse(b.hops);E(Array.isArray(A)?A:[A])}catch(A){O.error("Failed to parse master node hops:",A),E([])}else E([])},[t,d,l]);const $=m=>{const j=t.find(b=>b.id===m);if(j&&j.hops)try{const b=JSON.parse(j.hops);L(Array.isArray(b)?b:[b])}catch(b){O.error("Failed to parse server hops:",b),L([])}else L([])};return o.useEffect(()=>{},[p]),{form:l,currentStep:d,minioMode:p,isSubmitting:x,selectedServerHops:S,engineAuthHops:k,setMinioMode:h,handleNext:async()=>{try{await l.validateFields();const m=l.getFieldsValue(!0);if(d===0){const j={k8sInfra:void 0};Object.keys(m).forEach(b=>{b.startsWith("ssh_")&&(j[b]=void 0)}),l.setFieldsValue(j),E([]),c(1)}else if(d===1){_(!0);const j={...m,minioMode:p};await a(j)}}catch(m){O.error("í¼ ê²€ì¦ ì‹¤íŒ¨",m)}finally{_(!1)}},handlePrev:()=>{const m=l.getFieldsValue(!0),j={storageServer:void 0};Object.keys(m).forEach(b=>{b.startsWith("ssh_")&&(j[b]=void 0)}),l.setFieldsValue(j),L([]),c(d-1)},getServerOptions:()=>t?t.map(m=>({key:m.id,value:m.id,label:`${m.server_name} (${m.type||"N/A"})`})):[],handleStorageInfraChange:P,handleStorageServerChange:$,handleK8sInfraChange:I}},Cj=({installStatus:s})=>{if(!s)return null;const t=s.minio.error,r=s.velero.error,n=s.minio.status==="installing",a=s.velero.status==="installing",i=n||a,l=c=>{switch(c){case"active":case"connected":return e.jsx(Ze,{style:{color:"#52c41a"}});case"installing":return e.jsx(jc,{style:{color:"#1890ff"}});case"failed":case"error":return e.jsx(Es,{style:{color:"#ff4d4f"}});default:return null}},d=c=>{switch(c){case"active":case"connected":return"success";case"installing":return"processing";case"failed":case"error":return"error";default:return"default"}};return e.jsxs("div",{style:{marginBottom:16},children:[(t||r)&&e.jsx(xe,{message:"ì„¤ì¹˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",description:t||r,type:"error",showIcon:!0,style:{marginBottom:16}}),i&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{style:{marginBottom:8},children:e.jsx("strong",{children:"ë°±ì—… ì‹œìŠ¤í…œ ì„¤ì¹˜ ì§„í–‰ì¤‘..."})}),e.jsx(qt,{percent:n&&a?50:n?25:75,status:"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]}),e.jsx(ar,{size:"small",header:e.jsx("div",{children:"ì„¤ì¹˜ ìƒíƒœ"}),bordered:!0,dataSource:[{name:"MinIO ì €ì¥ì†Œ",status:s.minio.status,message:s.minio.error},{name:"Velero ë°±ì—… ì—”ì§„",status:s.velero.status,message:s.velero.error}],renderItem:c=>e.jsx(ar.Item,{children:e.jsx(ar.Item.Meta,{avatar:l(c.status),title:e.jsxs("span",{style:{fontSize:"14px"},children:[c.name,e.jsx(T,{color:d(c.status),style:{marginLeft:8},children:c.status})]}),description:c.message&&e.jsx("span",{style:{fontSize:"12px",color:"#666"},children:c.message})})})})]})},Sh=({hops:s,namePrefix:t})=>!s||s.length===0?null:e.jsxs(e.Fragment,{children:[e.jsxs(xt,{orientation:"left",plain:!0,children:[e.jsx(_t,{})," ì„œë²„ ì ‘ì† ì •ë³´ (SSH)"]}),s.map((r,n)=>e.jsxs("div",{style:{marginBottom:"16px",padding:"12px",border:"1px solid #f0f0f0",borderRadius:"4px"},children:[e.jsxs("p",{style:{fontWeight:500,margin:"-12px -12px 12px -12px",padding:"8px 12px",background:"#fafafa",borderBottom:"1px solid #f0f0f0"},children:[`Hop ${n+1}: ${r.host}:${r.port}`,n===s.length-1&&" (ìµœì¢… ëª©ì ì§€)"]}),e.jsx(H.Item,{name:`${t}_ssh_username_${n}`,label:"ì‚¬ìš©ì ì´ë¦„",rules:[{required:!0,message:"..."}],initialValue:r.username||"",children:e.jsx(ue,{})}),e.jsx(H.Item,{name:`${t}_ssh_password_${n}`,label:"ë¹„ë°€ë²ˆí˜¸",rules:[{required:!0,message:"..."}],children:e.jsx(ue.Password,{})})]},n))]}),{Option:Il}=Ee,Ij=({currentStep:s,minioMode:t,setMinioMode:r,infrastructures:n,getServerOptions:a,onStorageInfraChange:i,selectedServerHops:l,onStorageServerChange:d,engineAuthHops:c,onK8sInfraChange:p,allMinioStorages:h})=>{const x=()=>e.jsxs("div",{className:"step-content",children:[e.jsx("div",{className:"step-header",children:e.jsxs("div",{className:"step-info",children:[e.jsx("h3",{children:"ë°±ì—… ì €ì¥ì†Œ ì„¤ì •"}),e.jsx("p",{children:"ë°±ì—… ë°ì´í„°ë¥¼ ì €ì¥í•  ì €ì¥ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤."})]})}),e.jsx(H.Item,{label:"ë°±ì—… ì €ì¥ì†Œ ë°©ì‹",name:"minioMode",initialValue:"new",rules:[{required:!0,message:"ì €ì¥ì†Œ ë°©ì‹ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsxs(aa.Group,{onChange:S=>{r(S.target.value)},children:[e.jsx(aa,{value:"new",children:"ìƒˆë¡œ ì„¤ì¹˜"}),e.jsxs(aa,{value:"existing",children:["ê¸°ì¡´ ì €ì¥ì†Œ ì„ íƒ",e.jsx("span",{style:{color:"#666",fontSize:"12px",marginLeft:8},children:"(ì‚¬ìš© ê°€ëŠ¥í•œ ì €ì¥ì†Œê°€ ìˆëŠ” ê²½ìš°)"})]})]})}),t==="new"&&e.jsxs(e.Fragment,{children:[e.jsx(H.Item,{name:"storageInfra",label:"ì €ì¥ì†Œ ìœ„ì¹˜ ì„ íƒ",rules:[{required:!0,message:"ë°±ì—… ì €ì¥ì†Œë¥¼ ì„¤ì¹˜í•  ìœ„ì¹˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ì¸í”„ë¼ ì„ íƒ",size:"large",onChange:i,children:n.map(S=>e.jsxs(Il,{value:S.id,children:[S.name," (",S.type,")"]},S.id))})}),e.jsx(H.Item,{name:"storageServer",label:"ì„¤ì¹˜ ì„œë²„",rules:[{required:!0,message:"ë°±ì—… ì €ì¥ì†Œë¥¼ ì„¤ì¹˜í•  ì„œë²„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ì„œë²„ ì„ íƒ",size:"large",onChange:d,children:a().map(S=>e.jsx(Il,{value:S.value,children:S.label},S.key))})}),e.jsx(Sh,{hops:l,namePrefix:"minio"})]}),t==="existing"&&e.jsx(H.Item,{name:"existingMinioId",label:"ì‚¬ìš©í•  ì €ì¥ì†Œ ì„ íƒ",rules:[{required:!0,message:"ì‚¬ìš©í•  ë°±ì—… ì €ì¥ì†Œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ê¸°ì¡´ MinIO ì €ì¥ì†Œ ì„ íƒ",size:"large",children:(h||[]).map(S=>e.jsxs(Il,{value:S.id,children:[S.infra_name," (",S.endpoint,")"]},S.id))})})]}),_=()=>e.jsxs("div",{className:"step-content",children:[e.jsx("div",{className:"step-header",children:e.jsxs("div",{className:"step-info",children:[e.jsx("h3",{children:"ë°±ì—… ì—”ì§„ ì„¤ì •"}),e.jsx("p",{children:"Velero ë°±ì—… ì—”ì§„ì„ ì„¤ì •í•©ë‹ˆë‹¤."})]})}),e.jsx(H.Item,{name:"k8sInfra",label:"ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì„ íƒ",rules:[{required:!0,message:"Veleroë¥¼ ì„¤ì¹˜í•  ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ì„ íƒ",size:"large",onChange:p,children:n.filter(S=>S.type==="kubernetes"||S.type==="external_kubernetes").map(S=>e.jsx(Il,{value:S.id,children:S.name},S.id))})}),e.jsx(Sh,{hops:c,namePrefix:"velero"})]});switch(s){case 0:return x();case 1:return _();default:return null}},{Step:vh}=So,Tj=({visible:s,onCancel:t,onSubmit:r,installStatus:n,infrastructures:a,servers:i,selectedInfraId:l,onStorageInfraChange:d,onStartInstallation:c,allMinioStorages:p})=>{const{form:h,currentStep:x,minioMode:_,isSubmitting:S,selectedServerHops:L,engineAuthHops:k,setMinioMode:E,handleNext:P,handlePrev:I,handleStorageInfraChange:$,getServerOptions:y,handleStorageServerChange:v,handleK8sInfraChange:u}=kj({visible:s,infrastructures:a,servers:i||[],selectedInfraId:l,onStorageInfraChange:d,onStartInstallation:c||(async()=>{}),onSubmit:r});return e.jsx(rt,{title:e.jsxs(g,{children:[e.jsx(rn,{}),"ë°±ì—… ì‹œìŠ¤í…œ ì„¤ì • ë§ˆë²•ì‚¬"]}),open:s,onCancel:t,width:700,footer:null,children:e.jsxs("div",{className:"setup-wizard-modal",children:[e.jsx(Cj,{installStatus:n}),e.jsxs(So,{current:x,style:{marginBottom:24},children:[e.jsx(vh,{title:"ì €ì¥ì†Œ ì„¤ì •",description:"ë°±ì—… ì €ì¥ì†Œ ì„¤ì¹˜"}),e.jsx(vh,{title:"ì—”ì§„ ì„¤ì •",description:"ë°±ì—… ì—”ì§„ ì„¤ì¹˜"})]}),e.jsx(H,{form:h,layout:"vertical",children:e.jsx(Ij,{currentStep:x,minioMode:_,setMinioMode:E,infrastructures:a,engineAuthHops:k,onK8sInfraChange:u,onStorageInfraChange:$,getServerOptions:y,selectedServerHops:L,onStorageServerChange:v,allMinioStorages:p})}),e.jsx("div",{className:"wizard-footer",children:e.jsxs(g,{children:[x>0&&e.jsx(B,{onClick:I,children:"ì´ì „"}),e.jsx(B,{type:"primary",onClick:P,loading:S,children:x===1?"ì„¤ì¹˜ ì‹œì‘":"ë‹¤ìŒ"}),e.jsx(B,{onClick:t,children:"ì·¨ì†Œ"})]})})]})})},{Text:Kv,Title:Yv}=we,{Option:Jv}=Ee,{Text:Tl}=we,{Option:Rj}=Ee,Jl=["kubernetes","external_kubernetes"],zj=["docker","external_docker","podman","external_podman"],Ej=[...Jl,...zj],Pj=({visible:s,onCancel:t,storage:r,infrastructures:n,linkedInfras:a,onLink:i,onUnlink:l,loading:d=!1})=>{const[c]=H.useForm(),[p,h]=o.useState(!1),x=o.useMemo(()=>n.filter(y=>Ej.includes(y.type)&&!a.some(v=>v.infra_id===y.id)),[n,a]),[_,S]=o.useState(null),L=o.useMemo(()=>{if(!_)return!1;const y=n.find(v=>v.id===_);return y?Jl.includes(y.type):!1},[_,n]);o.useEffect(()=>{s&&(c.resetFields(),c.setFieldsValue({bsl_name:r?`bsl-${r.name.toLowerCase().replace(/\s+/g,"-")}`:"",is_default:!0}),S(null))},[s,c,r]);const k=y=>({kubernetes:"blue",external_kubernetes:"geekblue",docker:"green",external_docker:"cyan",podman:"orange",external_podman:"gold"})[y]||"default",E=y=>Jl.includes(y)?e.jsx(Cn,{}):e.jsx(Qr,{}),P=async()=>{if(r)try{const y=await c.validateFields();h(!0);const v=n.find(j=>j.id===y.infra_id),m=(v?Jl.includes(v.type):!1)?y.bsl_name:`storage-${r.name.toLowerCase().replace(/\s+/g,"-")}-${y.infra_id}`;await i({infra_id:y.infra_id,external_storage_id:r.id,bsl_name:m,is_default:y.is_default}),c.resetFields(),c.setFieldsValue({bsl_name:`bsl-${r.name.toLowerCase().replace(/\s+/g,"-")}`,is_default:!0}),S(null)}catch(y){}finally{h(!1)}},I=async y=>{r&&await l(y,r.id)},$=[{title:"ì¸í”„ë¼",key:"infra",render:(y,v)=>{const u=n.find(m=>m.id===v.infra_id);return e.jsxs(g,{children:[u&&E(u.type),e.jsx(Tl,{strong:!0,children:v.infra_name||(u==null?void 0:u.name)||"ì•Œ ìˆ˜ ì—†ìŒ"}),u&&e.jsx(T,{color:k(u.type),children:u.type})]})}},{title:"BSL ì´ë¦„",dataIndex:"bsl_name",key:"bsl_name",render:y=>e.jsx(T,{color:"cyan",children:y})},{title:"ê¸°ë³¸ê°’",dataIndex:"is_default",key:"is_default",width:80,render:y=>y?e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:"ê¸°ë³¸"}):e.jsx(T,{children:"-"})},{title:"ì‘ì—…",key:"action",width:80,render:(y,v)=>e.jsx(Kt,{title:"ì—°ê²° í•´ì œ",description:"ì´ ì¸í”„ë¼ì™€ì˜ ì—°ê²°ì„ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>I(v.infra_id),okText:"í•´ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{})})})}];return e.jsx(rt,{title:e.jsxs(g,{children:[e.jsx(Ea,{style:{color:"#1890ff"}}),e.jsx("span",{children:"ì¸í”„ë¼ ì—°ê²° ê´€ë¦¬"})]}),open:s,onCancel:t,width:700,footer:[e.jsx(B,{onClick:t,children:"ë‹«ê¸°"},"close")],children:r&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx(Tl,{strong:!0,children:r.name}),e.jsx(T,{color:r.type==="minio"?"purple":"orange",children:r.type.toUpperCase()})]}),description:e.jsxs(g,{direction:"vertical",size:0,children:[e.jsxs(Tl,{type:"secondary",children:["Endpoint: ",e.jsx(T,{color:"green",children:r.endpoint})]}),e.jsxs(Tl,{type:"secondary",children:["Bucket: ",e.jsx(T,{children:r.bucket})]})]}),type:"info",style:{marginBottom:16}}),e.jsx(xt,{orientation:"left",plain:!0,children:e.jsxs(g,{children:[e.jsx(Ea,{}),"ìƒˆ ì¸í”„ë¼ ì—°ê²°"]})}),x.length===0?e.jsx(xe,{message:"ì—°ê²° ê°€ëŠ¥í•œ ì¸í”„ë¼ê°€ ì—†ìŠµë‹ˆë‹¤",description:"ëª¨ë“  ì¸í”„ë¼ê°€ ì´ë¯¸ ì—°ê²°ë˜ì—ˆê±°ë‚˜, ë“±ë¡ëœ ì¸í”„ë¼ê°€ ì—†ìŠµë‹ˆë‹¤.",type:"warning",style:{marginBottom:16}}):e.jsxs(H,{form:c,layout:"vertical",children:[e.jsx(H.Item,{name:"infra_id",label:"ì¸í”„ë¼ ì„ íƒ",rules:[{required:!0,message:"ì¸í”„ë¼ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."}],children:e.jsx(Ee,{placeholder:"ì—°ê²°í•  ì¸í”„ë¼ë¥¼ ì„ íƒí•˜ì„¸ìš”",onChange:y=>S(y),children:x.map(y=>e.jsx(Rj,{value:y.id,children:e.jsxs(g,{children:[E(y.type),y.name,e.jsx(T,{color:k(y.type),children:y.type})]})},y.id))})}),L&&e.jsx(H.Item,{name:"bsl_name",label:"BackupStorageLocation ì´ë¦„",tooltip:"Veleroì—ì„œ ì‚¬ìš©í•  BSL ì´ë¦„ì…ë‹ˆë‹¤. ì˜ë¬¸ ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.",rules:[{required:!0,message:"BSL ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."},{pattern:/^[a-z0-9][a-z0-9-]*[a-z0-9]$/,message:"ì˜ë¬¸ ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."}],children:e.jsx(ue,{placeholder:"ì˜ˆ: production-minio-bsl"})}),e.jsx(H.Item,{name:"is_default",valuePropName:"checked",children:e.jsx(Vr,{children:"ì´ ì €ì¥ì†Œë¥¼ ê¸°ë³¸ ë°±ì—… ìœ„ì¹˜ë¡œ ì„¤ì •"})}),e.jsx(H.Item,{children:e.jsx(B,{type:"primary",icon:e.jsx(Ea,{}),onClick:P,loading:p||d,block:!0,children:"ì¸í”„ë¼ ì—°ê²°"})})]}),e.jsx(xt,{orientation:"left",plain:!0,children:e.jsxs(g,{children:[e.jsx(Ze,{style:{color:"#52c41a"}}),"ì—°ê²°ëœ ì¸í”„ë¼ (",a.length,"ê°œ)"]})}),a.length>0?e.jsx(wt,{dataSource:a,columns:$,rowKey:"id",size:"small",pagination:!1}):e.jsx(xe,{message:"ì—°ê²°ëœ ì¸í”„ë¼ê°€ ì—†ìŠµë‹ˆë‹¤",description:"ìœ„ì—ì„œ ì¸í”„ë¼ë¥¼ ì„ íƒí•˜ì—¬ ì´ ì €ì¥ì†Œì— ì—°ê²°í•˜ì„¸ìš”.",type:"info",showIcon:!0})]})})},{Panel:id}=nr,{Text:wn,Title:Mj}=we,Lj=({allBackups:s,onRestore:t,onDelete:r,onShowDetail:n,dockerBackups:a=[],dockerRestores:i=[],onRestoreDocker:l,onDeleteDocker:d,onShowDockerRestoreDetail:c,getStatusColor:p,getInstallStatusDisplay:h,selectedInfraName:x,selectedInfraType:_})=>{var u,m;const S=_==="docker"||_==="podman"||_==="external_docker"||_==="external_podman",L=o.useMemo(()=>{if(!S||a.length===0)return[];const j=new Map;return a.forEach(b=>{const A=b.containers||[],W=[...A].sort(),Z=A.length===0,se=Z?"full":W.join(",");let ce;Z?ce="ì „ì²´ ì»¨í…Œì´ë„ˆ":A.length===1?ce=A[0]:A.length<=3?ce=A.join(", "):ce=`${A.slice(0,2).join(", ")} ì™¸ ${A.length-2}ê°œ`,j.has(se)||j.set(se,{scopeKey:se,scopeLabel:ce,isFullBackup:Z,containers:W,backups:[],totalBackups:0,completedBackups:0,failedBackups:0,totalRestores:0});const D=i.filter(K=>K.backup_id===b.id),M=j.get(se);M.backups.push({backup:b,infraName:x||"",infraType:_||"",restores:D}),M.totalBackups++,M.totalRestores+=D.length,b.status==="completed"?M.completedBackups++:b.status==="failed"&&M.failedBackups++}),Array.from(j.values()).sort((b,A)=>b.isFullBackup?-1:A.isFullBackup?1:A.containers.length!==b.containers.length?A.containers.length-b.containers.length:b.scopeLabel.localeCompare(A.scopeLabel))},[a,i,S,x,_]),k=o.useMemo(()=>{if(S)return[];const j=new Map;return s.forEach(b=>{const A=b.backup.infra_id,W=b.backup.namespace;j.has(A)||j.set(A,{infraId:A,infraName:b.infraName,infraType:b.infraType,namespaces:[],totalBackups:0,totalNamespaces:0,containerScopes:[],totalScopes:0,installStatus:b.installStatus});const Z=j.get(A);let se=Z.namespaces.find(ce=>ce.namespace===W);se||(se={namespace:W,backups:[],totalBackups:0,completedBackups:0,failedBackups:0,totalRestores:0},Z.namespaces.push(se)),se.backups.push(b),se.totalBackups++,se.totalRestores+=b.restores.length,b.backup.status.toLowerCase()==="completed"?se.completedBackups++:b.backup.status.toLowerCase()==="failed"&&se.failedBackups++,Z.totalBackups++}),j.forEach(b=>{b.totalNamespaces=b.namespaces.length,b.namespaces.sort((A,W)=>A.namespace.localeCompare(W.namespace))}),Array.from(j.values()).sort((b,A)=>b.infraName.localeCompare(A.infraName))},[s,S]),E=[{title:"ë°±ì—… ì´ë¦„",dataIndex:["backup","name"],key:"name",render:j=>e.jsx(wn,{strong:!0,children:j})},{title:"ìƒíƒœ",dataIndex:["backup","status"],key:"status",width:100,render:j=>{const b={creating:"ìƒì„± ì¤‘",completed:"ì™„ë£Œ",failed:"ì‹¤íŒ¨",restoring:"ë³µêµ¬ ì¤‘",deleted:"ì‚­ì œë¨","in-progress":"ì§„í–‰ ì¤‘",partial:"ë¶€ë¶„ ì™„ë£Œ"};return e.jsx(T,{color:p(j),children:b[j==null?void 0:j.toLowerCase()]||j})}},{title:"ìƒì„±ì¼",dataIndex:["backup","created_at"],key:"created_at",width:180,render:j=>new Date(j).toLocaleString("ko-KR")},{title:"ë§Œë£Œì¼",dataIndex:["backup","expires_at"],key:"expires_at",width:130,render:j=>j?new Date(j).toLocaleDateString("ko-KR"):"-"},{title:"ë³µêµ¬ ì´ë ¥",dataIndex:"restores",key:"restores",width:100,render:(j,b)=>e.jsx("div",{children:j.length>0?e.jsx(B,{type:"link",size:"small",style:{padding:0,height:"auto"},onClick:()=>n({backupName:b.backup.name,backups:[b],totalRestores:j.length,lastRestoreDate:j.length>0?j[0].created_at:void 0}),children:e.jsxs(T,{color:"green",children:[j.length,"íšŒ"]})}):e.jsx(T,{color:"default",children:"0íšŒ"})})},{title:"ì‘ì—…",key:"actions",width:120,render:(j,b)=>e.jsxs(g,{size:"small",children:[e.jsx(Ie,{title:"ë³µêµ¬",children:e.jsx(B,{size:"small",icon:e.jsx(Gu,{}),onClick:()=>t(b.backup),disabled:b.backup.status.toLowerCase()!=="completed"})}),e.jsx(Ie,{title:"ì‚­ì œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),onClick:()=>r(b.backup)})})]})}],P=j=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[e.jsxs(g,{size:"middle",style:{flex:1},children:[e.jsx(Da,{style:{fontSize:16,color:"#1890ff"}}),e.jsx(wn,{strong:!0,style:{fontSize:15},children:j.namespace}),e.jsx(ps,{count:j.totalBackups,style:{backgroundColor:"#52c41a"}})]}),e.jsxs(g,{size:"large",onClick:b=>b.stopPropagation(),children:[e.jsx(Ie,{title:"ì™„ë£Œëœ ë°±ì—…",children:e.jsxs(g,{size:4,children:[e.jsx(Ze,{style:{color:"#52c41a"}}),e.jsx(wn,{type:"secondary",style:{fontSize:13},children:j.completedBackups})]})}),j.failedBackups>0&&e.jsx(Ie,{title:"ì‹¤íŒ¨í•œ ë°±ì—…",children:e.jsxs(g,{size:4,children:[e.jsx(Tr,{style:{color:"#ff4d4f"}}),e.jsx(wn,{type:"secondary",style:{fontSize:13},children:j.failedBackups})]})}),e.jsx(Ie,{title:"ì´ ë³µêµ¬ ì´ë ¥",children:e.jsxs(g,{size:4,children:[e.jsx(wr,{style:{color:"#1890ff"}}),e.jsxs(wn,{type:"secondary",style:{fontSize:13},children:[j.totalRestores,"íšŒ"]})]})})]})]}),I=[{title:"ë°±ì—… ì´ë¦„",dataIndex:["backup","name"],key:"name",render:j=>e.jsx(wn,{strong:!0,children:j})},{title:"ë°±ì—… ìœ í˜•",dataIndex:["backup","backup_type"],key:"backup_type",width:80,render:j=>{const A={full:{label:"ì „ì²´",color:"blue",icon:e.jsx(_s,{})},volume:{label:"ë³¼ë¥¨",color:"green",icon:e.jsx(Wo,{})},config:{label:"ì„¤ì •",color:"orange",icon:e.jsx(Pm,{})},compose:{label:"Compose",color:"purple",icon:e.jsx(Qr,{})}}[j]||{label:j,color:"default",icon:null};return e.jsx(T,{color:A.color,icon:A.icon,children:A.label})}},{title:"ìƒíƒœ",dataIndex:["backup","status"],key:"status",width:100,render:j=>{const b={creating:"processing",completed:"success",failed:"error",restoring:"warning",deleted:"default"},A={creating:"ìƒì„± ì¤‘",completed:"ì™„ë£Œ",failed:"ì‹¤íŒ¨",restoring:"ë³µêµ¬ ì¤‘",deleted:"ì‚­ì œë¨"};return e.jsx(T,{color:b[j]||"default",children:A[j]||j})}},{title:"í¬ê¸°",dataIndex:["backup","size_bytes"],key:"size_bytes",width:100,render:j=>{if(!j)return"-";const b=["B","KB","MB","GB"];let A=j,W=0;for(;A>=1024&&W<b.length-1;)A/=1024,W++;return`${A.toFixed(1)} ${b[W]}`}},{title:"ìƒì„±ì¼",dataIndex:["backup","created_at"],key:"created_at",width:160,render:j=>new Date(j).toLocaleString("ko-KR")},{title:"ë³µêµ¬ ì´ë ¥",dataIndex:"restores",key:"restores",width:100,render:(j,b)=>{const A=(j==null?void 0:j.length)||0,W=j==null?void 0:j[0],Z=j==null?void 0:j.some(D=>D.status==="failed"),se=j==null?void 0:j.some(D=>D.status==="in_progress"||D.status==="pending");let ce="default";return A>0&&(se?ce="processing":Z?ce="warning":ce="green"),e.jsx("div",{children:A>0?e.jsx(Ie,{title:W?`ìµœê·¼: ${new Date(W.created_at).toLocaleString("ko-KR")}`:void 0,children:e.jsx(B,{type:"link",size:"small",style:{padding:0,height:"auto"},onClick:()=>c==null?void 0:c(b.backup,j),children:e.jsxs(T,{color:ce,children:[A,"íšŒ"]})})}):e.jsx(T,{color:"default",children:"0íšŒ"})})}},{title:"ì‘ì—…",key:"actions",width:120,render:(j,b)=>e.jsxs(g,{size:"small",children:[e.jsx(Ie,{title:"ë³µêµ¬",children:e.jsx(B,{size:"small",icon:e.jsx(Gu,{}),onClick:()=>l==null?void 0:l(b.backup),disabled:b.backup.status!=="completed"})}),e.jsx(Ie,{title:"ì‚­ì œ",children:e.jsx(Kt,{title:"ë°±ì—…ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:"ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",onConfirm:()=>d==null?void 0:d(b.backup),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),disabled:b.backup.status==="creating"||b.backup.status==="restoring"})})})]})}],$=j=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[e.jsxs(g,{size:"middle",style:{flex:1},children:[j.isFullBackup?e.jsx(_s,{style:{fontSize:16,color:"#1890ff"}}):e.jsx(Qr,{style:{fontSize:16,color:"#13c2c2"}}),e.jsxs("div",{children:[e.jsx(wn,{strong:!0,style:{fontSize:15},children:j.scopeLabel}),!j.isFullBackup&&j.containers.length>3&&e.jsx("div",{children:e.jsx(Ie,{title:j.containers.join(", "),children:e.jsxs(wn,{type:"secondary",style:{fontSize:12,cursor:"pointer"},children:["ì»¨í…Œì´ë„ˆ ",j.containers.length,"ê°œ"]})})})]}),e.jsx(ps,{count:j.totalBackups,style:{backgroundColor:"#52c41a"}})]}),e.jsxs(g,{size:"large",onClick:b=>b.stopPropagation(),children:[e.jsx(Ie,{title:"ì™„ë£Œëœ ë°±ì—…",children:e.jsxs(g,{size:4,children:[e.jsx(Ze,{style:{color:"#52c41a"}}),e.jsx(wn,{type:"secondary",style:{fontSize:13},children:j.completedBackups})]})}),j.failedBackups>0&&e.jsx(Ie,{title:"ì‹¤íŒ¨í•œ ë°±ì—…",children:e.jsxs(g,{size:4,children:[e.jsx(Tr,{style:{color:"#ff4d4f"}}),e.jsx(wn,{type:"secondary",style:{fontSize:13},children:j.failedBackups})]})}),e.jsx(Ie,{title:"ì´ ë³µêµ¬ ì´ë ¥",children:e.jsxs(g,{size:4,children:[e.jsx(wr,{style:{color:"#1890ff"}}),e.jsxs(wn,{type:"secondary",style:{fontSize:13},children:[j.totalRestores,"íšŒ"]})]})})]})]}),y=j=>{const b=h(j.installStatus);return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[e.jsxs(g,{size:"large",style:{flex:1},children:[e.jsx(_t,{style:{fontSize:18,color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx(wn,{strong:!0,style:{fontSize:16},children:j.infraName}),e.jsx("div",{children:e.jsx(wn,{type:"secondary",style:{fontSize:12},children:j.infraType})})]}),e.jsx(T,{color:b.color,children:b.text})]}),e.jsxs(g,{size:"large",onClick:A=>A.stopPropagation(),children:[e.jsx($e,{title:j.infraType.includes("docker")||j.infraType.includes("podman")?"í”„ë¡œì íŠ¸":"ë„¤ì„ìŠ¤í˜ì´ìŠ¤",value:j.totalNamespaces||j.totalScopes,valueStyle:{fontSize:16,color:"#1890ff"}}),e.jsx($e,{title:"ì´ ë°±ì—…",value:j.totalBackups,valueStyle:{fontSize:16,color:"#52c41a"}})]})]})};if(S?L.length===0:k.length===0)return e.jsx(ie,{children:e.jsxs("div",{style:{textAlign:"center",padding:"40px 0"},children:[S?e.jsx(Qr,{style:{fontSize:48,color:"#d9d9d9",marginBottom:16}}):e.jsx(_t,{style:{fontSize:48,color:"#d9d9d9",marginBottom:16}}),e.jsx(Mj,{level:4,type:"secondary",children:"ë°±ì—…ì´ ì—†ìŠµë‹ˆë‹¤"}),e.jsx(wn,{type:"secondary",children:"ìƒˆ ë°±ì—…ì„ ìƒì„±í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”."})]})});if(S){const j=L.reduce((A,W)=>A+W.totalBackups,0),b=L.reduce((A,W)=>A+W.completedBackups,0);return e.jsxs("div",{style:{marginTop:16},children:[e.jsx(ie,{style:{marginBottom:16,background:"linear-gradient(135deg, #f5f7fa 0%, #f0f2f5 100%)",border:"1px solid #d9d9d9",borderRadius:8},bodyStyle:{padding:"16px 20px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(g,{size:"large",children:[e.jsx(Qr,{style:{fontSize:18,color:"#13c2c2"}}),e.jsxs("div",{children:[e.jsx(wn,{strong:!0,style:{fontSize:16},children:x}),e.jsx("div",{children:e.jsx(wn,{type:"secondary",style:{fontSize:12},children:_==="docker"||_==="external_docker"?"Docker":"Podman"})})]})]}),e.jsxs(g,{size:"large",children:[e.jsx($e,{title:"ì»¨í…Œì´ë„ˆ ê·¸ë£¹",value:L.length,valueStyle:{fontSize:16,color:"#1890ff"}}),e.jsx($e,{title:"ì´ ë°±ì—…",value:j,valueStyle:{fontSize:16,color:"#52c41a"}}),e.jsx($e,{title:"ì™„ë£Œ",value:b,valueStyle:{fontSize:16,color:"#52c41a"}})]})]})}),e.jsx(nr,{defaultActiveKey:(u=L[0])==null?void 0:u.scopeKey,expandIconPosition:"end",bordered:!1,className:"namespace-collapse",children:L.map(A=>e.jsx(id,{header:$(A),className:"namespace-panel",children:e.jsx(wt,{columns:I,dataSource:A.backups,rowKey:W=>`${W.backup.id}-${W.backup.created_at}`,pagination:!1,size:"small",bordered:!0})},A.scopeKey))})]})}return e.jsxs("div",{style:{marginTop:16},children:[e.jsx(nr,{defaultActiveKey:[(m=k[0])==null?void 0:m.infraId.toString()],expandIconPosition:"end",className:"infra-collapse",children:k.map(j=>{var b;return e.jsx(id,{header:y(j),className:"infra-panel",children:e.jsx(nr,{defaultActiveKey:(b=j.namespaces[0])==null?void 0:b.namespace,expandIconPosition:"end",bordered:!1,className:"namespace-collapse",children:j.namespaces.map(A=>e.jsx(id,{header:P(A),className:"namespace-panel",children:e.jsx(wt,{columns:E,dataSource:A.backups,rowKey:W=>W.backup.name+W.backup.created_at,pagination:!1,size:"small",bordered:!0})},A.namespace))})},j.infraId.toString())})}),e.jsx("style",{children:`
        .infra-collapse .infra-panel {
          margin-bottom: 16px;
          border: 1px solid #d9d9d9;
          border-radius: 8px;
          overflow: hidden;
        }

        .infra-collapse .infra-panel > .ant-collapse-header {
          padding: 16px 20px;
          background: linear-gradient(135deg, #f5f7fa 0%, #f0f2f5 100%);
          border-bottom: 1px solid #d9d9d9;
        }

        .infra-collapse .infra-panel > .ant-collapse-header:hover {
          background: linear-gradient(135deg, #e8eef5 0%, #e3e6eb 100%);
        }

        .namespace-collapse {
          background: #fafafa;
        }

        .namespace-collapse .namespace-panel {
          margin-bottom: 8px;
          background: white;
          border: 1px solid #e8e8e8;
          border-radius: 4px;
        }

        .namespace-collapse .namespace-panel > .ant-collapse-header {
          padding: 12px 16px;
          background: white;
        }

        .namespace-collapse .namespace-panel > .ant-collapse-header:hover {
          background: #f5f5f5;
        }

        .namespace-collapse .ant-collapse-content {
          border-top: 1px solid #e8e8e8;
        }

        .ant-statistic-title {
          font-size: 12px;
          margin-bottom: 2px;
        }
      `})]})},{TabPane:Rl}=xs,{Text:no}=we,Aj=({selectedInfraId:s,selectedInfra:t,backups:r,restores:n,installStatus:a,isLoadingStatus:i,pollingRestoreId:l,getBackupStatusDisplay:d,getRestoreStatusDisplay:c,onDeleteBackup:p,onRestoreBackup:h,onRefreshStatus:x,infrastructures:_,dockerBackups:S=[],dockerRestores:L=[],onDeleteDockerBackup:k,onRestoreDockerBackup:E,onShowDockerRestoreDetail:P,externalStorages:I=[],selectedInfraStorageMappings:$=[],onOpenExternalStorageModal:y,onDeleteExternalStorage:v,onOpenInfraLinkModal:u,onRefreshExternalStorages:m})=>{var J,te,G,q,oe,be;const j=(t==null?void 0:t.type)==="kubernetes"||(t==null?void 0:t.type)==="external_kubernetes",b=(t==null?void 0:t.type)==="docker"||(t==null?void 0:t.type)==="podman"||(t==null?void 0:t.type)==="external_docker"||(t==null?void 0:t.type)==="external_podman",A=ne=>d(ne.toLowerCase()).color,W=ne=>{var ye,Ue;return ne?(ye=ne.summary)!=null&&ye.can_create_backup?{color:"success",text:"ì—°ê²°ë¨"}:(Ue=ne.velero)!=null&&Ue.installed?{color:"warning",text:"ì„¤ì • í•„ìš”"}:{color:"default",text:"ë¯¸ì—°ê²°"}:{color:"default",text:"í™•ì¸ ë¶ˆê°€"}},Z=r.map(ne=>({backup:ne,infraName:(t==null?void 0:t.name)||"",infraType:(t==null?void 0:t.type)||"",restores:n.filter(ye=>ye.backup_name===ne.name),installStatus:a})),se=[{title:"ë°±ì—…ëª…",dataIndex:"backup_name",key:"backup_name",width:200,render:ne=>e.jsx(no,{strong:!0,style:{fontSize:"14px"},children:ne})},{title:"ë³µêµ¬ ëŒ€ìƒ",dataIndex:"restore_namespaces",key:"restore_namespaces",width:150,render:ne=>e.jsx(g,{wrap:!0,size:4,children:ne==null?void 0:ne.map(ye=>e.jsx(T,{color:"green",style:{fontSize:"12px"},children:ye},ye))})},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:100,render:(ne,ye)=>{const Ue=c(ne),N=l===ye.id;return e.jsx(T,{color:Ue.color,children:N?"ì—…ë°ì´íŠ¸ ì¤‘...":Ue.text})}},{title:"ë³µêµ¬ ì‹œì‘ì‹œê°„",dataIndex:"created_at",key:"created_at",width:140,render:ne=>hr(ne).format("YYYY-MM-DD HH:mm")},{title:"ë³µêµ¬ ì™„ë£Œì‹œê°„",dataIndex:"completed_at",key:"completed_at",width:140,render:ne=>ne?hr(ne).format("YYYY-MM-DD HH:mm"):"-"}],ce=ne=>{const ye=S.find(Ue=>Ue.id===ne);return(ye==null?void 0:ye.name)||`ë°±ì—… #${ne}`},D=[{title:"ë°±ì—…ëª…",dataIndex:"backup_id",key:"backup_name",width:200,render:ne=>e.jsx(no,{strong:!0,style:{fontSize:"14px"},children:ce(ne)})},{title:"ë³µêµ¬ ì˜µì…˜",key:"restore_options",width:150,render:(ne,ye)=>e.jsxs(g,{wrap:!0,size:4,children:[ye.restore_volumes&&e.jsx(T,{color:"blue",children:"ë³¼ë¥¨"}),ye.restore_config&&e.jsx(T,{color:"cyan",children:"ì„¤ì •"}),ye.redeploy&&e.jsx(T,{color:"purple",children:"ì¬ë°°í¬"})]})},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:100,render:ne=>{const Ue={completed:{color:"success",text:"ì™„ë£Œ"},failed:{color:"error",text:"ì‹¤íŒ¨"},in_progress:{color:"processing",text:"ì§„í–‰ì¤‘"},pending:{color:"warning",text:"ëŒ€ê¸°ì¤‘"}}[ne]||{color:"default",text:ne};return e.jsx(T,{color:Ue.color,children:Ue.text})}},{title:"ì˜¤ë¥˜ ë©”ì‹œì§€",dataIndex:"error_message",key:"error_message",width:200,render:ne=>ne?e.jsx(no,{type:"danger",style:{fontSize:"12px"},children:ne}):"-"},{title:"ë³µêµ¬ ì‹œì‘ì‹œê°„",dataIndex:"created_at",key:"created_at",width:150,render:ne=>hr(ne).format("YYYY-MM-DD HH:mm")},{title:"ë³µêµ¬ ì™„ë£Œì‹œê°„",dataIndex:"completed_at",key:"completed_at",width:150,render:ne=>ne?hr(ne).format("YYYY-MM-DD HH:mm"):"-"}],M=ne=>e.jsx("div",{className:"empty-status",children:e.jsxs("div",{className:"status-message",children:[e.jsx(Ks,{style:{fontSize:"24px",color:"#1890ff",marginBottom:"16px"}}),e.jsx("h3",{children:"ì¸í”„ë¼ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}),e.jsxs("p",{children:["ìƒë‹¨ì—ì„œ ì¸í”„ë¼ë¥¼ ì„ íƒí•˜ë©´ í•´ë‹¹ ì¸í”„ë¼ì˜"," ",ne==="backup"?"ë°±ì—…":"ë³µêµ¬"," ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]})]})}),K=()=>s?e.jsx(Lj,{allBackups:Z,dockerBackups:S,dockerRestores:L,onRestore:h,onDelete:p,onRestoreDocker:E,onDeleteDocker:k,onShowDetail:()=>{},onShowDockerRestoreDetail:P,getStatusColor:A,getInstallStatusDisplay:W,selectedInfraName:t==null?void 0:t.name,selectedInfraType:t==null?void 0:t.type}):M("backup");return e.jsxs(xs,{defaultActiveKey:"1",children:[e.jsxs(Rl,{tab:e.jsxs("span",{children:[e.jsx(mo,{})," ë°±ì—… ëª©ë¡"]}),children:[s&&j&&e.jsx("div",{className:"backup-header",style:{marginBottom:"16px"},children:e.jsxs(Se,{bordered:!0,size:"small",column:4,children:[e.jsx(Se.Item,{label:"ì¸í”„ë¼ íƒ€ì…",children:e.jsx(T,{color:"blue",children:"K8s"})}),e.jsx(Se.Item,{label:"ë°±ì—… í˜„í™©",children:e.jsxs(g,{children:[e.jsx(Ie,{title:"ì „ì²´ ë°±ì—…",children:e.jsxs(T,{color:"blue",children:[r.length,"ê°œ"]})}),e.jsx(Ie,{title:"ì™„ë£Œ",children:e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:r.filter(ne=>{var ye;return((ye=ne.status)==null?void 0:ye.toLowerCase())==="completed"}).length})}),r.filter(ne=>{var ye;return((ye=ne.status)==null?void 0:ye.toLowerCase())==="failed"}).length>0&&e.jsx(Ie,{title:"ì‹¤íŒ¨",children:e.jsx(T,{color:"error",icon:e.jsx(Es,{}),children:r.filter(ne=>{var ye;return((ye=ne.status)==null?void 0:ye.toLowerCase())==="failed"}).length})})]})}),e.jsx(Se.Item,{label:"ë³µêµ¬ ì´ë ¥",children:e.jsxs(g,{children:[e.jsx(Ie,{title:"ì „ì²´ ë³µêµ¬",children:e.jsxs(T,{color:"cyan",children:[n.length,"ê±´"]})}),n.filter(ne=>{var ye;return((ye=ne.status)==null?void 0:ye.toLowerCase())==="completed"}).length>0&&e.jsx(Ie,{title:"ì„±ê³µ",children:e.jsx(T,{color:"success",children:n.filter(ne=>{var ye;return((ye=ne.status)==null?void 0:ye.toLowerCase())==="completed"}).length})})]})}),e.jsx(Se.Item,{label:"ë°±ì—… ê°€ëŠ¥ ì—¬ë¶€",children:e.jsx(T,{color:(J=a==null?void 0:a.summary)!=null&&J.can_create_backup||(te=a==null?void 0:a.summary)!=null&&te.has_external_storage||(G=a==null?void 0:a.external_storage)!=null&&G.connected?"success":"warning",children:(q=a==null?void 0:a.summary)!=null&&q.can_create_backup||(oe=a==null?void 0:a.summary)!=null&&oe.has_external_storage||(be=a==null?void 0:a.external_storage)!=null&&be.connected?"ê°€ëŠ¥":"ì„¤ì • í•„ìš”"})})]})}),s&&b&&e.jsx("div",{className:"backup-header",style:{marginBottom:"16px"},children:e.jsxs(Se,{bordered:!0,size:"small",column:4,children:[e.jsx(Se.Item,{label:"ì¸í”„ë¼ íƒ€ì…",children:e.jsx(T,{color:"blue",children:(t==null?void 0:t.type)==="podman"||(t==null?void 0:t.type)==="external_podman"?"Podman":"Docker"})}),e.jsx(Se.Item,{label:"ë°±ì—… í˜„í™©",children:e.jsxs(g,{children:[e.jsx(Ie,{title:"ì „ì²´ ë°±ì—…",children:e.jsxs(T,{color:"blue",children:[S.length,"ê°œ"]})}),e.jsx(Ie,{title:"ì™„ë£Œ",children:e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:S.filter(ne=>ne.status==="completed").length})}),S.filter(ne=>ne.status==="failed").length>0&&e.jsx(Ie,{title:"ì‹¤íŒ¨",children:e.jsx(T,{color:"error",icon:e.jsx(Es,{}),children:S.filter(ne=>ne.status==="failed").length})})]})}),e.jsx(Se.Item,{label:"ë³µêµ¬ ì´ë ¥",children:e.jsxs(g,{children:[e.jsx(Ie,{title:"ì „ì²´ ë³µêµ¬",children:e.jsxs(T,{color:"cyan",children:[L.length,"ê±´"]})}),L.filter(ne=>ne.status==="completed").length>0&&e.jsx(Ie,{title:"ì„±ê³µ",children:e.jsx(T,{color:"success",children:L.filter(ne=>ne.status==="completed").length})})]})}),e.jsx(Se.Item,{label:"ë°±ì—… ê°€ëŠ¥ ì—¬ë¶€",children:e.jsx(T,{color:"success",children:"ê°€ëŠ¥"})})]})}),K()]},"1"),e.jsx(Rl,{tab:e.jsxs("span",{children:[e.jsx(hu,{})," ë³µêµ¬ ì´ë ¥"," ",b&&L.length>0&&`(${L.length})`,j&&n.length>0&&`(${n.length})`]}),children:s?b?e.jsx(wt,{columns:D,dataSource:L,rowKey:"id",pagination:{pageSize:10},size:"small",locale:{emptyText:"Docker ë³µêµ¬ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤."}}):e.jsx(wt,{columns:se,dataSource:n,rowKey:"id",pagination:{pageSize:10},size:"small",locale:{emptyText:"Kubernetes ë³µêµ¬ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤."}}):M("restore")},"2"),e.jsx(Rl,{tab:e.jsxs("span",{children:[e.jsx(rn,{})," ì„¤ì • ìƒíƒœ"]}),children:e.jsx(wj,{selectedInfraId:s,selectedInfra:t,infrastructures:_,installStatus:a,isLoadingStatus:i,externalStorages:I,selectedInfraStorageMappings:$,onRefresh:s?()=>x(Number(s)):void 0})},"3"),e.jsxs(Rl,{tab:e.jsxs("span",{children:[e.jsx(_t,{})," ì €ì¥ì†Œ ê´€ë¦¬",I.length>0&&e.jsx(ps,{count:I.length,style:{marginLeft:8,backgroundColor:"#1890ff"}})]}),children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(no,{type:"secondary",children:"ì™¸ë¶€ ì €ì¥ì†Œë¥¼ ë“±ë¡í•˜ê³  ì¸í”„ë¼ì— ì—°ê²°í•˜ì—¬ ë°±ì—… ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),e.jsxs(g,{children:[e.jsx(B,{icon:e.jsx(zs,{}),onClick:m,children:"ìƒˆë¡œê³ ì¹¨"}),e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:y,children:"ì €ì¥ì†Œ ì¶”ê°€"})]})]}),e.jsx(xt,{orientation:"left",children:e.jsxs(g,{children:[e.jsx(_t,{}),"ì™¸ë¶€ ì €ì¥ì†Œ ì„œë²„",e.jsx(ps,{count:I.length,style:{backgroundColor:"#1890ff"}})]})}),I.length>0?e.jsx(wt,{dataSource:I,rowKey:"id",pagination:!1,size:"small",columns:[{title:"ì €ì¥ì†Œ ì´ë¦„",dataIndex:"name",key:"name",render:(ne,ye)=>e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx(no,{strong:!0,children:ne}),e.jsx(T,{color:ye.type==="minio"?"purple":ye.type==="s3"?"orange":"default",children:ye.type.toUpperCase()})]})},{title:"Endpoint",dataIndex:"endpoint",key:"endpoint",render:ne=>e.jsx(T,{color:"green",children:ne})},{title:"Bucket",dataIndex:"bucket",key:"bucket"},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:80,render:ne=>{const Ue={active:{color:"success",text:"í™œì„±",icon:e.jsx(Ze,{})},inactive:{color:"default",text:"ë¹„í™œì„±",icon:e.jsx(xo,{})},error:{color:"error",text:"ì˜¤ë¥˜",icon:e.jsx(Es,{})}}[ne]||{color:"default",text:ne,icon:null};return e.jsx(T,{color:Ue.color,icon:Ue.icon,children:Ue.text})}},{title:"ë“±ë¡ì¼",dataIndex:"created_at",key:"created_at",width:120,render:ne=>hr(ne).format("YYYY-MM-DD")},{title:"ì‘ì—…",key:"action",width:120,render:(ne,ye)=>e.jsxs(g,{children:[e.jsx(Ie,{title:"ì¸í”„ë¼ ì—°ê²° ê´€ë¦¬",children:e.jsx(B,{size:"small",icon:e.jsx(Ea,{}),onClick:()=>u==null?void 0:u(ye)})}),e.jsx(Kt,{title:"ì €ì¥ì†Œ ì‚­ì œ",description:"ì´ ì™¸ë¶€ ì €ì¥ì†Œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>v==null?void 0:v(ye.id),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{})})})]})}]}):e.jsx(Je,{description:e.jsxs("span",{children:["ë“±ë¡ëœ ì™¸ë¶€ ì €ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤",e.jsx("br",{}),e.jsx(no,{type:"secondary",children:"ìƒë‹¨ì˜ 'ì €ì¥ì†Œ ì¶”ê°€' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì™¸ë¶€ ì €ì¥ì†Œë¥¼ ë“±ë¡í•˜ì„¸ìš”"})]}),style:{padding:"24px 0"},children:e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:y,children:"ì²« ë²ˆì§¸ ì €ì¥ì†Œ ë“±ë¡í•˜ê¸°"})})]},"4")]})},{Option:Nj}=Ee,Bj=()=>{const[s,t]=o.useState([]),[r,n]=o.useState([]),[a,i]=o.useState(null),[l,d]=o.useState([]),[c,p]=o.useState([]),[h,x]=o.useState(void 0),[_,S]=o.useState(!1),[L,k]=o.useState(!1),[E,P]=o.useState(!1),[I,$]=o.useState(!1),[y,v]=o.useState(null),[u,m]=o.useState([]),[j,b]=o.useState(!1),[A,W]=o.useState(!1),[Z,se]=o.useState(!1),[ce,D]=o.useState(!1),[M,K]=o.useState([]),[J,te]=o.useState([]),[G,q]=o.useState([]),[oe,be]=o.useState(!1),[ne,ye]=o.useState(null),[Ue,N]=o.useState([]),[ge,Ce]=o.useState([]),[je,Pe]=o.useState(!1),[w,R]=o.useState(!1),[U,V]=o.useState(!1),[F,X]=o.useState(null),[de,Ne]=o.useState([]),[ae,pe]=o.useState(!1),[Xe,Nt]=o.useState([]),Fe=o.useCallback(async fe=>{try{const Be=await Ng(fe);K(Be)}catch(Be){}},[]),Le=o.useCallback(async fe=>{try{const Be=await Dg(fe);te(Be)}catch(Be){}},[]),Oe=o.useCallback(async()=>{try{const fe=await ga.listExternalStorages();fe.success&&fe.data&&Ce(fe.data)}catch(fe){console.error("ì™¸ë¶€ ì €ì¥ì†Œ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",fe)}},[]),Mt=o.useCallback(async fe=>{try{const Be=await ga.getInfraStorageMappings(fe);Be.success&&Be.data?Nt(Be.data):Nt([])}catch(Be){console.error("ì¸í”„ë¼ ì €ì¥ì†Œ ë§¤í•‘ ë¡œë“œ ì‹¤íŒ¨:",Be),Nt([])}},[]),Ve=async fe=>{var Be;R(!0);try{const dt=await ga.createExternalStorage({name:fe.name,description:fe.description,type:fe.type,endpoint:fe.endpoint,access_key:fe.accessKey,secret_key:fe.secretKey,bucket:fe.bucket,region:fe.region,use_ssl:(Be=fe.useSSL)!=null?Be:!0,ssh_enabled:fe.sshEnabled,ssh_gateway_host:fe.sshGatewayHost,ssh_gateway_port:fe.sshGatewayPort,ssh_gateway_user:fe.sshGatewayUser,ssh_gateway_password:fe.sshGatewayPassword,ssh_target_host:fe.sshTargetHost,ssh_target_port:fe.sshTargetPort,ssh_target_user:fe.sshTargetUser,ssh_target_password:fe.sshTargetPassword});if(dt.success)Pe(!1),await Oe(),f.success("ì™¸ë¶€ ì €ì¥ì†Œê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");else throw new Error(dt.error||"ì €ì¥ì†Œ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(dt){f.error(`ì €ì¥ì†Œ ë“±ë¡ ì‹¤íŒ¨: ${dt instanceof Error?dt.message:String(dt)}`)}finally{R(!1)}},Me=async fe=>{try{const Be=await ga.deleteExternalStorage(fe);if(Be.success)await Oe(),f.success("ì™¸ë¶€ ì €ì¥ì†Œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");else throw new Error(Be.error||"ì €ì¥ì†Œ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(Be){f.error(`ì €ì¥ì†Œ ì‚­ì œ ì‹¤íŒ¨: ${Be instanceof Error?Be.message:String(Be)}`)}},ot=async fe=>{X(fe),V(!0),pe(!0);try{const Be=Ge.map(ns=>ns.id);if(Be.length===0){Ne([]);return}const dt=await ga.getBatchInfraStorageMappings(Be);if(dt.success&&dt.data){const ns=[];Object.values(dt.data).forEach(Ds=>{const hn=Ds.filter(Ar=>Ar.external_storage_id===fe.id);ns.push(...hn)}),Ne(ns)}else Ne([])}catch(Be){console.error("ì—°ê²°ëœ ì¸í”„ë¼ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",Be)}finally{pe(!1)}},Bt=async fe=>{try{(await ga.linkInfraToExternalStorage({infra_id:fe.infra_id,external_storage_id:fe.external_storage_id,bsl_name:fe.bsl_name,is_default:fe.is_default})).success&&(f.success("ì¸í”„ë¼ê°€ ì €ì¥ì†Œì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤."),F&&await ot(F))}catch(Be){f.error(`ì¸í”„ë¼ ì—°ê²° ì‹¤íŒ¨: ${Be instanceof Error?Be.message:String(Be)}`)}},Ps=async(fe,Be)=>{try{(await ga.unlinkInfraFromExternalStorage(fe,Be)).success&&(f.success("ì¸í”„ë¼ ì—°ê²°ì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤."),Ne(ns=>ns.filter(Ds=>Ds.infra_id!==fe)))}catch(dt){f.error(`ì—°ê²° í•´ì œ ì‹¤íŒ¨: ${dt instanceof Error?dt.message:String(dt)}`)}},{isLoading:ir,isLoadingStatus:Ut,infrastructures:Ge,selectedInfra:et,servers:tt,loadServers:Vt,loadBackups:lt,loadRestores:Rt,loadBackupStatus:St,getMasterNodeHops:ms,fetchNamespaces:Ts,createBackup:ds,deleteBackup:fs,restoreBackup:Cs,installBackupSystem:gr,startBackupEnvironmentSetup:Rr}=pj({selectedInfraId:h,onBackupsUpdate:t,onRestoresUpdate:n,onInstallStatusUpdate:i,onMinioStoragesUpdate:d,onNamespacesUpdate:p});(et==null?void 0:et.type)==="kubernetes"||(et==null||et.type);const Ss=(et==null?void 0:et.type)==="docker"||(et==null?void 0:et.type)==="external_docker"||(et==null?void 0:et.type)==="podman"||(et==null?void 0:et.type)==="external_podman",{pollingRestoreId:Rn,getBackupStatusDisplay:fn,getRestoreStatusDisplay:Os,startJobPolling:Ms}=hj({backups:s,restores:r}),{requestNamespaceAuth:Ht,requestSetupAuth:Dt,AuthModal:zr}=ej({onAuthSuccess:nn,onAuthCancel:zn});function nn(fe,Be,dt){switch(Be){case"namespace":ys(fe);break;case"setup":Jt(fe,dt);break;case"backup":an(fe,dt);break;case"delete":dn(fe,dt);break}}function zn(){f.info("ì¸ì¦ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.")}const Ys=async fe=>{if(x(fe),fe&&localStorage.setItem("backup_last_selected_infra",fe),fe){const Be=Number(fe);p([]),v(null),K([]),q([]),Nt([]);const dt=Ge.find(ns=>ns.id===Be);await Vt(Be),await Mt(Be),(dt==null?void 0:dt.type)==="docker"||(dt==null?void 0:dt.type)==="podman"||(dt==null?void 0:dt.type)==="external_docker"||(dt==null?void 0:dt.type)==="external_podman"?await Promise.all([Fe(Be),Le(Be)]):await Promise.all([lt(Be),Rt(Be),St(Be)])}},En=o.useRef(!1);o.useEffect(()=>{if(!En.current&&Ge.length>0&&!h){En.current=!0;const fe=localStorage.getItem("backup_last_selected_infra"),Be=fe?Ge.find(ns=>String(ns.id)===fe):null,dt=String(Be?Be.id:Ge[0].id);Ys(dt)}},[Ge]),o.useEffect(()=>{Oe()},[Oe]);const Pn=Ct.useCallback(async()=>{if(!h||!Ss)return[];try{const fe=tt.find(dt=>dt.infra_id===Number(h));return fe!=null&&fe.hops?(typeof fe.hops=="string"?JSON.parse(fe.hops):fe.hops)||[]:[]}catch(fe){return[]}},[h,Ss,tt]),Mr=async()=>{h&&await Promise.all([Fe(Number(h)),Le(Number(h))])},Lr=async fe=>{try{const Be=await Pn();await $g(fe.id,Be,!0),f.success("ë°±ì—…ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),await Mr()}catch(Be){f.error(`ë°±ì—… ì‚­ì œ ì‹¤íŒ¨: ${Be instanceof Error?Be.message:String(Be)}`)}},Xn=async fe=>{if(h)try{const Be={id:fe.id,name:fe.name,infra_id:fe.infra_id,namespace:fe.compose_project||"",status:fe.status==="completed"?"Completed":fe.status==="failed"?"Failed":fe.status==="creating"?"InProgress":"Completed",error:fe.error_message,size:fe.size_bytes?`${(fe.size_bytes/1024/1024).toFixed(2)} MB`:void 0,created_at:fe.created_at,completed_at:fe.completed_at},ns=(await Pn()).map(Ds=>({ip:Ds.host,host:Ds.host,port:Ds.port,username:Ds.username,password:Ds.password}));v(Be),m(ns),$(!0)}catch(Be){f.error(`ë³µêµ¬ ì¤€ë¹„ ì‹¤íŒ¨: ${Be instanceof Error?Be.message:String(Be)}`)}},ea=(fe,Be)=>{ye(fe),N(Be),be(!0)},or=async()=>{const fe=et==null?void 0:et.type;if(fe==="docker"||fe==="external_docker"||fe==="podman"||fe==="external_podman"){if(!h){console.warn("[BackupManageNew] selectedInfraId is not set"),f.warning("ì¸í”„ë¼ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.");return}try{const Be=await Pn();q(Be),D(!0)}catch(Be){console.error("[BackupManageNew] Failed to get Docker SSH hops:",Be),f.error("SSH ì—°ê²° ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}}else k(!0)},ss=async fe=>{try{x(String(fe)),await Vt(fe)}catch(Be){console.error("[BackupManageNew] loadServers failed:",Be)}S(!0)},rs=async fe=>{if(!h)return;v(fe);const Be=await ms(Number(h));Be.length>0?Dt(Be,"delete",fe):P(!0)},Hn=async fe=>{if(!h)return;v(fe);const Be=await ms(Number(h));m(Be),$(!0)},yn=async fe=>{const Be=fe||(h?Number(h):null);if(!Be){f.error("ë¨¼ì € ì¸í”„ë¼ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}tt.length===0&&await Vt(Be);const dt=await ms(Be);dt.length>0?Ht(dt,"namespace"):f.info('ë§ˆìŠ¤í„° ë…¸ë“œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. "ì§ì ‘ SSH ì…ë ¥" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ SSH ì ‘ì† ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.')},cn=async(fe,Be)=>{try{const dt=Be.map(ns=>({host:ns.host,port:ns.port,username:ns.username,password:ns.password}));await Ts(fe,dt),f.success("ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ëª©ë¡ì„ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.")}catch(dt){f.error(`ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì¡°íšŒ ì‹¤íŒ¨: ${dt instanceof Error?dt.message:String(dt)}`)}};async function ys(fe){if(h)try{await Ts(Number(h),fe),k(!0)}catch(Be){f.error("ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ëª©ë¡ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}}async function Jt(fe,Be){if(!(!Be.storageInfra||!Be.storageServer))try{const dt=tt.find(Ar=>Ar.id===Be.storageServer),ns=dt?typeof dt.hops=="string"?JSON.parse(dt.hops):dt.hops||[]:[],hn=((Ar,Nr)=>Ar.map((Mn,jn)=>({host:Mn.host,port:Mn.port,username:Be[`${Nr}_ssh_username_${jn}`],password:Be[`${Nr}_ssh_password_${jn}`]})))(ns,"minio");await gr({mode:"minio",formData:Be,minioAuthData:hn}),S(!1),f.info("MinIO ì„¤ì¹˜ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì™„ë£Œë˜ë©´ Velero ì„¤ì¹˜ê°€ ìë™ìœ¼ë¡œ ì‹œì‘ë©ë‹ˆë‹¤.")}catch(dt){}}async function an(fe,Be){try{b(!0),await ds({...Be,auth_data:fe}),k(!1)}catch(dt){f.error("ë°±ì—… ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{b(!1)}}async function dn(fe,Be){try{W(!0),await fs(Be,fe),P(!1)}catch(dt){f.error("ë°±ì—… ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{W(!1)}}const un=Ss?M.length:s.length,nt=Ss?M.filter(fe=>fe.status==="completed").length:s.filter(fe=>fe.status==="Completed").length,Gt=Ss?J.filter(fe=>fe.status==="completed").length:r.filter(fe=>fe.status==="Completed").length;return e.jsxs("div",{className:"backup-manage management-page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"page-header-title",children:[e.jsx(pr,{style:{fontSize:24,color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx("h1",{children:"ë°±ì—… ê´€ë¦¬"}),e.jsx("div",{className:"page-header-description",children:"ì¸í”„ë¼ ë°±ì—… ë° ë³µì›ì„ ê´€ë¦¬í•©ë‹ˆë‹¤"})]})]}),e.jsxs("div",{className:"page-header-actions",children:[e.jsx(Ee,{placeholder:"ì¸í”„ë¼ ì„ íƒ",style:{width:250},onChange:Ys,value:h||null,children:Ge.map(fe=>{const dt={kubernetes:"[K8s]",external_kubernetes:"[K8s]",docker:"[Docker]",external_docker:"[Docker]",podman:"[Podman]",external_podman:"[Podman]"}[fe.type]||`[${fe.type}]`;return e.jsxs(Nj,{value:String(fe.id),children:[dt," ",fe.name]},fe.id)})}),e.jsx(B,{icon:e.jsx(zs,{}),onClick:()=>{h&&(lt(Number(h)),Rt(Number(h)),St(Number(h)))},loading:ir,children:"ìƒˆë¡œê³ ì¹¨"}),e.jsxs(B,{type:"primary",onClick:or,disabled:!h,children:[e.jsx(Ui,{})," ìƒˆ ë°±ì—… ìƒì„±"]})]})]}),e.jsxs(Ke,{gutter:16,className:"stats-row",children:[e.jsx(Y,{xs:24,sm:8,children:e.jsx("div",{className:"stat-card",children:e.jsxs(g,{align:"start",children:[e.jsx("div",{className:"stat-card-icon blue",children:e.jsx(_s,{})}),e.jsx($e,{title:"ì „ì²´ ë°±ì—…",value:un,suffix:"ê°œ"})]})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx("div",{className:"stat-card",children:e.jsxs(g,{align:"start",children:[e.jsx("div",{className:"stat-card-icon green",children:e.jsx(Ze,{})}),e.jsx($e,{title:"ì„±ê³µí•œ ë°±ì—…",value:nt,suffix:`/ ${un}`})]})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx("div",{className:"stat-card",children:e.jsxs(g,{align:"start",children:[e.jsx("div",{className:"stat-card-icon orange",children:e.jsx(pr,{})}),e.jsx($e,{title:"ë³µì› ì™„ë£Œ",value:Gt,suffix:"ê±´"})]})})})]}),e.jsx(ie,{className:"main-card",children:e.jsx(Aj,{selectedInfraId:h,selectedInfra:et,backups:s,restores:r,installStatus:a,isLoadingStatus:Ut,pollingRestoreId:Rn,getBackupStatusDisplay:fn,getRestoreStatusDisplay:Os,onDeleteBackup:rs,onRestoreBackup:Hn,onRefreshStatus:St,infrastructures:Ge,dockerBackups:M,dockerRestores:J,onDeleteDockerBackup:Lr,onRestoreDockerBackup:Xn,onShowDockerRestoreDetail:ea,externalStorages:ge,selectedInfraStorageMappings:Xe,onOpenExternalStorageModal:()=>Pe(!0),onDeleteExternalStorage:Me,onOpenInfraLinkModal:ot,onRefreshExternalStorages:Oe})}),e.jsx(zr,{}),e.jsx(Tj,{visible:_,servers:tt,onCancel:()=>S(!1),onSubmit:()=>{S(!1),h&&St(Number(h))},infrastructures:Ge,allMinioStorages:l,selectedInfraId:h,onStorageInfraChange:fe=>{Vt(fe)},onStartInstallation:async fe=>{try{const Be=await Rr(fe);Be&&(Ms(Be),S(!1))}catch(Be){}}}),e.jsx(mj,{visible:L,onCancel:()=>k(!1),onSubmit:async fe=>{try{if(b(!0),fe.infraType==="kubernetes"||fe.infraType==="external_kubernetes"){const Be=await ms(fe.infraId),dt={infra_id:fe.infraId,name:fe.backupName,namespace:fe.namespace||"",selector:fe.selector,schedule:fe.schedule,retention:fe.retention,storage_type:fe.storageType,storage_id:fe.storageId,external_storage_id:fe.externalStorageId};Be.length>0?Ht(Be,"backup",dt):fe.sshCredentials&&fe.sshCredentials.length>0?(await ds({...dt,auth_data:fe.sshCredentials.map(ns=>({host:ns.host,port:ns.port,username:ns.username,password:ns.password}))}),f.success("K8s ë°±ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."),k(!1)):(await ds(dt),f.success("K8s ë°±ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."),k(!1))}else if(fe.infraType==="docker"||fe.infraType==="podman"||fe.infraType==="external_docker"||fe.infraType==="external_podman"){const{createDockerBackup:Be}=await vn(async()=>{const{createDockerBackup:Ds}=await Promise.resolve().then(()=>ry);return{createDockerBackup:Ds}},void 0),dt=(fe.sshCredentials||[]).map(Ds=>({host:Ds.host,port:Ds.port||22,username:Ds.username,password:Ds.password}));await Be({infra_id:fe.infraId,hops:dt,name:fe.backupName,backup_type:fe.backupType||"full",trigger_type:"manual",compose_project:fe.composeProject,storage_type:fe.storageType||"local",storage_id:fe.storageId,external_storage_id:fe.externalStorageId});const ns=fe.storageType==="minio"?" (ì¤‘ì•™ ì €ì¥ì†Œ)":" (ë¡œì»¬)";f.success(`Docker ë°±ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤${ns}`),k(!1),await Fe(fe.infraId)}h&&lt(Number(h))}catch(Be){f.error(`ë°±ì—… ìƒì„± ì‹¤íŒ¨: ${Be instanceof Error?Be.message:String(Be)}`)}finally{b(!1)}},loading:j,namespaces:c,onRequestNamespaces:yn,onFetchNamespacesWithAuth:cn,selectedInfra:et,infrastructures:Ge,onRequestVeleroInstall:ss}),e.jsx(fj,{visible:E,onCancel:()=>{P(!1),v(null)},onConfirm:async fe=>{if(!y||!h)return;const Be=await ms(Number(h));if(Be.length>0)Dt(Be,"delete",{...fe,backup:y});else try{W(!0),await fs(y,[]),P(!1)}catch(dt){f.error("ë°±ì—… ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{W(!1)}},loading:A,backup:y,selectedBackup:y,isDeleting:A}),e.jsx(vj,{visible:I,onCancel:()=>{$(!1),v(null)},onSubmit:async fe=>{var ns,Ds,hn,Ar;if(!y||!h)return;const Be=(et==null?void 0:et.type)||"",dt=Be==="docker"||Be==="external_docker"||Be==="podman"||Be==="external_podman";try{if(se(!0),dt){const Nr=fe.authData.map(jn=>({host:jn.host,port:jn.port,username:jn.username,password:jn.password}));await Og({backup_id:y.id,hops:Nr,restore_volumes:(ns=fe.restoreVolumes)!=null?ns:!0,restore_config:(Ds=fe.restoreConfig)!=null?Ds:!0,redeploy_compose:(hn=fe.redeployCompose)!=null?hn:!1,stop_existing:(Ar=fe.stopExisting)!=null?Ar:!1,containers:fe.containers});const Mn=fe.restoreScope==="selected"&&fe.containers?` (${fe.containers.length}ê°œ ì»¨í…Œì´ë„ˆ)`:" (ì „ì²´)";f.success(`ë³µêµ¬ ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.${Mn}`)}else{const Nr={[fe.originalNamespace]:fe.targetNamespace};await Cs({infra_id:Number(h),backup_name:y.name,backup_version:fe.backupVersion,namespace_mappings:Nr,auth_data:fe.authData}),f.success("ë³µêµ¬ ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.")}$(!1),v(null),dt&&setTimeout(()=>void Mr(),2e3)}catch(Nr){f.error(`ë³µêµ¬ ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${Nr instanceof Error?Nr.message:String(Nr)}`)}finally{se(!1)}},loading:Z,backup:y,masterHops:u,infraType:et==null?void 0:et.type}),e.jsx(yj,{visible:ce,onCancel:()=>D(!1),onSuccess:Mr,loading:j,selectedInfra:et,sshHops:G}),e.jsx(jj,{visible:oe,backup:ne,restores:Ue,onClose:()=>{be(!1),ye(null),N([])}}),e.jsx(_j,{visible:je,onCancel:()=>Pe(!1),onSubmit:Ve,loading:w}),e.jsx(Pj,{visible:U,storage:F,linkedInfras:de,infrastructures:Ge,loading:ae,onCancel:()=>{V(!1),X(null),Ne([])},onLink:Bt,onUnlink:Ps})]})},{TabPane:Zv}=xs,{RangePicker:Qv}=Mm,{Text:Xv}=we;var Hs;(function(s){s.assertEqual=a=>{};function t(a){}s.assertIs=t;function r(a){throw new Error}s.assertNever=r,s.arrayToEnum=a=>{const i={};for(const l of a)i[l]=l;return i},s.getValidEnumValues=a=>{const i=s.objectKeys(a).filter(d=>typeof a[a[d]]!="number"),l={};for(const d of i)l[d]=a[d];return s.objectValues(l)},s.objectValues=a=>s.objectKeys(a).map(function(i){return a[i]}),s.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&i.push(l);return i},s.find=(a,i)=>{for(const l of a)if(i(l))return l},s.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,i=" | "){return a.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}s.joinValues=n,s.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Hs||(Hs={}));var kh;(function(s){s.mergeShapes=(t,r)=>({...t,...r})})(kh||(kh={}));const Tt=Hs.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),fi=s=>{switch(typeof s){case"undefined":return Tt.undefined;case"string":return Tt.string;case"number":return Number.isNaN(s)?Tt.nan:Tt.number;case"boolean":return Tt.boolean;case"function":return Tt.function;case"bigint":return Tt.bigint;case"symbol":return Tt.symbol;case"object":return Array.isArray(s)?Tt.array:s===null?Tt.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?Tt.promise:typeof Map!="undefined"&&s instanceof Map?Tt.map:typeof Set!="undefined"&&s instanceof Set?Tt.set:typeof Date!="undefined"&&s instanceof Date?Tt.date:Tt.object;default:return Tt.unknown}},it=Hs.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class oi extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},n={_errors:[]},a=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(a);else if(l.code==="invalid_return_type")a(l.returnTypeError);else if(l.code==="invalid_arguments")a(l.argumentsError);else if(l.path.length===0)n._errors.push(r(l));else{let d=n,c=0;for(;c<l.path.length;){const p=l.path[c];c===l.path.length-1?(d[p]=d[p]||{_errors:[]},d[p]._errors.push(r(l))):d[p]=d[p]||{_errors:[]},d=d[p],c++}}};return a(this),n}static assert(t){if(!(t instanceof oi))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Hs.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];r[i]=r[i]||[],r[i].push(t(a))}else n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}oi.create=s=>new oi(s);const Kd=(s,t)=>{let r;switch(s.code){case it.invalid_type:s.received===Tt.undefined?r="Required":r=`Expected ${s.expected}, received ${s.received}`;break;case it.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,Hs.jsonStringifyReplacer)}`;break;case it.unrecognized_keys:r=`Unrecognized key(s) in object: ${Hs.joinValues(s.keys,", ")}`;break;case it.invalid_union:r="Invalid input";break;case it.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Hs.joinValues(s.options)}`;break;case it.invalid_enum_value:r=`Invalid enum value. Expected ${Hs.joinValues(s.options)}, received '${s.received}'`;break;case it.invalid_arguments:r="Invalid function arguments";break;case it.invalid_return_type:r="Invalid function return type";break;case it.invalid_date:r="Invalid date";break;case it.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:Hs.assertNever(s.validation):s.validation!=="regex"?r=`Invalid ${s.validation}`:r="Invalid";break;case it.too_small:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:r="Invalid input";break;case it.too_big:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?r=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:r="Invalid input";break;case it.custom:r="Invalid input";break;case it.invalid_intersection_types:r="Intersection results could not be merged";break;case it.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case it.not_finite:r="Number must be finite";break;default:r=t.defaultError,Hs.assertNever(s)}return{message:r}};let $j=Kd;function Oj(){return $j}const Dj=s=>{const{data:t,path:r,errorMaps:n,issueData:a}=s,i=[...r,...a.path||[]],l={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let d="";const c=n.filter(p=>!!p).slice().reverse();for(const p of c)d=p(l,{data:t,defaultError:d}).message;return{...a,path:i,message:d}};function jt(s,t){const r=Oj(),n=Dj({issueData:t,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===Kd?void 0:Kd].filter(a=>!!a)});s.common.issues.push(n)}class ia{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return is;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const i=await a.key,l=await a.value;n.push({key:i,value:l})}return ia.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:i,value:l}=a;if(i.status==="aborted"||l.status==="aborted")return is;i.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof l.value!="undefined"||a.alwaysSet)&&(n[i.value]=l.value)}return{status:t.value,value:n}}}const is=Object.freeze({status:"aborted"}),qo=s=>({status:"dirty",value:s}),ja=s=>({status:"valid",value:s}),Ch=s=>s.status==="aborted",Ih=s=>s.status==="dirty",yo=s=>s.status==="valid",oc=s=>typeof Promise!="undefined"&&s instanceof Promise;var Et;(function(s){s.errToObj=t=>typeof t=="string"?{message:t}:t||{},s.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Et||(Et={}));class vi{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Th=(s,t)=>{if(yo(t))return{success:!0,data:t.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new oi(s.common.issues);return this._error=r,this._error}}};function ws(s){if(!s)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=s;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(l,d)=>{var p,h;const{message:c}=s;return l.code==="invalid_enum_value"?{message:c!=null?c:d.defaultError}:typeof d.data=="undefined"?{message:(p=c!=null?c:n)!=null?p:d.defaultError}:l.code!=="invalid_type"?{message:d.defaultError}:{message:(h=c!=null?c:r)!=null?h:d.defaultError}},description:a}}class $s{get description(){return this._def.description}_getType(t){return fi(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:fi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ia,ctx:{common:t.parent.common,data:t.data,parsedType:fi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(oc(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var i;const n={common:{issues:[],async:(i=r==null?void 0:r.async)!=null?i:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:fi(t)},a=this._parseSync({data:t,path:n.path,parent:n});return Th(n,a)}"~validate"(t){var n,a;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:fi(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:r});return yo(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(a=(n=i==null?void 0:i.message)==null?void 0:n.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(i=>yo(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:fi(t)},a=this._parse({data:t,path:n.path,parent:n}),i=await(oc(a)?a:Promise.resolve(a));return Th(n,i)}refine(t,r){const n=a=>typeof r=="string"||typeof r=="undefined"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{const l=t(a),d=()=>i.addIssue({code:it.custom,...n(a)});return typeof Promise!="undefined"&&l instanceof Promise?l.then(c=>c?!0:(d(),!1)):l?!0:(d(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new _o({schema:this,typeName:os.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return _i.create(this,this._def)}nullable(){return wo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Oa.create(this)}promise(){return uc.create(this,this._def)}or(t){return cc.create([this,t],this._def)}and(t){return dc.create(this,t,this._def)}transform(t){return new _o({...ws(this._def),schema:this,typeName:os.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new Jd({...ws(this._def),innerType:this,defaultValue:r,typeName:os.ZodDefault})}brand(){return new cb({typeName:os.ZodBranded,type:this,...ws(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new Zd({...ws(this._def),innerType:this,catchValue:r,typeName:os.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return _u.create(this,t)}readonly(){return Qd.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Fj=/^c[^\s-]{8,}$/i,Uj=/^[0-9a-z]+$/,Hj=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Vj=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,qj=/^[a-z0-9_-]{21}$/i,Gj=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Wj=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Kj=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Yj="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let od;const Jj=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Zj=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Qj=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Xj=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,eb=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,tb=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Kg="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",sb=new RegExp(`^${Kg}$`);function Yg(s){let t="[0-5]\\d";s.precision?t=`${t}\\.\\d{${s.precision}}`:s.precision==null&&(t=`${t}(\\.\\d+)?`);const r=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function rb(s){return new RegExp(`^${Yg(s)}$`)}function nb(s){let t=`${Kg}T${Yg(s)}`;const r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function ab(s,t){return!!((t==="v4"||!t)&&Jj.test(s)||(t==="v6"||!t)&&Qj.test(s))}function ib(s,t){if(!Gj.test(s))return!1;try{const[r]=s.split(".");if(!r)return!1;const n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch(r){return!1}}function ob(s,t){return!!((t==="v4"||!t)&&Zj.test(s)||(t==="v6"||!t)&&Xj.test(s))}class ji extends $s{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Tt.string){const i=this._getOrReturnCtx(t);return jt(i,{code:it.invalid_type,expected:Tt.string,received:i.parsedType}),is}const n=new ia;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),jt(a,{code:it.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),jt(a,{code:it.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const l=t.data.length>i.value,d=t.data.length<i.value;(l||d)&&(a=this._getOrReturnCtx(t,a),l?jt(a,{code:it.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):d&&jt(a,{code:it.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")Kj.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"email",code:it.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")od||(od=new RegExp(Yj,"u")),od.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"emoji",code:it.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")Vj.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"uuid",code:it.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")qj.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"nanoid",code:it.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")Fj.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"cuid",code:it.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")Uj.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"cuid2",code:it.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")Hj.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"ulid",code:it.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch(l){a=this._getOrReturnCtx(t,a),jt(a,{validation:"url",code:it.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"regex",code:it.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),jt(a,{code:it.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),jt(a,{code:it.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),jt(a,{code:it.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?nb(i).test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{code:it.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?sb.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{code:it.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?rb(i).test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{code:it.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?Wj.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"duration",code:it.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?ab(t.data,i.version)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"ip",code:it.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?ib(t.data,i.alg)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"jwt",code:it.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?ob(t.data,i.version)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"cidr",code:it.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?eb.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"base64",code:it.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?tb.test(t.data)||(a=this._getOrReturnCtx(t,a),jt(a,{validation:"base64url",code:it.invalid_string,message:i.message}),n.dirty()):Hs.assertNever(i);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:it.invalid_string,...Et.errToObj(n)})}_addCheck(t){return new ji({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Et.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Et.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Et.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Et.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Et.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Et.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Et.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Et.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Et.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Et.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Et.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Et.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Et.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)=="undefined"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!=null?r:!1,local:(n=t==null?void 0:t.local)!=null?n:!1,...Et.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)=="undefined"?null:t==null?void 0:t.precision,...Et.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Et.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...Et.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...Et.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...Et.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...Et.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...Et.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...Et.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...Et.errToObj(r)})}nonempty(t){return this.min(1,Et.errToObj(t))}trim(){return new ji({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ji({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ji({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}ji.create=s=>{var t;return new ji({checks:[],typeName:os.ZodString,coerce:(t=s==null?void 0:s.coerce)!=null?t:!1,...ws(s)})};function lb(s,t){const r=(s.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,i=Number.parseInt(s.toFixed(a).replace(".","")),l=Number.parseInt(t.toFixed(a).replace(".",""));return i%l/10**a}class jo extends $s{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Tt.number){const i=this._getOrReturnCtx(t);return jt(i,{code:it.invalid_type,expected:Tt.number,received:i.parsedType}),is}let n;const a=new ia;for(const i of this._def.checks)i.kind==="int"?Hs.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),jt(n,{code:it.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),jt(n,{code:it.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),jt(n,{code:it.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?lb(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),jt(n,{code:it.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),jt(n,{code:it.not_finite,message:i.message}),a.dirty()):Hs.assertNever(i);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,Et.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Et.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Et.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Et.toString(r))}setLimit(t,r,n,a){return new jo({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Et.toString(a)}]})}_addCheck(t){return new jo({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Et.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Et.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Et.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Et.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Et.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Et.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:Et.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Et.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Et.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Hs.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}jo.create=s=>new jo({checks:[],typeName:os.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...ws(s)});class tl extends $s{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch(i){return this._getInvalidInput(t)}if(this._getType(t)!==Tt.bigint)return this._getInvalidInput(t);let n;const a=new ia;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),jt(n,{code:it.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),jt(n,{code:it.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),jt(n,{code:it.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Hs.assertNever(i);return{status:a.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return jt(r,{code:it.invalid_type,expected:Tt.bigint,received:r.parsedType}),is}gte(t,r){return this.setLimit("min",t,!0,Et.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Et.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Et.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Et.toString(r))}setLimit(t,r,n,a){return new tl({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Et.toString(a)}]})}_addCheck(t){return new tl({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Et.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Et.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Et.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Et.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Et.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}tl.create=s=>{var t;return new tl({checks:[],typeName:os.ZodBigInt,coerce:(t=s==null?void 0:s.coerce)!=null?t:!1,...ws(s)})};class Rh extends $s{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Tt.boolean){const n=this._getOrReturnCtx(t);return jt(n,{code:it.invalid_type,expected:Tt.boolean,received:n.parsedType}),is}return ja(t.data)}}Rh.create=s=>new Rh({typeName:os.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...ws(s)});class lc extends $s{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Tt.date){const i=this._getOrReturnCtx(t);return jt(i,{code:it.invalid_type,expected:Tt.date,received:i.parsedType}),is}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return jt(i,{code:it.invalid_date}),is}const n=new ia;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),jt(a,{code:it.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),jt(a,{code:it.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Hs.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new lc({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:Et.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:Et.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}lc.create=s=>new lc({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:os.ZodDate,...ws(s)});class zh extends $s{_parse(t){if(this._getType(t)!==Tt.symbol){const n=this._getOrReturnCtx(t);return jt(n,{code:it.invalid_type,expected:Tt.symbol,received:n.parsedType}),is}return ja(t.data)}}zh.create=s=>new zh({typeName:os.ZodSymbol,...ws(s)});class Eh extends $s{_parse(t){if(this._getType(t)!==Tt.undefined){const n=this._getOrReturnCtx(t);return jt(n,{code:it.invalid_type,expected:Tt.undefined,received:n.parsedType}),is}return ja(t.data)}}Eh.create=s=>new Eh({typeName:os.ZodUndefined,...ws(s)});class Ph extends $s{_parse(t){if(this._getType(t)!==Tt.null){const n=this._getOrReturnCtx(t);return jt(n,{code:it.invalid_type,expected:Tt.null,received:n.parsedType}),is}return ja(t.data)}}Ph.create=s=>new Ph({typeName:os.ZodNull,...ws(s)});class Mh extends $s{constructor(){super(...arguments),this._any=!0}_parse(t){return ja(t.data)}}Mh.create=s=>new Mh({typeName:os.ZodAny,...ws(s)});class Lh extends $s{constructor(){super(...arguments),this._unknown=!0}_parse(t){return ja(t.data)}}Lh.create=s=>new Lh({typeName:os.ZodUnknown,...ws(s)});class ki extends $s{_parse(t){const r=this._getOrReturnCtx(t);return jt(r,{code:it.invalid_type,expected:Tt.never,received:r.parsedType}),is}}ki.create=s=>new ki({typeName:os.ZodNever,...ws(s)});class Ah extends $s{_parse(t){if(this._getType(t)!==Tt.undefined){const n=this._getOrReturnCtx(t);return jt(n,{code:it.invalid_type,expected:Tt.void,received:n.parsedType}),is}return ja(t.data)}}Ah.create=s=>new Ah({typeName:os.ZodVoid,...ws(s)});class Oa extends $s{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==Tt.array)return jt(r,{code:it.invalid_type,expected:Tt.array,received:r.parsedType}),is;if(a.exactLength!==null){const l=r.data.length>a.exactLength.value,d=r.data.length<a.exactLength.value;(l||d)&&(jt(r,{code:l?it.too_big:it.too_small,minimum:d?a.exactLength.value:void 0,maximum:l?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(jt(r,{code:it.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(jt(r,{code:it.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((l,d)=>a.type._parseAsync(new vi(r,l,r.path,d)))).then(l=>ia.mergeArray(n,l));const i=[...r.data].map((l,d)=>a.type._parseSync(new vi(r,l,r.path,d)));return ia.mergeArray(n,i)}get element(){return this._def.type}min(t,r){return new Oa({...this._def,minLength:{value:t,message:Et.toString(r)}})}max(t,r){return new Oa({...this._def,maxLength:{value:t,message:Et.toString(r)}})}length(t,r){return new Oa({...this._def,exactLength:{value:t,message:Et.toString(r)}})}nonempty(t){return this.min(1,t)}}Oa.create=(s,t)=>new Oa({type:s,minLength:null,maxLength:null,exactLength:null,typeName:os.ZodArray,...ws(t)});function uo(s){if(s instanceof Jr){const t={};for(const r in s.shape){const n=s.shape[r];t[r]=_i.create(uo(n))}return new Jr({...s._def,shape:()=>t})}else return s instanceof Oa?new Oa({...s._def,type:uo(s.element)}):s instanceof _i?_i.create(uo(s.unwrap())):s instanceof wo?wo.create(uo(s.unwrap())):s instanceof Di?Di.create(s.items.map(t=>uo(t))):s}class Jr extends $s{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Hs.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==Tt.object){const p=this._getOrReturnCtx(t);return jt(p,{code:it.invalid_type,expected:Tt.object,received:p.parsedType}),is}const{status:n,ctx:a}=this._processInputParams(t),{shape:i,keys:l}=this._getCached(),d=[];if(!(this._def.catchall instanceof ki&&this._def.unknownKeys==="strip"))for(const p in a.data)l.includes(p)||d.push(p);const c=[];for(const p of l){const h=i[p],x=a.data[p];c.push({key:{status:"valid",value:p},value:h._parse(new vi(a,x,a.path,p)),alwaysSet:p in a.data})}if(this._def.catchall instanceof ki){const p=this._def.unknownKeys;if(p==="passthrough")for(const h of d)c.push({key:{status:"valid",value:h},value:{status:"valid",value:a.data[h]}});else if(p==="strict")d.length>0&&(jt(a,{code:it.unrecognized_keys,keys:d}),n.dirty());else if(p!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const p=this._def.catchall;for(const h of d){const x=a.data[h];c.push({key:{status:"valid",value:h},value:p._parse(new vi(a,x,a.path,h)),alwaysSet:h in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const p=[];for(const h of c){const x=await h.key,_=await h.value;p.push({key:x,value:_,alwaysSet:h.alwaysSet})}return p}).then(p=>ia.mergeObjectSync(n,p)):ia.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(t){return Et.errToObj,new Jr({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var i,l,d,c;const a=(d=(l=(i=this._def).errorMap)==null?void 0:l.call(i,r,n).message)!=null?d:n.defaultError;return r.code==="unrecognized_keys"?{message:(c=Et.errToObj(t).message)!=null?c:a}:{message:a}}}:{}})}strip(){return new Jr({...this._def,unknownKeys:"strip"})}passthrough(){return new Jr({...this._def,unknownKeys:"passthrough"})}extend(t){return new Jr({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Jr({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:os.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Jr({...this._def,catchall:t})}pick(t){const r={};for(const n of Hs.objectKeys(t))t[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new Jr({...this._def,shape:()=>r})}omit(t){const r={};for(const n of Hs.objectKeys(this.shape))t[n]||(r[n]=this.shape[n]);return new Jr({...this._def,shape:()=>r})}deepPartial(){return uo(this)}partial(t){const r={};for(const n of Hs.objectKeys(this.shape)){const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}return new Jr({...this._def,shape:()=>r})}required(t){const r={};for(const n of Hs.objectKeys(this.shape))if(t&&!t[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof _i;)i=i._def.innerType;r[n]=i}return new Jr({...this._def,shape:()=>r})}keyof(){return Jg(Hs.objectKeys(this.shape))}}Jr.create=(s,t)=>new Jr({shape:()=>s,unknownKeys:"strip",catchall:ki.create(),typeName:os.ZodObject,...ws(t)});Jr.strictCreate=(s,t)=>new Jr({shape:()=>s,unknownKeys:"strict",catchall:ki.create(),typeName:os.ZodObject,...ws(t)});Jr.lazycreate=(s,t)=>new Jr({shape:s,unknownKeys:"strip",catchall:ki.create(),typeName:os.ZodObject,...ws(t)});class cc extends $s{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(i){for(const d of i)if(d.result.status==="valid")return d.result;for(const d of i)if(d.result.status==="dirty")return r.common.issues.push(...d.ctx.common.issues),d.result;const l=i.map(d=>new oi(d.ctx.common.issues));return jt(r,{code:it.invalid_union,unionErrors:l}),is}if(r.common.async)return Promise.all(n.map(async i=>{const l={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:l}),ctx:l}})).then(a);{let i;const l=[];for(const c of n){const p={...r,common:{...r.common,issues:[]},parent:null},h=c._parseSync({data:r.data,path:r.path,parent:p});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:p}),p.common.issues.length&&l.push(p.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const d=l.map(c=>new oi(c));return jt(r,{code:it.invalid_union,unionErrors:d}),is}}get options(){return this._def.options}}cc.create=(s,t)=>new cc({options:s,typeName:os.ZodUnion,...ws(t)});function Yd(s,t){const r=fi(s),n=fi(t);if(s===t)return{valid:!0,data:s};if(r===Tt.object&&n===Tt.object){const a=Hs.objectKeys(t),i=Hs.objectKeys(s).filter(d=>a.indexOf(d)!==-1),l={...s,...t};for(const d of i){const c=Yd(s[d],t[d]);if(!c.valid)return{valid:!1};l[d]=c.data}return{valid:!0,data:l}}else if(r===Tt.array&&n===Tt.array){if(s.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<s.length;i++){const l=s[i],d=t[i],c=Yd(l,d);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return r===Tt.date&&n===Tt.date&&+s==+t?{valid:!0,data:s}:{valid:!1}}class dc extends $s{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(i,l)=>{if(Ch(i)||Ch(l))return is;const d=Yd(i.value,l.value);return d.valid?((Ih(i)||Ih(l))&&r.dirty(),{status:r.value,value:d.data}):(jt(n,{code:it.invalid_intersection_types}),is)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,l])=>a(i,l)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}dc.create=(s,t,r)=>new dc({left:s,right:t,typeName:os.ZodIntersection,...ws(r)});class Di extends $s{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==Tt.array)return jt(n,{code:it.invalid_type,expected:Tt.array,received:n.parsedType}),is;if(n.data.length<this._def.items.length)return jt(n,{code:it.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),is;!this._def.rest&&n.data.length>this._def.items.length&&(jt(n,{code:it.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((l,d)=>{const c=this._def.items[d]||this._def.rest;return c?c._parse(new vi(n,l,n.path,d)):null}).filter(l=>!!l);return n.common.async?Promise.all(i).then(l=>ia.mergeArray(r,l)):ia.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new Di({...this._def,rest:t})}}Di.create=(s,t)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Di({items:s,typeName:os.ZodTuple,rest:null,...ws(t)})};class Nh extends $s{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==Tt.map)return jt(n,{code:it.invalid_type,expected:Tt.map,received:n.parsedType}),is;const a=this._def.keyType,i=this._def.valueType,l=[...n.data.entries()].map(([d,c],p)=>({key:a._parse(new vi(n,d,n.path,[p,"key"])),value:i._parse(new vi(n,c,n.path,[p,"value"]))}));if(n.common.async){const d=new Map;return Promise.resolve().then(async()=>{for(const c of l){const p=await c.key,h=await c.value;if(p.status==="aborted"||h.status==="aborted")return is;(p.status==="dirty"||h.status==="dirty")&&r.dirty(),d.set(p.value,h.value)}return{status:r.value,value:d}})}else{const d=new Map;for(const c of l){const p=c.key,h=c.value;if(p.status==="aborted"||h.status==="aborted")return is;(p.status==="dirty"||h.status==="dirty")&&r.dirty(),d.set(p.value,h.value)}return{status:r.value,value:d}}}}Nh.create=(s,t,r)=>new Nh({valueType:t,keyType:s,typeName:os.ZodMap,...ws(r)});class sl extends $s{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==Tt.set)return jt(n,{code:it.invalid_type,expected:Tt.set,received:n.parsedType}),is;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(jt(n,{code:it.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(jt(n,{code:it.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const i=this._def.valueType;function l(c){const p=new Set;for(const h of c){if(h.status==="aborted")return is;h.status==="dirty"&&r.dirty(),p.add(h.value)}return{status:r.value,value:p}}const d=[...n.data.values()].map((c,p)=>i._parse(new vi(n,c,n.path,p)));return n.common.async?Promise.all(d).then(c=>l(c)):l(d)}min(t,r){return new sl({...this._def,minSize:{value:t,message:Et.toString(r)}})}max(t,r){return new sl({...this._def,maxSize:{value:t,message:Et.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}sl.create=(s,t)=>new sl({valueType:s,minSize:null,maxSize:null,typeName:os.ZodSet,...ws(t)});class Bh extends $s{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Bh.create=(s,t)=>new Bh({getter:s,typeName:os.ZodLazy,...ws(t)});class $h extends $s{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return jt(r,{received:r.data,code:it.invalid_literal,expected:this._def.value}),is}return{status:"valid",value:t.data}}get value(){return this._def.value}}$h.create=(s,t)=>new $h({value:s,typeName:os.ZodLiteral,...ws(t)});function Jg(s,t){return new bo({values:s,typeName:os.ZodEnum,...ws(t)})}class bo extends $s{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return jt(r,{expected:Hs.joinValues(n),received:r.parsedType,code:it.invalid_type}),is}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return jt(r,{received:r.data,code:it.invalid_enum_value,options:n}),is}return ja(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return bo.create(t,{...this._def,...r})}exclude(t,r=this._def){return bo.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}bo.create=Jg;class Oh extends $s{_parse(t){const r=Hs.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==Tt.string&&n.parsedType!==Tt.number){const a=Hs.objectValues(r);return jt(n,{expected:Hs.joinValues(a),received:n.parsedType,code:it.invalid_type}),is}if(this._cache||(this._cache=new Set(Hs.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=Hs.objectValues(r);return jt(n,{received:n.data,code:it.invalid_enum_value,options:a}),is}return ja(t.data)}get enum(){return this._def.values}}Oh.create=(s,t)=>new Oh({values:s,typeName:os.ZodNativeEnum,...ws(t)});class uc extends $s{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Tt.promise&&r.common.async===!1)return jt(r,{code:it.invalid_type,expected:Tt.promise,received:r.parsedType}),is;const n=r.parsedType===Tt.promise?r.data:Promise.resolve(r.data);return ja(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}uc.create=(s,t)=>new uc({type:s,typeName:os.ZodPromise,...ws(t)});class _o extends $s{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===os.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:l=>{jt(n,l),l.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const l=a.transform(n.data,i);if(n.common.async)return Promise.resolve(l).then(async d=>{if(r.value==="aborted")return is;const c=await this._def.schema._parseAsync({data:d,path:n.path,parent:n});return c.status==="aborted"?is:c.status==="dirty"||r.value==="dirty"?qo(c.value):c});{if(r.value==="aborted")return is;const d=this._def.schema._parseSync({data:l,path:n.path,parent:n});return d.status==="aborted"?is:d.status==="dirty"||r.value==="dirty"?qo(d.value):d}}if(a.type==="refinement"){const l=d=>{const c=a.refinement(d,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return d};if(n.common.async===!1){const d=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return d.status==="aborted"?is:(d.status==="dirty"&&r.dirty(),l(d.value),{status:r.value,value:d.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(d=>d.status==="aborted"?is:(d.status==="dirty"&&r.dirty(),l(d.value).then(()=>({status:r.value,value:d.value}))))}if(a.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!yo(l))return is;const d=a.transform(l.value,i);if(d instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:d}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>yo(l)?Promise.resolve(a.transform(l.value,i)).then(d=>({status:r.value,value:d})):is);Hs.assertNever(a)}}_o.create=(s,t,r)=>new _o({schema:s,typeName:os.ZodEffects,effect:t,...ws(r)});_o.createWithPreprocess=(s,t,r)=>new _o({schema:t,effect:{type:"preprocess",transform:s},typeName:os.ZodEffects,...ws(r)});class _i extends $s{_parse(t){return this._getType(t)===Tt.undefined?ja(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_i.create=(s,t)=>new _i({innerType:s,typeName:os.ZodOptional,...ws(t)});class wo extends $s{_parse(t){return this._getType(t)===Tt.null?ja(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}wo.create=(s,t)=>new wo({innerType:s,typeName:os.ZodNullable,...ws(t)});class Jd extends $s{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===Tt.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Jd.create=(s,t)=>new Jd({innerType:s,typeName:os.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ws(t)});class Zd extends $s{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return oc(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new oi(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new oi(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Zd.create=(s,t)=>new Zd({innerType:s,typeName:os.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ws(t)});class Dh extends $s{_parse(t){if(this._getType(t)!==Tt.nan){const n=this._getOrReturnCtx(t);return jt(n,{code:it.invalid_type,expected:Tt.nan,received:n.parsedType}),is}return{status:"valid",value:t.data}}}Dh.create=s=>new Dh({typeName:os.ZodNaN,...ws(s)});class cb extends $s{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class _u extends $s{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?is:i.status==="dirty"?(r.dirty(),qo(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?is:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new _u({in:t,out:r,typeName:os.ZodPipeline})}}class Qd extends $s{_parse(t){const r=this._def.innerType._parse(t),n=a=>(yo(a)&&(a.value=Object.freeze(a.value)),a);return oc(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}Qd.create=(s,t)=>new Qd({innerType:s,typeName:os.ZodReadonly,...ws(t)});var os;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(os||(os={}));const Na=ji.create,db=jo.create;ki.create;const ld=Oa.create,zl=Jr.create;cc.create;dc.create;Di.create;bo.create;uc.create;_i.create;wo.create;function ub(){const{imageRegistry:s,sourceRepository:t,serverlist:r}=Gs.getState(),a=JSON.stringify({imageRegistry:s,sourceRepository:t,serverlist:r},null,2);return new Blob([a],{type:"application/json"})}async function hb(){const s=ub(),t=`creds-${new Date().toISOString().slice(0,10)}.json`,r=window;if(r.showSaveFilePicker)try{const l=await(await r.showSaveFilePicker({suggestedName:t,types:[{description:"JSON",accept:{"application/json":[".json"]}}]})).createWritable();await l.write(s),await l.close();return}catch(i){const l=i;if(l&&l.name==="AbortError")return}const n=URL.createObjectURL(s),a=document.createElement("a");a.href=n,a.download=t,a.click(),URL.revokeObjectURL(n)}async function Fh(s,t="replace"){try{const r=await s.text(),n=zl({registryUrl:Na().optional().default(""),userId:Na().trim().min(1),password:Na().trim().min(1)}).strict(),a=zl({baseUrl:Na().url(),token:Na().trim().min(1),userId:Na().optional(),config:Na().optional()}).strict(),i=zl({host:Na().trim().min(1),port:db().int().positive().optional(),userId:Na().trim().min(1),password:Na().trim().min(1)}).strict(),d=zl({imageRegistry:ld(n),sourceRepository:ld(a),serverlist:ld(i).optional().default([])}).strict().parse(JSON.parse(r)),c=Gs.getState();if(t==="replace"){c.imageRegistry.forEach(h=>{c.removeImageRegistry(h.registryUrl)}),d.imageRegistry.forEach(h=>{c.upsertImageRegistry(h)}),c.sourceRepository.forEach(h=>{c.removeSourceRepository(h.baseUrl)}),d.sourceRepository.forEach(h=>{c.upsertSourceRepository(h)});for(let h=c.serverlist.length-1;h>=0;h--)c.removeServer(h);d.serverlist.forEach(h=>{c.upsertServerByHostPort(h)})}else{d.imageRegistry.forEach(x=>{const _=c.imageRegistry.findIndex(S=>S.userId===x.userId);_>=0&&c.removeImageRegistry(c.imageRegistry[_].registryUrl),c.upsertImageRegistry(x)}),d.sourceRepository.forEach(x=>{c.sourceRepository.findIndex(S=>S.baseUrl===x.baseUrl)>=0&&c.removeSourceRepository(x.baseUrl),c.upsertSourceRepository(x)});const h=new Set(d.serverlist.map(x=>`${x.host}:${x.port}`));for(let x=c.serverlist.length-1;x>=0;x--){const _=`${c.serverlist[x].host}:${c.serverlist[x].port}`;h.has(_)&&c.removeServer(x)}d.serverlist.forEach(x=>{c.upsertServerByHostPort(x)})}const p=Gs.getState();return{ok:!0}}catch(r){const n=r;if(n.message.includes("ZodError"))try{const a=JSON.parse(n.message);if(a&&Array.isArray(a))return{ok:!1,error:`ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜: ${a.map(l=>{var c;return`${((c=l.path)==null?void 0:c.join("."))||"ì•Œ ìˆ˜ ì—†ëŠ” í•„ë“œ"}: ${l.message}`}).join(", ")}`}}catch(a){}return{ok:!1,error:n.message}}}const ao={getUserNotifications:s=>ee.request("/notification","getUserNotifications",s?{limit:s}:{}),getUnreadCount:()=>ee.request("/notification","getUnreadCount",{}),acceptInvitation:s=>ee.request("/notification","acceptInvitation",{notificationId:s}),rejectInvitation:s=>ee.request("/notification","rejectInvitation",{notificationId:s}),markAsRead:s=>ee.request("/notification","markAsRead",{notificationId:s}),markAllAsRead:()=>ee.request("/notification","markAllAsRead",{}),request:(s,t)=>ee.request("/notification",s,t)},pb=()=>{const[s,t]=o.useState([]),[r,n]=o.useState(0),[a,i]=o.useState(!1),[l,d]=o.useState(null),c=o.useCallback(async(L=50)=>{i(!0),d(null);try{const k=await ao.getUserNotifications(L);if(k.success&&k.data)t(k.data);else{const E=`ì•Œë¦¼ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨: ${k.error||"API ì˜¤ë¥˜"}`;d(E),f.error(E)}}catch(k){const E="ì•Œë¦¼ ëª©ë¡ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";d(E),f.error(E)}finally{i(!1)}},[]),p=o.useCallback(async()=>{try{const L=await ao.getUnreadCount();L.success&&L.data&&n(L.data.count)}catch(L){}},[]),h=o.useCallback(async L=>{try{const k=await ao.acceptInvitation(L);return k.success?(f.success("ê¸°ê´€ ì´ˆëŒ€ë¥¼ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤."),await c(),await p(),!0):(f.error(`ì´ˆëŒ€ ìˆ˜ë½ ì‹¤íŒ¨: ${k.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`),!1)}catch(k){return f.error("ì´ˆëŒ€ ìˆ˜ë½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),!1}},[c,p]),x=o.useCallback(async L=>{try{const k=await ao.rejectInvitation(L);return k.success?(f.success("ê¸°ê´€ ì´ˆëŒ€ë¥¼ ê±°ì ˆí–ˆìŠµë‹ˆë‹¤."),await c(),await p(),!0):(f.error(`ì´ˆëŒ€ ê±°ì ˆ ì‹¤íŒ¨: ${k.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`),!1)}catch(k){return f.error("ì´ˆëŒ€ ê±°ì ˆ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),!1}},[c,p]),_=o.useCallback(async L=>{try{return(await ao.markAsRead(L)).success?(t(E=>E.map(P=>P.id===L?{...P,status:"read"}:P)),await p(),!0):!1}catch(k){return!1}},[p]),S=o.useCallback(async()=>{try{const L=await ao.markAllAsRead();return L.success?(f.success("ëª¨ë“  ì•Œë¦¼ì„ ì½ìŒìœ¼ë¡œ í‘œì‹œí–ˆìŠµë‹ˆë‹¤."),await c(),n(0),!0):(f.error(`ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ ì‹¤íŒ¨: ${L.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`),!1)}catch(L){return f.error("ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),!1}},[c]);return o.useEffect(()=>{c(),p()},[c,p]),o.useEffect(()=>{const L=setInterval(()=>{p()},3e4);return()=>clearInterval(L)},[p]),{notifications:s,unreadCount:r,isLoading:a,error:l,loadNotifications:c,loadUnreadCount:p,acceptInvitation:h,rejectInvitation:x,markAsRead:_,markAllAsRead:S}};var Zg={exports:{}};(function(s,t){(function(r,n){s.exports=n()})($p,function(){return function(r,n,a){r=r||{};var i=n.prototype,l={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function d(p,h,x,_){return i.fromToBase(p,h,x,_)}a.en.relativeTime=l,i.fromToBase=function(p,h,x,_,S){for(var L,k,E,P=x.$locale().relativeTime||l,I=r.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],$=I.length,y=0;y<$;y+=1){var v=I[y];v.d&&(L=_?a(p).diff(x,v.d,!0):x.diff(p,v.d,!0));var u=(r.rounding||Math.round)(Math.abs(L));if(E=L>0,u<=v.r||!v.r){u<=1&&y>0&&(v=I[y-1]);var m=P[v.l];S&&(u=S(""+u)),k=typeof m=="string"?m.replace("%d",u):m(u,h,v.l,E);break}}if(h)return k;var j=E?P.future:P.past;return typeof j=="function"?j(k):j.replace("%s",k)},i.to=function(p,h){return d(p,h,this,!0)},i.from=function(p,h){return d(p,h,this)};var c=function(p){return p.$u?a.utc():a()};i.toNow=function(p){return this.to(c(this),p)},i.fromNow=function(p){return this.from(c(this),p)}}})})(Zg);var gb=Zg.exports;const xb=fm(gb);var mb={exports:{}};(function(s,t){(function(r,n){s.exports=n(Lm)})($p,function(r){function n(l){return l&&typeof l=="object"&&"default"in l?l:{default:l}}var a=n(r),i={name:"ko",weekdays:"ì¼ìš”ì¼_ì›”ìš”ì¼_í™”ìš”ì¼_ìˆ˜ìš”ì¼_ëª©ìš”ì¼_ê¸ˆìš”ì¼_í† ìš”ì¼".split("_"),weekdaysShort:"ì¼_ì›”_í™”_ìˆ˜_ëª©_ê¸ˆ_í† ".split("_"),weekdaysMin:"ì¼_ì›”_í™”_ìˆ˜_ëª©_ê¸ˆ_í† ".split("_"),months:"1ì›”_2ì›”_3ì›”_4ì›”_5ì›”_6ì›”_7ì›”_8ì›”_9ì›”_10ì›”_11ì›”_12ì›”".split("_"),monthsShort:"1ì›”_2ì›”_3ì›”_4ì›”_5ì›”_6ì›”_7ì›”_8ì›”_9ì›”_10ì›”_11ì›”_12ì›”".split("_"),ordinal:function(l){return l+"ì¼"},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYYë…„ MMMM Dì¼",LLL:"YYYYë…„ MMMM Dì¼ A h:mm",LLLL:"YYYYë…„ MMMM Dì¼ dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYYë…„ MMMM Dì¼",lll:"YYYYë…„ MMMM Dì¼ A h:mm",llll:"YYYYë…„ MMMM Dì¼ dddd A h:mm"},meridiem:function(l){return l<12?"ì˜¤ì „":"ì˜¤í›„"},relativeTime:{future:"%s í›„",past:"%s ì „",s:"ëª‡ ì´ˆ",m:"1ë¶„",mm:"%dë¶„",h:"í•œ ì‹œê°„",hh:"%dì‹œê°„",d:"í•˜ë£¨",dd:"%dì¼",M:"í•œ ë‹¬",MM:"%dë‹¬",y:"ì¼ ë…„",yy:"%dë…„"}};return a.default.locale(i,null,!0),i})})(mb);hr.extend(xb);hr.locale("ko");const{Text:io,Title:fb}=we,yb=s=>{const r={pending:{color:"processing",text:"ëŒ€ê¸° ì¤‘"},accepted:{color:"success",text:"ìˆ˜ë½ë¨"},rejected:{color:"default",text:"ê±°ì ˆë¨"},read:{color:"default",text:"ì½ìŒ"}}[s];return e.jsx(T,{color:r.color,children:r.text})},jb=s=>({source:e.jsx(mn,{style:{fontSize:20}}),sast:e.jsx(Pa,{style:{fontSize:20}}),build:e.jsx(Yo,{style:{fontSize:20}}),sca:e.jsx(mn,{style:{fontSize:20}}),deploy:e.jsx(Bm,{style:{fontSize:20}}),operation:e.jsx(_t,{style:{fontSize:20}}),dast:e.jsx(Pa,{style:{fontSize:20}})})[s||""]||e.jsx(dr,{style:{fontSize:20}}),bb=(s,t)=>{const n={source:"ì†ŒìŠ¤ ë¶„ì„",sast:"SAST",build:"ë¹Œë“œ",sca:"SCA",deploy:"ë°°í¬",operation:"ìš´ì˜",dast:"DAST"}[s||""]||s||"";let a="default";return t==="started"&&(a="processing"),t==="completed"&&(a="success"),t==="failed"&&(a="error"),e.jsx(T,{color:a,children:n})},_b=({open:s,onClose:t,notifications:r,loading:n,onAcceptInvitation:a,onRejectInvitation:i,onMarkAsRead:l,onMarkAllAsRead:d})=>{const c=_=>{var P,I,$,y,v,u,m,j,b;const S=_.type==="organization_invite",L=_.type==="system"&&((P=_.data)==null?void 0:P.stage),k=_.status==="pending",E=_.status==="pending";return e.jsx(ar.Item,{style:{backgroundColor:E?"#f0f7ff":"transparent",padding:"16px",borderRadius:"8px",marginBottom:"8px"},actions:S&&k?[e.jsx(B,{type:"primary",size:"small",icon:e.jsx(Nm,{}),onClick:()=>p(_.id),children:"ìˆ˜ë½"},"accept"),e.jsx(B,{size:"small",danger:!0,icon:e.jsx(Gp,{}),onClick:()=>h(_.id),children:"ê±°ì ˆ"},"reject")]:_.status==="pending"?[e.jsx(B,{size:"small",icon:e.jsx(Ze,{}),onClick:()=>l(_.id),children:"ì½ìŒ"},"read")]:[],children:e.jsx(ar.Item.Meta,{avatar:e.jsx(ps,{dot:E,offset:[-5,5],children:L?e.jsx("div",{style:{color:((I=_.data)==null?void 0:I.stageStatus)==="failed"?"#ff4d4f":(($=_.data)==null?void 0:$.stageStatus)==="completed"?"#52c41a":"#1890ff"},children:jb((y=_.data)==null?void 0:y.stage)}):e.jsx(Ko,{style:{fontSize:24,color:E?"#1890ff":"#8c8c8c"}})}),title:e.jsxs(g,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsxs(g,{children:[e.jsx(io,{strong:!0,children:_.title}),L?bb((v=_.data)==null?void 0:v.stage,(u=_.data)==null?void 0:u.stageStatus):yb(_.status)]}),e.jsx(io,{type:"secondary",style:{fontSize:12},children:hr(_.createdAt).fromNow()})]}),description:e.jsxs(g,{direction:"vertical",size:8,style:{width:"100%",marginTop:8},children:[e.jsx(io,{children:_.message}),((m=_.data)==null?void 0:m.inviterEmail)&&e.jsxs(io,{type:"secondary",style:{fontSize:12},children:["ì´ˆëŒ€ì: ",_.data.inviterEmail]}),L&&((j=_.data)==null?void 0:j.serviceName)&&e.jsxs(io,{type:"secondary",style:{fontSize:12},children:["ì„œë¹„ìŠ¤: ",_.data.serviceName]}),L&&((b=_.data)==null?void 0:b.errorMessage)&&e.jsxs(io,{type:"danger",style:{fontSize:12},children:["ì˜¤ë¥˜: ",_.data.errorMessage]})]})})})},p=async _=>{await a(_)},h=async _=>{await i(_)},x=r.filter(_=>_.status==="pending").length;return e.jsx(Am,{title:e.jsxs(g,{style:{width:"100%",justifyContent:"space-between"},children:[e.jsxs(fb,{level:4,style:{margin:0},children:["ì•Œë¦¼ ",e.jsx(ps,{count:x,showZero:!1})]}),x>0&&e.jsx(B,{type:"link",size:"small",onClick:d,children:"ëª¨ë‘ ì½ìŒ"})]}),placement:"right",onClose:t,open:s,width:480,children:r.length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤",style:{marginTop:100}}):e.jsxs(e.Fragment,{children:[e.jsx(xt,{style:{marginTop:0}}),e.jsx(ar,{dataSource:r,renderItem:c,loading:n,style:{maxHeight:"calc(100vh - 120px)",overflowY:"auto"}})]})})},{Header:wb,Content:Sb}=Wp,Uh=[{key:"dashboard",path:"/dashboard",icon:e.jsx(ii,{}),label:"ëŒ€ì‹œë³´ë“œ",requiredPermission:null},{key:"device_management",path:"/devices",icon:e.jsx(il,{}),label:"ì¥ë¹„ ê´€ë¦¬",requiredPermission:"device"},{key:"runtime_management",path:"/runtimes",icon:e.jsx(_t,{}),label:"ëŸ°íƒ€ì„ í™˜ê²½",requiredPermission:"infra"},{key:"backup_management",path:"/backup",icon:e.jsx(pr,{}),label:"ë°±ì—… ê´€ë¦¬",requiredPermission:"backup"},{key:"service_management",path:"/services",icon:e.jsx(Da,{}),label:"ì„œë¹„ìŠ¤ ê´€ë¦¬",requiredPermission:"service"},{key:"database_management",path:"/database",icon:e.jsx(_s,{}),label:"ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬",requiredPermission:"service"},{key:"user_management",path:"/users",icon:e.jsx(Ld,{}),label:"ì‚¬ìš©ì ê´€ë¦¬",requiredPermission:null},{key:"Owner",path:"/organizations",icon:e.jsx(Kp,{}),label:"ê¸°ê´€ ê´€ë¦¬",requiredPermission:null}],vb=()=>{const[s,t]=o.useState(!1),[r,n]=o.useState(null),a=async()=>{var i;try{const d=(await ze.checkHealth()).data;(i=d==null?void 0:d.data)!=null&&i.is_expired&&(n({expiryDate:d.data.expiry_date||"",message:"ë¼ì´ì„ ìŠ¤ê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),t(!0))}catch(l){O.error("ë¼ì´ì„ ìŠ¤ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨",l)}};return o.useEffect(()=>{a();const i=l=>{n(l.detail),t(!0)};return window.addEventListener("licenseExpired",i),()=>{window.removeEventListener("licenseExpired",i)}},[]),{showExpiredAlert:s,expiryInfo:r,setShowExpiredAlert:t}},kb=()=>{const s=ym(),{user:t,logout:r,tokenExpiresAt:n,refreshToken:a}=Tn(),{showExpiredAlert:i,expiryInfo:l,setShowExpiredAlert:d}=vb(),[c,p]=o.useState(!1),[h,x]=o.useState(""),[_,S]=o.useState(!1),[L,k]=o.useState(!1),E=o.useCallback(D=>{const M=Date.now(),K=D-M;if(K<=0)return"ë§Œë£Œë¨";const J=Math.floor(K/(1e3*60*60)),te=Math.floor(K%(1e3*60*60)/(1e3*60));return J>0?`${J}ì‹œê°„ ${te}ë¶„`:`${te}ë¶„`},[]);o.useEffect(()=>{if(!n)return;const D=()=>{const K=n-Date.now();x(E(n)),S(K<60*60*1e3&&K>0)};D();const M=setInterval(D,6e4);return()=>clearInterval(M)},[n,E]);const P=async()=>{k(!0);try{await a()?f.success("ì„¸ì…˜ì´ 24ì‹œê°„ ì—°ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."):f.error("ì„¸ì…˜ ì—°ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.")}catch(D){f.error("ì„¸ì…˜ ì—°ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{k(!1)}},{notifications:I,unreadCount:$,isLoading:y,loadNotifications:v,acceptInvitation:u,rejectInvitation:m,markAsRead:j,markAllAsRead:b}=pb();o.useEffect(()=>{c&&v()},[c,v]);const A=Uh.filter(D=>{var M;return D.key==="dashboard"?!0:D.key==="Owner"?(t==null?void 0:t.role)==="Owner":D.key==="user_management"?(t==null?void 0:t.role)==="Owner"||(t==null?void 0:t.role)==="Manager":(t==null?void 0:t.role)==="Owner"||(t==null?void 0:t.role)==="Manager"?!0:D.requiredPermission?(M=t==null?void 0:t.permissions)==null?void 0:M.includes(D.requiredPermission):!1}),W=async()=>{var D,M,K;try{const te=(D=(await ze.user.getInitialGitLabPassword()).data.data)==null?void 0:D.password;rt.info({title:"GitLab ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸",content:e.jsxs("div",{children:[e.jsx("p",{style:{marginTop:"12px"},children:"ì‹œìŠ¤í…œì—ì„œ ë°œê¸‰ëœ GitLab ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤."}),e.jsx(ue.Password,{value:te,readOnly:!0}),e.jsxs("p",{style:{color:"red",marginTop:"12px"},children:[e.jsx("strong",{children:"âš ï¸ ì¤‘ìš”:"})," ì´ ë¹„ë°€ë²ˆí˜¸ë¡œ GitLabì— ì²˜ìŒ ë¡œê·¸ì¸í•œ í›„, ì¦‰ì‹œ ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”."]})]}),okText:"í™•ì¸",width:450})}catch(J){const te=J,G=((K=(M=te==null?void 0:te.response)==null?void 0:M.data)==null?void 0:K.error)||"ë¹„ë°€ë²ˆí˜¸ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";f.warning(G)}},Z=[{key:"gitlab-password",icon:e.jsx(za,{}),label:"GitLab ë¹„ë°€ë²ˆí˜¸ í™•ì¸",onClick:()=>{W()}},{key:"logout",icon:e.jsx($m,{}),label:"ë¡œê·¸ì•„ì›ƒ",onClick:r}],ce=(D=>{const K=[...Uh].sort((J,te)=>te.path.length-J.path.length).find(J=>D.startsWith(J.path));return K?K.key:""})(s.pathname);return e.jsxs(Wp,{style:{minHeight:"100vh"},children:[i&&l&&e.jsx(rt,{title:"ë¼ì´ì„ ìŠ¤ ë§Œë£Œ ì•Œë¦¼",open:i,onOk:()=>d(!1),onCancel:()=>d(!1),okText:"í™•ì¸",cancelText:"ë‹«ê¸°",children:e.jsx(xe,{message:l.message,description:e.jsxs("div",{children:[e.jsxs("p",{children:["ë§Œë£Œì¼: ",l.expiryDate]}),e.jsx("p",{children:"ë¼ì´ì„ ìŠ¤ê°€ ë§Œë£Œë˜ì–´ ì„œë¹„ìŠ¤ ì´ìš©ì´ ì œí•œë©ë‹ˆë‹¤."}),e.jsx("p",{children:"ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì—¬ ë¼ì´ì„ ìŠ¤ë¥¼ ê°±ì‹ í•´ì£¼ì„¸ìš”."})]}),type:"error",showIcon:!0})}),e.jsxs(wb,{className:"system-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("img",{src:"/favicon-32x32.png",alt:"KIWI",className:"header-icon",style:{width:24,height:24}}),e.jsx("h1",{children:"KIWI"})]}),e.jsxs("div",{className:"header-right",children:[n&&e.jsx(Ie,{title:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{children:"í´ë¦­í•˜ì—¬ ì„¸ì…˜ ì—°ì¥ (24ì‹œê°„)"}),_&&e.jsx("div",{style:{color:"#ffccc7",fontSize:11,marginTop:4},children:"1ì‹œê°„ ë¯¸ë§Œ - ì—°ì¥ì„ ê¶Œì¥í•©ë‹ˆë‹¤"})]}),children:e.jsx(B,{type:"text",size:"small",className:`session-timer ${_?"session-timer-warning":""}`,onClick:P,loading:L,icon:e.jsx(wr,{}),style:{marginRight:12,color:_?"#ff4d4f":"#595959",fontWeight:500,fontSize:13,height:32,borderRadius:4,background:_?"#fff2f0":"transparent",border:_?"1px solid #ffccc7":"none"},children:h})}),e.jsx(ps,{count:$,offset:[-5,5],style:{marginRight:16},children:e.jsx(B,{type:"text",icon:e.jsx(Ko,{style:{fontSize:20}}),onClick:()=>p(!0),style:{padding:"4px 8px"}})}),e.jsxs("div",{style:{display:"flex",gap:8,marginRight:8},children:[e.jsx(B,{size:"small",onClick:()=>{hb()},children:"ë‚´ë³´ë‚´ê¸°"}),e.jsx(B,{size:"small",onClick:()=>{const D=document.createElement("input");D.type="file",D.accept="application/json",D.onchange=async()=>{var K;const M=(K=D.files)==null?void 0:K[0];M&&rt.confirm({title:"ê°€ì ¸ì˜¤ê¸° ë°©ì‹ ì„ íƒ",content:e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ì™„ì „ êµì²´:"})," ê¸°ì¡´ ì¸ì¦ ì •ë³´ë¥¼ ëª¨ë‘ ì§€ìš°ê³  ìƒˆë¡œìš´ ì •ë³´ë¡œ êµì²´"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ë³‘í•©:"})," ê¸°ì¡´ ì •ë³´ëŠ” ìœ ì§€í•˜ê³  ìƒˆë¡œìš´ ì •ë³´ë§Œ ì¶”ê°€/ì—…ë°ì´íŠ¸"]})]}),okText:"ì™„ì „ êµì²´",cancelText:"ë³‘í•©",onOk:async()=>{const J=await Fh(M,"replace");J.ok?f.success("ì¸ì¦ ì •ë³´ë¥¼ ì™„ì „íˆ êµì²´í–ˆìŠµë‹ˆë‹¤."):f.error(`ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: ${J.error}`)},onCancel:async()=>{const J=await Fh(M,"merge");J.ok?f.success("ì¸ì¦ ì •ë³´ë¥¼ ë³‘í•©í–ˆìŠµë‹ˆë‹¤."):f.error(`ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: ${J.error}`)}})},D.click()},children:"ê°€ì ¸ì˜¤ê¸°"})]}),t&&e.jsx(uu,{menu:{items:Z},placement:"bottomRight",children:e.jsx(B,{type:"text",icon:e.jsx(Un,{}),children:t.email})})]})]}),e.jsx("div",{className:"tab-menu",children:A.map(D=>e.jsxs(gc,{to:D.path,className:`tab-item ${D.key===ce?"active":""}`,children:[e.jsx("div",{className:"tab-icon",children:D.icon}),e.jsx("span",{children:D.label})]},D.key))}),e.jsx(Sb,{className:"system-content",children:e.jsx(au,{})}),e.jsx(_b,{open:c,onClose:()=>p(!1),notifications:I,loading:y,onAcceptInvitation:u,onRejectInvitation:m,onMarkAsRead:j,onMarkAllAsRead:b})]})},Hh=({roles:s})=>{const{isAuthenticated:t,isLoading:r,user:n}=Tn();if(r)return e.jsx("div",{children:"Loading..."});if(!t)return e.jsx(rc,{to:"/login",replace:!0});if(s&&s.length>0){const a=n==null?void 0:n.role,i=s.map(d=>String(d).toLowerCase()),l=a?String(a).toLowerCase():"";if(!l||!i.includes(l))return e.jsx(rc,{to:"/",replace:!0})}return e.jsx(au,{})},Fn={getAllOrganizations:()=>ee.request("/organization","getAllOrganizations",{}),getMyOrganizations:()=>ee.request("/organization","getMyOrganizations",{}),getOrganizationByID:s=>ee.request("/organization","getOrganizationByID",{id:s}),createOrganization:s=>ee.request("/organization","createOrganization",s),updateOrganization:(s,t)=>{const r={id:s,...t};return ee.request("/organization","updateOrganization",r)},deleteOrganization:s=>ee.request("/organization","deleteOrganization",{id:s}),getOrganizationMembers:s=>ee.request("/organization","getOrganizationMembers",{organizationId:s}),getAllUsersForOwner:()=>ee.request("/organization","getAllUsersForOwner",{}),inviteMember:(s,t)=>ee.request("/organization","inviteMember",{organizationId:s,...t}),removeMember:(s,t)=>ee.request("/organization","removeMember",{organizationId:s,userId:t}),updateMemberRole:(s,t,r,n)=>ee.request("/organization","updateMemberRole",{organizationId:s,userId:t,role:r,permissions:n}),getGitUrls:s=>ee.request("/organization","getGitlabUrls",{organizationId:s}),addGitUrl:(s,t)=>ee.request("/organization","addGitlabUrl",{organizationId:s,gitlabUrl:t}),removeGitlabUrl:(s,t)=>ee.request("/organization","removeGitlabUrl",{id:s,organizationId:t}),addUserToOrganization:(s,t,r="Member",n=["infra","service","backup","device"])=>ee.request("/organization","addUserToOrganization",{userId:s,organizationId:t,role:r,permissions:n}),removeUserFromOrganization:(s,t)=>ee.request("/organization","removeUserFromOrganization",{userId:s,organizationId:t}),updateUserOrganizations:(s,t)=>ee.request("/organization","updateUserOrganizations",{userId:s,organizations:t}),request:(s,t)=>ee.request("/organization",s,t)},{Title:Vh,Text:Zl}=we,{Option:cd}=Ee,{TextArea:Cb}=ue,Ib=async()=>{try{const s=await ol.getAllUsers();return s.success&&s.data?s.data.filter(r=>r.role!=="Admin").map(r=>({id:r.id,email:r.email,name:r.name})):(f.error(`ê´€ë¦¬ì ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨: ${s.error||"API ì˜¤ë¥˜"}`),[])}catch(s){return f.error("ì„œë²„ì™€ì˜ í†µì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),[]}},qh={q:"",statuses:[],planTypes:[]},Qg=[{label:"Active",value:"Active"},{label:"Pending",value:"Pending"}],Xg=[{label:"Free",value:"Free"},{label:"Standard",value:"Standard"},{label:"Enterprise",value:"Enterprise"}],Tb=()=>{const[s,t]=o.useState([]),[r,n]=o.useState(!1),[a,i]=o.useState(qh),[l,d]=o.useState(!1),[c,p]=o.useState(null),h=async()=>{n(!0);try{const y=await Fn.getAllOrganizations();y.success&&y.data?t(y.data):(f.error(`ê¸°ê´€ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨: ${y.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`),t([]))}catch(y){f.error("ì„œë²„ì™€ì˜ í†µì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{n(!1)}};o.useEffect(()=>{h()},[]);const x=o.useMemo(()=>{const y=a.q.trim().toLowerCase();return s.filter(v=>{const u=!y||v.name.toLowerCase().includes(y)||v.businessRegistrationNumber&&v.businessRegistrationNumber.toLowerCase().includes(y),m=!a.statuses.length||a.statuses.includes(v.status),j=!a.planTypes.length||a.planTypes.includes(v.planType);return u&&m&&j})},[s,a]),_=()=>{p(null),d(!0)},S=y=>{p(y),d(!0)},L=async y=>{try{const v=await Fn.deleteOrganization(y);v.success?(t(u=>u.filter(m=>m.id!==y)),f.success(`ê¸°ê´€ ID ${y}ë¥¼ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.`)):f.error(`ì‚­ì œ ì‹¤íŒ¨: ${v.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}catch(v){f.error("ì„œë²„ì™€ì˜ í†µì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},k=async y=>{try{let v;c?(v=await Fn.updateOrganization(c.id,y),v.success&&f.success(`${y.name} ê¸°ê´€ ì •ë³´ë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.`)):(v=await Fn.createOrganization(y),v.success&&f.success(`${y.name} ê¸°ê´€ì„ ìƒˆë¡œ ìƒì„±í–ˆìŠµë‹ˆë‹¤.`)),v&&v.success?(d(!1),await h()):v?f.error(`ì‘ì—… ì‹¤íŒ¨: ${v.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`):f.error("ìš”ì²­ ì¤‘ ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}catch(v){f.error("ì„œë²„ì™€ì˜ í†µì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},E=y=>{switch(y){case"Active":return"success";case"Pending":return"warning";default:return"default"}},P=[{title:"ê¸°ê´€ ì´ë¦„",dataIndex:"name",key:"name",render:y=>e.jsx(Zl,{strong:!0,children:y})},{title:"í”Œëœ ìœ í˜•",dataIndex:"planType",key:"planType",render:y=>e.jsx(T,{color:y==="Enterprise"?"gold":y==="Standard"?"blue":"default",children:y})},{title:"ê´€ë¦¬ì",dataIndex:"managerEmails",key:"managerEmails",width:250,render:(y,v)=>{const u=v.managerCount||0;if(u===0)return e.jsx(Zl,{type:"secondary",children:"ê´€ë¦¬ì ì—†ìŒ"});const m=y.slice(0,2),j=u-m.length;return e.jsxs(g,{direction:"vertical",size:2,style:{width:"100%"},children:[e.jsxs(Zl,{strong:!0,style:{fontSize:"12px",color:"#1890ff"},children:[e.jsx(Yp,{})," ê´€ë¦¬ì ",u,"ëª…"]}),e.jsx(Ie,{title:e.jsx("div",{children:y.map((b,A)=>e.jsxs("div",{style:{marginBottom:4},children:["â€¢ ",b]},A))}),placement:"topLeft",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:"4px"},children:[m.map((b,A)=>e.jsx(T,{color:"blue",style:{maxWidth:"220px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},children:b},A)),j>0&&e.jsxs(T,{color:"default",children:["+",j,"ëª…"]})]})})]})}},{title:"ì‚¬ì—…ì ë²ˆí˜¸",dataIndex:"businessRegistrationNumber",key:"businessRegistrationNumber",render:y=>y||"-"},{title:"ìƒíƒœ",dataIndex:"status",key:"status",render:y=>e.jsx(T,{color:E(y),children:y})},{title:"ìƒì„±ì¼",dataIndex:"createdAt",key:"createdAt",render:y=>hr(y).format("YYYY-MM-DD"),sorter:(y,v)=>hr(y.createdAt).valueOf()-hr(v.createdAt).valueOf(),defaultSortOrder:"descend"},{title:"ì‘ì—…",key:"actions",width:120,render:(y,v)=>e.jsxs(g,{size:"small",children:[e.jsx(Ie,{title:"ìˆ˜ì •",children:e.jsx(B,{size:"small",icon:e.jsx(ln,{}),onClick:()=>S(v)})}),e.jsx(Ie,{title:"ì‚­ì œ",children:e.jsx(Kt,{title:"ê¸°ê´€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:"ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê´€ë ¨ëœ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ì‚­ì œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",onConfirm:()=>L(v.id),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{})})})})]})}],I=s.filter(y=>y.status==="Active").length,$=s.filter(y=>y.planType==="Enterprise").length;return s.reduce((y,v)=>y+(v.managerCount||0),0),e.jsxs("div",{className:"organizations-management management-page",children:[e.jsx(ie,{className:"page-header-card",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(g,{align:"center",children:[e.jsx(Kp,{style:{fontSize:24,color:"#1890ff"}}),e.jsx(Vh,{level:3,style:{margin:0},children:"ê¸°ê´€ ê´€ë¦¬"})]}),e.jsxs(g,{className:"header-actions",wrap:!0,children:[e.jsx(B,{icon:e.jsx(zs,{}),onClick:h,loading:r,children:"ìƒˆë¡œê³ ì¹¨"}),e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:_,children:"ìƒˆ ê¸°ê´€ ë“±ë¡"})]})]})}),e.jsxs(Ke,{gutter:[16,16],className:"stat-row",style:{marginBottom:16},children:[e.jsx(Y,{xs:24,sm:8,children:e.jsx(ie,{size:"small",children:e.jsx($e,{title:"ì „ì²´ ê¸°ê´€",value:s.length,suffix:"ê°œ",prefix:e.jsx(fo,{style:{color:"#1890ff"}})})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx(ie,{size:"small",children:e.jsx($e,{title:"í™œì„± ê¸°ê´€",value:I,suffix:`/ ${s.length}`,prefix:e.jsx(Ze,{style:{color:"#52c41a"}})})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx(ie,{size:"small",children:e.jsx($e,{title:"Enterprise í”Œëœ",value:$,suffix:"ê°œ",prefix:e.jsx(Ad,{style:{color:"#faad14"}})})})})]}),e.jsx(Ke,{gutter:[16,16],children:e.jsx(Y,{span:24,children:e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(fo,{}),e.jsxs(Vh,{level:4,style:{margin:0},children:["ì „ì²´ ê¸°ê´€ ëª©ë¡ (",x.length,"ê°œ)"]})]}),children:[e.jsx(ie,{size:"small",className:"filter-card",style:{marginBottom:16},children:e.jsxs(g,{wrap:!0,align:"center",size:[12,12],style:{width:"100%"},children:[e.jsx(ue,{allowClear:!0,placeholder:"ê¸°ê´€ ì´ë¦„ ë˜ëŠ” ì‚¬ì—…ì ë²ˆí˜¸ ê²€ìƒ‰",value:a.q,onChange:y=>i({...a,q:y.target.value}),style:{width:280}}),e.jsx(Ee,{mode:"multiple",allowClear:!0,placeholder:"ìƒíƒœ í•„í„°",value:a.statuses,options:Qg,onChange:y=>i({...a,statuses:y}),style:{minWidth:200}}),e.jsx(Ee,{mode:"multiple",allowClear:!0,placeholder:"í”Œëœ ìœ í˜• í•„í„°",value:a.planTypes,options:Xg,onChange:y=>i({...a,planTypes:y}),style:{minWidth:200}}),e.jsx(B,{onClick:()=>i(qh),icon:e.jsx(rn,{}),children:"í•„í„° ì´ˆê¸°í™”"})]})}),e.jsx(wt,{columns:P,dataSource:x,rowKey:"id",loading:r,pagination:{pageSize:10},scroll:{x:1e3}})]})})}),e.jsx(Rb,{visible:l,onCancel:()=>d(!1),onSubmit:k,initialData:c})]})},Rb=({visible:s,onCancel:t,onSubmit:r,initialData:n})=>{const[a]=H.useForm(),[i,l]=o.useState([]),[d,c]=o.useState(!1);o.useEffect(()=>{s&&(async()=>{c(!0);const x=await Ib();l(x),c(!1)})()},[s]),o.useEffect(()=>{if(!s){a.resetFields();return}if(!(d||i.length===0))if(n){const h=i.filter(x=>{var _;return(_=n.managerEmails)==null?void 0:_.includes(x.email)}).map(x=>x.id);a.setFieldsValue({id:n.id,name:n.name,status:n.status||"Pending",planType:n.planType||"Standard",managerUserIds:h,businessRegistrationNumber:n.businessRegistrationNumber||void 0,billingAddress:n.billingAddress||void 0})}else a.setFieldsValue({name:"",status:"Pending",planType:"Standard",managerUserIds:[],businessRegistrationNumber:void 0,billingAddress:void 0})},[s,n,a,i,d]);const p=h=>{const x={name:h.name,status:h.status,planType:h.planType,managerUserIds:h.managerUserIds||[],businessRegistrationNumber:h.businessRegistrationNumber||null,billingAddress:h.billingAddress||null};r(x)};return e.jsx(rt,{title:n?"ê¸°ê´€ ì •ë³´ ìˆ˜ì •":"ìƒˆ ê¸°ê´€ ë“±ë¡",visible:s,onCancel:t,footer:[e.jsx(B,{onClick:t,children:"ì·¨ì†Œ"},"back"),e.jsx(B,{type:"primary",onClick:()=>a.submit(),children:n?"ìˆ˜ì •":"ë“±ë¡"},"submit")],destroyOnClose:!0,width:500,children:e.jsxs(H,{form:a,layout:"vertical",onFinish:p,children:[e.jsx(H.Item,{name:"name",label:"ê¸°ê´€ ì´ë¦„",rules:[{required:!0,message:"ê¸°ê´€ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{prefix:e.jsx(fo,{}),placeholder:"ì˜ˆ: Line World"})}),e.jsx(H.Item,{name:"managerUserIds",label:"ê¸°ê´€ ê´€ë¦¬ì",rules:[{required:!0,type:"array",min:1,message:"ìµœì†Œ 1ëª… ì´ìƒì˜ ê´€ë¦¬ìë¥¼ ì„ íƒí•˜ì„¸ìš”"}],tooltip:"ê¸°ê´€ì„ ê´€ë¦¬í•  ê´€ë¦¬ìë¥¼ ì„ íƒí•˜ì„¸ìš”. ì—¬ëŸ¬ ëª…ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",children:e.jsx(Ee,{mode:"multiple",placeholder:d?"ì‚¬ìš©ì ëª©ë¡ ë¡œë”© ì¤‘...":"ê´€ë¦¬ì ì„ íƒ (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)",notFoundContent:d?e.jsx(gt,{size:"small"}):"ì„ íƒ ê°€ëŠ¥í•œ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤.",showSearch:!0,optionFilterProp:"children",filterOption:(h,x)=>{var _;return(_=x==null?void 0:x.children)==null?void 0:_.toLowerCase().includes(h.toLowerCase())},children:i.map(h=>e.jsx(cd,{value:h.id,children:`${h.email}`},h.id))})}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"businessRegistrationNumber",label:"ì‚¬ì—…ì ë“±ë¡ ë²ˆí˜¸",children:e.jsx(ue,{prefix:e.jsx(Yp,{}),placeholder:"ì˜ˆ: 123-45-67890 (ì„ íƒ ì‚¬í•­)"})})}),e.jsx(Y,{span:12})]}),e.jsx(H.Item,{name:"billingAddress",label:"ì²­êµ¬ ì£¼ì†Œ",children:e.jsx(Cb,{rows:2,placeholder:"ì˜ˆ: ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123 (ì„ íƒ ì‚¬í•­)"})}),e.jsx(H.Item,{name:"planType",label:"ì„œë¹„ìŠ¤ í”Œëœ",rules:[{required:!0,message:"í”Œëœ ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"í”Œëœ ì„ íƒ",children:Xg.map(h=>e.jsx(cd,{value:h.value,children:h.label},h.value))})}),e.jsx(H.Item,{name:"status",label:"ê¸°ê´€ ìƒíƒœ",rules:[{required:!0,message:"ìƒíƒœë¥¼ ì„ íƒí•˜ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ìƒíƒœ ì„ íƒ",disabled:!n,children:Qg.map(h=>e.jsx(cd,{value:h.value,children:h.label},h.value))})}),n&&e.jsx(H.Item,{label:"ìƒì„±ì¼ì‹œ/ìµœì¢… ìˆ˜ì •ì¼ì‹œ",children:e.jsxs(Zl,{type:"secondary",children:["ìƒì„±: ",hr(n.createdAt).format("YYYY-MM-DD HH:mm:ss")," ","/ ìˆ˜ì •:"," ",hr(n.lastModified).format("YYYY-MM-DD HH:mm:ss")]})})]})})},zb=()=>{const[s,t]=o.useState([]),[r,n]=o.useState(null),[a,i]=o.useState(!1),[l,d]=o.useState(null),c=o.useCallback(async()=>{i(!0),d(null);try{const h=await Fn.getMyOrganizations();if(h.success&&h.data)t(h.data),h.data.length>0&&r===null&&n(h.data[0].id);else{const x=`ê¸°ê´€ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨: ${h.error||"API ì˜¤ë¥˜"}`;d(x),f.error(x)}}catch(h){const x="ì†Œì† ê¸°ê´€ ëª©ë¡ ë¡œë“œ ì¤‘ ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";d(x),f.error(x)}finally{i(!1)}},[r]),p=s.find(h=>h.id===r);return o.useEffect(()=>{c()},[c]),{organizations:s,selectedOrgId:r,setSelectedOrgId:n,selectedOrganization:p,isLoading:a,error:l,loadOrganizations:c}},Eb=s=>{const[t,r]=o.useState([]),[n,a]=o.useState(!1),[i,l]=o.useState(null),d=o.useCallback(async()=>{if(!s){r([]);return}a(!0),l(null);try{const h=await Fn.getOrganizationMembers(s);if(h.success&&h.data)r(h.data);else{const x=`ì‚¬ìš©ì ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨: ${h.error||"API ì˜¤ë¥˜"}`;l(x),f.error(x),r([])}}catch(h){const x="ì†Œì† ì‚¬ìš©ì ëª©ë¡ ë¡œë“œ ì¤‘ ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";l(x),f.error(x),r([])}finally{a(!1)}},[s]),c=o.useCallback(async h=>{if(!s)return!1;try{f.loading({content:`${h} ì´ˆëŒ€ ìš”ì²­ ì¤‘...`,key:"invite"});const x=await Fn.inviteMember(s,{email:h});return x.success?(f.success({content:`${h}ë‹˜ì„ ê¸°ê´€ì— ì„±ê³µì ìœ¼ë¡œ ì´ˆëŒ€í–ˆìŠµë‹ˆë‹¤.`,key:"invite"}),await d(),!0):(f.error({content:`ì´ˆëŒ€ ì‹¤íŒ¨: ${x.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`,key:"invite"}),!1)}catch(x){return f.error({content:"ì‚¬ìš©ì ì´ˆëŒ€ ì¤‘ ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",key:"invite"}),!1}},[s,d]),p=o.useCallback(async(h,x)=>{if(!s)return!1;try{f.loading({content:`${x} ë‚´ë³´ë‚´ëŠ” ì¤‘...`,key:"remove"});const _=await Fn.removeMember(s,h);return _.success?(f.success({content:`${x}ë‹˜ì„ ê¸°ê´€ì—ì„œ ë‚´ë³´ëƒˆìŠµë‹ˆë‹¤.`,key:"remove"}),r(S=>S.filter(L=>L.id!==h)),!0):(f.error({content:`ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨: ${_.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`,key:"remove"}),!1)}catch(_){return f.error({content:"ì‚¬ìš©ì ë‚´ë³´ë‚´ê¸° ì¤‘ ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",key:"remove"}),!1}},[s]);return o.useEffect(()=>{d()},[d]),{members:t,isLoading:n,error:i,loadMembers:d,inviteMember:c,removeMember:p}},{Text:Pb}=we,Mb=({visible:s,onCancel:t,onInvite:r})=>{const[n]=H.useForm(),a=async l=>{await r(l.email)&&(n.resetFields(),t())},i=()=>{n.resetFields(),t()};return e.jsx(rt,{title:"ì‚¬ìš©ì ì´ˆëŒ€",open:s,onCancel:i,footer:[e.jsx(B,{onClick:i,children:"ì·¨ì†Œ"},"back"),e.jsx(B,{type:"primary",onClick:()=>n.submit(),children:"ì´ˆëŒ€"},"submit")],destroyOnClose:!0,children:e.jsxs(H,{form:n,layout:"vertical",onFinish:a,children:[e.jsx(H.Item,{name:"email",label:"ì´ˆëŒ€í•  ì‚¬ìš©ì ì´ë©”ì¼",rules:[{required:!0,message:"ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"},{type:"email",message:"ìœ íš¨í•œ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤."}],children:e.jsx(ue,{prefix:e.jsx(cu,{}),placeholder:"user@example.com"})}),e.jsx(Pb,{type:"secondary",children:"ì´ˆëŒ€ëœ ì‚¬ìš©ìëŠ” í•´ë‹¹ ê¸°ê´€ì˜ ë©¤ë²„ ê¶Œí•œì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤."})]})})},{Panel:Lb}=nr,{Text:ei}=we,Ab={service:e.jsx(_t,{}),infra:e.jsx(Cn,{}),backup:e.jsx(Ui,{}),device:e.jsx(il,{}),database:e.jsx(_s,{})},dd={service:"#52c41a",infra:"#1890ff",backup:"#722ed1",device:"#eb2f96",database:"#13c2c2"},Nb=[{key:"viewer",label:"ì¡°íšŒ ì „ìš©",description:"ëª¨ë“  ë¦¬ì†ŒìŠ¤ ì¡°íšŒë§Œ ê°€ëŠ¥",icon:e.jsx(xa,{}),color:"#1890ff",permissionFilter:s=>s.code.endsWith(":view")},{key:"operator",label:"ìš´ì˜ì",description:"ì¡°íšŒ + ìš´ì˜ ê¶Œí•œ (ë¡œê·¸, ì¬ì‹œì‘ ë“±)",icon:e.jsx(ln,{}),color:"#52c41a",permissionFilter:s=>s.code.endsWith(":view")||s.code.includes(":restart")||s.code.includes(":logs")||s.code.includes(":test")},{key:"developer",label:"ê°œë°œì",description:"ì„œë¹„ìŠ¤ + DB ê´€ë¦¬ (ë¹Œë“œ/ë°°í¬/ë³´ì•ˆìŠ¤ìº”)",icon:e.jsx(Pa,{}),color:"#722ed1",permissionFilter:s=>s.category==="service"||s.category==="database"},{key:"admin",label:"ì „ì²´ ê¶Œí•œ",description:"ëª¨ë“  ê¶Œí•œ ë¶€ì—¬",icon:e.jsx(pr,{}),color:"#f5222d",permissionFilter:()=>!0},{key:"infra",label:"ì¸í”„ë¼ ê´€ë¦¬",description:"ëŸ°íƒ€ì„ í™˜ê²½ (K8s/Docker/Nginx)",icon:e.jsx(Cn,{}),color:"#1890ff",permissionFilter:s=>s.category==="infra"},{key:"backup",label:"ë°±ì—… ê´€ë¦¬",description:"ë°±ì—… ìƒì„±/ë³µêµ¬/ë‹¤ìš´ë¡œë“œ",icon:e.jsx(Ui,{}),color:"#722ed1",permissionFilter:s=>s.category==="backup"},{key:"device-db",label:"ì¥ë¹„ + DB",description:"ì¥ë¹„ ê´€ë¦¬ + ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬",icon:e.jsx(_s,{}),color:"#13c2c2",permissionFilter:s=>s.category==="device"||s.category==="database"},{key:"read-update",label:"ì¡°íšŒ + ìˆ˜ì •",description:"ì¡°íšŒ ë° ìˆ˜ì • ê¶Œí•œ (ì‚­ì œ/ì‹¤í–‰ ì œì™¸)",icon:e.jsx(ln,{}),color:"#faad14",permissionFilter:s=>s.code.endsWith(":view")||s.code.endsWith(":update")||s.code.includes(":create")}],Gh=["view","create","update","delete","execute","manage","other"],Bb=({value:s=[],onChange:t,disabled:r=!1,showPresets:n=!0,showSearch:a=!0,maxHeight:i=500,compactMode:l=!1})=>{const[d,c]=o.useState(!0),[p,h]=o.useState([]),[x,_]=o.useState({}),[S,L]=o.useState(""),[k,E]=o.useState([]),[P,I]=o.useState(new Set(s));o.useEffect(()=>{(async()=>{c(!0);try{const K=await $i.getAllPermissions();if(K.success&&K.data){h(K.data.permissions||[]),_(K.data.grouped||{});const J=Object.keys(K.data.grouped||{});J.length>0&&E([J[0]])}}catch(K){console.error("Failed to load permissions:",K)}finally{c(!1)}})()},[]),o.useEffect(()=>{I(new Set(s))},[s]);const $=o.useMemo(()=>{if(!S.trim())return x;const M=S.toLowerCase(),K={};return Object.entries(x).forEach(([J,te])=>{const G=te.filter(q=>{var oe;return q.code.toLowerCase().includes(M)||q.name_ko.toLowerCase().includes(M)||((oe=q.description)==null?void 0:oe.toLowerCase().includes(M))});G.length>0&&(K[J]=G)}),K},[x,S]),y=o.useCallback((M,K)=>{I(J=>{const te=new Set(J);return K?te.add(M):te.delete(M),t==null||t(Array.from(te)),te})},[t]),v=o.useCallback((M,K)=>{const J=x[M]||[];I(te=>{const G=new Set(te);return J.forEach(q=>{K?G.add(q.code):G.delete(q.code)}),t==null||t(Array.from(G)),G})},[x,t]),u=o.useCallback(M=>{const K=p.filter(M.permissionFilter),J=new Set(K.map(te=>te.code));I(J),t==null||t(Array.from(J))},[p,t]),m=o.useCallback(()=>{I(new Set),t==null||t([])},[t]),j=o.useCallback(M=>(x[M]||[]).filter(J=>P.has(J.code)).length,[x,P]),b=M=>{const K=og[M],J=ig[M];return M==="low"?null:e.jsx(T,{color:K,style:{fontSize:10,padding:"0 4px",lineHeight:"16px",marginLeft:4},children:J})},A=M=>{const K=P.has(M.code),J=M.risk_level==="high"||M.risk_level==="critical";return e.jsxs("div",{style:{padding:"6px 8px",borderRadius:6,backgroundColor:K?"#e6f7ff":"transparent",border:J&&K?"1px solid #ff4d4f40":"1px solid transparent",marginBottom:4,transition:"all 0.2s"},children:[e.jsx(Vr,{checked:K,disabled:r,onChange:te=>y(M.code,te.target.checked),style:{width:"100%"},children:e.jsxs(g,{size:4,wrap:!0,children:[e.jsx(ei,{code:!0,style:{fontSize:11,backgroundColor:K?"#1890ff15":"#f5f5f5",color:K?"#1890ff":"#666"},children:M.code}),e.jsx(ei,{style:{fontSize:13},children:M.name_ko}),b(M.risk_level),M.requires_approval&&e.jsx(Ie,{title:"ìŠ¹ì¸ í•„ìš”",children:e.jsx(Tr,{style:{color:"#faad14",fontSize:12}})})]})}),!l&&M.description&&e.jsx(ei,{type:"secondary",style:{fontSize:11,marginLeft:24,display:"block",lineHeight:"16px"},children:M.description})]},M.id)},W=M=>{const K=M,J=(x[M]||[]).length,te=j(M),G=te===J&&J>0;return e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx("span",{style:{color:dd[K],marginRight:8},children:Ab[K]}),e.jsx(ei,{strong:!0,style:{flex:1},children:Gl[K]||M}),e.jsx(ps,{count:`${te}/${J}`,style:{backgroundColor:te>0?dd[K]:"#d9d9d9",fontSize:11}}),e.jsx(g,{size:4,style:{marginLeft:12},onClick:q=>q.stopPropagation(),children:e.jsx(Ie,{title:G?"ì „ì²´ í•´ì œ":"ì „ì²´ ì„ íƒ",children:e.jsx(B,{size:"small",type:G?"primary":"default",icon:G?e.jsx($a,{}):e.jsx(Ze,{}),onClick:()=>v(M,!G),disabled:r,style:{padding:"0 6px",height:22,fontSize:11},children:G?"í•´ì œ":"ì „ì²´"})})})]})},Z=M=>{const K={};return M.forEach(te=>{const G=te.subcategory||"other";K[G]||(K[G]=[]),K[G].push(te)}),Object.entries(K).sort((te,G)=>{const q=Gh.indexOf(te[0]),oe=Gh.indexOf(G[0]);return(q===-1?999:q)-(oe===-1?999:oe)})},se=M=>rf[M]||M;if(d)return e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx(gt,{tip:"ê¶Œí•œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})});const ce=P.size,D=p.length;return e.jsxs("div",{className:"granular-permission-selector",children:[e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(ei,{children:"ì„ íƒëœ ê¶Œí•œ:"}),e.jsx(ei,{strong:!0,style:{color:"#1890ff"},children:ce}),e.jsxs(ei,{type:"secondary",children:["/ ",D]})]}),type:"info",showIcon:!0,icon:e.jsx(pr,{}),style:{marginBottom:12},action:ce>0&&e.jsx(B,{size:"small",danger:!0,onClick:m,disabled:r,children:"ì „ì²´ ì´ˆê¸°í™”"})}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx(ei,{type:"secondary",style:{fontSize:12,marginBottom:8,display:"block"},children:"ë¹ ë¥¸ ì„ íƒ í”„ë¦¬ì…‹"}),e.jsx(g,{wrap:!0,children:Nb.map(M=>e.jsx(Ie,{title:M.description,children:e.jsx(B,{size:"small",icon:M.icon,onClick:()=>u(M),disabled:r,style:{borderColor:M.color,color:M.color},children:M.label})},M.key))})]}),e.jsx(xt,{style:{margin:"12px 0"}})]}),a&&e.jsx(ue,{placeholder:"ê¶Œí•œ ì½”ë“œ ë˜ëŠ” ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰...",prefix:e.jsx(Fi,{}),value:S,onChange:M=>L(M.target.value),allowClear:!0,style:{marginBottom:12}}),e.jsx("div",{style:{maxHeight:i,overflowY:"auto"},children:Object.keys($).length===0?e.jsx(Je,{description:"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤"}):e.jsx(nr,{activeKey:k,onChange:M=>E(M),expandIconPosition:"start",children:Object.entries($).map(([M,K])=>e.jsx(Lb,{header:W(M),style:{marginBottom:8},children:Z(K).map(([J,te])=>e.jsxs("div",{style:{marginBottom:12},children:[e.jsx(ei,{type:"secondary",style:{fontSize:11,fontWeight:600,textTransform:"uppercase",letterSpacing:.5,display:"block",marginBottom:4,color:dd[M]},children:se(J)}),e.jsx(Ke,{gutter:[8,0],children:te.map(G=>e.jsx(Y,{xs:24,sm:l?24:12,children:A(G)},G.id))})]},J))},M))})}),Array.from(P).some(M=>{const K=p.find(J=>J.code===M);return(K==null?void 0:K.risk_level)==="high"||(K==null?void 0:K.risk_level)==="critical"})&&e.jsx(xe,{message:"ì£¼ì˜: ë†’ì€ ìœ„í—˜ë„ì˜ ê¶Œí•œì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤",description:"ì‚­ì œ, ì‹¤í–‰ ë“± ìœ„í—˜í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ë¶€ì—¬í•´ì£¼ì„¸ìš”.",type:"warning",showIcon:!0,icon:e.jsx(Tr,{}),style:{marginTop:12}})]})},{Option:ud}=Ee,{Text:hd}=we,$b=[{value:"service",label:"ì„œë¹„ìŠ¤ ê´€ë¦¬",description:"Git ì €ì¥ì†Œ, ë¹Œë“œ/ë°°í¬, ë³´ì•ˆìŠ¤ìº”(SAST/SCA/DAST/SBOM), ìš´ì˜",color:"#52c41a"},{value:"infra",label:"ëŸ°íƒ€ì„ í™˜ê²½",description:"Kubernetes, Docker, Nginx ì„¤ì • ë° ê´€ë¦¬",color:"#1890ff"},{value:"backup",label:"ë°±ì—… ê´€ë¦¬",description:"ë°±ì—… ìƒì„±/ë³µêµ¬/ë‹¤ìš´ë¡œë“œ, ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬",color:"#722ed1"},{value:"device",label:"ì¥ë¹„ ê´€ë¦¬",description:"ì¥ë¹„ ë“±ë¡/ìˆ˜ì •/ì‚­ì œ",color:"#eb2f96"},{value:"database",label:"ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬",description:"DB ì—°ê²°, ë™ê¸°í™”, ë§ˆì´ê·¸ë ˆì´ì…˜",color:"#13c2c2"}],Ql={service:["service:view","service:create","service:update","service:build:view","service:build:execute","service:deploy:view","service:deploy:execute","service:operate:view","service:operate:restart","service:operate:logs","service:security:view","service:security:execute"],infra:["infra:view","infra:create","infra:update","infra:k8s:view","infra:k8s:manage","infra:docker:view","infra:docker:manage","infra:nginx:view","infra:nginx:manage"],backup:["backup:view","backup:create","backup:download","backup:storage:view","backup:storage:manage"],device:["device:view","device:create","device:update"],database:["database:view","database:create","database:update","database:test","database:sync:view","database:sync:execute"]},Ob=s=>{const t=new Set;return s.forEach(r=>{const n=r.split(":")[0];Ql[n]&&t.add(n)}),Array.from(t)},Db=({visible:s,member:t,onCancel:r,onSave:n})=>{const[a]=H.useForm(),[i,l]=o.useState(!1),[d,c]=o.useState("Member"),[p,h]=o.useState(!1),[x,_]=o.useState([]),[S,L]=o.useState([]);o.useEffect(()=>{if(t&&s){const u=t.organizationRole||"Member",m=t.permissions||["infra","service","backup","device"];a.setFieldsValue({role:u,permissions:m}),c(u),L(m);const j=m.some(b=>b.includes(":"));if(h(j),j)_(m);else{const b=m.flatMap(A=>Ql[A]||[]);_(b)}}},[t,s,a]);const k=u=>{L(u);const m=u.flatMap(j=>Ql[j]||[]);_(m),a.setFieldsValue({permissions:u})},E=u=>{_(u);const m=Ob(u);L(m)},P=u=>{if(h(u),!u){const m=S.flatMap(j=>Ql[j]||[]);_(m)}},I=async()=>{try{const u=await a.validateFields();l(!0);const m=p?x:S;await n(u.role,m),a.resetFields(),l(!1),h(!1)}catch(u){l(!1)}},$=()=>{a.resetFields(),h(!1),r()},y=(t==null?void 0:t.organizationRole)==="Owner",v=d==="Owner"||d==="Manager";return e.jsx(rt,{title:e.jsxs(g,{children:[e.jsx(rn,{}),e.jsx("span",{children:"ë©¤ë²„ ì—­í•  ë° ê¶Œí•œ ìˆ˜ì •"})]}),open:s,onOk:I,onCancel:$,confirmLoading:i,okText:"ì €ì¥",cancelText:"ì·¨ì†Œ",width:p?800:600,style:{top:20},styles:{body:{maxHeight:"calc(100vh - 200px)",overflowY:"auto"}},children:t&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{message:`${t.email}ë‹˜ì˜ ì—­í• ê³¼ ê¶Œí•œì„ ìˆ˜ì •í•©ë‹ˆë‹¤.`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(H,{form:a,layout:"vertical",initialValues:{role:"Member",permissions:["infra","service","backup","device"]},children:[e.jsx(H.Item,{name:"role",label:"ê¸°ê´€ ë‚´ ì—­í• ",rules:[{required:!0,message:"ì—­í• ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsxs(Ee,{placeholder:"ì—­í•  ì„ íƒ",onChange:u=>c(u),disabled:y,children:[e.jsx(ud,{value:"Owner",children:e.jsxs(g,{children:[e.jsx(ps,{color:"gold"}),"ì‹œìŠ¤í…œ ê´€ë¦¬ì (Owner)"]})}),e.jsx(ud,{value:"Manager",children:e.jsxs(g,{children:[e.jsx(ps,{color:"blue"}),"ê¸°ê´€ ê´€ë¦¬ì (Manager)"]})}),e.jsx(ud,{value:"Member",children:e.jsxs(g,{children:[e.jsx(ps,{color:"default"}),"ë©¤ë²„ (Member)"]})})]})}),y&&e.jsx(xe,{message:"ì‹œìŠ¤í…œ ê´€ë¦¬ìì˜ ì—­í• ì€ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",type:"warning",showIcon:!0,style:{marginBottom:16}}),v?e.jsx(xe,{message:`${d==="Owner"?"ì‹œìŠ¤í…œ ê´€ë¦¬ì":"ê¸°ê´€ ê´€ë¦¬ì"}ëŠ” ëª¨ë“  ê¶Œí•œì„ ìë™ìœ¼ë¡œ ë³´ìœ í•©ë‹ˆë‹¤.`,description:"ë³„ë„ì˜ ê¶Œí•œ ì„¤ì •ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",type:"success",showIcon:!0,style:{marginBottom:16}}):e.jsxs(e.Fragment,{children:[e.jsx(xt,{style:{margin:"16px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:"8px 12px",backgroundColor:"#fafafa",borderRadius:8},children:[e.jsxs(g,{children:[p?e.jsx(rn,{}):e.jsx(pu,{}),e.jsx(hd,{strong:!0,children:p?"ì„¸ë¶„í™”ëœ ê¶Œí•œ ì„¤ì •":"ê¸°ë³¸ ê¶Œí•œ ì„¤ì •"}),e.jsx(Ie,{title:"ì„¸ë¶„í™” ëª¨ë“œì—ì„œëŠ” ê°œë³„ ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ ê¶Œí•œì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",children:e.jsx(Ks,{style:{color:"#1890ff"}})})]}),e.jsx(Zr,{checked:p,onChange:P,checkedChildren:"ìƒì„¸",unCheckedChildren:"ê¸°ë³¸"})]}),!p&&e.jsx(H.Item,{name:"permissions",label:"ì‹œìŠ¤í…œ ê¶Œí•œ",rules:[{validator:(u,m)=>!m||m.length===0?Promise.reject(new Error("ìµœì†Œ 1ê°œ ì´ìƒì˜ ê¶Œí•œì„ ì„ íƒí•´ì£¼ì„¸ìš”")):Promise.resolve()}],children:e.jsx(Vr.Group,{style:{width:"100%"},value:S,onChange:u=>k(u),children:e.jsx(g,{direction:"vertical",style:{width:"100%"},children:$b.map(u=>e.jsxs("div",{style:{padding:"8px 12px",borderRadius:8,border:S.includes(u.value)?`1px solid ${u.color}40`:"1px solid #f0f0f0",backgroundColor:S.includes(u.value)?`${u.color}08`:"transparent",transition:"all 0.2s"},children:[e.jsx(Vr,{value:u.value,children:e.jsxs(g,{children:[e.jsx("span",{style:{display:"inline-block",width:8,height:8,borderRadius:"50%",backgroundColor:u.color}}),e.jsx(hd,{strong:!0,children:u.label})]})}),e.jsx(hd,{type:"secondary",style:{display:"block",marginLeft:32,fontSize:12},children:u.description})]},u.value))})})}),p&&e.jsx(Bb,{value:x,onChange:E,showPresets:!0,showSearch:!0,maxHeight:400,compactMode:!1})]})]})]})})},{Text:Wh}=we,{Option:Kh}=Ee,Fb=[{value:"infra",label:"ì¸í”„ë¼"},{value:"service",label:"ì„œë¹„ìŠ¤"},{value:"backup",label:"ë°±ì—…"},{value:"device",label:"ì¥ë¹„"},{value:"database",label:"DB"}],Ub=[{value:"Owner",label:"ì†Œìœ ì",color:"gold"},{value:"Manager",label:"ê´€ë¦¬ì",color:"blue"},{value:"Member",label:"ë©¤ë²„",color:"default"}],Hb=({visible:s,user:t,onCancel:r,onSave:n})=>{const[a,i]=o.useState([]),[l,d]=o.useState([]),[c,p]=o.useState(!1),[h,x]=o.useState(!1),[_,S]=o.useState(!1),[L,k]=o.useState(null),E=o.useCallback(async()=>{try{const j=await Fn.getAllOrganizations();j.success&&j.data&&d(j.data)}catch(j){f.error("ê¸°ê´€ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨")}},[]);o.useEffect(()=>{if(s&&t){p(!0);const j=(t.organizations||[]).map(b=>({organizationId:b.organizationId,organizationName:b.organizationName,role:b.role,permissions:b.permissions||["infra","service","backup","device"]}));i(j),E(),p(!1),S(!1),k(null)}},[s,t,E]);const P=async()=>{if(t){x(!0);try{const j=a.map(A=>({organizationId:A.organizationId,role:A.role,permissions:A.permissions})),b=await Fn.updateUserOrganizations(t.id,j);b.success?(f.success("ì‚¬ìš©ì ê¸°ê´€ ì†Œì†ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤."),n()):f.error(b.error||"ì—…ë°ì´íŠ¸ ì‹¤íŒ¨")}catch(j){f.error("ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{x(!1)}}},I=()=>{if(!L)return;if(a.some(b=>b.organizationId===L)){f.warning("ì´ë¯¸ ì†Œì†ëœ ê¸°ê´€ì…ë‹ˆë‹¤.");return}const j=l.find(b=>b.id===L);j&&(i([...a,{organizationId:j.id,organizationName:j.name,role:"Member",permissions:["infra","service","backup","device"]}]),S(!1),k(null))},$=j=>{i(a.filter(b=>b.organizationId!==j))},y=(j,b)=>{i(a.map(A=>A.organizationId===j?{...A,role:b}:A))},v=(j,b)=>{i(a.map(A=>A.organizationId===j?{...A,permissions:b}:A))},u=l.filter(j=>!a.some(b=>b.organizationId===j.id)),m=[{title:"ê¸°ê´€ëª…",dataIndex:"organizationName",key:"organizationName",width:150,render:j=>e.jsxs(g,{children:[e.jsx(fo,{}),e.jsx(Wh,{strong:!0,children:j})]})},{title:"ì—­í• ",dataIndex:"role",key:"role",width:120,render:(j,b)=>e.jsx(Ee,{value:j,onChange:A=>y(b.organizationId,A),style:{width:100},size:"small",children:Ub.map(A=>e.jsx(Kh,{value:A.value,children:e.jsx(T,{color:A.color,style:{margin:0},children:A.label})},A.value))})},{title:"ì‹œìŠ¤í…œ ê¶Œí•œ",dataIndex:"permissions",key:"permissions",render:(j,b)=>b.role==="Owner"||b.role==="Manager"?e.jsx(T,{color:"gold",style:{borderRadius:12,padding:"2px 10px",fontWeight:500},children:"ì „ì²´ ê¶Œí•œ"}):e.jsx(Vr.Group,{options:Fb,value:j,onChange:A=>v(b.organizationId,A),style:{display:"flex",flexWrap:"wrap",gap:4}})},{title:"",key:"actions",width:60,render:(j,b)=>e.jsx(Kt,{title:"ì´ ê¸°ê´€ì—ì„œ ì‚¬ìš©ìë¥¼ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>$(b.organizationId),okText:"ì œê±°",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(B,{type:"text",danger:!0,icon:e.jsx(gs,{}),size:"small"})})}];return e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(fo,{}),e.jsx("span",{children:"ì‚¬ìš©ì ê¸°ê´€ ê´€ë¦¬"}),t&&e.jsx(T,{color:"blue",children:t.email})]}),open:s,onCancel:r,width:700,footer:[e.jsx(B,{onClick:r,children:"ì·¨ì†Œ"},"cancel"),e.jsx(B,{type:"primary",loading:h,onClick:P,children:"ì €ì¥"},"save")],children:[e.jsxs("div",{style:{marginBottom:16},children:[_?e.jsxs(g,{children:[e.jsx(Ee,{placeholder:"ê¸°ê´€ ì„ íƒ",value:L,onChange:k,style:{width:200},showSearch:!0,optionFilterProp:"children",children:u.map(j=>e.jsx(Kh,{value:j.id,children:j.name},j.id))}),e.jsx(B,{type:"primary",onClick:I,disabled:!L,children:"ì¶”ê°€"}),e.jsx(B,{onClick:()=>{S(!1),k(null)},children:"ì·¨ì†Œ"})]}):e.jsx(B,{type:"dashed",icon:e.jsx(rr,{}),onClick:()=>S(!0),disabled:u.length===0,children:"ê¸°ê´€ ì¶”ê°€"}),u.length===0&&!_&&e.jsx(Wh,{type:"secondary",style:{marginLeft:8},children:"(ì¶”ê°€ ê°€ëŠ¥í•œ ê¸°ê´€ì´ ì—†ìŠµë‹ˆë‹¤)"})]}),e.jsx(xt,{style:{margin:"12px 0"}}),e.jsx(wt,{columns:m,dataSource:a,rowKey:"organizationId",loading:c,pagination:!1,size:"small",locale:{emptyText:"ì†Œì†ëœ ê¸°ê´€ì´ ì—†ìŠµë‹ˆë‹¤."}}),a.length===0&&e.jsxs("div",{style:{textAlign:"center",padding:"20px 0",color:"#999"},children:["ì‚¬ìš©ìê°€ ì–´ë–¤ ê¸°ê´€ì—ë„ ì†Œì†ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.",e.jsx("br",{}),'ìœ„ì˜ "ê¸°ê´€ ì¶”ê°€" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ê¸°ê´€ì„ ì¶”ê°€í•˜ì„¸ìš”.']})]})},pd=-1,{Title:Yh,Text:El}=we,{Option:Jh}=Ee,Vb=()=>{const{user:s}=Tn(),[t,r]=o.useState(!1),[n,a]=o.useState(!1),[i,l]=o.useState(null),[d,c]=o.useState([]),[p,h]=o.useState(!1),[x,_]=o.useState("organization"),[S,L]=o.useState(!1),[k,E]=o.useState(null),{organizations:P,selectedOrgId:I,setSelectedOrgId:$,selectedOrganization:y,isLoading:v}=zb(),{members:u,isLoading:m,loadMembers:j,inviteMember:b,removeMember:A}=Eb(x==="organization"?I:null),W=o.useCallback(async()=>{if((s==null?void 0:s.role)==="Owner"){h(!0);try{const N=await Fn.getAllUsersForOwner();N.success&&N.data?c(N.data):f.error("ì „ì²´ ì‚¬ìš©ì ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨")}catch(N){f.error("ì „ì²´ ì‚¬ìš©ì ëª©ë¡ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}finally{h(!1)}}},[s==null?void 0:s.role]);o.useEffect(()=>{x==="all"&&W()},[x,W]);const Z=N=>{N===pd?(_("all"),$(null)):(_("organization"),$(N))};if(!s||s.role!=="Owner"&&s.role!=="Manager")return e.jsx("div",{className:"users-management management-page",children:e.jsx(el,{status:"403",icon:e.jsx(xo,{}),title:"ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤",subTitle:"ì´ í˜ì´ì§€ëŠ” Owner ë˜ëŠ” Manager ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})});const se=async N=>{const ge=await b(N);return ge&&r(!1),ge},ce=async(N,ge)=>{await A(N,ge)},D=N=>{l(N),a(!0)},M=async(N,ge)=>{if(!(!i||!I))try{await Fn.updateMemberRole(I,i.id,N,ge),f.success("ë©¤ë²„ ì—­í•  ë° ê¶Œí•œì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤."),a(!1),l(null),j()}catch(Ce){f.error("ì—­í•  ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},K=[{title:"ì´ë©”ì¼",dataIndex:"email",key:"email",ellipsis:!0,render:N=>e.jsx(El,{strong:!0,children:N})},{title:"ì—­í• ",dataIndex:"organizationRole",key:"organizationRole",width:80,align:"center",render:N=>{if(!N)return e.jsx(T,{children:"ë©¤ë²„"});const ge={Owner:"gold",Manager:"blue",Member:"default"},Ce={Owner:"ì†Œìœ ì",Manager:"ê´€ë¦¬ì",Member:"ë©¤ë²„"};return e.jsx(T,{color:ge[N]||"default",style:{margin:0},children:Ce[N]||N})}},{title:"ì‹œìŠ¤í…œ ê¶Œí•œ",dataIndex:"permissions",key:"permissions",width:320,render:(N,ge)=>{if((ge==null?void 0:ge.organizationRole)==="Owner"||(ge==null?void 0:ge.organizationRole)==="Manager")return e.jsx(Ie,{title:"ê´€ë¦¬ìëŠ” ëª¨ë“  ê¸°ëŠ¥ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤",children:e.jsx(T,{icon:e.jsx(Ad,{}),color:"gold",style:{borderRadius:12,padding:"2px 12px",fontWeight:500},children:"ì „ì²´ ê¶Œí•œ"})});if(!N||N.length===0)return e.jsx(Ie,{title:"ê¶Œí•œì´ í• ë‹¹ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.",children:e.jsx(T,{icon:e.jsx(xo,{}),color:"default",style:{borderRadius:12,padding:"2px 10px"},children:"ê¶Œí•œ ì—†ìŒ"})});const Ce={infra:{label:"ëŸ°íƒ€ì„",color:"#1890ff",description:"K8s, Docker, Nginx"},service:{label:"ì„œë¹„ìŠ¤",color:"#52c41a",description:"Git, ë¹Œë“œ/ë°°í¬, ë³´ì•ˆìŠ¤ìº”"},backup:{label:"ë°±ì—…",color:"#fa8c16",description:"ë°±ì—…/ë³µêµ¬, ìŠ¤í† ë¦¬ì§€"},device:{label:"ì¥ë¹„",color:"#722ed1",description:"ì¥ë¹„ ê´€ë¦¬"},database:{label:"DB",color:"#13c2c2",description:"DBì—°ê²°, ë™ê¸°í™”"}},je=["infra","service","backup","device","database"],Pe=N.filter(F=>je.includes(F)),w=N.filter(F=>F.includes(":")),R=new Set(w.map(F=>F.split(":")[0])),U=new Set([...Pe,...Array.from(R)]);if(U.size===0)return e.jsx(Ie,{title:"ê¶Œí•œì´ í• ë‹¹ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤",children:e.jsx(T,{color:"default",style:{borderRadius:12,padding:"2px 10px"},children:"ê¶Œí•œ ì—†ìŒ"})});const V=F=>{var ae;const X=w.filter(pe=>pe.startsWith(F+":"));if(X.length===0)return((ae=Ce[F])==null?void 0:ae.description)||"ì „ì²´ ì ‘ê·¼";const de=X.map(pe=>{const Xe=pe.split(":");return Xe[Xe.length-1]}),Ne={view:"ì¡°íšŒ",create:"ìƒì„±",update:"ìˆ˜ì •",delete:"ì‚­ì œ",execute:"ì‹¤í–‰",manage:"ê´€ë¦¬",restart:"ì¬ì‹œì‘",logs:"ë¡œê·¸"};return de.map(pe=>Ne[pe]||pe).join(", ")};return e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:Array.from(U).map(F=>{const X=Ce[F],de=R.has(F),Ne=V(F);return e.jsx(Ie,{title:Ne,children:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,padding:"3px 10px",borderRadius:12,fontSize:11,fontWeight:500,backgroundColor:(X==null?void 0:X.color)+"15",color:X==null?void 0:X.color,border:`1px solid ${X==null?void 0:X.color}40`,cursor:"help"},children:[(X==null?void 0:X.label)||F,de&&e.jsx("span",{style:{fontSize:9,opacity:.7,marginLeft:2},children:"âœ“"})]})},F)})})}},{title:"ê°€ì…ì¼",dataIndex:"joinedAt",key:"joinedAt",width:90,align:"center",render:N=>N?hr(N).format("YY.MM.DD"):"-",sorter:(N,ge)=>!N.joinedAt||!ge.joinedAt?0:hr(N.joinedAt).valueOf()-hr(ge.joinedAt).valueOf()},{title:"ì‘ì—…",key:"actions",width:100,align:"center",render:(N,ge)=>{const Ce=s&&ge.id===s.id,je=ge.organizationRole==="Owner";return e.jsxs(g,{size:"small",children:[!Ce&&e.jsx(Ie,{title:"ì—­í•  ë° ê¶Œí•œ ìˆ˜ì •",children:e.jsx(B,{size:"small",icon:e.jsx(ln,{}),onClick:()=>D(ge)})}),Ce?e.jsx(T,{color:"volcano",children:"ë³¸ì¸"}):je?e.jsx(T,{color:"gold",children:"ì†Œìœ ì"}):e.jsx(Ie,{title:"ê¸°ê´€ì—ì„œ ë‚´ë³´ë‚´ê¸°",children:e.jsx(Kt,{title:`'${ge.name}'ë‹˜ì„ ê¸°ê´€ì—ì„œ ë‚´ë³´ë‚´ì‹œê² ìŠµë‹ˆê¹Œ?`,description:"ë‚´ë³´ë‚´ë©´ ì´ ê¸°ê´€ì˜ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ì—†ê²Œ ë©ë‹ˆë‹¤.",onConfirm:()=>ce(ge.id,ge.name),okText:"ë‚´ë³´ë‚´ê¸°",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{})})})})]})}}],J=N=>{E(N),L(!0)},te=()=>{L(!1),E(null),W()},G=[{title:"ì´ë©”ì¼",dataIndex:"email",key:"email",ellipsis:!0,render:N=>e.jsx(El,{strong:!0,children:N})},{title:"ì†Œì† ê¸°ê´€",dataIndex:"organizations",key:"organizations",width:350,render:N=>{if(!N||N.length===0)return e.jsx(T,{color:"default",children:"ë¯¸ì†Œì†"});const ge={Owner:"gold",Manager:"blue",Member:"default"},Ce={Owner:"ì†Œìœ ì",Manager:"ê´€ë¦¬ì",Member:"ë©¤ë²„"};return e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:N.map((je,Pe)=>e.jsx(Ie,{title:`${Ce[je.role]||je.role}`,children:e.jsx(T,{color:ge[je.role]||"default",style:{margin:0},children:je.organizationName})},Pe))})}},{title:"ê°€ì…ì¼",dataIndex:"createdAt",key:"createdAt",width:90,align:"center",render:N=>N?hr(N).format("YY.MM.DD"):"-",sorter:(N,ge)=>!N.createdAt||!ge.createdAt?0:hr(N.createdAt).valueOf()-hr(ge.createdAt).valueOf()},{title:"ê´€ë¦¬",key:"actions",width:70,align:"center",render:(N,ge)=>e.jsx(Ie,{title:"ê¸°ê´€ ë° ê¶Œí•œ ê´€ë¦¬",children:e.jsx(B,{size:"small",icon:e.jsx(ln,{}),onClick:()=>J(ge)})})}],q=x==="all"?d.length:u.length,oe=x==="all"?d.filter(N=>{var ge;return(ge=N.organizations)==null?void 0:ge.some(Ce=>Ce.role==="Owner")}).length:u.filter(N=>N.organizationRole==="Owner").length,be=x==="all"?d.filter(N=>{var ge;return(ge=N.organizations)==null?void 0:ge.some(Ce=>Ce.role==="Manager")}).length:u.filter(N=>N.organizationRole==="Manager").length,ne=x==="all"?d.filter(N=>{var ge;return!((ge=N.organizations)!=null&&ge.length)||N.organizations.every(Ce=>Ce.role==="Member")}).length:u.filter(N=>!N.organizationRole||N.organizationRole==="Member").length,ye=x==="all"?p:m,Ue=()=>{x==="all"?W():j()};return e.jsxs("div",{className:"users-management management-page",children:[e.jsx(ie,{className:"page-header-card",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(g,{align:"center",children:[e.jsx(Jp,{style:{fontSize:24,color:"#1890ff"}}),e.jsx(Yh,{level:3,style:{margin:0},children:"ì‚¬ìš©ì ê´€ë¦¬"})]}),e.jsx(B,{icon:e.jsx(zs,{}),onClick:Ue,loading:ye,disabled:x==="organization"&&!I,children:"ìƒˆë¡œê³ ì¹¨"})]})}),e.jsxs(Ke,{gutter:[16,16],className:"stat-row",style:{marginBottom:16},children:[e.jsx(Y,{xs:24,sm:8,children:e.jsx(ie,{size:"small",children:e.jsx($e,{title:"ì „ì²´ ì‚¬ìš©ì",value:q,suffix:"ëª…",prefix:e.jsx(Un,{style:{color:"#1890ff"}})})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx(ie,{size:"small",children:e.jsx($e,{title:"ê´€ë¦¬ì",value:oe+be,suffix:`/ ${q}`,prefix:e.jsx(Ad,{style:{color:"#faad14"}})})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx(ie,{size:"small",children:e.jsx($e,{title:"ì¼ë°˜ ë©¤ë²„",value:ne,suffix:"ëª…",prefix:e.jsx(pr,{style:{color:"#52c41a"}})})})})]}),e.jsx(ie,{size:"small",className:"org-select-card",style:{marginBottom:16},children:e.jsxs(Ke,{gutter:[16,12],align:"middle",children:[e.jsx(Y,{children:e.jsx(El,{strong:!0,children:"ì†Œì† ê¸°ê´€ ì„ íƒ:"})}),e.jsx(Y,{flex:"auto",children:e.jsxs(Ee,{placeholder:v?"ê¸°ê´€ ëª©ë¡ ë¡œë”© ì¤‘...":"ê´€ë¦¬í•  ê¸°ê´€ì„ ì„ íƒí•˜ì„¸ìš”",value:x==="all"?pd:I,onChange:Z,style:{minWidth:250},loading:v,children:[(s==null?void 0:s.role)==="Owner"&&e.jsx(Jh,{value:pd,children:e.jsxs(g,{children:[e.jsx(ur,{style:{color:"#1890ff"}}),"ì „ì²´ ì‚¬ìš©ì (ëª¨ë“  ê¸°ê´€)"]})},"all"),P.map(N=>e.jsx(Jh,{value:N.id,children:N.name},N.id))]})}),e.jsx(Y,{children:e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:()=>r(!0),disabled:x==="all"||!I,children:"ì‚¬ìš©ì ì´ˆëŒ€"})})]})}),e.jsx(ie,{title:e.jsxs(g,{children:[x==="all"?e.jsx(ur,{}):e.jsx(fo,{}),e.jsx(Yh,{level:4,style:{margin:0},children:x==="all"?`ì „ì²´ ì‚¬ìš©ì (${d.length}ëª…)`:`${(y==null?void 0:y.name)||"ê¸°ê´€ì„ ì„ íƒí•˜ì„¸ìš”"} ì†Œì† ì‚¬ìš©ì (${u.length}ëª…)`})]}),children:x==="all"?e.jsx(wt,{columns:G,dataSource:d,rowKey:"id",loading:p,pagination:{pageSize:10},scroll:{x:600}}):I?e.jsx(wt,{columns:K,dataSource:u,rowKey:"id",loading:m,pagination:{pageSize:10},scroll:{x:600}}):e.jsx("div",{style:{textAlign:"center",padding:"50px 0"},children:e.jsx(El,{type:"secondary",children:"ê´€ë¦¬í•  ê¸°ê´€ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”."})})}),e.jsx(Mb,{visible:t,onCancel:()=>r(!1),onInvite:se}),e.jsx(Db,{visible:n,member:i,onCancel:()=>{a(!1),l(null)},onSave:M}),e.jsx(Hb,{visible:S,user:k,onCancel:()=>{L(!1),E(null)},onSave:te})]})},qb=async s=>{try{const t=s?`?role=${s.join(",")}`:"",r=await ee.post(`/user${t}`,{action:"get-all-users"});return r.success&&r.data?r.data:(O.warn("ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",{error:r.error}),[])}catch(t){throw O.error("ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},{Title:Gb,Text:gi}=we,{Panel:Zh}=nr,{confirm:Wb}=rt,Kb=()=>{const{isOwnerOrManager:s}=lf(),[t,r]=o.useState(!1),[n,a]=o.useState("permissions"),[i,l]=o.useState([]),[d,c]=o.useState({}),[p,h]=o.useState([]),[x,_]=o.useState(null),[S,L]=o.useState([]),[k,E]=o.useState(!1),[P,I]=o.useState(!1),[$,y]=o.useState([]),[v,u]=o.useState(""),m=o.useCallback(async()=>{r(!0);try{const J=await $i.getAllPermissions();J.success&&J.data&&(l(J.data.permissions||[]),c(J.data.grouped||{}))}catch(J){f.error("ê¶Œí•œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{r(!1)}},[]),j=o.useCallback(async()=>{try{const J=await qb();h(J)}catch(J){f.error("ì‚¬ìš©ì ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},[]),b=o.useCallback(async J=>{E(!0);try{const te=await $i.getUserPermissions(J);te.success&&te.data?L(te.data):L([])}catch(te){f.error("ì‚¬ìš©ì ê¶Œí•œì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),L([])}finally{E(!1)}},[]);o.useEffect(()=>{s&&(m(),j())},[s,m,j]);const A=J=>{const te=p.find(G=>G.id===J);_(te||null),te?b(te.id):L([])},W=async()=>{if(!x||$.length===0){f.warning("ì‚¬ìš©ìì™€ ê¶Œí•œì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}r(!0);try{let J=0;for(const te of $)(await $i.grantUserPermission(x.id,{permission_id:te,organization_id:x.organization_id||0,reason:"ê´€ë¦¬ìì— ì˜í•œ ê¶Œí•œ ë¶€ì—¬"})).success&&J++;f.success(`${J}ê°œì˜ ê¶Œí•œì´ ë¶€ì—¬ë˜ì—ˆìŠµë‹ˆë‹¤.`),I(!1),y([]),b(x.id)}catch(J){f.error("ê¶Œí•œ ë¶€ì—¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{r(!1)}},Z=async J=>{if(!x)return;const te=i.find(G=>G.code===J);if(!te){f.error("ê¶Œí•œì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}Wb({title:"ê¶Œí•œ íšŒìˆ˜",icon:e.jsx(Tr,{}),content:`"${te.name_ko}" ê¶Œí•œì„ íšŒìˆ˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,okText:"íšŒìˆ˜",okType:"danger",cancelText:"ì·¨ì†Œ",onOk:async()=>{try{const G=await $i.revokeUserPermission(x.id,{permission_id:te.id,organization_id:x.organization_id||0,reason:"ê´€ë¦¬ìì— ì˜í•œ ê¶Œí•œ íšŒìˆ˜"});G.success?(f.success("ê¶Œí•œì´ íšŒìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤."),b(x.id)):f.error(G.error||"ê¶Œí•œ íšŒìˆ˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(G){f.error("ê¶Œí•œ íšŒìˆ˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}}})},se=J=>{const te=og[J],G=ig[J];return e.jsx(T,{color:te,children:G})},ce=[{title:"ê¶Œí•œ ì½”ë“œ",dataIndex:"code",key:"code",width:200,render:J=>e.jsx(gi,{code:!0,children:J})},{title:"ê¶Œí•œëª…",dataIndex:"name_ko",key:"name_ko",width:180},{title:"ì„¤ëª…",dataIndex:"description",key:"description",ellipsis:!0},{title:"ìœ„í—˜ë„",dataIndex:"risk_level",key:"risk_level",width:100,render:J=>se(J),filters:[{text:"ë‚®ìŒ",value:"low"},{text:"ë³´í†µ",value:"medium"},{text:"ë†’ìŒ",value:"high"},{text:"ë§¤ìš° ë†’ìŒ",value:"critical"}],onFilter:(J,te)=>te.risk_level===J},{title:"ìŠ¹ì¸ í•„ìš”",dataIndex:"requires_approval",key:"requires_approval",width:100,render:J=>J?e.jsx(T,{color:"orange",icon:e.jsx(Yt,{}),children:"í•„ìš”"}):e.jsx(T,{color:"green",icon:e.jsx(Ze,{}),children:"ë¶ˆí•„ìš”"})}],D=()=>e.jsx(ie,{children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"large",children:[e.jsx(ue.Search,{placeholder:"ê¶Œí•œ ì½”ë“œ ë˜ëŠ” ì´ë¦„ ê²€ìƒ‰",allowClear:!0,enterButton:e.jsx(Fi,{}),value:v,onChange:J=>u(J.target.value),style:{maxWidth:400}}),e.jsx(nr,{defaultActiveKey:["service","git","db"],children:Object.entries(d).map(([J,te])=>{const G=Gl[J]||J,q=te.filter(oe=>oe.code.toLowerCase().includes(v.toLowerCase())||oe.name_ko.toLowerCase().includes(v.toLowerCase()));return v&&q.length===0?null:e.jsx(Zh,{header:e.jsxs(g,{children:[e.jsx(pr,{}),e.jsx("span",{children:G}),e.jsx(ps,{count:q.length,style:{backgroundColor:"#1890ff"}})]}),children:e.jsx(wt,{dataSource:q,columns:ce,rowKey:"id",size:"small",pagination:!1})},J)})})]})}),M=()=>e.jsxs(ie,{children:[e.jsx(xe,{message:"ì‚¬ìš©ìë³„ ê¶Œí•œ ê´€ë¦¬",description:"ì‚¬ìš©ìë¥¼ ì„ íƒí•˜ì—¬ ê°œë³„ ê¶Œí•œì„ ë¶€ì—¬í•˜ê±°ë‚˜ íšŒìˆ˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Owner/Managerì—ê²Œ ë¶€ì—¬ëœ ê¸°ë³¸ ê¶Œí•œ ì™¸ì— ì¶”ê°€ì ì¸ ê¶Œí•œì„ ì„¤ì •í•©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"large",children:[e.jsxs(g,{children:[e.jsx(Ee,{placeholder:"ì‚¬ìš©ì ì„ íƒ",style:{width:350},showSearch:!0,optionFilterProp:"children",onChange:A,value:x==null?void 0:x.id,loading:t,children:p.map(J=>e.jsxs(Ee.Option,{value:J.id,children:[J.email," (",J.role||"Member",")"]},J.id))}),e.jsx(B,{icon:e.jsx(zs,{}),onClick:j,title:"ì‚¬ìš©ì ëª©ë¡ ìƒˆë¡œê³ ì¹¨"}),x&&e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:()=>I(!0),children:"ê¶Œí•œ ë¶€ì—¬"})]}),x&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(Un,{}),e.jsxs("span",{children:[x.email,"ì˜ ê¶Œí•œ"]})]}),size:"small",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(g,{children:[e.jsx(gi,{children:"ì—­í• :"}),e.jsx(T,{color:"blue",children:x.role||"Member"}),x.organization_name&&e.jsxs(e.Fragment,{children:[e.jsx(gi,{children:"ê¸°ê´€:"}),e.jsx(T,{children:x.organization_name})]})]}),e.jsx(xt,{style:{margin:"12px 0"}}),e.jsx(gt,{spinning:k,children:S.length>0?e.jsx(ar,{dataSource:S,renderItem:J=>{const te=i.find(G=>G.code===J.code);return e.jsx(ar.Item,{actions:[e.jsx(B,{type:"text",danger:!0,icon:e.jsx(gs,{}),onClick:()=>Z(J.code),children:"íšŒìˆ˜"},"revoke")],children:e.jsx(ar.Item.Meta,{title:e.jsxs(g,{children:[e.jsx(gi,{code:!0,children:J.code}),e.jsx(gi,{children:J.name_ko}),te&&se(te.risk_level)]}),description:e.jsxs(g,{children:[e.jsx(T,{color:"default",children:Gl[J.category]||J.category}),J.granted_at&&e.jsxs(gi,{type:"secondary",children:["ë¶€ì—¬ì¼: ",new Date(J.granted_at).toLocaleDateString()]})]})})})}}):e.jsx(Je,{description:"ë¶€ì—¬ëœ ê°œë³„ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})})]})})]})]}),K=()=>e.jsxs(rt,{title:`ê¶Œí•œ ë¶€ì—¬ - ${x==null?void 0:x.email}`,open:P,onOk:W,onCancel:()=>{I(!1),y([])},width:800,okText:"ë¶€ì—¬",cancelText:"ì·¨ì†Œ",confirmLoading:t,children:[e.jsx(xe,{message:"ì£¼ì˜",description:"Critical ê¶Œí•œì€ ì‹ ì¤‘í•˜ê²Œ ë¶€ì—¬í•´ì£¼ì„¸ìš”. ìœ„í—˜í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì…ë‹ˆë‹¤.",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx(nr,{children:Object.entries(d).map(([J,te])=>{const G=Gl[J]||J,q=te.filter(oe=>!S.some(be=>be.code===oe.code));return q.length===0?null:e.jsx(Zh,{header:e.jsxs(g,{children:[e.jsx("span",{children:G}),e.jsx(ps,{count:q.length,style:{backgroundColor:"#52c41a"}})]}),children:e.jsx(Vr.Group,{value:$,onChange:oe=>y(oe),style:{width:"100%"},children:e.jsx(g,{direction:"vertical",style:{width:"100%"},children:q.map(oe=>e.jsx(Vr,{value:oe.id,children:e.jsxs(g,{children:[e.jsx(gi,{code:!0,children:oe.code}),e.jsx(gi,{children:oe.name_ko}),se(oe.risk_level)]})},oe.id))})})},J)})})]});return s?e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(Gb,{level:3,children:[e.jsx(pr,{})," ê¶Œí•œ ê´€ë¦¬"]}),e.jsx(gt,{spinning:t,children:e.jsx(xs,{activeKey:n,onChange:a,items:[{key:"permissions",label:e.jsxs("span",{children:[e.jsx(pr,{}),"ê¶Œí•œ ëª©ë¡"]}),children:D()},{key:"users",label:e.jsxs("span",{children:[e.jsx(Un,{}),"ì‚¬ìš©ìë³„ ê¶Œí•œ"]}),children:M()}]})}),K()]}):e.jsx(ie,{children:e.jsx(xe,{message:"ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ",description:"ê¶Œí•œ ê´€ë¦¬ í˜ì´ì§€ëŠ” Owner ë˜ëŠ” Managerë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"error",showIcon:!0})})},Yb=()=>{const s=al(),{login:t}=Tn(),r=async n=>{var a,i;try{if(n.email==="test@gmail.com"&&n.password==="12341234"){const d={email:n.email,permissions:["project_management","service_operations"],exp:Math.floor(Date.now()/1e3)+86400},p=["eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9",btoa(JSON.stringify(d)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),"temp-signature"].join(".");try{const h={id:0,email:n.email,permissions:["project_management","service_operations"]};t(p,h),f.success("ì„ì‹œ ë¡œê·¸ì¸ ë˜ì—ˆìŠµë‹ˆë‹¤."),s("/dashboard");return}catch(h){f.error("ì„ì‹œ ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return}}const l=await ze.auth.login({email:n.email,password:n.password});if(l.data.success&&"data"in l.data){const d=l.data.data.token,c=l.data.data.user;t(d,c),f.success("ë¡œê·¸ì¸ ë˜ì—ˆìŠµë‹ˆë‹¤.");let p=[];if(c&&c.permissions)p=c.permissions;else try{p=Uo(d).permissions||[]}catch(x){p=[]}let h="/";p.includes("project_management")?h="/projects":p.includes("service_operations")&&(h="/services"),s(h)}else throw new Error("ë¡œê·¸ì¸ ì‘ë‹µì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.")}catch(l){let d=((i=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:i.error)||(l==null?void 0:l.message)||"ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.";(d.includes("ê¶Œí•œ")||d.includes("ì¡°ì§")||d.includes("ê¸°ê´€"))&&(d+=" ì•„ì§ ê¸°ê´€ì— ì†Œì†ë˜ì§€ ì•Šì•˜ë‹¤ë©´, ê¸°ê´€ ê´€ë¦¬ìì˜ ì´ˆëŒ€ë¥¼ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”."),f.error(d)}};return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"#f0f2f5"},children:e.jsx(ie,{title:"KIWI ë¡œê·¸ì¸",style:{width:400},children:e.jsxs(H,{name:"login",onFinish:r,size:"large",children:[e.jsx(H.Item,{name:"email",rules:[{required:!0,type:"email",message:"ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!"}],children:e.jsx(ue,{prefix:e.jsx(Un,{}),placeholder:"ì´ë©”ì¼"})}),e.jsx(H.Item,{name:"password",rules:[{required:!0,message:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!"}],children:e.jsx(ue.Password,{prefix:e.jsx(Qn,{}),placeholder:"ë¹„ë°€ë²ˆí˜¸"})}),e.jsx(H.Item,{children:e.jsx(B,{type:"primary",htmlType:"submit",style:{width:"100%"},children:"ë¡œê·¸ì¸"})}),e.jsxs("div",{style:{textAlign:"center"},children:["ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? ",e.jsx(gc,{to:"/signup",children:"íšŒì›ê°€ì…"})]})]})})})},Jb=()=>{const s=al(),t=async r=>{var n,a,i,l;try{await ze.auth.signup({email:r.email,password:r.password}),f.success("íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê¸°ê´€ ì´ˆëŒ€ë¥¼ ë°›ìœ¼ë©´ ì‹œìŠ¤í…œì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."),s("/login")}catch(d){let c="íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";d instanceof Error?c=d.message:typeof d=="object"&&d!==null&&"response"in d&&typeof((a=(n=d.response)==null?void 0:n.data)==null?void 0:a.error)=="string"&&(c=((l=(i=d.response)==null?void 0:i.data)==null?void 0:l.error)||"íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),f.error(c)}};return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"#f0f2f5"},children:e.jsxs(ie,{title:"KIWI íšŒì›ê°€ì…",style:{width:400},children:[e.jsx(xe,{message:"íšŒì›ê°€ì… ì•ˆë‚´",description:e.jsxs("div",{children:[e.jsx("p",{children:"â€¢ íšŒì›ê°€ì… í›„ ë°”ë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),e.jsx("p",{children:"â€¢ ì‹œìŠ¤í…œ ì‚¬ìš©ì„ ìœ„í•´ì„œëŠ” ê¸°ê´€ ê´€ë¦¬ìì˜ ì´ˆëŒ€ê°€ í•„ìš”í•©ë‹ˆë‹¤."}),e.jsx("p",{children:"â€¢ ì´ˆëŒ€ë¥¼ ë°›ìœ¼ë©´ ì•Œë¦¼ì„ í†µí•´ ê¸°ê´€ì— ê°€ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})]}),type:"info",icon:e.jsx(Ks,{}),showIcon:!0,style:{marginBottom:24}}),e.jsxs(H,{name:"signup",onFinish:t,size:"large",children:[e.jsx(H.Item,{name:"email",rules:[{required:!0,type:"email",message:"ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!"}],children:e.jsx(ue,{prefix:e.jsx(Un,{}),placeholder:"ì‚¬ìš©í•  ì´ë©”ì¼"})}),e.jsx(H.Item,{name:"password",rules:[{required:!0,message:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!"},{min:8,message:"ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤."}],children:e.jsx(ue.Password,{prefix:e.jsx(Qn,{}),placeholder:"ë¹„ë°€ë²ˆí˜¸"})}),e.jsx(H.Item,{name:"confirm",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ í•œë²ˆ ì…ë ¥í•´ì£¼ì„¸ìš”!"},({getFieldValue:r})=>({validator(n,a){return!a||r("password")===a?Promise.resolve():Promise.reject(new Error("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!"))}})],children:e.jsx(ue.Password,{prefix:e.jsx(Qn,{}),placeholder:"ë¹„ë°€ë²ˆí˜¸ í™•ì¸"})}),e.jsx(H.Item,{children:e.jsx(B,{type:"primary",htmlType:"submit",style:{width:"100%"},children:"íšŒì›ê°€ì…"})}),e.jsxs("div",{style:{textAlign:"center"},children:["ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? ",e.jsx(gc,{to:"/login",children:"ë¡œê·¸ì¸"})]})]})]})})},ex=async()=>{try{return(await ze.project.listMyProjects()).data.data||[]}catch(s){throw O.error("í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",s),s}},Zb=async s=>{try{const r=(await ex()).find(n=>n.id===s);if(!r)throw new Error("í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return r}catch(t){throw O.error("í”„ë¡œì íŠ¸ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},tx=async s=>{try{return(await ee.request("/project","list-branches",{projectId:s})).data||[]}catch(t){throw O.error("ë¸Œëœì¹˜ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},Qb=async(s,t)=>{var r,n;try{if(!t){const i=await tx(s);t=((r=i.find(l=>l.default))==null?void 0:r.name)||((n=i[0])==null?void 0:n.name)||"main"}return(await ee.request("/project","list-commits",{projectId:s,branchName:t})).data||[]}catch(a){throw O.error("ì»¤ë°‹ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",a),a}},Xb=async s=>{try{throw new Error("í”„ë¡œì íŠ¸ ìƒì„± ê¸°ëŠ¥ì€ í˜„ì¬ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. GitLabì—ì„œ ì§ì ‘ ìƒì„±í•´ì£¼ì„¸ìš”.")}catch(t){throw O.error("í”„ë¡œì íŠ¸ ìƒì„± ì‹¤íŒ¨:",t),t}},e0=async(s,t)=>{try{throw new Error("í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ ê¸°ëŠ¥ì€ í˜„ì¬ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. GitLabì—ì„œ ì§ì ‘ ìˆ˜ì •í•´ì£¼ì„¸ìš”.")}catch(r){throw O.error("í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:",r),r}},t0=async s=>{try{throw new Error("í”„ë¡œì íŠ¸ ì‚­ì œ ê¸°ëŠ¥ì€ í˜„ì¬ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. GitLabì—ì„œ ì§ì ‘ ì‚­ì œí•´ì£¼ì„¸ìš”.")}catch(t){throw O.error("í”„ë¡œì íŠ¸ ì‚­ì œ ì‹¤íŒ¨:",t),t}},Xd={getProjects:ex,getProject:Zb,getProjectBranches:tx,getProjectCommits:Qb,createProject:Xb,updateProject:e0,deleteProject:t0},{Title:Qh,Text:Xh}=we,ep=({visible:s,onSuccess:t,onCancel:r,initialGitLabURL:n})=>{const[a]=H.useForm(),[i,l]=o.useState(!1),d=Gs();o.useEffect(()=>{s&&a.setFieldsValue({gitlabURL:n||"",accessToken:""})},[s,n,a]);const c=async p=>{l(!0);try{const h=await ol.saveGitLabInfo(p.gitlabURL,p.accessToken);if(h&&h.success){const x=my(p.gitlabURL);d.upsertSourceRepository({baseUrl:x,token:p.accessToken}),f.success("GitLab ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤."),t(),a.resetFields()}else throw new Error("ì •ë³´ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(h){const x=h instanceof Error?h.message:"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";f.error(x)}finally{l(!1)}};return e.jsx(rt,{title:"GitLab í† í° ë“±ë¡/ìˆ˜ì •",visible:s,onCancel:r,footer:[e.jsx(B,{onClick:r,children:"ì·¨ì†Œ"},"back"),e.jsx(B,{type:"primary",loading:i,onClick:()=>a.submit(),children:"ì €ì¥"},"submit")],children:e.jsxs(H,{form:a,layout:"vertical",onFinish:c,children:[e.jsx(H.Item,{name:"gitlabURL",label:"GitLab ì„œë²„ ì£¼ì†Œ",rules:[{required:!0,message:"GitLab ì„œë²„ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."},{type:"url",message:"ì˜¬ë°”ë¥¸ URL í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (ì˜ˆ: https://gitlab.com)"}],children:e.jsx(ue,{placeholder:"https://gitlab.com ë˜ëŠ” https://gitlab.my-company.com"})}),e.jsx(H.Item,{name:"accessToken",label:"ê°œì¸ìš© ì•¡ì„¸ìŠ¤ í† í° (Personal Access Token)",rules:[{required:!0,message:"ì•¡ì„¸ìŠ¤ í† í°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue.Password,{placeholder:"GitLabì—ì„œ ë°œê¸‰ë°›ì€ í† í°ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”"})})]})})},s0=()=>{const[s,t]=o.useState(null),[r,n]=o.useState([]),[a,i]=o.useState(""),[l,d]=o.useState(!0),[c,p]=o.useState(null),[h,x]=o.useState(!1),[_,S]=o.useState(""),L=async()=>{d(!0),p(null);try{const I=await Xd.getProjects();n(I)}catch(I){const $=I instanceof Error?I.message:"í”„ë¡œì íŠ¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";p($)}finally{d(!1)}};o.useEffect(()=>{(async()=>{try{const y=(await ol.checkGitLabStatus()).data;if(y){const{hasToken:v,gitlabURL:u}=y;t(v),i(u||""),v?L():d(!1)}else t(!1),d(!1)}catch($){p($.message||"ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),d(!1)}})()},[]);const k=()=>{x(!1),t(!0),L()},E=[{title:"Project Name",dataIndex:"name",key:"name",render:(I,$)=>e.jsx(gc,{to:`/projects/${$.id}`,children:I})},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Last Activity",dataIndex:"last_activity_at",key:"last_activity_at",render:I=>new Date(I).toLocaleString("ko-KR")}],P=r.filter(I=>I.name.toLowerCase().includes(_.toLowerCase()));return l&&s===null?e.jsx("div",{className:"project-manage-container centered",children:e.jsx(gt,{size:"large",tip:"GitLab ì—°ë™ ìƒíƒœë¥¼ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤..."})}):s?e.jsxs("div",{className:"project-manage-container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Qh,{level:2,style:{margin:0},children:"GitLab í”„ë¡œì íŠ¸ ê´€ë¦¬"}),e.jsx("div",{style:{display:"flex",gap:8},children:e.jsx(B,{onClick:()=>x(!0),children:"í† í° ìˆ˜ì •"})})]}),e.jsx(Xh,{type:"secondary",children:"íšŒì›ë‹˜ì˜ ê³„ì •ê³¼ ì—°ë™ëœ GitLab í”„ë¡œì íŠ¸ ëª©ë¡ì…ë‹ˆë‹¤."}),e.jsx(ue.Search,{placeholder:"í”„ë¡œì íŠ¸ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰",allowClear:!0,enterButton:!0,style:{margin:"20px 0"},onSearch:I=>S(I),onChange:I=>S(I.target.value)}),c?e.jsx(xe,{message:"ì˜¤ë¥˜",description:c+" (GitLab í† í°ì´ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í† í° ìˆ˜ì •ì„ ì‹œë„í•´ì£¼ì„¸ìš”.)",type:"error",showIcon:!0,style:{marginTop:20}}):e.jsx(gt,{spinning:l,children:e.jsx(wt,{columns:E,dataSource:P,rowKey:"id",style:{marginTop:20}})}),e.jsx(ep,{visible:h,onSuccess:k,onCancel:()=>x(!1),initialGitLabURL:a})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"project-manage-container centered empty-state",children:[e.jsx(Zp,{style:{fontSize:"48px",color:"#8c8c8c"}}),e.jsx(Qh,{level:4,style:{marginTop:"16px"},children:"GitLab ì—°ë™ì´ í•„ìš”í•©ë‹ˆë‹¤."}),e.jsx(Xh,{type:"secondary",children:"í”„ë¡œì íŠ¸ ê´€ë¦¬ë¥¼ ìœ„í•´ GitLab ê°œì¸ìš© ì•¡ì„¸ìŠ¤ í† í°ì„ ë“±ë¡í•´ì£¼ì„¸ìš”."}),e.jsx(B,{type:"primary",style:{marginTop:"24px"},onClick:()=>x(!0),children:"í† í° ë“±ë¡í•˜ê¸°"})]}),e.jsx(ep,{visible:h,onSuccess:k,onCancel:()=>x(!1)})]})},{Title:r0,Text:Pl}=we,{Option:n0}=Ee,a0=()=>{const{projectId:s}=nu(),[t,r]=o.useState([]),[n,a]=o.useState([]),[i,l]=o.useState(null),[d,c]=o.useState(!0),[p,h]=o.useState(!1),[x,_]=o.useState(null),[S,L]=o.useState(null),[k,E]=o.useState(!1),[P,I]=o.useState(!1),[$]=H.useForm();o.useEffect(()=>{if(!s)return;(async()=>{c(!0);try{const m=await Xd.getProjectBranches(Number(s));r(m);const j=m.find(b=>b.default)||m[0];j&&l(j.name)}catch(m){const j=m instanceof Error?m.message:"ë¸Œëœì¹˜ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";_(j)}finally{c(!1)}})()},[s]),o.useEffect(()=>{if(!s||!i)return;(async()=>{h(!0),a([]);try{const m=await Xd.getProjectCommits(Number(s),i);a(m)}catch(m){const j=m instanceof Error?m.message:"ì»¤ë°‹ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";_(j)}finally{h(!1)}})()},[s,i]);const y=async u=>{var m;E(!0),I(!1);try{const j=await Nf.getLastDeploymentTime({namespace:u.namespace});j.data.success&&((m=j.data.data)!=null&&m.lastDeploymentTime)?L(j.data.data.lastDeploymentTime):L("ë°°í¬ ì •ë³´ ì—†ìŒ")}catch(j){O.error("ë°°í¬ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨",j),L("í™•ì¸ ì‹¤íŒ¨")}finally{E(!1),$.resetFields()}},v=[{title:"Commit",dataIndex:"title",key:"title",render:(u,m)=>e.jsxs("div",{children:[e.jsx("a",{href:m.web_url,target:"_blank",rel:"noopener noreferrer",style:{fontWeight:500},children:u}),e.jsx("br",{}),e.jsxs(Pl,{type:"secondary",children:[m.author_name," authored"," ",new Date(m.authored_date).toLocaleString()]})]})},{title:"ID",dataIndex:"short_id",key:"short_id",render:u=>e.jsx(T,{children:u})}];return x?e.jsx(xe,{message:"ì˜¤ë¥˜ ë°œìƒ",description:x,type:"error",showIcon:!0}):e.jsxs("div",{style:{padding:24,background:"#fff"},children:[e.jsxs("div",{children:[e.jsxs(g,{align:"center",style:{marginBottom:16},children:[e.jsx(B,{icon:e.jsx(Om,{}),onClick:()=>window.history.back()}),e.jsxs("div",{children:[e.jsxs(r0,{level:4,style:{margin:0},children:["í”„ë¡œì íŠ¸ #",s]}),e.jsx(Pl,{type:"secondary",children:"ë¸Œëœì¹˜ ë° ì»¤ë°‹ ëª©ë¡"})]})]}),e.jsx(xt,{style:{marginTop:0,marginBottom:24}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsxs(g,{align:"center",children:[e.jsx(Pl,{strong:!0,children:"ë¸Œëœì¹˜ ì„ íƒ: "}),e.jsx(gt,{spinning:d,children:e.jsx(Ee,{style:{width:300},placeholder:"ë¸Œëœì¹˜ë¥¼ ì„ íƒí•˜ì„¸ìš”",value:i,onChange:u=>l(u),disabled:d,children:t.map(u=>e.jsx(n0,{value:u.name,children:u.name},u.name))})})]}),e.jsxs(g,{align:"center",children:[e.jsx(B,{icon:e.jsx(mo,{}),onClick:()=>I(!0),loading:k,children:"ìµœì¢… ë°°í¬ ì¼ì‹œ í™•ì¸"}),S&&(["í™•ì¸ ì‹¤íŒ¨","ë°°í¬ ì •ë³´ ì—†ìŒ"].includes(S)?e.jsx(Pl,{type:"secondary",children:S}):e.jsx(T,{color:"blue",children:new Date(S).toLocaleString("ko-KR")}))]})]}),e.jsx("div",{style:{marginTop:24},children:e.jsx(wt,{loading:p,columns:v,dataSource:n,rowKey:"id",pagination:{pageSize:15}})}),e.jsx(rt,{title:"ë°°í¬ ì •ë³´ ì…ë ¥",visible:P,onOk:()=>$.submit(),onCancel:()=>I(!1),confirmLoading:k,children:e.jsx(H,{form:$,layout:"vertical",onFinish:y,children:e.jsx(H.Item,{name:"namespace",label:"Namespace",rules:[{required:!0,message:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue,{placeholder:"ì˜ˆ: my-project-ns"})})})})]})},Sn=()=>"/api/v1",tp=()=>`${Sn()}/scan/trivy/scan/image`,sp=()=>`${Sn()}/scan/zap/scan`,rp=()=>`${Sn()}/scan/sast/scan`;class Wt extends Error{constructor(t,r,n,a){super(t),this.isAnalysisError=!0,this.name="AnalysisApiError",this.statusCode=r,this.code=n,this.details=a}}class i0{constructor(){this.timeout=6e5,this.instance=iu.create({timeout:this.timeout,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}setupInterceptors(){this.instance.interceptors.request.use(t=>{const r=localStorage.getItem("authToken");return r&&t.headers&&(t.headers.Authorization=`Bearer ${r}`),t},t=>(O.error("[Analysis API] Request interceptor error:",t),Promise.reject(t))),this.instance.interceptors.response.use(t=>t,t=>this.handleError(t))}handleError(t){var l;let r="ë¶„ì„ ì„œë¹„ìŠ¤ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",n="ANALYSIS_ERROR",a=0,i;if(t.response){a=t.response.status;const d=t.response.data;switch(a){case 400:r=(d==null?void 0:d.error)||"ì˜ëª»ëœ ë¶„ì„ ìš”ì²­ì…ë‹ˆë‹¤.",n="INVALID_REQUEST";break;case 401:r="ë¶„ì„ ì„œë¹„ìŠ¤ ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",n="AUTH_FAILED";break;case 403:r="ë¶„ì„ ì„œë¹„ìŠ¤ ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.",n="ACCESS_DENIED";break;case 404:r="ë¶„ì„ ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",n="SERVICE_NOT_FOUND";break;case 408:case 504:r="ë¶„ì„ ì‘ì—… ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",n="TIMEOUT";break;case 500:r=(d==null?void 0:d.error)||"ë¶„ì„ ì„œë¹„ìŠ¤ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",n="SERVER_ERROR";break;case 502:case 503:r="ë¶„ì„ ì„œë¹„ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",n="SERVICE_UNAVAILABLE";break;default:r=(d==null?void 0:d.error)||`ë¶„ì„ ì„œë¹„ìŠ¤ ì˜¤ë¥˜ (${a})`,n="UNKNOWN_ERROR"}i=d}else t.request?(r="ë¶„ì„ ì„œë¹„ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.",n="NETWORK_ERROR",a=0):(r=t.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",n="REQUEST_ERROR");throw O.error("[Analysis API] Error:",new Error(JSON.stringify({message:r,code:n,statusCode:a,url:(l=t.config)==null?void 0:l.url}))),new Wt(r,a,n,i)}async scanImage(t){const r=tp();O.info("[Trivy] Starting container image scan:",{image_url:t.image_url,scan_type:t.scan_type||"vuln",endpoint:r});try{const n=await this.instance.post(r,t);if(!n.data)throw new Wt("Trivy ìŠ¤ìº” ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");if(n.data.success===!1)throw new Wt(n.data.error||"Trivy ìŠ¤ìº”ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",500,"SCAN_FAILED",n.data);return O.info("[Trivy] Scan completed successfully"),n.data}catch(n){throw n instanceof Wt?n:new Wt(n instanceof Error?n.message:"Trivy ìŠ¤ìº” ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"SCAN_ERROR",n)}}async scanWeb(t){const r=sp();O.info("[ZAP] Starting DAST web scan:",{target_url:t.target_url,scan_type:t.scan_type||"baseline",endpoint:r});try{const n=await this.instance.post(r,t);if(!n.data)throw new Wt("ZAP DAST ìŠ¤ìº” ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");if(n.data.success===!1)throw new Wt(n.data.error||"ZAP DAST ìŠ¤ìº”ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",500,"SCAN_FAILED",n.data);return O.info("[ZAP] DAST scan completed successfully"),n.data}catch(n){throw n instanceof Wt?n:new Wt(n instanceof Error?n.message:"ZAP DAST ìŠ¤ìº” ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"SCAN_ERROR",n)}}async scanCode(t){const r=rp();O.info("[SAST] Starting source code scan:",{git_url:t.git_url,branch:t.branch||"main",endpoint:r});try{const n=await this.instance.post(r,t);if(!n.data)throw new Wt("SAST ìŠ¤ìº” ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");if(n.data.success===!1)throw new Wt(n.data.error||"SAST ìŠ¤ìº”ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",500,"SCAN_FAILED",n.data);return O.info("[SAST] Source code scan completed successfully"),n.data}catch(n){throw n instanceof Wt?n:new Wt(n instanceof Error?n.message:"SAST ìŠ¤ìº” ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"SCAN_ERROR",n)}}getServiceConfig(){return{astServiceUrl:Sn(),trivyEndpoint:tp(),zapEndpoint:sp(),sastEndpoint:rp(),environment:"production"}}async checkHealth(){try{return{healthy:(await this.instance.get(`${Sn()}/health`,{timeout:5e3})).status===200,message:"AST ì„œë¹„ìŠ¤ê°€ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤."}}catch(t){return{healthy:!1,message:"AST ì„œë¹„ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}}}async getVulnerabilityCategories(){const t=`${Sn()}/scan/vulnerabilities/categories`;O.info("[Vulnerability] Fetching categories");try{const r=await this.instance.get(t);if(!r.data)throw new Wt("ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");return O.info("[Vulnerability] Categories fetched successfully"),r.data}catch(r){throw r instanceof Wt?r:new Wt(r instanceof Error?r.message:"ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"FETCH_ERROR",r)}}async getCategorizedVulnerabilities(t,r="all",n){const a=new URLSearchParams;r!=="all"&&a.append("tool",r),n&&a.append("image_name",n);const i=a.toString(),l=`${Sn()}/scan/vulnerabilities/categorized/${t}${i?`?${i}`:""}`;O.info("[Vulnerability] Fetching categorized vulnerabilities:",{gitInfoIdx:t,tool:r,imageName:n});try{const d=await this.instance.get(l);if(!d.data)throw new Wt("ì¹´í…Œê³ ë¦¬í™”ëœ ì·¨ì•½ì  ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");return O.info("[Vulnerability] Categorized vulnerabilities fetched successfully"),d.data}catch(d){throw d instanceof Wt?d:new Wt(d instanceof Error?d.message:"ì¹´í…Œê³ ë¦¬í™”ëœ ì·¨ì•½ì  ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"FETCH_ERROR",d)}}async getPendingVulnerabilities(t,r="all",n){const a=new URLSearchParams;r!=="all"&&a.append("tool",r),n&&a.append("image_name",n);const i=a.toString(),l=`${Sn()}/scan/vulnerabilities/pending/${t}${i?`?${i}`:""}`;O.info("[Vulnerability] Fetching pending vulnerabilities:",{gitInfoIdx:t,tool:r,imageName:n});try{const d=await this.instance.get(l);if(!d.data)throw new Wt("ë¯¸í•´ê²° ì·¨ì•½ì  ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");return O.info("[Vulnerability] Pending vulnerabilities fetched successfully"),d.data}catch(d){throw d instanceof Wt?d:new Wt(d instanceof Error?d.message:"ë¯¸í•´ê²° ì·¨ì•½ì  ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"FETCH_ERROR",d)}}async resolveVulnerability(t){const r=`${Sn()}/scan/vulnerabilities/resolve`;O.info("[Vulnerability] Resolving vulnerability:",{item_id:t.item_id,status:t.status});try{const n=await this.instance.post(r,t);if(!n.data)throw new Wt("ì·¨ì•½ì  í•´ê²° ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");if(n.data.success===!1)throw new Wt(n.data.error||"ì·¨ì•½ì  í•´ê²° ìƒíƒœ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",500,"UPDATE_FAILED",n.data);return O.info("[Vulnerability] Vulnerability resolved successfully"),n.data}catch(n){throw n instanceof Wt?n:new Wt(n instanceof Error?n.message:"ì·¨ì•½ì  í•´ê²° ìƒíƒœ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"UPDATE_ERROR",n)}}async generateImageSbom(t){const r=`${Sn()}/scan/sbom/image`;O.info("[SBOM] Generating image SBOM:",{image_url:t.image_url,license_analysis:t.license_analysis});try{const n=await this.instance.post(r,t);if(!n.data)throw new Wt("SBOM ìƒì„± ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");if(n.data.success===!1)throw new Wt(n.data.error||"SBOM ìƒì„±ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",500,"SBOM_GENERATION_FAILED",n.data);return O.info("[SBOM] Image SBOM generated successfully"),n.data}catch(n){throw n instanceof Wt?n:new Wt(n instanceof Error?n.message:"SBOM ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"SBOM_ERROR",n)}}async generateSourceSbom(t){const r=`${Sn()}/scan/sbom/source`;O.info("[SBOM] Generating source SBOM:",{git_url:t.git_url,branch:t.branch,license_analysis:t.license_analysis});try{const n=await this.instance.post(r,t);if(!n.data)throw new Wt("SBOM ìƒì„± ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");if(n.data.success===!1)throw new Wt(n.data.error||"SBOM ìƒì„±ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",500,"SBOM_GENERATION_FAILED",n.data);return O.info("[SBOM] Source SBOM generated successfully"),n.data}catch(n){throw n instanceof Wt?n:new Wt(n instanceof Error?n.message:"SBOM ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"SBOM_ERROR",n)}}async getSbomResults(t){const r=`${Sn()}/scan/sbom/${t}`;O.info("[SBOM] Fetching SBOM results:",{serviceId:t});try{const n=await this.instance.get(r);if(!n.data)throw new Wt("SBOM ê²°ê³¼ ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");return O.info("[SBOM] SBOM results fetched successfully"),n.data}catch(n){throw n instanceof Wt?n:new Wt(n instanceof Error?n.message:"SBOM ê²°ê³¼ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"FETCH_ERROR",n)}}async downloadSbom(t,r="json"){const n=`${Sn()}/scan/sbom/${t}/download`;O.info("[SBOM] Downloading SBOM:",{sbomId:t,format:r});try{const a=await this.instance.get(n,{responseType:"blob",params:{format:r}});return O.info("[SBOM] SBOM downloaded successfully"),a.data}catch(a){throw a instanceof Wt?a:new Wt(a instanceof Error?a.message:"SBOM ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"DOWNLOAD_ERROR",a)}}async getLicenseAnalysis(t){const r=`${Sn()}/scan/license/${t}`;O.info("[License] Fetching license analysis:",{serviceId:t});try{const n=await this.instance.get(r);if(!n.data)throw new Wt("ë¼ì´ì„ ìŠ¤ ë¶„ì„ ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");return O.info("[License] License analysis fetched successfully"),n.data}catch(n){throw n instanceof Wt?n:new Wt(n instanceof Error?n.message:"ë¼ì´ì„ ìŠ¤ ë¶„ì„ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"FETCH_ERROR",n)}}async resolveLicense(t){const r=`${Sn()}/scan/license/resolve`;O.info("[License] Resolving license:",{sbom_id:t.sbom_id,component_name:t.component_name,status:t.status});try{const n=await this.instance.post(r,t);if(!n.data)throw new Wt("ë¼ì´ì„ ìŠ¤ ê²€í†  ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.",500,"EMPTY_RESPONSE");if(n.data.success===!1)throw new Wt(n.data.error||"ë¼ì´ì„ ìŠ¤ ê²€í†  ìƒíƒœ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",500,"UPDATE_FAILED",n.data);return O.info("[License] License resolved successfully"),n.data}catch(n){throw n instanceof Wt?n:new Wt(n instanceof Error?n.message:"ë¼ì´ì„ ìŠ¤ ê²€í†  ìƒíƒœ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"UPDATE_ERROR",n)}}async getLicenseReport(t,r="json"){const n=`${Sn()}/scan/license/report/${t}?format=${r}`;O.info("[License] Generating license report:",{sbomId:t,format:r});try{if(r==="json"){const a=await this.instance.get(n);return O.info("[License] License report generated successfully"),a.data}else{const a=await this.instance.get(n,{responseType:"blob"});return O.info("[License] License report downloaded successfully"),a.data}}catch(a){throw a instanceof Wt?a:new Wt(a instanceof Error?a.message:"ë¼ì´ì„ ìŠ¤ ë¦¬í¬íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ",500,"REPORT_ERROR",a)}}}const go=new i0,Qo=s=>s instanceof Wt,Xt={list:async()=>ee.post("/gits",{action:"getRepositories"}),getRepoById:async s=>ee.post("/gits",{action:"getRepositoryById",parameters:{id:s}}),add:async s=>ee.post("/gits",{action:"createRepository",parameters:s}),delete:async s=>ee.post("/gits",{action:"deleteRepository",parameters:{id:s}}),getRepoMembers:async s=>ee.post("/gits",{action:"getRepoMembers",parameters:{id:s}}),addRepoMember:async(s,t,r)=>ee.post("/gits",{action:"addRepoMember",parameters:{id:s,email:t,admin_token:r}}),removeRepoMember:async(s,t,r)=>ee.post("/gits",{action:"removeRepoMember",parameters:{id:s,email:t,admin_token:r}}),getUsername:async s=>ee.post("/gits",{action:"getUsername",parameters:{gitlabUrl:s}}),getGroups:async s=>ee.post("/gits",{action:"getGroups",parameters:{gitlab_url:s}}),createUser:async s=>ee.post("/gits",{action:"createUser",parameters:{gitlabUrl:s.gitlabUrl,groupID:s.groupID,userAuth:s.userAuth,username:s.username,name:s.name,email:s.email,password:s.password}}),newSastResult:async s=>ee.post("/gits",{action:"newSastResult",parameters:{repo_id:s}}),saveSastResult:async(s,t,r,n,a,i)=>ee.post("/gits",{action:"saveSastResult",parameters:{repo_id:s,result:t,status:r,semgrep_command_log:n||"",codeql_command_log:a||"",trivy_command_log:i||null}}),getSastResult:async s=>ee.post("/gits",{action:"getSastResult",parameters:{repo_id:s}}),listSastLastUpdates:async()=>ee.post("/gits",{action:"listSastLastUpdates",parameters:{}}),executeSastScan:async s=>ee.post("/gits",{action:"executeSastScan",parameters:s},{timeout:3e5}),validateAdminToken:async(s,t)=>ee.post("/gits",{action:"validateAdminToken",parameters:{token:s,gitlab_url:t}}),getCommits:async(s,t)=>{const r={repo_id:s};return t&&(r.gitlab_token=t),ee.post("/gits",{action:"getCommits",parameters:r})},trivyScanImage:async s=>(O.info("[SCA] Trivy ì´ë¯¸ì§€ ìŠ¤ìº” ì‹œì‘ (Backend í†µí•´):",{image_url:s.image_url}),ee.post("/gits",{action:"newScaResult",parameters:{repo_id:s.repo_id,image_url:s.image_url,scan_type:s.scan_type||"vuln",registry_username:s.registry_username,registry_password:s.registry_password}},{timeout:3e5})),newScaResult:async(s,t)=>ee.post("/gits",{action:"newScaResult",parameters:{repo_id:s,...t}}),saveScaResult:async(s,t,r,n)=>ee.post("/gits",{action:"saveScaResult",parameters:{repo_id:s,result:t,status:r,execution_log:n||""}}),getScaResult:async s=>ee.post("/gits",{action:"getScaResult",parameters:{repo_id:s}}),getScaResults:async(s,t=10)=>ee.post("/gits",{action:"getScaResults",parameters:{repo_id:s,limit:t}}),listScaLastUpdates:async()=>ee.post("/gits",{action:"listScaLastUpdates",parameters:{}}),newDastResult:async s=>ee.post("/gits",{action:"newDastResult",parameters:{repo_id:s}}),saveDastResult:async(s,t,r,n)=>ee.post("/gits",{action:"saveDastResult",parameters:{repo_id:s,result:t,status:r,execution_log:n||""}}),getDastResult:async s=>ee.post("/gits",{action:"getDastResult",parameters:{repo_id:s}}),listDastLastUpdates:async()=>ee.post("/gits",{action:"listDastLastUpdates",parameters:{}}),executeDastScan:async(s,t)=>ee.post("/gits",{action:"executeDastScan",parameters:{repo_id:s,...t}}),dastScanWeb:async s=>(O.info("[DAST] ZAP ì›¹ ìŠ¤ìº” ì‹œì‘ (Backend í†µí•´):",{target_url:s.target_url}),ee.post("/gits",{action:"executeDastScan",parameters:{repo_id:s.repo_id,target_url:s.target_url,scan_type:s.scan_type||"baseline",options:s.options}},{timeout:3e5})),getAnalysisServiceConfig:()=>go.getServiceConfig(),checkAnalysisServiceHealth:async()=>go.checkHealth(),generateImageSbom:async s=>(O.info("[SBOM] ì´ë¯¸ì§€ SBOM ìƒì„± ì‹œì‘ (Backend í†µí•´):",{image_url:s.image_url,license_analysis:s.license_analysis}),ee.post("/sbom/image",s,{timeout:6e5})),generateSourceSbom:async s=>(O.info("[SBOM] ì†ŒìŠ¤ì½”ë“œ SBOM ìƒì„± ì‹œì‘ (Backend í†µí•´):",{git_url:s.git_url,branch:s.branch,license_analysis:s.license_analysis}),ee.post("/sbom/source",s,{timeout:6e5})),getSbomResults:async s=>ee.get(`/sbom/list/${s}`),downloadSbom:async(s,t="json")=>ee.get(`/sbom/download/${s}?format=${t}`,{responseType:"blob"})},np={source:"code",build:"build",deploy:"deploy",operate:"operate"},ap={source:"ì†ŒìŠ¤",build:"ë¹Œë“œ",deploy:"ë°°í¬",operate:"ìš´ì˜"},sx=async()=>{try{return(await ee.service("getServices",{})).data||[]}catch(s){throw O.error("ì„œë¹„ìŠ¤ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",s),s}},vo=async s=>{try{const t=await ee.service("getServiceById",{id:s});if(!t.data)throw new Error("ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error("ì„œë¹„ìŠ¤ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},o0=s=>typeof s=="string"&&["running","stopped","error","pending","deploying","failed","registered","restarting","stopping"].includes(s),rx=async s=>{try{const t=await ee.service("status",{service_id:s});return!t.data||!o0(t.data)?(O.warn("Received invalid service status:",{status:t.data}),"pending"):t.data}catch(t){throw O.error("ì„œë¹„ìŠ¤ ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},nx=async s=>{try{const t=await ee.service("create",s);if(!t.data)throw new Error("ì„œë¹„ìŠ¤ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error("ì„œë¹„ìŠ¤ ìƒì„± ì‹¤íŒ¨:",t),t}},ax=async(s,t)=>{try{const r=await ee.service("update",{service_id:s,...t});if(!r.data)throw new Error("ì„œë¹„ìŠ¤ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data}catch(r){throw O.error("ì„œë¹„ìŠ¤ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:",r),r}},ix=async s=>{try{await ee.service("delete",{service_id:s})}catch(t){throw O.error("ì„œë¹„ìŠ¤ ì‚­ì œ ì‹¤íŒ¨:",t),t}},ox=async s=>{try{return await ee.service("deployService",s)}catch(t){throw O.error("ì„œë¹„ìŠ¤ ë°°í¬ ì‹¤íŒ¨:",t),t}},lx=async s=>{try{await ee.service("start",{service_id:s})}catch(t){throw O.error("ì„œë¹„ìŠ¤ ì‹œì‘ ì‹¤íŒ¨:",t),t}},cx=async s=>{try{await ee.service("stop",{service_id:s})}catch(t){throw O.error("ì„œë¹„ìŠ¤ ì¤‘ì§€ ì‹¤íŒ¨:",t),t}},dx=async s=>{try{await ee.service("restart",{service_id:s})}catch(t){throw O.error("ì„œë¹„ìŠ¤ ì¬ì‹œì‘ ì‹¤íŒ¨:",t),t}},ux=async(s,t)=>{var r;try{return((r=(await ee.service("logs",{service_id:s,lines:t||100})).data)==null?void 0:r.logs)||""}catch(n){throw O.error("ì„œë¹„ìŠ¤ ë¡œê·¸ ì¡°íšŒ ì‹¤íŒ¨:",n),n}},hx=async s=>{try{return O.warn("ì„œë¹„ìŠ¤ ë©¤ë²„ ê¸°ëŠ¥ì´ í˜„ì¬ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤."),[]}catch(t){throw O.error("ì„œë¹„ìŠ¤ ë©¤ë²„ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},px=async(s,t,r)=>{try{throw new Error("ì„œë¹„ìŠ¤ ë©¤ë²„ ì¶”ê°€ ê¸°ëŠ¥ì´ í˜„ì¬ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")}catch(n){throw O.error("ì„œë¹„ìŠ¤ ë©¤ë²„ ì¶”ê°€ ì‹¤íŒ¨:",n),n}},gx=async(s,t)=>{try{throw new Error("ì„œë¹„ìŠ¤ ë©¤ë²„ ì œê±° ê¸°ëŠ¥ì´ í˜„ì¬ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")}catch(r){throw O.error("ì„œë¹„ìŠ¤ ë©¤ë²„ ì œê±° ì‹¤íŒ¨:",r),r}},xx=async s=>{try{const t=await ee.service("getServiceServers",{service_id:s});if(!t.data)throw new Error("ì„œë²„ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error("ì„œë¹„ìŠ¤ì˜ ì„œë²„ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},l0=async(s,t)=>{try{await ee.service("updateServiceInfra",{service_id:s,infra_id:t})}catch(r){throw O.error("ì„œë¹„ìŠ¤ ì¸í”„ë¼ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:",r),r}},kc=async(s,t,r,n,a,i)=>{try{await ee.infra("updateServiceRegistryConfig",{service_id:s,registry_url:t,registry_type:r,project_name:n,username:a,password:i})}catch(l){throw O.error("Registry ì„¤ì • ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:",l),l}},mx=async s=>{try{return(await ee.service("updateServiceInfo",{id:s.id,name:s.serviceName,branch:s.gitlabBranch,infra_id:s.infraId})).data||null}catch(t){throw O.error("ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì • ì‹¤íŒ¨",t),t}},wu=async(s,t)=>{try{const r=await ee.service("updateService",{id:s,gitlab_access_token:t});if(!r.data)throw new Error("GitLab í† í° ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data}catch(r){throw O.error("GitLab í† í° ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:",r),r}},fx=async(s,t)=>{try{const r={...t};r.access_token&&!r.token&&(r.token=r.access_token);const n=await ee.service("updateService",{id:s,gitlab_config:JSON.stringify(r)});if(!n.data)throw new Error("GitLab ì„¤ì • ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return n.data}catch(r){throw O.error("GitLab ì„¤ì • ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:",r),r}},gn={getServices:sx,getService:vo,getServiceStatus:rx,createService:nx,updateService:ax,deleteService:ix,deployService:ox,startService:lx,stopService:cx,restartService:dx,getServiceLogs:ux,getServiceMembers:hx,addServiceMember:px,removeServiceMember:gx,getServiceServers:xx,updateServiceInfra:l0,updateServiceRegistryConfig:kc,updateServiceInfo:mx,updateServiceGitLabToken:wu,updateServiceGitLabConfig:fx},c0=Object.freeze(Object.defineProperty({__proto__:null,addServiceMember:px,createService:nx,deleteService:ix,deployService:ox,getService:vo,getServiceLogs:ux,getServiceMembers:hx,getServiceServers:xx,getServiceStatus:rx,getServices:sx,removeServiceMember:gx,restartService:dx,serviceApi:gn,startService:lx,stopService:cx,updateService:ax,updateServiceGitLabConfig:fx,updateServiceGitLabToken:wu,updateServiceInfo:mx,updateServiceRegistryConfig:kc},Symbol.toStringTag,{value:"Module"}));var d0={};class ip extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.statusCode=r,this.originalError=n}}class u0{constructor(t){this.config={timeout:1e4,showErrorMessages:!0,showLoadingMessages:!1,...t},this.instance=iu.create({baseURL:this.config.baseURL,timeout:this.config.timeout||1e4,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}setupInterceptors(){this.instance.interceptors.request.use(t=>{const r=localStorage.getItem("authToken");return r&&(t.headers.Authorization=`Bearer ${r}`),this.config.showLoadingMessages&&f.loading("ìš”ì²­ ì²˜ë¦¬ ì¤‘...",0),t},t=>(f.destroy(),Promise.reject(new Error(t instanceof Error?t.message:String(t))))),this.instance.interceptors.response.use(t=>{if(f.destroy(),t.data&&typeof t.data=="object"&&"success"in t.data){const r=t.data;if(!r.success&&r.error)throw new ip(r.error,t.status,new Op(r.error,"API_ERROR",t.config,t.request,t))}return t},t=>{f.destroy();let r="ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",n=0;if(t.response){n=t.response.status;const i=t.response.data;if(i&&typeof i=="object"&&"error"in i){const l=i;l!=null&&l.error&&(r=l.error)}else switch(n){case 400:r="ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤.";break;case 401:r="ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.",localStorage.removeItem("authToken"),window.location.href="/login";break;case 403:r="ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.";break;case 404:r="ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";break;case 500:r="ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";break;default:r=`ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (${n})`}}else t.request?r="ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.":r=t.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";this.config.showErrorMessages&&n!==401&&f.error(r);const a=new ip(r,n,t);return Promise.reject(a)})}async get(t,r){return(await this.instance.get(t,r)).data}async post(t,r,n){return(await this.instance.post(t,r,n)).data}async put(t,r,n){return(await this.instance.put(t,r,n)).data}async patch(t,r,n){return(await this.instance.patch(t,r,n)).data}async delete(t,r){return(await this.instance.delete(t,r)).data}async upload(t,r,n,a){const i=new FormData;i.append("file",r);const l={...a,headers:{...a==null?void 0:a.headers,"Content-Type":"multipart/form-data"},onUploadProgress:c=>{if(n&&c.total){const p=Math.round(c.loaded*100/c.total);n(p)}}};return(await this.instance.post(t,i,l)).data}createAbortController(){return new AbortController}getAxiosInstance(){return this.instance}}const Kn=new u0({baseURL:d0.REACT_APP_API_BASE_URL||"/api/v1",timeout:3e4,showErrorMessages:!0,showLoadingMessages:!1}),h0=async s=>{try{const t=await Kn.post("/harbor/projects",s||{});if(!t.success||!t.data)throw new Error(t.error||"Harbor í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨");return O.info(`Harbor í”„ë¡œì íŠ¸ ${t.data.projects.length}ê°œ ì¡°íšŒ ì„±ê³µ`),t.data}catch(t){throw O.error("Harbor í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:",t),t}},p0={spa:{label:"SPA (ì •ì  ì‚¬ì´íŠ¸)",description:"ë¹Œë“œ í›„ Nginxë¡œ ì •ì  íŒŒì¼ ì„œë¹™"},ssr:{label:"SSR (ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§)",description:"Node.js ëŸ°íƒ€ì„ì—ì„œ ì„œë²„ ì‹¤í–‰"},api:{label:"API ì„œë²„",description:"ë°±ì—”ë“œ API ì„œë²„"},compiled:{label:"ì»´íŒŒì¼ ì–¸ì–´",description:"ë¹Œë“œ í›„ ë°”ì´ë„ˆë¦¬ ì‹¤í–‰"},static:{label:"ì •ì  ì‚¬ì´íŠ¸",description:"HTML/CSS/JS íŒŒì¼ì„ Nginxë¡œ ì„œë¹™"}},op={nextjs:{name:"nextjs",display_name:"Next.js",build_type:"ssr",default_port:3e3,description:"React í’€ìŠ¤íƒ í”„ë ˆì„ì›Œí¬"},react:{name:"react",display_name:"React",build_type:"spa",default_port:80,description:"React SPA ì• í”Œë¦¬ì¼€ì´ì…˜"},vue:{name:"vue",display_name:"Vue.js",build_type:"spa",default_port:80,description:"Vue.js SPA ì• í”Œë¦¬ì¼€ì´ì…˜"},angular:{name:"angular",display_name:"Angular",build_type:"spa",default_port:80,description:"Angular SPA ì• í”Œë¦¬ì¼€ì´ì…˜"},nestjs:{name:"nestjs",display_name:"NestJS",build_type:"api",default_port:3e3,description:"Node.js ë°±ì—”ë“œ í”„ë ˆì„ì›Œí¬"},express:{name:"express",display_name:"Express.js",build_type:"api",default_port:3e3,description:"Node.js ì›¹ í”„ë ˆì„ì›Œí¬"},fastapi:{name:"fastapi",display_name:"FastAPI",build_type:"api",default_port:8e3,description:"ê³ ì„±ëŠ¥ Python API í”„ë ˆì„ì›Œí¬"},django:{name:"django",display_name:"Django",build_type:"api",default_port:8e3,description:"Python í’€ìŠ¤íƒ í”„ë ˆì„ì›Œí¬"},flask:{name:"flask",display_name:"Flask",build_type:"api",default_port:5e3,description:"Python ë§ˆì´í¬ë¡œ í”„ë ˆì„ì›Œí¬"},streamlit:{name:"streamlit",display_name:"Streamlit",build_type:"ssr",default_port:8501,description:"ë°ì´í„° ì•± í”„ë ˆì„ì›Œí¬"},"spring-boot":{name:"spring-boot",display_name:"Spring Boot",build_type:"api",default_port:8080,description:"Java ì—”í„°í”„ë¼ì´ì¦ˆ í”„ë ˆì„ì›Œí¬"},quarkus:{name:"quarkus",display_name:"Quarkus",build_type:"api",default_port:8080,description:"í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ Java í”„ë ˆì„ì›Œí¬"},rust:{name:"rust",display_name:"Rust",build_type:"compiled",default_port:8080,description:"ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´"},dotnet:{name:"dotnet",display_name:".NET / C#",build_type:"compiled",default_port:8080,description:".NET í”„ë ˆì„ì›Œí¬"},static:{name:"static",display_name:"ì •ì  ì‚¬ì´íŠ¸",build_type:"static",default_port:80,description:"HTML/CSS/JS ì •ì  íŒŒì¼"}},Ni={detectProjectType:async s=>ee.post("/build-wizard",{action:"detectProjectType",parameters:s}),generateBuildFiles:async s=>ee.post("/build-wizard",{action:"generateBuildFiles",parameters:s}),getLanguageConfigs:async()=>ee.post("/build-wizard",{action:"getLanguageConfigs",parameters:{}}),commitBuildFiles:async s=>ee.post("/build-wizard",{action:"commitBuildFiles",parameters:s}),checkBuildFiles:async s=>ee.post("/build-wizard",{action:"checkBuildFiles",parameters:s})},g0=({open:s,onCancel:t,onConfirm:r,gitUrl:n,branch:a="main"})=>{const[i,l]=o.useState(!1),[d,c]=o.useState([]),[p,h]=o.useState([]),[x,_]=o.useState(!0),[S,L]=o.useState(null);o.useEffect(()=>{s&&n&&k()},[s,n,a]);const k=async()=>{var $;try{l(!0),L(null);const y=await Ni.detectProjectType({git_url:n,branch:a});let v=[];y.data.sub_projects&&y.data.sub_projects.length>0?v=y.data.sub_projects.map(u=>u.path):y.data.has_dockerfile&&(v=[(($=n.split("/").pop())==null?void 0:$.replace(".git",""))||"service"]),v.length===0?L("í”„ë¡œì íŠ¸ì—ì„œ ë¹Œë“œ ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."):(c(v),h(v),_(!0))}catch(y){console.error("Failed to load services:",y),L("ì„œë¹„ìŠ¤ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. Git ì €ì¥ì†Œ ì ‘ê·¼ ê¶Œí•œì„ í™•ì¸í•´ì£¼ì„¸ìš”.")}finally{l(!1)}},E=$=>{_($),h($?d:[])},P=($,y)=>{if(y){const v=[...p,$];h(v),_(v.length===d.length)}else{const v=p.filter(u=>u!==$);h(v),_(!1)}},I=($=!1)=>{if(p.length===0){f.warning("ìµœì†Œ 1ê°œ ì´ìƒì˜ ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}r(p,$)};return e.jsx(rt,{open:s,title:e.jsxs(g,{children:[e.jsx(Da,{style:{color:"#1890ff"}}),e.jsx("span",{children:"ë¹Œë“œ ì„œë¹„ìŠ¤ ì„ íƒ"})]}),onCancel:t,width:600,footer:[e.jsx(B,{onClick:t,children:"ì·¨ì†Œ"},"cancel"),e.jsxs(B,{type:"primary",onClick:()=>I(!1),disabled:p.length===0,icon:e.jsx(Ze,{}),children:["ë¹Œë“œ ì‹œì‘ (",p.length,"ê°œ ì„œë¹„ìŠ¤)"]},"submit")],children:e.jsxs(gt,{spinning:i,children:[e.jsx(xe,{message:"ë¹Œë“œí•  ì„œë¹„ìŠ¤ ì„ íƒ",description:"í”„ë¡œì íŠ¸ì˜ docker-compose.yamlì—ì„œ ê°ì§€ëœ ì„œë¹„ìŠ¤ ëª©ë¡ì…ë‹ˆë‹¤. ë¹Œë“œí•  ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•˜ì„¸ìš”.",type:"info",showIcon:!0,style:{marginBottom:16}}),S?e.jsx(xe,{message:"ì˜¤ë¥˜ ë°œìƒ",description:S,type:"error",showIcon:!0,style:{marginBottom:16}}):null,!i&&d.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(Vr,{checked:x,onChange:$=>E($.target.checked),style:{marginBottom:16,fontWeight:"bold"},children:["ëª¨ë“  ì„œë¹„ìŠ¤ ì„ íƒ (",d.length,"ê°œ)"]}),e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid #f0f0f0",borderRadius:"4px",padding:"12px"},children:e.jsx(g,{direction:"vertical",style:{width:"100%"},children:d.map($=>e.jsx(Vr,{checked:p.includes($),onChange:y=>P($,y.target.checked),style:{padding:"8px",borderRadius:"4px",backgroundColor:p.includes($)?"#e6f7ff":"transparent",width:"100%",transition:"background-color 0.3s"},children:e.jsx(we.Text,{strong:!0,children:$})},$))})}),e.jsx(we.Text,{type:"secondary",style:{display:"block",marginTop:12},children:"ğŸ’¡ ì„ íƒí•œ ì„œë¹„ìŠ¤ë§Œ ë¹Œë“œë˜ë©°, Harbor Registryì— í‘¸ì‹œë©ë‹ˆë‹¤."})]}),!i&&d.length===0&&!S&&e.jsx(Je,{description:"ë¹Œë“œ ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",style:{marginTop:32}})]})})},x0=({open:s,onCancel:t,onSubmit:r,serviceId:n,gitUrl:a,registryUrl:i,gitBranch:l,defaultAutoDeploy:d=!1})=>{const[c]=H.useForm(),[p,h]=o.useState(!1),[x,_]=o.useState([]),[S,L]=o.useState([]),[k,E]=o.useState(null),[P,I]=o.useState(null),[$,y]=o.useState([]),[v,u]=o.useState(null),[m,j]=o.useState("idle"),[b,A]=o.useState("idle"),[W,Z]=o.useState(""),[se,ce]=o.useState("main"),[D,M]=o.useState(""),[K,J]=o.useState("harbor"),[te,G]=o.useState(""),[q,oe]=o.useState([]),[be,ne]=o.useState(!1),[ye,Ue]=o.useState(null),[N,ge]=o.useState([]),[Ce,je]=o.useState(!1),[Pe,w]=o.useState(null),[R,U]=o.useState(""),[V,F]=o.useState(!1),[X,de]=o.useState(!1),[Ne,ae]=o.useState(!1),[pe,Xe]=o.useState(!1),[Nt,Fe]=o.useState(void 0),[Le,Oe]=o.useState(null),[Mt,Ve]=o.useState(!1),{serverlist:Me,upsertServerByHostPort:ot}=Gs();o.useEffect(()=>{s||(E(null),I(null),L([]),y([]),u(null),F(!1),de(!1),ae(!1),j("idle"),A("idle"),c.resetFields())},[s,c]),o.useEffect(()=>{if(a&&Z(a),l&&ce(l),i)try{const lt=JSON.parse(i);lt.registry_url&&M(lt.registry_url),lt.project_name&&G(lt.project_name),lt.registry_url&&lt.registry_url.includes("docker.io")?J("dockerhub"):J("harbor")}catch(lt){M(i)}},[a,l,i]),o.useEffect(()=>{if(!s||!n)return;(async()=>{try{const Rt=await vo(n);if(Rt.infra_id&&(c.setFieldsValue({infra_id:Rt.infra_id}),u(Rt.infra_id)),Rt.gitlab_config&&Rt.gitlab_config.trim()!=="")try{const St=JSON.parse(Rt.gitlab_config),ms=St.token||St.access_token;ms&&St.username?(F(!0),c.setFieldsValue({credentials:{...c.getFieldValue("credentials"),username_repo:St.username,password_repo:ms}}),j("success")):console.warn("[BuildExecutionModal] âš ï¸ GitLab token ë˜ëŠ” usernameì´ ë¹„ì–´ìˆìŒ")}catch(St){console.error("[BuildExecutionModal]  GitLab config íŒŒì‹± ì‹¤íŒ¨:",St)}else console.warn("[BuildExecutionModal] âš ï¸ gitlab_configê°€ ì—†ê±°ë‚˜ ë¹„ì–´ìˆìŒ");if(Rt.registry_config)try{const St=JSON.parse(Rt.registry_config);St.username&&St.password&&(de(!0),c.setFieldsValue({credentials:{...c.getFieldValue("credentials"),docker_username:St.username,docker_password:St.password}}),A("success"))}catch(St){console.warn("Registry config íŒŒì‹± ì‹¤íŒ¨:",St)}}catch(Rt){console.warn("Service ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:",Rt)}})()},[s,n,c]),o.useEffect(()=>{s&&(Bt(),K==="harbor"&&Ps())},[s,K]),o.useEffect(()=>{s&&x.length>0&&v&&!k&&(ir(v),u(null))},[s,x,v,k]);const Bt=async()=>{try{h(!0);const lt=await Gg();_(lt)}catch(lt){f.error("ì¸í”„ë¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{h(!1)}},Ps=async()=>{try{ne(!0),Ue(null);const Rt=await h0(D?{registry_url:D}:void 0);oe(Rt.projects),Rt.projects.length===0&&Ue("Harbor í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.")}catch(lt){const Rt=lt instanceof Error?lt.message:"Harbor í”„ë¡œì íŠ¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";Ue(Rt),f.error(Rt)}finally{ne(!1)}},ir=async lt=>{const Rt=x.find(St=>St.id===lt);E(Rt||null),I(null),L([]),y([]),c.setFieldsValue({server_id:void 0});try{h(!0);const St=await vc(lt);L(St)}catch(St){f.error("ì„œë²„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{h(!1)}},Ut=async lt=>{const Rt=S.find(St=>Number(St.id)===lt);I(Rt||null);try{h(!0);const ms=(await Wg(lt)).map(ds=>{let fs=Me.find(Cs=>Cs.host===ds.host&&(Cs.port||22)===ds.port&&Cs.userId===ds.username);return fs||(fs=Me.find(Cs=>Cs.host===ds.host&&(Cs.port||22)===ds.port)),{...ds,username:ds.username||(fs==null?void 0:fs.userId)||"",password:(fs==null?void 0:fs.password)||""}}),Ts=ms.every(ds=>ds.password);ae(Ts),y(ms),c.setFieldsValue({hops:ms.map(ds=>({host:ds.host,port:ds.port,username:ds.username,password:ds.password}))})}catch(St){f.error("SSH ì ‘ì† ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{h(!1)}},Ge=async()=>{if(!(!n||!D))try{const lt=c.getFieldValue(["credentials","docker_username"]),Rt=c.getFieldValue(["credentials","docker_password"]);await kc(n,D,K,K==="harbor"?te:void 0,lt,Rt)}catch(lt){}},et=lt=>{if(!k||!P){f.error("ì¸í”„ë¼ì™€ ì„œë²„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}if(!V){f.error("Git ì¸ì¦ ì •ë³´ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ GitLab í† í°ì„ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”.");return}if(!X){f.error("Registry ì¸ì¦ ì •ë³´ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ Registry ì¸ì¦ ì •ë³´ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”.");return}Oe(lt),Xe(!0)},tt=(lt,Rt)=>{const St=d||Rt||!1;Fe(lt),Ve(St),Xe(!1),Le&&Vt(Le,lt,St)},Vt=async(lt,Rt,St)=>{var ms,Ts,ds,fs,Cs;if(!(!k||!P)){if((ms=lt.hops)==null||ms.forEach(gr=>{gr.password&&ot({host:gr.host,port:gr.port,userId:gr.username,password:gr.password})}),n)try{await Ge()}catch(gr){f.warning("Registry ì„¤ì • ì €ì¥ì— ì‹¤íŒ¨í–ˆì§€ë§Œ ë¹Œë“œë¥¼ ê³„ì† ì§„í–‰í•©ë‹ˆë‹¤.")}r({infra_id:k.id,server_id:Number(P.id),hops:lt.hops,username_repo:(Ts=lt.credentials)==null?void 0:Ts.username_repo,password_repo:(ds=lt.credentials)==null?void 0:ds.password_repo,docker_username:(fs=lt.credentials)==null?void 0:fs.docker_username,docker_password:(Cs=lt.credentials)==null?void 0:Cs.docker_password,selected_services:Rt&&Rt.length>0?Rt:void 0,auto_deploy:St})}};return e.jsxs(rt,{open:s,title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",paddingRight:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[e.jsx(_t,{style:{color:"#1890ff",fontSize:"18px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:"ë¹Œë“œ ì‹¤í–‰"})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexShrink:0},children:[e.jsx(B,{size:"small",onClick:t,style:{marginRight:"4px"},children:"ì·¨ì†Œ"}),e.jsx(B,{type:"primary",onClick:()=>c.submit(),loading:p,size:"small",icon:e.jsx(_t,{}),style:{minWidth:"130px",height:"28px"},children:"ë¹Œë“œ ì„œë¹„ìŠ¤ ì„ íƒ"})]})]}),onCancel:t,closeIcon:!1,width:700,footer:null,children:[e.jsxs(gt,{spinning:p,children:[!k&&e.jsx(xe,{message:"ë¹Œë“œ ì¸í”„ë¼ê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ",description:"ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ ë¹Œë“œ/ë°°í¬ ì¸í”„ë¼ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”. ì¸í”„ë¼ê°€ ì„¤ì •ë˜ì–´ì•¼ ë¹Œë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"warning",showIcon:!0,style:{marginBottom:24}}),k&&e.jsx(xe,{message:"ë¹Œë“œ ì‹¤í–‰ ì¤€ë¹„",description:"ë¹Œë“œë¥¼ ì‹¤í–‰í•  ì„œë²„ë¥¼ ì„ íƒí•˜ê³ , í•„ìš”í•œ ì¸ì¦ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”. ë¹Œë“œ ì¸í”„ë¼ëŠ” ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ ì„¤ì •í•œ ì¸í”„ë¼ë¡œ ê³ ì •ë©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs(H,{form:c,layout:"vertical",onFinish:et,autoComplete:"off",children:[e.jsx(H.Item,{label:e.jsxs(g,{children:[e.jsx(_t,{}),e.jsx(we.Text,{strong:!0,children:"ë¹Œë“œ ì¸í”„ë¼ (ì„œë¹„ìŠ¤ ì •ë³´ì—ì„œ ì„¤ì •ë¨)"})]}),name:"infra_id",rules:[{required:!0,message:"ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ ë¹Œë“œ ì¸í”„ë¼ë¥¼ ë¨¼ì € ì„¤ì •í•˜ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ ì„¤ì •í•œ ì¸í”„ë¼ê°€ ìë™ ì„ íƒë©ë‹ˆë‹¤",onChange:ir,options:x.map(lt=>({label:`${lt.name} (${lt.type})`,value:lt.id})),disabled:!0})}),k&&e.jsx(H.Item,{label:e.jsxs(we.Text,{strong:!0,children:["ì„œë²„ ì„ íƒ (",k.type,")"]}),name:"server_id",rules:[{required:!0,message:"ì„œë²„ë¥¼ ì„ íƒí•˜ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ë¹Œë“œë¥¼ ì‹¤í–‰í•  ì„œë²„ë¥¼ ì„ íƒí•˜ì„¸ìš”",onChange:Ut,options:S.map(lt=>({label:lt.server_name||`Server #${lt.id}`,value:Number(lt.id)})),disabled:S.length===0})}),$.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{children:"SSH ì ‘ì† ì •ë³´"}),e.jsx(nr,{defaultActiveKey:["ssh"],items:[{key:"ssh",label:e.jsxs(g,{children:[e.jsx(_t,{}),e.jsxs(we.Text,{strong:!0,children:["SSH ì ‘ì† ì •ë³´ (",$.length,"ê°œ hop)"]}),Ne&&e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:"ì €ì¥ë¨"})]}),extra:Ne&&e.jsx(ln,{}),children:e.jsx(e.Fragment,{children:$.map((lt,Rt)=>{let St=Me.find(ms=>ms.host===lt.host&&(ms.port||22)===lt.port&&ms.userId===lt.username);return St||(St=Me.find(ms=>ms.host===lt.host&&(ms.port||22)===lt.port)),e.jsxs("div",{style:{border:"1px solid #f0f0f0",borderRadius:"8px",padding:"16px",marginBottom:"16px",backgroundColor:St?"#f6ffed":void 0},children:[e.jsx(H.Item,{name:["hops",Rt,"host"],hidden:!0,initialValue:lt.host,children:e.jsx(ue,{})}),e.jsx(H.Item,{name:["hops",Rt,"port"],hidden:!0,initialValue:lt.port,children:e.jsx(ue,{})}),e.jsxs(g,{style:{marginBottom:12},children:[e.jsxs(we.Text,{strong:!0,children:["Hop #",Rt+1]}),St&&e.jsx(T,{color:"success",icon:e.jsx(Qn,{}),style:{fontSize:"11px"},children:"ì €ì¥ë¨ (â—â—â—â—â—â—)"})]}),e.jsxs(Ke,{gutter:16,style:{marginTop:12},children:[e.jsx(Y,{span:16,children:e.jsx(H.Item,{label:"í˜¸ìŠ¤íŠ¸",children:e.jsx(ue,{value:lt.host,disabled:!0})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{label:"í¬íŠ¸",children:e.jsx(ue,{value:lt.port,disabled:!0})})})]}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:["hops",Rt,"username"],label:"ì‚¬ìš©ì",initialValue:lt.username,rules:[{required:!0,message:"ì‚¬ìš©ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"SSH ì‚¬ìš©ìëª…"})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:["hops",Rt,"password"],label:"ë¹„ë°€ë²ˆí˜¸",rules:[{required:!0,message:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue.Password,{placeholder:"SSH ë¹„ë°€ë²ˆí˜¸"})})})]})]},Rt)})})}]})]}),e.jsx(xt,{children:"Git ì €ì¥ì†Œ ì¸ì¦"}),e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:V?"#f6ffed":"#fff7e6",border:`1px solid ${V?"#b7eb8f":"#ffd591"}`,borderRadius:"8px",marginBottom:"16px"},children:[e.jsxs(g,{children:[e.jsx(si,{style:{fontSize:"16px",color:V?"#52c41a":"#fa8c16"}}),e.jsx(we.Text,{strong:!0,children:"Git ì¸ì¦ ì •ë³´"}),V?e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:"ì €ì¥ë¨"}),e.jsxs(we.Text,{type:"secondary",style:{fontSize:"12px"},children:["(",c.getFieldValue(["credentials","username_repo"])," / â—â—â—â—â—â—)"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"warning",icon:e.jsx(Es,{}),children:"ë¯¸ì„¤ì •"}),e.jsx(we.Text,{type:"secondary",style:{fontSize:"12px"},children:"ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ GitLab í† í°ì„ ì„¤ì •í•˜ì„¸ìš”"})]})]}),e.jsx(H.Item,{name:["credentials","username_repo"],hidden:!0,children:e.jsx(ue,{})}),e.jsx(H.Item,{name:["credentials","password_repo"],hidden:!0,children:e.jsx(ue,{})})]}),e.jsx(xt,{children:"Container Registry ì¸ì¦"}),e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:X?"#f6ffed":"#fff7e6",border:`1px solid ${X?"#b7eb8f":"#ffd591"}`,borderRadius:"8px",marginBottom:"16px"},children:[e.jsxs(g,{wrap:!0,children:[e.jsx(nc,{style:{fontSize:"16px",color:X?"#52c41a":"#fa8c16"}}),e.jsx(we.Text,{strong:!0,children:"Registry ì¸ì¦ ì •ë³´"}),X?e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:"ì €ì¥ë¨"}),D&&e.jsxs(we.Text,{type:"secondary",style:{fontSize:"12px"},children:["(",K==="harbor"?"Harbor":"Docker Hub",":"," ",D," -"," ",c.getFieldValue(["credentials","docker_username"])," / â—â—â—â—â—â—)"]}),te&&e.jsx(T,{color:"blue",children:K==="harbor"?`í”„ë¡œì íŠ¸: ${te}`:te})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"warning",icon:e.jsx(Es,{}),children:"ë¯¸ì„¤ì •"}),e.jsx(we.Text,{type:"secondary",style:{fontSize:"12px"},children:"ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ Registry ì¸ì¦ ì •ë³´ë¥¼ ì„¤ì •í•˜ì„¸ìš”"})]})]}),e.jsx(H.Item,{name:["credentials","docker_username"],hidden:!0,children:e.jsx(ue,{})}),e.jsx(H.Item,{name:["credentials","docker_password"],hidden:!0,children:e.jsx(ue,{})})]})]})]}),e.jsx(g0,{open:pe,onCancel:()=>Xe(!1),onConfirm:tt,gitUrl:W,branch:se})]})},m0=({open:s,loading:t,stageInfo:r,initialValues:n,availableBuilds:a=[],serviceBuildVersions:i,onCancel:l,onSubmit:d})=>{const[c]=H.useForm(),[p,h]=o.useState({hasAllCredentials:!1,missingCredentials:[],authenticationResult:"not_tested"}),[x,_]=o.useState(!1),[S,L]=o.useState(!1),[k,E]=o.useState(!1),[P,I]=o.useState(""),[$,y]=o.useState(""),[v,u]=o.useState("harbor"),[m,j]=o.useState(""),[b,A]=o.useState(""),[W,Z]=o.useState(void 0),{serverlist:se,upsertServerByHostPort:ce}=Gs(),D=(r==null?void 0:r.displayKey.toUpperCase())||"";o.useEffect(()=>{s||(h({hasAllCredentials:!1,missingCredentials:[],authenticationResult:"not_tested"}),_(!1),L(!1),E(!1),I(""),y(""),u("harbor"),j(""),A(""),Z(void 0),c.resetFields())},[s,c]),o.useEffect(()=>{},[s,D,r,i,a]),o.useEffect(()=>{if(!s)return;if(n!=null&&n.deployInfraId&&Z(n.deployInfraId),!(n!=null&&n.serviceId)){n!=null&&n.infraType&&A(n.infraType);return}(async()=>{try{const q=n.serviceId,oe=await vo(q);if(oe.infraType&&A(oe.infraType),oe.gitlab_config&&oe.gitlab_config.trim()!=="")try{const be=JSON.parse(oe.gitlab_config);(be.token||be.access_token)&&be.username?_(!0):console.warn("[ExecutionModal] âš ï¸ GitLab token ë˜ëŠ” usernameì´ ë¹„ì–´ìˆìŒ")}catch(be){console.error("[ExecutionModal]  GitLab config íŒŒì‹± ì‹¤íŒ¨:",be)}else console.warn("[ExecutionModal] âš ï¸ gitlab_configê°€ ì—†ê±°ë‚˜ ë¹„ì–´ìˆìŒ");if(oe.registry_config)try{const be=JSON.parse(oe.registry_config);be.username&&be.password&&(I(be.username),y(be.password))}catch(be){console.warn("Registry config íŒŒì‹± ì‹¤íŒ¨:",be)}}catch(q){console.warn("Service ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:",q)}})()},[s,n==null?void 0:n.serviceId]);const M=Ct.useCallback(()=>{var ne,ye,Ue,N;if(!n||!s)return;const G=[],q={...n};let oe=!1;if(n.hops){let ge=0;const Ce=n.hops;q.hops=Ce.map(je=>{let Pe=se.find(w=>{var R,U;return((R=w.host)==null?void 0:R.toLowerCase())===((U=je.host)==null?void 0:U.toLowerCase())&&(w.port||22)===(je.port||22)&&w.userId===je.username&&(W?w.infraId===W:w.infraId===void 0)});return Pe||(Pe=se.find(w=>{var R,U;return((R=w.host)==null?void 0:R.toLowerCase())===((U=je.host)==null?void 0:U.toLowerCase())&&(w.port||22)===(je.port||22)&&(W?w.infraId===W:w.infraId===void 0)})),Pe&&Pe.password?(ge++,{...je,username:je.username||Pe.userId||"",password:Pe.password}):(G.push(`SSH ${je.host||"unknown"}:${je.port||22}`),{...je,username:je.username||(Pe==null?void 0:Pe.userId)||""})}),oe=ge===Ce.length&&Ce.length>0,E(oe)}if(n.dockerRegistry,P&&$)q.credentials={...q.credentials||{},docker_username:P,docker_password:$},L(!0);else if((ne=n.credentials)!=null&&ne.docker_username&&((ye=n.credentials)!=null&&ye.docker_password)){const ge=(Ue=n.credentials)==null?void 0:Ue.docker_username,Ce=(N=n.credentials)==null?void 0:N.docker_password;q.credentials={...q.credentials||{},docker_username:ge,docker_password:Ce},L(!0)}else G.push("Docker Registry"),L(!1);const be=G.length===0;return h({hasAllCredentials:be,missingCredentials:G,authenticationResult:"not_tested"}),c.setFieldsValue(q),{hasAllCreds:be,missingCreds:G,formValues:q}},[n,se,c,s,P,$,W]),K=Ct.useCallback(G=>{const q=a.find(oe=>oe.image_tag===G);q&&q.docker_username&&q.docker_password?(c.setFieldsValue({credentials:{...c.getFieldValue("credentials"),docker_username:q.docker_username,docker_password:q.docker_password}}),q.registry_type&&(u(q.registry_type),c.setFieldsValue({registry_type:q.registry_type})),q.registry_project&&j(q.registry_project),L(!0)):L(!1)},[a,c]);o.useEffect(()=>{if(s&&(n!=null&&n.dockerRegistry)){const G=n.dockerRegistry;G.includes("docker.io")||G.includes("hub.docker.com")?u("dockerhub"):u("harbor")}},[s,n]),o.useEffect(()=>{s&&n&&M()},[s,n,M]),o.useEffect(()=>{if(s&&a.length>0&&D==="DEPLOY"){const G=a[0];G.docker_username&&G.docker_password&&setTimeout(()=>{c.setFieldsValue({credentials:{...c.getFieldValue("credentials"),docker_username:G.docker_username,docker_password:G.docker_password}}),G.registry_type&&(u(G.registry_type),c.setFieldsValue({registry_type:G.registry_type})),G.registry_project&&j(G.registry_project),L(!0)},100)}},[s,a,D,c]);const J=Ct.useCallback(async G=>{G.selectedServiceImages&&(G.selected_service_images=G.selectedServiceImages,delete G.selectedServiceImages),G.selectedImageTag&&(G.selected_image_tag=G.selectedImageTag,delete G.selectedImageTag);try{if(G.hops&&n.hops){const oe=n.hops,be=G.hops;oe.forEach((ne,ye)=>{const Ue=be[ye]||{},N=Ue.username||ne.username;Ue.password&&ne.host&&N&&ce({host:ne.host,port:ne.port||22,userId:N,password:Ue.password,infraId:W,serviceId:n==null?void 0:n.serviceId,hopOrder:ye})})}const q=G.credentials;if(q!=null&&q.username_repo&&(q!=null&&q.password_repo)&&(n!=null&&n.gitUrl)){let oe=n.gitUrl;try{const be=new URL(oe);oe=`${be.protocol}//${be.host}`}catch(be){}}if(q!=null&&q.docker_username&&(q!=null&&q.docker_password)&&(n!=null&&n.dockerRegistry)&&n!=null&&n.serviceId)try{await kc(n.serviceId,n.dockerRegistry,G.registry_type||v,m||void 0)}catch(oe){}f.success("ìê²©ì¦ëª… ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."),d(G)}catch(q){f.error("ìê²©ì¦ëª… ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},[ce,n,d,v,m]),te=s;return e.jsx(rt,{open:te,title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",paddingRight:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[e.jsx(dr,{style:{color:"#1890ff",fontSize:"18px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:D==="DEPLOY"?"ë°°í¬ ì‹¤í–‰":`${D} ë‹¨ê³„ ì‹¤í–‰`})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexShrink:0},children:[e.jsx(B,{size:"small",onClick:l,style:{marginRight:"8px"},children:"ì·¨ì†Œ"}),e.jsx(B,{type:"primary",size:"small",icon:e.jsx(dr,{}),onClick:()=>c.submit(),loading:t,style:{minWidth:"100px",height:"28px"},children:D==="DEPLOY"?"ë°°í¬ ì‹¤í–‰":"ì‹¤í–‰ ì‹œì‘"})]})]}),onCancel:l,closeIcon:!1,afterClose:()=>c.resetFields(),width:700,footer:null,destroyOnClose:!0,children:e.jsxs(gt,{spinning:t,tip:"ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...",children:[p.missingCredentials.length>0&&e.jsx(xe,{message:"ì¼ë¶€ ìê²©ì¦ëª…ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤",description:`ë‹¤ìŒ í•­ëª©ì˜ ìê²©ì¦ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”: ${p.missingCredentials.join(", ")}`,type:"warning",showIcon:!0,style:{marginBottom:16}}),p.hasAllCredentials&&p.authenticationResult==="failed"&&e.jsx(xe,{message:"ì¸ì¦ ì‹¤íŒ¨",description:"ì €ì¥ëœ ìê²©ì¦ëª…ìœ¼ë¡œ ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",type:"error",showIcon:!0,style:{marginBottom:16}}),e.jsxs(H,{form:c,layout:"vertical",onFinish:J,autoComplete:"off",initialValues:n,children:[D==="DEPLOY"&&i&&Object.keys(i).length>0&&(()=>{const G=Object.keys(i).sort();return e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",style:{margin:"16px 0"},children:e.jsxs(g,{children:[e.jsx(Yo,{style:{color:"#1890ff"}}),e.jsx(we.Text,{strong:!0,children:"ì„œë¹„ìŠ¤ë³„ ë¹Œë“œ ë²„ì „ ì„ íƒ"}),e.jsxs(T,{color:"blue",children:[G.length,"ê°œ ì„œë¹„ìŠ¤"]})]})}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"12px",marginBottom:"16px"},children:G.map(q=>{var be;const oe=i[q];return!oe||oe.length===0?null:e.jsxs("div",{style:{border:"1px solid #d9d9d9",borderRadius:"4px",padding:"12px",backgroundColor:"#fafafa"},children:[e.jsx("div",{style:{marginBottom:"8px"},children:e.jsxs(g,{size:4,children:[e.jsx(nc,{style:{color:"#1890ff",fontSize:"14px"}}),e.jsx(we.Text,{strong:!0,style:{fontSize:"13px"},children:q}),e.jsx(T,{color:"blue",style:{fontSize:"11px",padding:"0 4px",margin:0},children:oe.length})]})}),e.jsx(H.Item,{name:["selectedServiceImages",q],initialValue:(be=oe[0])==null?void 0:be.image_url,rules:[{required:!0,message:`${q} ë²„ì „ ì„ íƒ`}],style:{marginBottom:0},children:e.jsx(Ee,{size:"small",placeholder:"ë²„ì „ ì„ íƒ",style:{width:"100%",fontSize:"12px"},optionLabelProp:"label",children:oe.map((ne,ye)=>e.jsx(Ee.Option,{value:ne.image_url,label:e.jsxs(g,{size:4,children:[ye===0&&e.jsx(T,{color:"green",style:{fontSize:"10px",padding:"0 4px",margin:0},children:"ìµœì‹ "}),e.jsx("span",{style:{fontSize:"12px"},children:ne.image_tag})]}),children:e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"4px"},children:e.jsxs(g,{size:4,children:[ye===0&&e.jsx(T,{color:"green",style:{fontSize:"10px",padding:"0 4px",margin:0},children:"ìµœì‹ "}),e.jsx(we.Text,{strong:!0,style:{fontSize:"12px"},children:ne.image_tag})]})}),e.jsxs(we.Text,{type:"secondary",style:{fontSize:"11px"},children:[e.jsx(wr,{style:{fontSize:"10px"}})," ",new Date(ne.started_at).toLocaleDateString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})},ne.image_url))})})]},q)})})]})})(),D==="DEPLOY"&&(!i||Object.keys(i).length===0)&&a&&a.length>0&&(()=>{var G;return e.jsxs(e.Fragment,{children:[e.jsx(xt,{children:e.jsxs(we.Text,{type:"secondary",style:{fontSize:14},children:[e.jsx(Yo,{})," ë°°í¬í•  ë¹Œë“œ ì´ë¯¸ì§€ ì„ íƒ"]})}),e.jsx(xe,{message:"ë¹Œë“œ ì´ë¯¸ì§€ ì„ íƒ",description:"ë°°í¬í•  ë¹Œë“œ ë²„ì „ì„ ì„ íƒí•˜ì„¸ìš”. ìµœì‹  ë¹Œë“œ(ë§¨ ìœ„)ê°€ ê¸°ë³¸ìœ¼ë¡œ ì„ íƒë©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(H.Item,{name:"selectedImageTag",initialValue:(G=a[0])==null?void 0:G.image_tag,rules:[{required:!0,message:"ë¹Œë“œ ë²„ì „ì„ ì„ íƒí•´ì£¼ì„¸ìš”."}],children:e.jsx(aa.Group,{style:{width:"100%"},onChange:q=>K(q.target.value),children:e.jsx(g,{direction:"vertical",style:{width:"100%"},children:a.map((q,oe)=>{const be=q.built_images&&q.built_images.length>0,ne=q.registry_url&&q.registry_project?`${q.registry_url}/${q.registry_project}/*:${q.image_tag}`:q.image_tag;return e.jsx(aa.Button,{value:q.image_tag,style:{width:"100%",height:"auto",padding:0},children:e.jsx(ie,{size:"small",style:{border:"none",boxShadow:"none",background:"transparent"},bodyStyle:{padding:"12px 16px"},children:e.jsxs(Ke,{gutter:[16,8],children:[e.jsx(Y,{span:24,children:e.jsxs(g,{size:"small",wrap:!0,children:[oe===0&&e.jsx(T,{color:"green",icon:e.jsx(Ze,{}),children:"ìµœì‹ "}),e.jsx(T,{color:"blue",icon:e.jsx(Yo,{}),children:q.image_tag}),e.jsxs(we.Text,{type:"secondary",style:{fontSize:12},children:[e.jsx(wr,{})," ",new Date(q.started_at).toLocaleString("ko-KR")]}),be&&e.jsxs(T,{color:"purple",children:[q.built_images.length,"ê°œ ì´ë¯¸ì§€"]})]})}),e.jsx(Y,{span:24,children:be?e.jsxs(g,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsx(we.Text,{type:"secondary",style:{fontSize:11},children:"ë¹Œë“œëœ ì´ë¯¸ì§€:"}),q.built_images.map((ye,Ue)=>e.jsx(Ie,{title:"í´ë¦­í•˜ì—¬ ì´ë¯¸ì§€ ê²½ë¡œ ë³µì‚¬",children:e.jsxs(we.Text,{style:{fontSize:12,fontFamily:"monospace",color:"#666",wordBreak:"break-all",display:"block",paddingLeft:"8px"},copyable:{text:ye},children:[e.jsx(_s,{style:{marginRight:4}}),ye]})},Ue))]}):e.jsx(Ie,{title:"ë¹Œë“œëœ ì´ë¯¸ì§€ ì „ì²´ ê²½ë¡œ",children:e.jsxs(we.Text,{style:{fontSize:12,fontFamily:"monospace",color:"#666",wordBreak:"break-all"},copyable:{text:ne},children:[e.jsx(_s,{style:{marginRight:4}}),ne]})})}),e.jsx(Y,{span:24,children:e.jsxs(we.Text,{type:"secondary",style:{fontSize:11},children:["íŒŒì´í”„ë¼ì¸ #",q.pipeline_id,q.infra_name&&q.infra_name!=="N/A"&&e.jsxs(e.Fragment,{children:[" â€¢ ì¸í”„ë¼: ",q.infra_name]})]})})]})})},q.id)})})})})]})})(),((n==null?void 0:n.hops)||[]).length>0&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{children:"SSH ì ‘ì† ì •ë³´"}),e.jsx(nr,{defaultActiveKey:k?[]:["ssh"],items:[{key:"ssh",label:e.jsxs(g,{children:[e.jsx(_t,{}),e.jsxs(we.Text,{strong:!0,children:["SSH ì ‘ì† ì •ë³´ (",((n==null?void 0:n.hops)||[]).length,"ê°œ hop)"]}),k&&e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:"ì €ì¥ë¨"})]}),extra:k&&e.jsx(ln,{}),children:e.jsxs(e.Fragment,{children:[b&&e.jsx(xe,{message:b==="kubernetes"||b==="external_kubernetes"?"Master ë…¸ë“œ ìë™ ì„ íƒ":"ëŒ€ìƒ ì„œë²„ ìë™ ì—°ê²°",description:b==="kubernetes"||b==="external_kubernetes"?"ë°°í¬ëŠ” Master ë…¸ë“œì—ì„œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. SSH ì¸ì¦ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.":b==="docker"||b==="external_docker"?"ë°°í¬ëŠ” ì„ íƒëœ Docker ì„œë²„ì—ì„œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. SSH ì¸ì¦ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.":b==="podman"||b==="external_podman"?"ë°°í¬ëŠ” ì„ íƒëœ Podman ì„œë²„ì—ì„œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. SSH ì¸ì¦ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.":"ë°°í¬ëŠ” ì„ íƒëœ ì„œë²„ì—ì„œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. SSH ì¸ì¦ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.",type:"info",showIcon:!0,style:{marginBottom:16}}),((n==null?void 0:n.hops)||[]).map((G,q)=>{const oe=c.getFieldValue(["hops",q,"password"]);return e.jsxs("div",{style:{marginBottom:16,border:"1px solid #f0f0f0",borderRadius:"8px",padding:"16px",backgroundColor:oe?"#f6ffed":void 0},children:[e.jsx(H.Item,{name:["hops",q,"host"],hidden:!0,initialValue:G.host,children:e.jsx(ue,{})}),e.jsx(H.Item,{name:["hops",q,"port"],hidden:!0,initialValue:G.port,children:e.jsx(ue,{})}),e.jsxs(g,{style:{marginBottom:12},children:[e.jsxs(we.Text,{strong:!0,style:{color:"#1890ff"},children:[e.jsx(_t,{})," Hop ",q+1,":"," ",G.host,":",G.port]}),oe&&e.jsx(T,{color:"success",icon:e.jsx(Qn,{}),style:{fontSize:"11px"},children:"ì €ì¥ë¨ (â—â—â—â—â—â—)"})]}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:["hops",q,"username"],label:e.jsx(we.Text,{type:"secondary",style:{fontSize:12},children:"SSH ì‚¬ìš©ìëª…"}),rules:[{required:!0,message:"SSH ì‚¬ìš©ìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue,{placeholder:"SSH ì‚¬ìš©ìëª…",prefix:e.jsx(Un,{})})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:["hops",q,"password"],label:e.jsx(we.Text,{type:"secondary",style:{fontSize:12},children:"SSH ë¹„ë°€ë²ˆí˜¸"}),rules:[{required:!0,message:"SSH ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."}],children:e.jsx(ue.Password,{placeholder:"SSH ë¹„ë°€ë²ˆí˜¸"})})})]})]},q)})]})}]})]}),e.jsx(xt,{children:"GitLab ì €ì¥ì†Œ ì¸ì¦"}),e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:x?"#f6ffed":"#fff7e6",border:`1px solid ${x?"#b7eb8f":"#ffd591"}`,borderRadius:"8px",marginBottom:"16px"},children:[e.jsxs(g,{children:[e.jsx(si,{style:{fontSize:"16px",color:x?"#52c41a":"#fa8c16"}}),e.jsx(we.Text,{strong:!0,children:"Git ì¸ì¦ ì •ë³´"}),x?e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:"ì €ì¥ë¨"}),e.jsxs(we.Text,{type:"secondary",style:{fontSize:"12px"},children:["(",c.getFieldValue(["credentials","username_repo"])," / â—â—â—â—â—â—)"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"warning",children:"ë¯¸ì„¤ì •"}),e.jsx(we.Text,{type:"secondary",style:{fontSize:"12px"},children:"ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ GitLab í† í°ì„ ì„¤ì •í•˜ì„¸ìš”"})]})]}),e.jsx(H.Item,{name:["credentials","username_repo"],hidden:!0,children:e.jsx(ue,{})}),e.jsx(H.Item,{name:["credentials","password_repo"],hidden:!0,children:e.jsx(ue,{})})]}),e.jsx(xt,{children:"Container Registry ì¸ì¦"}),e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:S?"#f6ffed":"#fff7e6",border:`1px solid ${S?"#b7eb8f":"#ffd591"}`,borderRadius:"8px",marginBottom:"16px"},children:[e.jsxs(g,{wrap:!0,children:[e.jsx(nc,{style:{fontSize:"16px",color:S?"#52c41a":"#fa8c16"}}),e.jsx(we.Text,{strong:!0,children:"Registry ì¸ì¦ ì •ë³´"}),S?e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:"ì €ì¥ë¨"}),e.jsxs(we.Text,{type:"secondary",style:{fontSize:"12px"},children:["(",c.getFieldValue(["credentials","docker_username"])," / â—â—â—â—â—â—)"]}),m&&e.jsx(T,{color:"blue",children:v==="harbor"?`í”„ë¡œì íŠ¸: ${m}`:m})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"warning",children:"ë¯¸ì„¤ì •"}),e.jsx(we.Text,{type:"secondary",style:{fontSize:"12px"},children:"ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ Registry ì¸ì¦ ì •ë³´ë¥¼ ì„¤ì •í•˜ì„¸ìš”"})]})]}),e.jsx(H.Item,{name:["credentials","docker_username"],hidden:!0,children:e.jsx(ue,{})}),e.jsx(H.Item,{name:["credentials","docker_password"],hidden:!0,children:e.jsx(ue,{})})]})]},JSON.stringify(n))]})})};function f0(s,t="short",r="ko-KR"){if(!s||s==="null"||s==="undefined")return"-";try{const n=typeof s=="string"?new Date(s):s;if(isNaN(n.getTime()))return"-";switch(t){case"short":return n.toLocaleDateString(r);case"long":return n.toLocaleDateString(r,{year:"numeric",month:"2-digit",day:"2-digit"});case"datetime":return new Intl.DateTimeFormat(r,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(n);case"time":return n.toLocaleTimeString(r,{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});case"relative":return yx(n);default:return n.toLocaleDateString(r)}}catch(n){return String(s)}}function yx(s){try{const t=typeof s=="string"?new Date(s):s,n=Math.floor((new Date().getTime()-t.getTime())/1e3);if(n<60)return"ë°©ê¸ˆ ì „";const a=Math.floor(n/60);if(a<60)return`${a}ë¶„ ì „`;const i=Math.floor(a/60);if(i<24)return`${i}ì‹œê°„ ì „`;const l=Math.floor(i/24);if(l<30)return`${l}ì¼ ì „`;const d=Math.floor(l/30);return d<12?`${d}ê°œì›” ì „`:`${Math.floor(d/12)}ë…„ ì „`}catch(t){return"í™•ì¸ ì•ˆë¨"}}function lp(s){if(!s)return{full:"-",short:"-"};try{const t=new Date(s);if(isNaN(t.getTime()))return{full:"-",short:"-"};const r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return{full:`${r}-${n}-${a} ${i}:${l}`,short:`${n}.${a} ${i}:${l}`}}catch(t){return{full:"-",short:"-"}}}function y0(s){if(!s)return"-";try{const t=new Date(s);return isNaN(t.getTime())?s:t.toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})}catch(t){return s}}const{Text:Lo}=we,gd=({state:s,label:t})=>{const r=!s||s==="null"||s==="idle",n=()=>r?"default":s==="analyzing"?"processing":s==="completed"?"success":s==="failed"?"error":"default";return e.jsx(T,{color:n(),className:s==="analyzing"?"ant-tag-processing":"",style:{fontSize:11,fontWeight:600,borderRadius:6,padding:"4px 10px",marginTop:6,border:r?"1.5px dashed #bfbfbf":"none",boxShadow:r?"0 1px 3px rgba(0, 0, 0, 0.08)":"0 2px 6px rgba(0, 0, 0, 0.1)",opacity:r?.85:1,backgroundColor:r?"#f5f5f5":void 0,color:r?"#8c8c8c":void 0},children:t})},cp=(s,t,r)=>{var n,a;if(s==="source"&&t)return lp(t).short;if((s==="build"||s==="deploy")&&r){const i=(n=r.completed_at)!=null&&n.Valid?r.completed_at.String:(a=r.started_at)!=null&&a.Valid?r.started_at.String:null;return i?lp(i).short:null}return null},j0=["source","build","deploy","operate"],b0={source:"ì†ŒìŠ¤",build:"ë¹Œë“œ",deploy:"ë°°í¬",operate:"ìš´ì˜"},Ml={success:"#52c41a",running:"#1890ff",failed:"#ff4d4f",pending:"#d9d9d9",inactive:"#d9d9d9"},ho=s=>{if(!s)return"inactive";const t=s.toLowerCase();return t==="success"||t==="succeeded"||t==="successed"||t==="completed"||t==="done"?"success":t==="running"||t==="in_progress"||t==="processing"||t==="progress"?"running":t==="failed"||t==="error"||t==="cancelled"||t==="canceled"?"failed":t==="pending"||t==="queued"||t==="waiting"?"pending":"inactive"},_0=s=>{if(!s)return{percent:0,progressStatus:"normal"};let t=0;s.progress_percentage.Valid?t=s.progress_percentage.Float64:ho(s.status)==="success"&&(t=100);const r=ho(s.status);return r==="success"?{percent:100,progressStatus:"success"}:r==="failed"?{percent:t,progressStatus:"exception"}:r==="running"?{percent:t,progressStatus:"active"}:{percent:t,progressStatus:"normal"}},w0=({pipelineStatus:s,isLoading:t,onStageClick:r,serviceId:n,sourceTime:a,sastState:i,sastLastUpdate:l,hideSastProgressWhenRunning:d,scaState:c,scaLastUpdate:p,dastState:h,dastLastUpdate:x,disabledStages:_={}})=>{if(t)return e.jsxs("div",{className:"pipeline-loading-container",children:[e.jsx(gt,{size:"small"}),e.jsx(Lo,{type:"secondary",style:{marginLeft:8},children:"íŒŒì´í”„ë¼ì¸ ìƒíƒœ ë¡œë”© ì¤‘..."})]});if(!s)return e.jsx("div",{className:"pipeline-loading-container",children:e.jsx(Lo,{type:"secondary",children:"íŒŒì´í”„ë¼ì¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})});const S=k=>{if(!k)return"";const E=k.toLowerCase().trim();return E==="build"||E==="image build"||E==="docker-build"||E==="docker_build"||E.includes("build")&&!E.includes("rebuild")?"build":E==="deploy"||E==="deployment"||E==="k8s-deploy"||E==="kubernetes"||E==="k8s_deploy"||E==="k8sdeploy"||E.includes("deploy")?"deploy":E==="operate"||E==="operation"||E==="monitor"||E==="monitoring"||E==="ops"||E.includes("operat")?"operate":E},L=k=>{if(!s||!Array.isArray(s))return;const E=S(k),P=s.filter($=>S($.step_name)===E);return P.length===0?void 0:[...P].sort(($,y)=>{const v=ho($.status)==="running",u=ho(y.status)==="running";if(v&&!u)return-1;if(!v&&u)return 1;const m=Z=>Z&&Z.Valid&&Date.parse(Z.String)||0,j=m($.started_at),b=m(y.started_at);if(j!==b)return b-j;const A=m($.completed_at),W=m(y.completed_at);return A!==W?W-A:(y.id||0)-($.id||0)})[0]};return e.jsx("div",{className:"compact-pipeline-container",children:e.jsx("div",{className:"pipeline-flex-row",children:j0.map(k=>{var b,A,W,Z;const E=_[k],P=(E==null?void 0:E.disabled)||!1;E==null||E.reason;let I;if(k==="build"||k==="deploy"||k==="operate"){if(I=L(k),!I&&s){const se=s.find(ce=>S(ce.step_name)===k);se&&(I=se)}if(k==="operate"&&!I){const se=L("deploy");se&&se.status==="success"&&(I={...se,step_name:"operate",status:"success"})}}let{percent:$,progressStatus:y}=_0(I),v=ho(I==null?void 0:I.status);(b=I==null?void 0:I.completed_at)!=null&&b.Valid?new Date(I.completed_at.String).toLocaleTimeString():(A=I==null?void 0:I.started_at)!=null&&A.Valid&&new Date(I.started_at.String).toLocaleTimeString();const u=!!I;P&&!u&&(v="inactive",$=0,y="normal"),(!P||u)&&(k==="source"&&(v="success",$=100,y="success"),k==="build"&&(v==="running"?y="active":v==="success"?($=100,y="success"):v==="failed"?y="exception":(v="inactive",$=0)),k==="deploy"&&(v==="running"?y="active":v==="success"?($=100,y="success"):v==="failed"?y="exception":(v="inactive",$=0)),k==="operate"&&(s.filter(D=>D.step_name==="deploy").some(D=>ho(D.status)==="success")?(v="success",$=100,y="success"):(v="inactive",$=0)));const m=I==null?void 0:I.error_message;m!=null&&m.Valid&&m.String;const j=v==="running"?"running":v==="success"?"completed":v==="failed"?"failed":v==="pending"?"pending":"inactive";return e.jsx("div",{className:`pipeline-stage-col ${j==="completed"?"active":""}`,children:e.jsxs("div",{className:`pipeline-stage-item ${j} ${P&&!u?"pipeline-stage-disabled":""}`,role:"button",tabIndex:0,onClick:()=>{r(k)},onKeyDown:se=>{(se.key==="Enter"||se.key===" ")&&r(k)},style:{cursor:"pointer"},children:[e.jsxs("div",{className:"pipeline-stage-header",children:[e.jsx(Lo,{className:"pipeline-stage-name",style:{fontSize:14,fontWeight:700,color:P&&!u?"#bfbfbf":Ml[v]||"#262626",display:"block",marginBottom:2},children:b0[k]}),cp(k,a,I)&&e.jsx(Lo,{style:{fontSize:11,fontWeight:700,color:P&&!u?"#bfbfbf":Ml[v]||"#262626",display:"block"},children:cp(k,a,I)})]}),e.jsxs("div",{style:{width:"100%",marginBottom:6},children:[e.jsx(qt,{percent:$,size:"small",status:y,showInfo:!0,format:se=>`${se}%`,strokeWidth:6,strokeColor:P&&!u?"#d9d9d9":Ml[v]||"#d9d9d9",style:{marginBottom:4}}),e.jsx(Lo,{className:"pipeline-stage-status",style:{fontSize:11,fontWeight:600,color:Ml[v]||"#8c8c8c",display:"block",marginTop:2},children:v==="success"?"ì™„ë£Œ":v==="running"?"ì§„í–‰ì¤‘":v==="failed"?"ì‹¤íŒ¨":v==="pending"?"ëŒ€ê¸°":"ì¤€ë¹„"})]}),k==="source"&&e.jsx(gd,{state:i,label:"ì½”ë“œë¶„ì„"}),k==="build"&&e.jsxs(e.Fragment,{children:[e.jsx(gd,{state:c,label:"ì´ë¯¸ì§€ë¶„ì„"}),v==="success"&&((W=I==null?void 0:I.details_data)==null?void 0:W.built_images)&&e.jsx("div",{style:{marginTop:6,display:"flex",flexWrap:"wrap",gap:4},children:(()=>{const se=I.details_data.built_images,ce=Math.min(se.length,2);return e.jsxs(e.Fragment,{children:[se.slice(0,ce).map((D,M)=>{var K;return e.jsx(T,{color:"blue",style:{fontSize:10,fontWeight:500,padding:"2px 6px",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:((K=D.split("/").pop())==null?void 0:K.split(":")[0])||D},M)}),se.length>ce&&e.jsxs(T,{color:"blue",style:{fontSize:10,fontWeight:500,padding:"2px 6px"},children:["+",se.length-ce,"ê°œ"]})]})})()}),v==="failed"&&((Z=I==null?void 0:I.details_data)==null?void 0:Z.error_analysis)&&e.jsxs("div",{style:{marginTop:8,padding:"8px 12px",backgroundColor:"#fff2e8",border:"1px solid #ffbb96",borderRadius:6,fontSize:11},children:[e.jsx("div",{style:{fontWeight:600,color:"#d4380d",marginBottom:4},children:I.details_data.error_analysis.title}),e.jsx("div",{style:{color:"#8c8c8c",marginBottom:6},children:I.details_data.error_analysis.description}),I.details_data.error_analysis.error_type==="env_file_missing"&&I.details_data.error_analysis.is_fixable&&e.jsx(B,{size:"small",type:"primary",danger:!0,style:{fontSize:10,height:24},onClick:()=>{},children:".env íŒŒì¼ ìë™ ìƒì„±"})]})]}),k==="operate"&&e.jsx(gd,{state:h,label:"ë„ë©”ì¸ë¶„ì„"})]})},k)})})})},jx=async(s,t)=>{try{const r=await ee.pipeline("getLatestPipelineStepDetails",{service_id:s,step_name:t});if(!r||!r.success)throw new Error((r==null?void 0:r.error)||"íŒŒì´í”„ë¼ì¸ ë¡œê·¸ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data||[]}catch(r){throw O.error(`íŒŒì´í”„ë¼ì¸ ë¡œê·¸ ì¡°íšŒ ì‹¤íŒ¨ (Service: ${s}, Step: ${t}):`,r),r}},bx=async s=>{try{const t=await ee.pipeline("getLatestPipelineStatus",{service_id:s});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"íŒŒì´í”„ë¼ì¸ ìƒíƒœ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data||[]}catch(t){throw O.error(`íŒŒì´í”„ë¼ì¸ ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨ (Service: ${s}):`,t),t}},_x=async(s,t,r,n,a)=>ee.pipeline("pipelineBuildImage",{id:s,hops:t,...r?{infra_id:r}:{},...n&&n.length>0?{selected_services:n}:{},...a!==void 0?{auto_deploy:a}:{}}),wx=async(s,t,r,n)=>ee.pipeline("pipelineApplyK8s",{id:s,hops:t,...r?{selected_image_tag:r}:{},...n?{selected_service_images:n}:{}}),Sx=async s=>{try{const t=await ee.pipeline("getPipelineMetrics",{service_id:s});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"íŒŒì´í”„ë¼ì¸ í†µê³„ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error(`íŒŒì´í”„ë¼ì¸ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨ (Service: ${s}):`,t),t}},Su=async s=>{try{const t=await ee.pipeline("getBuiltImages",{service_id:s});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ë¹Œë“œ ì´ë¯¸ì§€ ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data||[]}catch(t){throw O.error(`ë¹Œë“œ ì´ë¯¸ì§€ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨ (Service: ${s}):`,t),t}},vx=async(s,t)=>{try{const r=await ee.pipeline("getPipelineStepDetail",{service_id:s,step_name:t});if(!r||!r.success)throw new Error((r==null?void 0:r.error)||"íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ ìƒì„¸ ì •ë³´ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data}catch(r){throw O.error(`íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ ìƒì„¸ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨ (Service: ${s}, Step: ${t}):`,r),r}},kx=async s=>{try{const t=await ee.pipeline("getLastSuccessfulDeployment",{service_id:s});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ë§ˆì§€ë§‰ ì„±ê³µí•œ ë°°í¬ ì •ë³´ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error(`ë§ˆì§€ë§‰ ì„±ê³µí•œ ë°°í¬ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨ (Service: ${s}):`,t),t}},Cx=async(s,t,r)=>ee.pipeline("pipelineApplyDockerCompose",{id:s,...r}),Ix=async s=>{try{if(s.length===0)return{};const t=await ee.pipeline("getBatchPipelineStatus",{service_ids:s});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ë°°ì¹˜ íŒŒì´í”„ë¼ì¸ ìƒíƒœ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data||{}}catch(t){throw O.error(`ë°°ì¹˜ íŒŒì´í”„ë¼ì¸ ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨ (Services: ${s.join(", ")}):`,t),t}},Tx=async s=>{try{if(s.length===0)return{};const t=await ee.pipeline("getBatchBuildStatistics",{service_ids:s});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ë°°ì¹˜ ë¹Œë“œ í†µê³„ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data||{}}catch(t){throw O.error(`ë°°ì¹˜ ë¹Œë“œ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨ (Services: ${s.join(", ")}):`,t),t}},Bi={getLatestStepDetails:jx,getLatestPipelineStatus:bx,getBatchPipelineStatus:Ix,getBatchBuildStatistics:Tx,getPipelineStepDetail:vx,getLastSuccessfulDeployment:kx,buildImage:_x,applyKubernetes:wx,getPipelineMetrics:Sx,getBuiltImages:Su,triggerPipeline:Cx},S0=Object.freeze(Object.defineProperty({__proto__:null,applyKubernetes:wx,buildImage:_x,getBatchBuildStatistics:Tx,getBatchPipelineStatus:Ix,getBuiltImages:Su,getLastSuccessfulDeployment:kx,getLatestPipelineStatus:bx,getLatestStepDetails:jx,getPipelineMetrics:Sx,getPipelineStepDetail:vx,pipelineApi:Bi,triggerPipeline:Cx},Symbol.toStringTag,{value:"Module"})),v0=async(s,t)=>{try{const r=await ee.git("getRepositoryStatistics",{repo_id:s,token:t});if(!r||!r.success)throw new Error((r==null?void 0:r.error)||"ì €ì¥ì†Œ í†µê³„ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data}catch(r){throw O.error(`ì €ì¥ì†Œ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨ (RepoID: ${s}):`,r),r}},k0=async s=>{try{const t=await ee.git("getRepositoryLanguages",{repo_id:s});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ì €ì¥ì†Œ ì–¸ì–´ í†µê³„ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error(`ì €ì¥ì†Œ ì–¸ì–´ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨ (RepoID: ${s}):`,t),t}},C0=async(s,t=5)=>{try{const r=await ee.git("getRepositoryContributors",{repo_id:s,limit:t});if(!r||!r.success)throw new Error((r==null?void 0:r.error)||"ì €ì¥ì†Œ ê¸°ì—¬ì ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data}catch(r){throw O.error(`ì €ì¥ì†Œ ê¸°ì—¬ì ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨ (RepoID: ${s}):`,r),r}},vu=async(s,t)=>{try{const r=await ee.git("getBranches",{repo_id:s,token:t});if(!r||!r.success)throw new Error((r==null?void 0:r.error)||"ë¸Œëœì¹˜ ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data}catch(r){throw O.error(`ë¸Œëœì¹˜ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨ (RepoID: ${s}):`,r),r}},I0={getRepositoryStatistics:v0,getRepositoryLanguages:k0,getRepositoryContributors:C0,getRepositoryBranches:vu},{Text:T0}=we,{confirm:R0}=rt,z0=({visible:s,onClose:t,onSelect:r,title:n="ì¸í”„ë¼ ì„ íƒ",currentInfraName:a})=>{const[i,l]=o.useState(!1),[d,c]=o.useState([]),[p,h]=o.useState(null),x=al(),{user:_}=Tn(),S=o.useCallback(async()=>{if(s){l(!0),h(null);try{const P=await yu.getInfrasByUserId(_.id);if(P.success&&Array.isArray(P.data)){const I=P.data.filter($=>["docker","podman","kubernetes"].includes($.type.toLowerCase()));c(I)}else window.alert(`ì„œë¹„ìŠ¤ ì¸í”„ë¼ê°€ ë“±ë¡ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.
[ì¸í”„ë¼ ì„œë¹„ìŠ¤ ì„¤ì •]ì—ì„œ ì¸í”„ë¼ë¥¼ ë¨¼ì € ë“±ë¡í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.`)}catch(P){const I=P instanceof Error?P.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";h(I)}finally{l(!1)}}},[s]);o.useEffect(()=>{S()},[S]);const L=P=>{const I=a?`í˜„ì¬ ì„œë¹„ìŠ¤ì˜ ì¸í”„ë¼ë¥¼ "${a}"ì—ì„œ "${P.name}"ìœ¼ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?

ì´ ì‘ì—…ì€ ì„œë¹„ìŠ¤ì˜ ë°°í¬ ëŒ€ìƒ ì¸í”„ë¼ë¥¼ ë³€ê²½í•©ë‹ˆë‹¤.`:`ì´ ì„œë¹„ìŠ¤ì˜ ì¸í”„ë¼ë¥¼ "${P.name}"ìœ¼ë¡œ ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;R0({title:"ì¸í”„ë¼ ë³€ê²½ í™•ì¸",icon:e.jsx(Tr,{}),content:I,okText:"ë³€ê²½",cancelText:"ì·¨ì†Œ",onOk:()=>{r(P.id,P.name),t()}})},k=()=>{x("/runtimes"),t()},E=()=>i?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px"},children:"ì¸í”„ë¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."})]}):p?e.jsx(el,{status:"error",title:"ì˜¤ë¥˜ ë°œìƒ",subTitle:p}):d.length===0?e.jsx(el,{icon:e.jsx(mc,{}),title:"ì‚¬ìš© ê°€ëŠ¥í•œ ì¸í”„ë¼ê°€ ì—†ìŠµë‹ˆë‹¤.",subTitle:"ë¨¼ì € ì¸í”„ë¼ ì„œë¹„ìŠ¤ ì„¤ì • í˜ì´ì§€ì—ì„œ ì‚¬ìš©í•  ì¸í”„ë¼(Kubernetes, Docker ë“±)ë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”.",extra:e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:k,children:"ì¸í”„ë¼ ìƒì„± í˜ì´ì§€ë¡œ ì´ë™"})}):e.jsx(ar,{itemLayout:"horizontal",dataSource:d,renderItem:P=>e.jsx(ar.Item,{actions:[e.jsx(B,{type:"primary",onClick:()=>L(P),children:"ì„ íƒ"},`select-infra-${P.id}`)],children:e.jsx(ar.Item.Meta,{title:e.jsx(T0,{strong:!0,children:P.name}),description:`íƒ€ì…: ${P.type.charAt(0).toUpperCase()+P.type.slice(1)} | ìƒì„±ì¼: ${new Date(P.created_at).toLocaleDateString()}`})}),style:{maxHeight:"60vh",overflowY:"auto"}});return e.jsx(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(_t,{style:{color:"#1890ff",fontSize:"18px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:n})]}),open:s,onCancel:t,footer:[e.jsx(B,{onClick:t,children:"ì·¨ì†Œ"},"close")],width:800,destroyOnClose:!0,children:e.jsx(ie,{variant:"borderless",children:E()})})},E0=({open:s,repo:t,onClose:r})=>{const[n,a]=o.useState([]),[i,l]=o.useState(!1),[d,c]=o.useState(""),[p,h]=o.useState(!1),[x,_]=o.useState(""),[S,L]=o.useState(!1),[k,E]=o.useState(null),[P,I]=o.useState(!1),$=o.useCallback(async()=>{if(t){l(!0);try{const b=await Xt.getRepoMembers(t.id);b.data&&Array.isArray(b.data)?a(b.data):a([])}catch(b){f.error("ê¶Œí•œì ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."+b)}finally{l(!1)}}},[t]);o.useEffect(()=>{s&&t?$():(c(""),_(""),_(""),h(!1))},[s,t,$]);const y=async()=>{if(!t||!d||!x){f.warning("ì¶”ê°€í•  ì‚¬ìš©ìì˜ ì´ë©”ì¼ê³¼ ê´€ë¦¬ì í† í°ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}h(!0);try{await Xt.validateAdminToken(x,t.gitlabUrl),await Xt.addRepoMember(t.id,d,x),f.success(`'${d}' ì‚¬ìš©ìë¥¼ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.`),c(""),_(""),await $()}catch(b){f.error("ê¶Œí•œì ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."+b)}finally{h(!1)}},v=async b=>{if(t)try{await Xt.removeRepoMember(t.id,b,x),f.success("ê¶Œí•œìë¥¼ ì‚­ì œí–ˆìŠµë‹ˆë‹¤."),await $()}catch(A){f.error("ê¶Œí•œì ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."+A)}},u=b=>{E(b),L(!0)},m=()=>{L(!1),E(null),_(""),I(!1)},j=async()=>{if(!t||!k||!x){f.warning("ê´€ë¦¬ì í† í°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}I(!0);try{await Xt.validateAdminToken(x,t.gitlabUrl),v(k.email),m(),await $()}catch(b){f.error("ê¶Œí•œì ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."+b),I(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"8px 0"},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"linear-gradient(135deg, #faad14 0%, #d48806 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(250, 173, 20, 0.3)"},children:e.jsx(du,{style:{color:"#fff",fontSize:18}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#262626",lineHeight:1.2},children:"ê¶Œí•œì ê´€ë¦¬"}),e.jsx("div",{style:{fontSize:12,color:"#8c8c8c",marginTop:2},children:t?t.name:"ì„œë¹„ìŠ¤ ê¶Œí•œì„ ê´€ë¦¬í•©ë‹ˆë‹¤"})]})]}),open:s,onCancel:r,footer:e.jsx(B,{onClick:r,size:"large",style:{height:44,fontSize:15,fontWeight:600,borderRadius:8,minWidth:120},children:"ë‹«ê¸°"}),width:700,style:{top:40},bodyStyle:{padding:"24px"},children:[e.jsxs("div",{style:{padding:20,background:"linear-gradient(135deg, #fff7e6 0%, #fffbe6 100%)",borderRadius:12,border:"2px solid #ffe58f",marginBottom:24},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16,paddingBottom:12,borderBottom:"1px solid #ffe58f"},children:[e.jsx(rr,{style:{color:"#faad14",fontSize:16}}),e.jsx("span",{style:{fontWeight:600,color:"#d48806",fontSize:15},children:"ìƒˆ ê¶Œí•œì ì¶”ê°€"})]}),e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:12,children:[e.jsx(ue,{prefix:e.jsx(cu,{style:{color:"#8c8c8c"}}),placeholder:"ì¶”ê°€í•  ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥",value:d,onChange:b=>c(b.target.value),onPressEnter:y,size:"large",style:{borderRadius:8,fontSize:14}}),e.jsx(ue.Password,{prefix:e.jsx(za,{style:{color:"#8c8c8c"}}),placeholder:"ìš”ì²­ì„ ë³´ë‚´ëŠ” ê´€ë¦¬ì ë³¸ì¸ì˜ í† í° ì…ë ¥",value:x,onChange:b=>_(b.target.value),onPressEnter:y,size:"large",style:{borderRadius:8,fontSize:14},addonAfter:e.jsx(Ie,{title:"í† í° ë°œê¸‰ ë°©ë²•ì€ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.",children:e.jsx(xc,{style:{cursor:"help",color:"#8c8c8c"}})})}),e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:y,loading:p,block:!0,size:"large",style:{height:44,fontSize:15,fontWeight:600,borderRadius:8,background:"linear-gradient(135deg, #faad14 0%, #d48806 100%)",border:"none",boxShadow:"0 4px 12px rgba(250, 173, 20, 0.3)"},children:"ì¶”ê°€ ë° ì´ˆëŒ€"})]})]}),i?e.jsx("div",{style:{textAlign:"center",padding:"30px"},children:e.jsx(gt,{})}):e.jsxs("div",{style:{border:"2px solid #e8e8e8",borderRadius:12,padding:20,background:"#fafafa"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16,paddingBottom:12,borderBottom:"2px solid #e8e8e8"},children:[e.jsx(Un,{style:{color:"#1890ff",fontSize:16}}),e.jsx(we.Text,{style:{color:"#262626",fontSize:15,fontWeight:600},children:"í˜„ì¬ ê¶Œí•œì ëª©ë¡"}),e.jsxs(T,{color:"blue",style:{marginLeft:"auto"},children:[n.length,"ëª…"]})]}),n.length>0?e.jsx(ar,{itemLayout:"horizontal",dataSource:n,renderItem:b=>e.jsx(ar.Item,{actions:b.role!=="admin"?[e.jsx(B,{type:"text",danger:!0,icon:e.jsx(gs,{}),onClick:()=>u(b)},`remove-${b.userId}`)]:[],children:e.jsx(ar.Item.Meta,{avatar:e.jsx(Vp,{icon:e.jsx(Un,{})}),title:e.jsx(we.Text,{children:b.email}),description:b.role==="admin"?e.jsx(T,{color:"purple",children:"ê´€ë¦¬ì"}):e.jsx(T,{color:"geekblue",children:"ê¶Œí•œì"})})})}):e.jsx(Je,{description:"ë“±ë¡ëœ ê¶Œí•œìê°€ ì—†ìŠµë‹ˆë‹¤."})]})]}),e.jsxs(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"8px 0"},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"linear-gradient(135deg, #ff4d4f 0%, #cf1322 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(255, 77, 79, 0.3)"},children:e.jsx(gs,{style:{color:"#fff",fontSize:18}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#262626",lineHeight:1.2},children:"ê¶Œí•œì ì‚­ì œ í™•ì¸"}),e.jsx("div",{style:{fontSize:12,color:"#8c8c8c",marginTop:2},children:"ê¶Œí•œìë¥¼ ì œê±°í•˜ë ¤ë©´ ê´€ë¦¬ì í† í°ì´ í•„ìš”í•©ë‹ˆë‹¤"})]})]}),open:S,onOk:j,onCancel:m,confirmLoading:P,okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0,size:"large",style:{height:44,fontSize:15,fontWeight:600,borderRadius:8,boxShadow:"0 2px 8px rgba(255, 77, 79, 0.3)"}},cancelButtonProps:{size:"large",style:{height:44,fontSize:15,fontWeight:600,borderRadius:8}},width:500,style:{top:40},bodyStyle:{padding:"24px"},children:[e.jsx("div",{style:{padding:16,background:"#fff2f0",borderRadius:8,border:"1px solid #ffccc7",marginBottom:20},children:e.jsxs(we.Text,{style:{fontSize:14,color:"#cf1322",fontWeight:500},children:[e.jsx(gs,{style:{marginRight:8}}),k==null?void 0:k.email," ì‚¬ìš©ìì˜ ê¶Œí•œì„ ì‚­ì œí•˜ë ¤ë©´, ê´€ë¦¬ì ë³¸ì¸ì˜ í† í°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."]})}),e.jsx(ue.Password,{prefix:e.jsx(za,{style:{color:"#8c8c8c"}}),placeholder:"ìš”ì²­ì„ ë³´ë‚´ëŠ” ê´€ë¦¬ì ë³¸ì¸ì˜ í† í°",value:x,onChange:b=>_(b.target.value),onPressEnter:j,size:"large",style:{borderRadius:8,fontSize:14}})]})]})};function dp(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=Array(t);r<t;r++)n[r]=s[r];return n}function P0(s){if(Array.isArray(s))return s}function M0(s,t,r){return(t=D0(t))in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function L0(s,t){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,l,d=[],c=!0,p=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(d.push(n.value),d.length!==t);c=!0);}catch(h){p=!0,a=h}finally{try{if(!c&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(p)throw a}}return d}}function A0(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function up(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function hp(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?up(Object(r),!0).forEach(function(n){M0(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):up(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function N0(s,t){if(s==null)return{};var r,n,a=B0(s,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(s,r)&&(a[r]=s[r])}return a}function B0(s,t){if(s==null)return{};var r={};for(var n in s)if({}.hasOwnProperty.call(s,n)){if(t.indexOf(n)!==-1)continue;r[n]=s[n]}return r}function $0(s,t){return P0(s)||L0(s,t)||F0(s,t)||A0()}function O0(s,t){if(typeof s!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function D0(s){var t=O0(s,"string");return typeof t=="symbol"?t:t+""}function F0(s,t){if(s){if(typeof s=="string")return dp(s,t);var r={}.toString.call(s).slice(8,-1);return r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set"?Array.from(s):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dp(s,t):void 0}}function U0(s,t,r){return t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function pp(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function gp(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pp(Object(r),!0).forEach(function(n){U0(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):pp(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function H0(){for(var s=arguments.length,t=new Array(s),r=0;r<s;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(a,i){return i(a)},n)}}function Go(s){return function t(){for(var r=this,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return a.length>=s.length?s.apply(this,a):function(){for(var l=arguments.length,d=new Array(l),c=0;c<l;c++)d[c]=arguments[c];return t.apply(r,[].concat(a,d))}}}function hc(s){return{}.toString.call(s).includes("Object")}function V0(s){return!Object.keys(s).length}function rl(s){return typeof s=="function"}function q0(s,t){return Object.prototype.hasOwnProperty.call(s,t)}function G0(s,t){return hc(t)||wi("changeType"),Object.keys(t).some(function(r){return!q0(s,r)})&&wi("changeField"),t}function W0(s){rl(s)||wi("selectorType")}function K0(s){rl(s)||hc(s)||wi("handlerType"),hc(s)&&Object.values(s).some(function(t){return!rl(t)})&&wi("handlersType")}function Y0(s){s||wi("initialIsRequired"),hc(s)||wi("initialType"),V0(s)&&wi("initialContent")}function J0(s,t){throw new Error(s[t]||s.default)}var Z0={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},wi=Go(J0)(Z0),Ll={changes:G0,selector:W0,handler:K0,initial:Y0};function Q0(s){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ll.initial(s),Ll.handler(t);var r={current:s},n=Go(t_)(r,t),a=Go(e_)(r),i=Go(Ll.changes)(s),l=Go(X0)(r);function d(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(h){return h};return Ll.selector(p),p(r.current)}function c(p){H0(n,a,i,l)(p)}return[d,c]}function X0(s,t){return rl(t)?t(s.current):t}function e_(s,t){return s.current=gp(gp({},s.current),t),t}function t_(s,t,r){return rl(t)?t(s.current):Object.keys(r).forEach(function(n){var a;return(a=t[n])===null||a===void 0?void 0:a.call(t,s.current[n])}),r}var s_={create:Q0},r_={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.54.0/min/vs"}};function n_(s){return function t(){for(var r=this,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return a.length>=s.length?s.apply(this,a):function(){for(var l=arguments.length,d=new Array(l),c=0;c<l;c++)d[c]=arguments[c];return t.apply(r,[].concat(a,d))}}}function a_(s){return{}.toString.call(s).includes("Object")}function i_(s){return s||xp("configIsRequired"),a_(s)||xp("configType"),s.urls?(o_(),{paths:{vs:s.urls.monacoBase}}):s}function o_(){console.warn(Rx.deprecation)}function l_(s,t){throw new Error(s[t]||s.default)}var Rx={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},xp=n_(l_)(Rx),c_={config:i_},d_=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(a){return r.reduceRight(function(i,l){return l(i)},a)}};function zx(s,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&s[r]&&Object.assign(t[r],zx(s[r],t[r]))}),hp(hp({},s),t)}var u_={type:"cancelation",msg:"operation is manually canceled"};function xd(s){var t=!1,r=new Promise(function(n,a){s.then(function(i){return t?a(u_):n(i)}),s.catch(a)});return r.cancel=function(){return t=!0},r}var h_=["monaco"],p_=s_.create({config:r_,isInitialized:!1,resolve:null,reject:null,monaco:null}),Ex=$0(p_,2),ll=Ex[0],Cc=Ex[1];function g_(s){var t=c_.config(s),r=t.monaco,n=N0(t,h_);Cc(function(a){return{config:zx(a.config,n),monaco:r}})}function x_(){var s=ll(function(t){var r=t.monaco,n=t.isInitialized,a=t.resolve;return{monaco:r,isInitialized:n,resolve:a}});if(!s.isInitialized){if(Cc({isInitialized:!0}),s.monaco)return s.resolve(s.monaco),xd(md);if(window.monaco&&window.monaco.editor)return Px(window.monaco),s.resolve(window.monaco),xd(md);d_(m_,y_)(j_)}return xd(md)}function m_(s){return document.body.appendChild(s)}function f_(s){var t=document.createElement("script");return s&&(t.src=s),t}function y_(s){var t=ll(function(n){var a=n.config,i=n.reject;return{config:a,reject:i}}),r=f_("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return s()},r.onerror=t.reject,r}function j_(){var s=ll(function(r){var n=r.config,a=r.resolve,i=r.reject;return{config:n,resolve:a,reject:i}}),t=window.require;t.config(s.config),t(["vs/editor/editor.main"],function(r){var n=r.m;Px(n),s.resolve(n)},function(r){s.reject(r)})}function Px(s){ll().monaco||Cc({monaco:s})}function b_(){return ll(function(s){var t=s.monaco;return t})}var md=new Promise(function(s,t){return Cc({resolve:s,reject:t})}),Mx={config:g_,init:x_,__getMonacoInstance:b_},__={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},fd=__,w_={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},S_=w_;function v_({children:s}){return Ct.createElement("div",{style:S_.container},s)}var k_=v_,C_=k_;function I_({width:s,height:t,isEditorReady:r,loading:n,_ref:a,className:i,wrapperProps:l}){return Ct.createElement("section",{style:{...fd.wrapper,width:s,height:t},...l},!r&&Ct.createElement(C_,null,n),Ct.createElement("div",{ref:a,style:{...fd.fullWidth,...!r&&fd.hide},className:i}))}var T_=I_,Lx=o.memo(T_);function R_(s){o.useEffect(s,[])}var Ax=R_;function z_(s,t,r=!0){let n=o.useRef(!0);o.useEffect(n.current||!r?()=>{n.current=!1}:s,t)}var sa=z_;function Xo(){}function po(s,t,r,n){return E_(s,n)||P_(s,t,r,n)}function E_(s,t){return s.editor.getModel(Nx(s,t))}function P_(s,t,r,n){return s.editor.createModel(t,r,n?Nx(s,n):void 0)}function Nx(s,t){return s.Uri.parse(t)}function M_({original:s,modified:t,language:r,originalLanguage:n,modifiedLanguage:a,originalModelPath:i,modifiedModelPath:l,keepCurrentOriginalModel:d=!1,keepCurrentModifiedModel:c=!1,theme:p="light",loading:h="Loading...",options:x={},height:_="100%",width:S="100%",className:L,wrapperProps:k={},beforeMount:E=Xo,onMount:P=Xo}){let[I,$]=o.useState(!1),[y,v]=o.useState(!0),u=o.useRef(null),m=o.useRef(null),j=o.useRef(null),b=o.useRef(P),A=o.useRef(E),W=o.useRef(!1);Ax(()=>{let D=Mx.init();return D.then(M=>(m.current=M)&&v(!1)).catch(M=>(M==null?void 0:M.type)!=="cancelation"&&console.error("Monaco initialization: error:",M)),()=>u.current?ce():D.cancel()}),sa(()=>{if(u.current&&m.current){let D=u.current.getOriginalEditor(),M=po(m.current,s||"",n||r||"text",i||"");M!==D.getModel()&&D.setModel(M)}},[i],I),sa(()=>{if(u.current&&m.current){let D=u.current.getModifiedEditor(),M=po(m.current,t||"",a||r||"text",l||"");M!==D.getModel()&&D.setModel(M)}},[l],I),sa(()=>{let D=u.current.getModifiedEditor();D.getOption(m.current.editor.EditorOption.readOnly)?D.setValue(t||""):t!==D.getValue()&&(D.executeEdits("",[{range:D.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),D.pushUndoStop())},[t],I),sa(()=>{var D,M;(M=(D=u.current)==null?void 0:D.getModel())==null||M.original.setValue(s||"")},[s],I),sa(()=>{let{original:D,modified:M}=u.current.getModel();m.current.editor.setModelLanguage(D,n||r||"text"),m.current.editor.setModelLanguage(M,a||r||"text")},[r,n,a],I),sa(()=>{var D;(D=m.current)==null||D.editor.setTheme(p)},[p],I),sa(()=>{var D;(D=u.current)==null||D.updateOptions(x)},[x],I);let Z=o.useCallback(()=>{var K;if(!m.current)return;A.current(m.current);let D=po(m.current,s||"",n||r||"text",i||""),M=po(m.current,t||"",a||r||"text",l||"");(K=u.current)==null||K.setModel({original:D,modified:M})},[r,t,a,s,n,i,l]),se=o.useCallback(()=>{var D;!W.current&&j.current&&(u.current=m.current.editor.createDiffEditor(j.current,{automaticLayout:!0,...x}),Z(),(D=m.current)==null||D.editor.setTheme(p),$(!0),W.current=!0)},[x,p,Z]);o.useEffect(()=>{I&&b.current(u.current,m.current)},[I]),o.useEffect(()=>{!y&&!I&&se()},[y,I,se]);function ce(){var M,K,J,te;let D=(M=u.current)==null?void 0:M.getModel();d||((K=D==null?void 0:D.original)==null||K.dispose()),c||((J=D==null?void 0:D.modified)==null||J.dispose()),(te=u.current)==null||te.dispose()}return Ct.createElement(Lx,{width:S,height:_,isEditorReady:I,loading:h,_ref:j,className:L,wrapperProps:k})}var L_=M_;o.memo(L_);function A_(s){let t=o.useRef();return o.useEffect(()=>{t.current=s},[s]),t.current}var N_=A_,Al=new Map;function B_({defaultValue:s,defaultLanguage:t,defaultPath:r,value:n,language:a,path:i,theme:l="light",line:d,loading:c="Loading...",options:p={},overrideServices:h={},saveViewState:x=!0,keepCurrentModel:_=!1,width:S="100%",height:L="100%",className:k,wrapperProps:E={},beforeMount:P=Xo,onMount:I=Xo,onChange:$,onValidate:y=Xo}){let[v,u]=o.useState(!1),[m,j]=o.useState(!0),b=o.useRef(null),A=o.useRef(null),W=o.useRef(null),Z=o.useRef(I),se=o.useRef(P),ce=o.useRef(),D=o.useRef(n),M=N_(i),K=o.useRef(!1),J=o.useRef(!1);Ax(()=>{let q=Mx.init();return q.then(oe=>(b.current=oe)&&j(!1)).catch(oe=>(oe==null?void 0:oe.type)!=="cancelation"&&console.error("Monaco initialization: error:",oe)),()=>A.current?G():q.cancel()}),sa(()=>{var oe,be,ne,ye;let q=po(b.current,s||n||"",t||a||"",i||r||"");q!==((oe=A.current)==null?void 0:oe.getModel())&&(x&&Al.set(M,(be=A.current)==null?void 0:be.saveViewState()),(ne=A.current)==null||ne.setModel(q),x&&((ye=A.current)==null||ye.restoreViewState(Al.get(i))))},[i],v),sa(()=>{var q;(q=A.current)==null||q.updateOptions(p)},[p],v),sa(()=>{!A.current||n===void 0||(A.current.getOption(b.current.editor.EditorOption.readOnly)?A.current.setValue(n):n!==A.current.getValue()&&(J.current=!0,A.current.executeEdits("",[{range:A.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),A.current.pushUndoStop(),J.current=!1))},[n],v),sa(()=>{var oe,be;let q=(oe=A.current)==null?void 0:oe.getModel();q&&a&&((be=b.current)==null||be.editor.setModelLanguage(q,a))},[a],v),sa(()=>{var q;d!==void 0&&((q=A.current)==null||q.revealLine(d))},[d],v),sa(()=>{var q;(q=b.current)==null||q.editor.setTheme(l)},[l],v);let te=o.useCallback(()=>{var q;if(!(!W.current||!b.current)&&!K.current){se.current(b.current);let oe=i||r,be=po(b.current,n||s||"",t||a||"",oe||"");A.current=(q=b.current)==null?void 0:q.editor.create(W.current,{model:be,automaticLayout:!0,...p},h),x&&A.current.restoreViewState(Al.get(oe)),b.current.editor.setTheme(l),d!==void 0&&A.current.revealLine(d),u(!0),K.current=!0}},[s,t,r,n,a,i,p,h,x,l,d]);o.useEffect(()=>{v&&Z.current(A.current,b.current)},[v]),o.useEffect(()=>{!m&&!v&&te()},[m,v,te]),D.current=n,o.useEffect(()=>{var q,oe;v&&$&&((q=ce.current)==null||q.dispose(),ce.current=(oe=A.current)==null?void 0:oe.onDidChangeModelContent(be=>{J.current||$(A.current.getValue(),be)}))},[v,$]),o.useEffect(()=>{if(v){let q=b.current.editor.onDidChangeMarkers(oe=>{var ne;let be=(ne=A.current.getModel())==null?void 0:ne.uri;if(be&&oe.find(ye=>ye.path===be.path)){let ye=b.current.editor.getModelMarkers({resource:be});y==null||y(ye)}});return()=>{q==null||q.dispose()}}return()=>{}},[v,y]);function G(){var q,oe;(q=ce.current)==null||q.dispose(),_?x&&Al.set(i,A.current.saveViewState()):(oe=A.current.getModel())==null||oe.dispose(),A.current.dispose()}return Ct.createElement(Lx,{width:S,height:L,isEditorReady:v,loading:c,_ref:W,className:k,wrapperProps:E})}var $_=B_,O_=o.memo($_),Nl=O_;const{Step:yd}=So,{Title:jd,Text:fr,Paragraph:bd}=we,{Option:Wn}=Ee;function D_({gitUrl:s,branch:t="main",serviceName:r="app",onSuccess:n}){const[a,i]=o.useState(0),[l,d]=o.useState(!1),[c]=H.useForm(),[p,h]=o.useState(""),[x,_]=o.useState(""),[S,L]=o.useState(""),[k,E]=o.useState(""),[P,I]=o.useState(!1),[$,y]=o.useState([]),[v,u]=o.useState({dockerfile:!1,dockerCompose:!1}),[m,j]=o.useState({enableHealthcheck:!0,nonRootUser:!0}),[b,A]=o.useState([]),[W,Z]=o.useState(!1),[se,ce]=o.useState([]),[D,M]=o.useState(""),[K,J]=o.useState(""),[te,G]=o.useState({}),q=o.useCallback(async()=>{try{const w=await Ni.getLanguageConfigs();w.success&&w.data&&G(w.data)}catch(w){console.error("ì–¸ì–´ ì„¤ì • ë¡œë“œ ì‹¤íŒ¨:",w)}},[]);o.useEffect(()=>{q()},[q]);const oe=w=>{const R=te[w];return{version:(R==null?void 0:R.default_version)||"",base_os:(R==null?void 0:R.default_os)||""}},be=async()=>{d(!0);try{const w=await Ni.detectProjectType({git_url:s,branch:t});if(w.success&&w.data){const R=w.data;if(h(R.detected_type),_(R.framework||""),L(R.package_manager||""),E(R.build_type||""),I(R.has_typescript||!1),u({dockerfile:R.has_dockerfile,dockerCompose:R.has_docker_compose}),R.sub_projects&&R.sub_projects.length>0){Z(!0),y(R.sub_projects);const U=R.sub_projects.map(V=>{const F=oe(V.type);return{path:V.path,name:V.path,type:V.type,selected:!0,port:ne(V.type),version:F.version,base_os:F.base_os,framework:V.framework||"",package_manager:V.package_manager||"",enable_healthcheck:!0,non_root_user:!0}});A(U)}else{Z(!1);const U=oe(R.detected_type),V=op[R.framework],F=(V==null?void 0:V.default_port)||ne(R.detected_type);c.setFieldsValue({project_type:R.detected_type,service_name:r,version:U.version,base_os:U.base_os,framework:R.framework||"",package_manager:R.package_manager||"",build_type:R.build_type||"",port:F})}f.success("í”„ë¡œì íŠ¸ ë¶„ì„ ì™„ë£Œ!"),i(1)}}catch(w){const R=w instanceof Error?w.message:"í”„ë¡œì íŠ¸ íƒ€ì… ê°ì§€ ì‹¤íŒ¨";f.error(R)}finally{d(!1)}},ne=w=>({nodejs:3e3,python:8e3,go:8080,java:8080,ruby:3e3,php:80,rust:8080,dotnet:8080,static:80})[w]||8080,ye=async()=>{d(!0);try{if(W){const w=b.filter(U=>U.selected);if(w.length===0){f.warning("ìµœì†Œ 1ê°œ ì´ìƒì˜ ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),d(!1);return}const R=await Ni.generateBuildFiles({services:w.map(U=>({path:U.path,name:U.name,type:U.type,port:U.port,version:U.version,base_os:U.base_os,framework:U.framework,package_manager:U.package_manager,enable_healthcheck:U.enable_healthcheck,non_root_user:U.non_root_user}))});if(R.success&&R.data){const U=R.data;ce(U.files||[]),M(U.docker_compose),f.success(`${w.length}ê°œ ì„œë¹„ìŠ¤ì˜ ë¹Œë“œ íŒŒì¼ ìƒì„± ì™„ë£Œ`),i(2)}}else{const w=c.getFieldsValue(),R=await Ni.generateBuildFiles({project_type:w.project_type,service_name:w.service_name,port:w.port,version:w.version,base_os:w.base_os,framework:w.framework||x,package_manager:w.package_manager||S,build_type:w.build_type||k,enable_healthcheck:m.enableHealthcheck,non_root_user:m.nonRootUser});if(R.success&&R.data){const U=R.data;J(U.dockerfile||""),M(U.docker_compose),f.success("ë¹Œë“œ íŒŒì¼ í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ"),i(2)}}}catch(w){const R=w instanceof Error?w.message:"í…œí”Œë¦¿ ìƒì„± ì‹¤íŒ¨";f.error(R)}finally{d(!1)}},Ue=async()=>{d(!0);try{W?(await Ni.commitBuildFiles({git_url:s,branch:t,files:se,docker_compose:D})).success&&(f.success("ë¹Œë“œ í™˜ê²½ íŒŒì¼ì´ GitLabì— ì»¤ë°‹ë˜ì—ˆìŠµë‹ˆë‹¤!"),n==null||n(),N()):(await Ni.commitBuildFiles({git_url:s,branch:t,dockerfile:K,docker_compose:D})).success&&(f.success("ë¹Œë“œ í™˜ê²½ íŒŒì¼ì´ GitLabì— ì»¤ë°‹ë˜ì—ˆìŠµë‹ˆë‹¤!"),n==null||n(),N())}catch(w){const R=w instanceof Error?w.message:"íŒŒì¼ ì»¤ë°‹ ì‹¤íŒ¨";f.error(R)}finally{d(!1)}},N=()=>{i(0),h(""),y([]),A([]),Z(!1),ce([]),M(""),J(""),c.resetFields()},ge=w=>{A(b.map(R=>R.path===w?{...R,selected:!R.selected}:R))},Ce=(w,R,U)=>{A(b.map(V=>V.path===w?{...V,[R]:U}:V))},je=()=>{var w,R;switch(a){case 0:return e.jsxs("div",{style:{padding:"24px 0"},children:[e.jsxs(jd,{level:4,children:[e.jsx(Jn,{})," í”„ë¡œì íŠ¸ ë¶„ì„"]}),e.jsx(bd,{children:"GitLab ì €ì¥ì†Œë¥¼ ë¶„ì„í•˜ì—¬ í”„ë¡œì íŠ¸ êµ¬ì¡°ì™€ íƒ€ì…ì„ ìë™ìœ¼ë¡œ ê°ì§€í•©ë‹ˆë‹¤."}),e.jsx(ie,{style:{marginTop:16},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(fr,{strong:!0,children:"Git URL:"}),e.jsx("div",{style:{padding:"8px 12px",background:"#f5f5f5",borderRadius:4,marginTop:8,fontFamily:"monospace"},children:s})]}),e.jsxs("div",{children:[e.jsx(fr,{strong:!0,children:"Branch:"}),e.jsx("div",{style:{padding:"8px 12px",background:"#f5f5f5",borderRadius:4,marginTop:8,fontFamily:"monospace"},children:t})]})]})}),e.jsx(xe,{message:"ìë™ ê°ì§€ ê¸°ëŠ¥",description:"ëª¨ë…¸ë ˆí¬ êµ¬ì¡°(backend, frontend ë“±)ë¥¼ ìë™ìœ¼ë¡œ ì¸ì‹í•˜ê³  ê° ì„œë¸Œ í”„ë¡œì íŠ¸ë³„ ë¹Œë“œ í™˜ê²½ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginTop:16}})]});case 1:return e.jsxs("div",{style:{padding:"24px 0"},children:[e.jsxs(jd,{level:4,children:[e.jsx(Da,{})," ë¹Œë“œ ì„¤ì •"]}),W?e.jsxs(e.Fragment,{children:[e.jsx(xe,{message:`ëª¨ë…¸ë ˆí¬ ê°ì§€ë¨: ${$.length}ê°œì˜ ì„œë¸Œ í”„ë¡œì íŠ¸ ë°œê²¬`,description:"ë¹Œë“œí•  ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•˜ê³  ê° ì„œë¹„ìŠ¤ì˜ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.",type:"success",showIcon:!0,icon:e.jsx(Wo,{}),style:{marginBottom:16}}),e.jsx(wt,{dataSource:b,rowKey:"path",pagination:!1,size:"small",columns:[{title:"ì„ íƒ",width:60,render:(V,F)=>e.jsx(Vr,{checked:F.selected,onChange:()=>ge(F.path)})},{title:"ê²½ë¡œ",dataIndex:"path",render:V=>e.jsxs(g,{children:[e.jsx(Wo,{}),e.jsx(fr,{code:!0,children:V})]})},{title:"í”„ë¡œì íŠ¸ íƒ€ì…",dataIndex:"type",render:V=>{const F={nodejs:"green",python:"blue",go:"cyan",java:"orange",ruby:"red",php:"purple"};return e.jsx(T,{color:F[V]||"default",children:V.toUpperCase()})}},{title:"ì„œë¹„ìŠ¤ ì´ë¦„",dataIndex:"name",render:(V,F)=>e.jsx(ue,{value:V,size:"small",style:{width:120},onChange:X=>Ce(F.path,"name",X.target.value),disabled:!F.selected})},{title:"í¬íŠ¸",dataIndex:"port",width:80,render:(V,F)=>e.jsx(ue,{type:"number",value:V,size:"small",style:{width:70},onChange:X=>Ce(F.path,"port",parseInt(X.target.value)||8080),disabled:!F.selected})},{title:"ë²„ì „",dataIndex:"version",width:100,render:(V,F)=>{const X=te[F.type];return X?e.jsx(Ee,{value:V||X.default_version,size:"small",style:{width:85},onChange:de=>Ce(F.path,"version",de),disabled:!F.selected,children:X.versions.map(de=>e.jsx(Wn,{value:de,children:de},de))}):e.jsx(fr,{type:"secondary",children:"-"})}},{title:"ë² ì´ìŠ¤ ì´ë¯¸ì§€",dataIndex:"base_os",width:120,render:(V,F)=>{const X=te[F.type];return X?e.jsx(Ee,{value:V||X.default_os,size:"small",style:{width:100},onChange:de=>Ce(F.path,"base_os",de),disabled:!F.selected,children:X.os_options.map(de=>e.jsx(Wn,{value:de,children:de},de))}):e.jsx(fr,{type:"secondary",children:"-"})}},{title:e.jsx(Ie,{title:"ì»¨í…Œì´ë„ˆ ìƒíƒœë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ í™•ì¸",children:e.jsxs(g,{size:4,children:[e.jsx(Wu,{style:{color:"#52c41a"}}),e.jsx("span",{children:"í—¬ìŠ¤ì²´í¬"})]})}),dataIndex:"enable_healthcheck",width:90,render:(V,F)=>e.jsx(Zr,{size:"small",checked:V!==!1,onChange:X=>Ce(F.path,"enable_healthcheck",X),disabled:!F.selected})},{title:e.jsx(Ie,{title:"ë³´ì•ˆì„ ìœ„í•´ ë¹„ë£¨íŠ¸ ì‚¬ìš©ìë¡œ ì‹¤í–‰",children:e.jsxs(g,{size:4,children:[e.jsx(Ku,{style:{color:"#722ed1"}}),e.jsx("span",{children:"ë¹„ë£¨íŠ¸"})]})}),dataIndex:"non_root_user",width:80,render:(V,F)=>e.jsx(Zr,{size:"small",checked:V!==!1,onChange:X=>Ce(F.path,"non_root_user",X),disabled:!F.selected})}],scroll:{x:1e3}}),e.jsxs(bd,{style:{marginTop:16,color:"#888"},children:["ğŸ’¡ ì„ íƒëœ ì„œë¹„ìŠ¤: ",b.filter(V=>V.selected).length,"ê°œ"]})]}):e.jsxs(e.Fragment,{children:[(x||S||k)&&e.jsx(ie,{size:"small",style:{marginBottom:16,background:"#f0f5ff",border:"1px solid #adc6ff"},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs(fr,{strong:!0,style:{color:"#1890ff"},children:[e.jsx(Ks,{})," í”„ë¡œì íŠ¸ ìë™ ê°ì§€ ê²°ê³¼"]}),e.jsxs(Ke,{gutter:[16,8],children:[x&&e.jsx(Y,{children:e.jsxs(g,{size:4,children:[e.jsx(fr,{type:"secondary",children:"í”„ë ˆì„ì›Œí¬:"}),e.jsx(T,{color:"blue",children:((w=op[x])==null?void 0:w.display_name)||x})]})}),S&&e.jsx(Y,{children:e.jsxs(g,{size:4,children:[e.jsx(fr,{type:"secondary",children:"íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €:"}),e.jsx(T,{color:"green",children:S})]})}),k&&e.jsx(Y,{children:e.jsxs(g,{size:4,children:[e.jsx(fr,{type:"secondary",children:"ë¹Œë“œ íƒ€ì…:"}),e.jsx(T,{color:"purple",children:((R=p0[k])==null?void 0:R.label)||k})]})}),P&&e.jsx(Y,{children:e.jsx(T,{color:"cyan",children:"TypeScript"})})]})]})}),v.dockerfile||v.dockerCompose?e.jsx(xe,{message:"ê¸°ì¡´ ë¹Œë“œ íŒŒì¼ ë°œê²¬",description:`ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íŒŒì¼: ${v.dockerfile?"Dockerfile":""} ${v.dockerCompose?"docker-compose.yml":""}. ê³„ì† ì§„í–‰í•˜ë©´ íŒŒì¼ì´ ë®ì–´ì“°ê¸°ë©ë‹ˆë‹¤.`,type:"warning",showIcon:!0,style:{marginBottom:16}}):null,e.jsxs(H,{form:c,layout:"vertical",children:[e.jsx(H.Item,{label:"í”„ë¡œì íŠ¸ íƒ€ì…",name:"project_type",rules:[{required:!0,message:"í”„ë¡œì íŠ¸ íƒ€ì…ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsxs(Ee,{placeholder:"í”„ë¡œì íŠ¸ íƒ€ì… ì„ íƒ",size:"large",onChange:V=>{const F=oe(V);c.setFieldsValue({version:F.version,base_os:F.base_os})},children:[e.jsx(Wn,{value:"nodejs",children:"Node.js"}),e.jsx(Wn,{value:"python",children:"Python"}),e.jsx(Wn,{value:"go",children:"Go"}),e.jsx(Wn,{value:"java",children:"Java"}),e.jsx(Wn,{value:"ruby",children:"Ruby"}),e.jsx(Wn,{value:"php",children:"PHP"}),e.jsx(Wn,{value:"rust",children:"Rust"}),e.jsx(Wn,{value:"dotnet",children:".NET / C#"}),e.jsx(Wn,{value:"static",children:"ì •ì  ì‚¬ì´íŠ¸"}),e.jsx(Wn,{value:"unknown",children:"ê¸°íƒ€"})]})}),e.jsx(H.Item,{noStyle:!0,shouldUpdate:(V,F)=>V.project_type!==F.project_type,children:({getFieldValue:V})=>{const F=V("project_type"),X=te[F];return X?e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{label:e.jsxs(g,{children:[e.jsx(rn,{}),e.jsx("span",{children:"ì–¸ì–´ ë²„ì „"})]}),name:"version",extra:`ê¶Œì¥: ${X.default_version}`,children:e.jsx(Ee,{placeholder:"ë²„ì „ ì„ íƒ",size:"large",children:X.versions.map(de=>e.jsxs(Wn,{value:de,children:[de,de===X.default_version&&e.jsx(T,{color:"blue",style:{marginLeft:8},children:"ê¶Œì¥"})]},de))})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{label:e.jsxs(g,{children:[e.jsx(Dm,{}),e.jsx("span",{children:"ë² ì´ìŠ¤ ì´ë¯¸ì§€"})]}),name:"base_os",extra:`ê¶Œì¥: ${X.default_os}`,children:e.jsx(Ee,{placeholder:"ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì„ íƒ",size:"large",children:X.os_options.map(de=>e.jsxs(Wn,{value:de,children:[de,de===X.default_os&&e.jsx(T,{color:"green",style:{marginLeft:8},children:"ê¶Œì¥"})]},de))})})})]}):null}}),e.jsx(xt,{style:{margin:"16px 0"}}),e.jsx(H.Item,{label:"ì„œë¹„ìŠ¤ ì´ë¦„",name:"service_name",rules:[{required:!0,message:"ì„œë¹„ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],initialValue:r,children:e.jsx(ue,{placeholder:"ì˜ˆ: myapp",size:"large"})}),e.jsx(H.Item,{label:"í¬íŠ¸ ë²ˆí˜¸",name:"port",extra:"ë¹„ì›Œë‘ë©´ í”„ë¡œì íŠ¸ íƒ€ì…ë³„ ê¸°ë³¸ í¬íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤ (Node.js: 3000, Python: 8000, etc)",children:e.jsx(ue,{type:"number",placeholder:"ì˜ˆ: 3000",size:"large"})}),e.jsx(nr,{ghost:!0,style:{marginTop:16},items:[{key:"advanced",label:e.jsxs(g,{children:[e.jsx(Bs,{}),e.jsx(fr,{strong:!0,children:"ê³ ê¸‰ ë¹Œë“œ ì˜µì…˜"})]}),children:e.jsx(ie,{size:"small",style:{background:"#fafafa"},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"middle",children:[e.jsxs(Ke,{align:"middle",justify:"space-between",children:[e.jsx(Y,{children:e.jsxs(g,{children:[e.jsx(Wu,{style:{color:"#52c41a"}}),e.jsx(fr,{children:"í—¬ìŠ¤ì²´í¬ í™œì„±í™”"}),e.jsx(Ie,{title:"ì»¨í…Œì´ë„ˆì˜ ìƒíƒœë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ í™•ì¸í•˜ì—¬ ë¬¸ì œ ë°œìƒ ì‹œ ìë™ ì¬ì‹œì‘í•©ë‹ˆë‹¤",children:e.jsx(Ks,{style:{color:"#1890ff",cursor:"help"}})})]})}),e.jsx(Y,{children:e.jsx(Zr,{checked:m.enableHealthcheck,onChange:V=>j(F=>({...F,enableHealthcheck:V})),checkedChildren:"ON",unCheckedChildren:"OFF"})})]}),e.jsxs(Ke,{align:"middle",justify:"space-between",children:[e.jsx(Y,{children:e.jsxs(g,{children:[e.jsx(Ku,{style:{color:"#722ed1"}}),e.jsx(fr,{children:"ë¹„ë£¨íŠ¸ ì‚¬ìš©ìë¡œ ì‹¤í–‰"}),e.jsx(Ie,{title:"ë³´ì•ˆì„ ìœ„í•´ rootê°€ ì•„ë‹Œ ì¼ë°˜ ì‚¬ìš©ì ê¶Œí•œìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤",children:e.jsx(Ks,{style:{color:"#1890ff",cursor:"help"}})})]})}),e.jsx(Y,{children:e.jsx(Zr,{checked:m.nonRootUser,onChange:V=>j(F=>({...F,nonRootUser:V})),checkedChildren:"ON",unCheckedChildren:"OFF"})})]}),e.jsx(xe,{message:"í”„ë¡œë•ì…˜ ê¶Œì¥ ì„¤ì •",description:"í—¬ìŠ¤ì²´í¬ì™€ ë¹„ë£¨íŠ¸ ì‚¬ìš©ì ì„¤ì •ì€ Kubernetes í™˜ê²½ì—ì„œ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ ìš´ì˜ì„ ìœ„í•´ ê¶Œì¥ë©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginTop:8}})]})})}]})]})]})]});case 2:const U=()=>{var X;const V=c.getFieldsValue(),F=b.filter(de=>de.selected);return e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(Ks,{style:{color:"#1890ff"}}),e.jsx("span",{children:"ë¶„ì„ ì •ë³´ ìš”ì•½"})]}),size:"small",style:{height:"100%"},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"middle",children:[e.jsxs("div",{children:[e.jsx(fr,{type:"secondary",style:{fontSize:12},children:"í”„ë¡œì íŠ¸ êµ¬ì¡°"}),e.jsx("div",{style:{marginTop:4},children:e.jsx(T,{color:W?"purple":"blue",children:W?"ëª¨ë…¸ë ˆí¬":"ë‹¨ì¼ í”„ë¡œì íŠ¸"})})]}),e.jsx(xt,{style:{margin:"8px 0"}}),W?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(fr,{type:"secondary",style:{fontSize:12},children:"ì„ íƒëœ ì„œë¹„ìŠ¤"}),e.jsx("div",{style:{marginTop:8},children:F.map(de=>e.jsxs("div",{style:{padding:"8px 12px",background:"#f5f5f5",borderRadius:4,marginBottom:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(Wo,{style:{color:"#1890ff"}}),e.jsx(fr,{strong:!0,children:de.name}),e.jsx(T,{color:"green",style:{marginLeft:"auto"},children:de.type})]}),e.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:4},children:["ê²½ë¡œ: ",de.path," | í¬íŠ¸: ",de.port]})]},de.path))})]}),e.jsxs("div",{children:[e.jsx(fr,{type:"secondary",style:{fontSize:12},children:"ìƒì„± íŒŒì¼"}),e.jsx("div",{style:{marginTop:4},children:e.jsxs(g,{direction:"vertical",size:4,children:[e.jsxs(fr,{children:[e.jsx(Fr,{})," docker-compose.yml"]}),se.map(de=>e.jsxs(fr,{children:[e.jsx(Jn,{})," ",de.path,"/Dockerfile"]},de.path))]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(fr,{type:"secondary",style:{fontSize:12},children:"í”„ë¡œì íŠ¸ íƒ€ì…"}),e.jsx("div",{style:{marginTop:4},children:e.jsx(T,{color:"green",children:((X=V.project_type)==null?void 0:X.toUpperCase())||"-"})})]}),e.jsxs("div",{children:[e.jsx(fr,{type:"secondary",style:{fontSize:12},children:"ì„œë¹„ìŠ¤ ì´ë¦„"}),e.jsx("div",{style:{marginTop:4},children:e.jsx(fr,{strong:!0,children:V.service_name||r})})]}),e.jsxs("div",{children:[e.jsx(fr,{type:"secondary",style:{fontSize:12},children:"í¬íŠ¸ ë²ˆí˜¸"}),e.jsx("div",{style:{marginTop:4},children:e.jsx(fr,{code:!0,children:V.port||ne(V.project_type)})})]}),e.jsx(xt,{style:{margin:"8px 0"}}),e.jsxs("div",{children:[e.jsx(fr,{type:"secondary",style:{fontSize:12},children:"ìƒì„± íŒŒì¼"}),e.jsx("div",{style:{marginTop:4},children:e.jsxs(g,{direction:"vertical",size:4,children:[e.jsxs(fr,{children:[e.jsx(Jn,{})," Dockerfile"]}),e.jsxs(fr,{children:[e.jsx(Fr,{})," docker-compose.yml"]})]})})]})]}),e.jsx(xt,{style:{margin:"8px 0"}}),e.jsx(xe,{message:"ë‹¤ìŒ ë‹¨ê³„",description:"íŒŒì¼ ë‚´ìš©ì„ í™•ì¸í•˜ê³  í•„ìš”ì‹œ ìˆ˜ì •í•œ í›„, 'GitLabì— ì»¤ë°‹' ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.",type:"info",showIcon:!0,style:{fontSize:12}})]})})};return e.jsxs("div",{style:{padding:"24px 0"},children:[e.jsxs(jd,{level:4,children:[e.jsx(Ze,{})," íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° ë° ìˆ˜ì •"]}),e.jsx(bd,{children:"ìƒì„±ëœ ë¹Œë“œ íŒŒì¼ì„ í™•ì¸í•˜ê³  í•„ìš”ì‹œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),e.jsx(xe,{message:W?`${se.length}ê°œì˜ Dockerfile ìƒì„±ë¨`:"ë¹Œë“œ íŒŒì¼ ìƒì„± ì™„ë£Œ",type:"success",showIcon:!0,style:{marginBottom:16}}),(v.dockerfile||v.dockerCompose)&&e.jsx(xe,{message:"ê¸°ì¡´ ë¹Œë“œ íŒŒì¼ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤",description:e.jsxs("div",{children:[e.jsxs("p",{style:{margin:0},children:["ë‹¤ìŒ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤:",v.dockerfile&&e.jsx(T,{color:"orange",style:{marginLeft:8},children:"Dockerfile"}),v.dockerCompose&&e.jsx(T,{color:"orange",style:{marginLeft:8},children:"docker-compose.yml"})]}),e.jsx("p",{style:{margin:"8px 0 0 0",fontWeight:500},children:"GitLabì— ì»¤ë°‹í•˜ë©´ ê¸°ì¡´ íŒŒì¼ì´ ë®ì–´ì“°ê¸°ë©ë‹ˆë‹¤. ê³„ì† ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"})]}),type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:16,children:W?e.jsx(xs,{defaultActiveKey:"compose",items:[{key:"compose",label:e.jsxs(g,{children:[e.jsx(Fr,{}),"docker-compose.yml"]}),children:e.jsx("div",{style:{border:"1px solid #d9d9d9",borderRadius:4},children:e.jsx(Nl,{height:"350px",language:"yaml",value:D,onChange:V=>M(V||""),options:{minimap:{enabled:!1},fontSize:12,lineNumbers:"on",scrollBeyondLastLine:!1}})})},...se.map(V=>({key:V.path,label:e.jsxs(g,{children:[e.jsx(Jn,{}),V.path,"/Dockerfile",e.jsx(T,{color:"blue",children:V.type})]}),children:e.jsx("div",{style:{border:"1px solid #d9d9d9",borderRadius:4},children:e.jsx(Nl,{height:"350px",language:"dockerfile",value:V.dockerfile,onChange:F=>{const X=se.map(de=>de.path===V.path?{...de,dockerfile:F||""}:de);ce(X)},options:{minimap:{enabled:!1},fontSize:12,lineNumbers:"on",scrollBeyondLastLine:!1}})})}))]}):e.jsx(xs,{defaultActiveKey:"dockerfile",items:[{key:"dockerfile",label:e.jsxs(g,{children:[e.jsx(Jn,{}),"Dockerfile"]}),children:e.jsx("div",{style:{border:"1px solid #d9d9d9",borderRadius:4},children:e.jsx(Nl,{height:"350px",language:"dockerfile",value:K,onChange:V=>J(V||""),options:{minimap:{enabled:!1},fontSize:12,lineNumbers:"on",scrollBeyondLastLine:!1}})})},{key:"compose",label:e.jsxs(g,{children:[e.jsx(Fr,{}),"docker-compose.yml"]}),children:e.jsx("div",{style:{border:"1px solid #d9d9d9",borderRadius:4},children:e.jsx(Nl,{height:"350px",language:"yaml",value:D,onChange:V=>M(V||""),options:{minimap:{enabled:!1},fontSize:12,lineNumbers:"on",scrollBeyondLastLine:!1}})})}]})}),e.jsx(Y,{span:8,children:U()})]})]});default:return null}},Pe=()=>{const w=[];return a>0&&w.push(e.jsx(B,{onClick:()=>i(a-1),children:"ì´ì „"},"back")),a===0?w.push(e.jsx(B,{type:"primary",onClick:be,loading:l,icon:e.jsx(Jn,{}),children:"í”„ë¡œì íŠ¸ ë¶„ì„ ì‹œì‘"},"detect")):a===1?w.push(e.jsx(B,{type:"primary",onClick:ye,loading:l,icon:e.jsx(Fr,{}),children:"í…œí”Œë¦¿ ìƒì„±"},"generate")):a===2&&w.push(e.jsx(B,{type:"primary",icon:e.jsx(dr,{}),onClick:Ue,loading:l,children:"GitLabì— ì»¤ë°‹"},"commit")),w};return e.jsx("div",{children:e.jsxs(gt,{spinning:l,tip:l?"ì²˜ë¦¬ ì¤‘...":void 0,children:[e.jsxs(So,{current:a,style:{marginBottom:32},children:[e.jsx(yd,{title:"í”„ë¡œì íŠ¸ ë¶„ì„",icon:e.jsx(Jn,{})}),e.jsx(yd,{title:"ë¹Œë“œ ì„¤ì •",icon:e.jsx(Fr,{})}),e.jsx(yd,{title:"íŒŒì¼ ìƒì„±",icon:e.jsx(Ze,{})})]}),je(),e.jsx(xt,{}),e.jsx("div",{style:{marginTop:24,textAlign:"right"},children:e.jsx(g,{children:Pe()})})]})})}const{Title:F_}=we,{Option:Bl}=Ee,ku=({visible:s,onClose:t,onConfirm:r,loading:n=!1,serviceId:a,infraType:i="kubernetes",scanStatus:l="idle",scanError:d})=>{const[c]=H.useForm(),[p,h]=o.useState("baseline"),[x,_]=o.useState([]),[S,L]=o.useState(!1),[k,E]=o.useState("manual");o.useEffect(()=>{s&&a&&P()},[s,a]);const P=async()=>{if(a)try{L(!0);const m=[];try{(await Ky(a)).forEach(b=>{if(b.hostname&&b.proxy_status==="active"){const W=b.hostname.startsWith("http://")||b.hostname.startsWith("https://")?b.hostname:`http://${b.hostname}`;m.push({domain:W,source:"service_domain",sourceName:b.upstream_address||"ì™¸ë¶€ Nginx",protocol:b.hostname.startsWith("https://")?"https":"http"})}})}catch(j){console.error("Service domains ë¡œë“œ ì‹¤íŒ¨:",j)}_(m),m.length>0?(E("select"),c.setFieldsValue({target_url:m[0].domain})):E("manual")}catch(m){console.error("ë„ë©”ì¸ ë¡œë“œ ì‹¤íŒ¨:",m),_([]),E("manual")}finally{L(!1)}},I=m=>{h(m)},$=m=>{E(m),c.setFieldsValue({target_url:void 0})},y=()=>{c.validateFields().then(m=>{const j={target_url:m.target_url,scan_type:m.scan_type||"baseline",options:{}};r(j)})},v=()=>{c.resetFields(),h("baseline"),E("manual"),t()},u=(m,j)=>{if(!j)return Promise.reject(new Error("ëŒ€ìƒ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”"));try{const b=new URL(j);return b.protocol!=="http:"&&b.protocol!=="https:"?Promise.reject(new Error("http:// ë˜ëŠ” https://ë¡œ ì‹œì‘í•˜ëŠ” URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”")):Promise.resolve()}catch(b){return Promise.reject(new Error("ì˜¬ë°”ë¥¸ URL í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (ì˜ˆ: https://example.com)"))}};return e.jsxs(rt,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",paddingRight:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[e.jsx(ni,{style:{color:"#52c41a",fontSize:"18px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:"DAST ì›¹ ë³´ì•ˆ ìŠ¤ìº”"})]}),e.jsx("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexShrink:0,paddingRight:"12px"},children:e.jsx(B,{type:"primary",size:"small",icon:l==="scanning"?e.jsx(jc,{spin:!0}):e.jsx(ni,{}),onClick:y,loading:n,disabled:l==="scanning",style:{minWidth:"100px",height:"28px"},children:l==="scanning"?"ìŠ¤ìº” ì¤‘...":"ìŠ¤ìº” ì‹œì‘"})})]}),open:s,onCancel:v,closeIcon:null,width:700,footer:[e.jsx(B,{onClick:v,children:"ë‹«ê¸°"},"cancel")],children:[e.jsx(xe,{message:"DAST (Dynamic Application Security Testing)",description:"ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë™ì  ë³´ì•ˆ ì·¨ì•½ì ì„ ìŠ¤ìº”í•©ë‹ˆë‹¤. ZAP(OWASP ZAP)ì„ ì‚¬ìš©í•˜ì—¬ XSS, SQL Injection, CSRF ë“±ì˜ ì·¨ì•½ì ì„ íƒì§€í•©ë‹ˆë‹¤.",type:"info",showIcon:!0,icon:e.jsx(Ks,{}),style:{marginBottom:24}}),l==="failed"&&e.jsx(xe,{message:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(Es,{style:{color:"#ff4d4f",fontSize:18}}),e.jsx("span",{style:{fontWeight:600},children:"ìŠ¤ìº”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"})]}),description:d||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",type:"error",showIcon:!1,style:{marginBottom:24}}),e.jsx(gt,{spinning:S,tip:"ë„ë©”ì¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",children:e.jsxs(H,{form:c,layout:"vertical",initialValues:{scan_type:"baseline"},disabled:l==="scanning",children:[e.jsxs(F_,{level:4,children:[e.jsx(ur,{style:{marginRight:8}}),"ìŠ¤ìº” ì„¤ì •"]}),a&&x.length>0&&e.jsx(H.Item,{label:"URL ì…ë ¥ ë°©ì‹",children:e.jsxs(aa.Group,{value:k,onChange:m=>$(m.target.value),optionType:"button",buttonStyle:"solid",children:[e.jsxs(aa.Button,{value:"select",children:[e.jsx(pu,{style:{marginRight:4}}),"ë„ë©”ì¸ ì„ íƒ"]}),e.jsxs(aa.Button,{value:"manual",children:[e.jsx(ln,{style:{marginRight:4}}),"ì§ì ‘ ì…ë ¥"]})]})}),e.jsx(H.Item,{name:"target_url",label:e.jsxs(g,{children:[e.jsx(ur,{}),e.jsx(we.Text,{strong:!0,children:"ìŠ¤ìº” ëŒ€ìƒ URL"})]}),rules:[{validator:u}],tooltip:"DAST ìŠ¤ìº”ì„ ìˆ˜í–‰í•  ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ URLì„ ì…ë ¥í•˜ì„¸ìš”",children:k==="select"&&x.length>0?e.jsx(Ee,{placeholder:"ìŠ¤ìº”í•  ë„ë©”ì¸ì„ ì„ íƒí•˜ì„¸ìš”",loading:S,showSearch:!0,size:"large",style:{width:"100%"},popupMatchSelectWidth:!0,optionLabelProp:"label",filterOption:(m,j)=>{const b=j==null?void 0:j.label;return(typeof b=="string"?b:"").toLowerCase().includes(m.toLowerCase())},children:x.map((m,j)=>e.jsx(Bl,{value:m.domain,label:m.domain,children:e.jsxs("div",{style:{overflow:"hidden"},children:[e.jsx("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m.domain}),e.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m.sourceName})]})},j))}):e.jsx(ue,{placeholder:"https://example.com",size:"large",prefix:e.jsx(ur,{style:{color:"#999"}})})}),a&&e.jsxs(e.Fragment,{children:[!S&&x.length===0&&e.jsx(xe,{message:"ì—°ê²°ëœ ë„ë©”ì¸ì´ ì—†ìŠµë‹ˆë‹¤",description:e.jsxs("div",{children:[e.jsx("p",{children:"ì„œë¹„ìŠ¤ì— ì—°ê²°ëœ ì™¸ë¶€ Nginx ë„ë©”ì¸ì´ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{style:{marginTop:4},children:"ìŠ¤ìº”í•˜ë ¤ëŠ” URLì„ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜, ë„ë©”ì¸ ì„¤ì •ì—ì„œ ì™¸ë¶€ Nginx ë„ë©”ì¸ì„ ì—°ê²°í•´ì£¼ì„¸ìš”."})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),!S&&x.length>0&&k==="select"&&e.jsx(xe,{message:`${x.length}ê°œì˜ ë„ë©”ì¸ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤`,description:"ì™¸ë¶€ Nginxì— ì—°ê²°ëœ ë„ë©”ì¸ì…ë‹ˆë‹¤. ë‹¤ë¥¸ URLì„ ìŠ¤ìº”í•˜ë ¤ë©´ 'ì§ì ‘ ì…ë ¥' ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.",type:"success",showIcon:!0,style:{marginBottom:16}})]}),e.jsx(xt,{}),e.jsx(H.Item,{name:"scan_type",label:"ìŠ¤ìº” íƒ€ì…",rules:[{required:!0,message:"ìŠ¤ìº” íƒ€ì…ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsxs(Ee,{onChange:I,size:"large",children:[e.jsx(Bl,{value:"baseline",children:"Baseline (ë¹ ë¦„, ì£¼ìš” ì·¨ì•½ì ë§Œ)"}),e.jsx(Bl,{value:"full",children:"Full (ëŠë¦¼, ëª¨ë“  ì·¨ì•½ì )"}),e.jsx(Bl,{value:"api",children:"API (REST API ëŒ€ìƒ)"})]})})]})})]})},{Text:mp}=we,{TabPane:_d}=xs,U_=({visible:s,onClose:t,repoId:r,repoName:n="ì €ì¥ì†Œ",onRefresh:a,onStartScan:i,onScanStateChange:l})=>{var v;const[d,c]=o.useState(!1),[p,h]=o.useState(null),[x,_]=o.useState(null),[S,L]=o.useState(!1),[k,E]=o.useState("summary"),P=o.useCallback(async()=>{var u,m,j,b,A,W,Z;if(!(!s||!r)){c(!0),_(null);try{const ce=await Xt.getDastResult(r);if(ce&&ce.status==="completed"&&ce.result){const D=ce.result;if(D.result&&D.result.results&&D.result.results.alerts){const M=D.result.results,K={alerts:M.alerts||[],summary:{total_alerts:M.total_alerts||0,high_alerts:M.high_alerts||0,medium_alerts:M.medium_alerts||0,low_alerts:M.low_alerts||0,info_alerts:M.info_alerts||0,scan_time:((u=D.result.summary)==null?void 0:u.scan_time)||0},execution_log:D.execution_log||{log_messages:[],total_duration:0}};h(K)}else if(D.result&&D.result.alerts){const M={alerts:D.result.alerts||[],summary:{total_alerts:((m=D.result.summary)==null?void 0:m.total_alerts)||0,high_alerts:((j=D.result.summary)==null?void 0:j.high_alerts)||0,medium_alerts:((b=D.result.summary)==null?void 0:b.medium_alerts)||0,low_alerts:((A=D.result.summary)==null?void 0:A.low_alerts)||0,info_alerts:((W=D.result.summary)==null?void 0:W.info_alerts)||0,scan_time:((Z=D.result.summary)==null?void 0:Z.scan_time)||0},execution_log:D.execution_log||{log_messages:[],total_duration:0}};h(M)}else h(D)}else ce&&ce.status==="pending"?(h(null),_("ë„ë©”ì¸ ë¶„ì„ì´ ì•„ì§ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.")):(ce&&ce.status,h(null),_("ë„ë©”ì¸ ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìŠ¤ìº”ì„ ì‹œì‘í•˜ì—¬ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤."))}catch(se){_("ë„ë©”ì¸ ë¶„ì„ ê²°ê³¼ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+(se.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}finally{c(!1)}}},[s,r]);o.useEffect(()=>{s&&P()},[s,r,P]),o.useEffect(()=>{s&&!S&&p===null&&P()},[s,S,p,P]);const I=o.useCallback(async()=>{if(!i){_("ìŠ¤ìº”ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}const u=`dast_params_${r}`,m=localStorage.getItem(u);if(!m){await i({target_url:"",scan_type:""});return}let j;try{j=JSON.parse(m)}catch(b){_("ì €ì¥ëœ ë„ë©”ì¸ ë¶„ì„ íŒŒë¼ë¯¸í„°ë¥¼ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}if(!j.target_url||!j.target_url.trim()){_("ëŒ€ìƒ URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");return}try{new URL(j.target_url.trim())}catch(b){_("ì˜¬ë°”ë¥¸ URL í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (ì˜ˆ: https://example.com)");return}L(!0),_(null),l==null||l("analyzing");try{await i(j),await P(),l==null||l("completed")}catch(b){_("ë„ë©”ì¸ ë¶„ì„ì„ ì‹œì‘í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+(b instanceof Error?b.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜")),l==null||l("failed")}finally{L(!1)}},[i,l,P,r]),$=u=>{switch(u){case"4":return"red";case"3":return"red";case"2":return"orange";case"1":return"blue";case"0":return"green";default:return"default"}},y=u=>{switch(u){case"4":return"Critical";case"3":return"High";case"2":return"Medium";case"1":return"Low";case"0":return"Info";default:return"Unknown"}};return e.jsx(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",paddingRight:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[e.jsx(ur,{style:{color:"#1890ff",fontSize:"18px"}}),e.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold"},children:[n," - ë„ë©”ì¸ ë¶„ì„ ê²°ê³¼"]}),(p==null?void 0:p.summary)&&e.jsxs(T,{color:"blue",style:{fontSize:"12px",padding:"2px 8px"},children:["ì•Œë¦¼ ",p.summary.total_alerts,"ê°œ"]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexShrink:0},children:[e.jsx(B,{size:"small",onClick:t,style:{marginRight:"4px"},children:"ë‹«ê¸°"}),a&&e.jsx(B,{icon:e.jsx(zs,{}),onClick:a,size:"small",disabled:S,style:{minWidth:"80px",height:"28px"},children:"ìƒˆë¡œê³ ì¹¨"}),i&&e.jsx(B,{type:"primary",icon:S?e.jsx(gt,{size:"small"}):e.jsx(In,{}),onClick:I,size:"small",disabled:S,style:{minWidth:"100px",height:"28px"},children:S?"ìŠ¤ìº” ì¤‘...":"ë¶„ì„ ì‹¤í–‰"})]})]}),open:s,onCancel:t,closeIcon:!1,footer:null,width:1400,style:{top:20},styles:{body:{maxHeight:"calc(100vh - 180px)",overflow:"auto",padding:"16px"}},children:d?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px",fontSize:"16px",color:"#666"},children:"ë„ë©”ì¸ ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."})]}):S?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px",fontSize:"16px",color:"#1890ff"},children:"ë„ë©”ì¸ ë¶„ì„ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤..."}),e.jsx("p",{style:{marginTop:"8px",fontSize:"14px",color:"#666"},children:"ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”. ìŠ¤ìº”ì´ ì™„ë£Œë˜ë©´ ìë™ìœ¼ë¡œ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤."})]}):x?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#ff4d4f"},children:[e.jsx(mn,{style:{fontSize:"48px",marginBottom:"16px"}}),e.jsx("p",{style:{fontSize:"16px",margin:0},children:x})]}):p?p!=null&&p.summary?e.jsx("div",{children:e.jsxs(xs,{activeKey:k,onChange:u=>E(u),style:{marginBottom:16},children:[e.jsxs(_d,{tab:"ìš”ì•½",children:[e.jsx(ie,{title:"ì·¨ì•½ì  ìš”ì•½",size:"small",style:{marginBottom:16},children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{span:6,children:e.jsx($e,{title:"ì´ ì•Œë¦¼",value:p.summary.total_alerts,valueStyle:{color:p.summary.total_alerts>0?"#ff4d4f":"#52c41a"}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"HIGH",value:p.summary.high_alerts,valueStyle:{color:"#ff4d4f"}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"MEDIUM",value:p.summary.medium_alerts,valueStyle:{color:"#fa8c16"}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"LOW",value:p.summary.low_alerts,valueStyle:{color:"#1890ff"}})})]})}),e.jsx(ie,{title:"ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼",size:"small",style:{marginBottom:16},children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{span:8,children:e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",background:p.alerts.filter(u=>u.name.toLowerCase().includes("sql")).length>0?"#fff1f0":"#f6ffed",border:`1px solid ${p.alerts.filter(u=>u.name.toLowerCase().includes("sql")).length>0?"#ffa39e":"#b7eb8f"}`},children:[e.jsx("div",{style:{fontSize:"12px",color:"#595959",marginBottom:"8px"},children:"SQL Injection"}),e.jsx("div",{style:{fontSize:"18px",fontWeight:600,marginBottom:"4px"},children:p.alerts.filter(u=>u.name.toLowerCase().includes("sql")).length>0?"ë°œê²¬ë¨":"ì•ˆì „"}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[p.alerts.filter(u=>u.name.toLowerCase().includes("sql")).length,"ê°œ ì•Œë¦¼"]})]})}),e.jsx(Y,{span:8,children:e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",background:p.alerts.filter(u=>u.name.toLowerCase().includes("cross site scripting")||u.name.toLowerCase().includes("xss")).length>0?"#fff1f0":"#f6ffed",border:`1px solid ${p.alerts.filter(u=>u.name.toLowerCase().includes("cross site scripting")||u.name.toLowerCase().includes("xss")).length>0?"#ffa39e":"#b7eb8f"}`},children:[e.jsx("div",{style:{fontSize:"12px",color:"#595959",marginBottom:"8px"},children:"XSS (Cross-Site Scripting)"}),e.jsx("div",{style:{fontSize:"18px",fontWeight:600,marginBottom:"4px"},children:p.alerts.filter(u=>u.name.toLowerCase().includes("cross site scripting")||u.name.toLowerCase().includes("xss")).length>0?"ë°œê²¬ë¨":"ì•ˆì „"}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[p.alerts.filter(u=>u.name.toLowerCase().includes("cross site scripting")||u.name.toLowerCase().includes("xss")).length,"ê°œ ì•Œë¦¼"]})]})}),e.jsx(Y,{span:8,children:e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",background:p.alerts.filter(u=>u.name.toLowerCase().includes("auth")||u.name.toLowerCase().includes("session")||u.name.toLowerCase().includes("cookie")).length>0?"#fff1f0":"#f6ffed",border:`1px solid ${p.alerts.filter(u=>u.name.toLowerCase().includes("auth")||u.name.toLowerCase().includes("session")||u.name.toLowerCase().includes("cookie")).length>0?"#ffa39e":"#b7eb8f"}`},children:[e.jsx("div",{style:{fontSize:"12px",color:"#595959",marginBottom:"8px"},children:"ì¸ì¦/ì„¸ì…˜ ë³´ì•ˆ"}),e.jsx("div",{style:{fontSize:"18px",fontWeight:600,marginBottom:"4px"},children:p.alerts.filter(u=>u.name.toLowerCase().includes("auth")||u.name.toLowerCase().includes("session")||u.name.toLowerCase().includes("cookie")).length>0?"ì·¨ì•½ì  ë°œê²¬":"ì•ˆì „"}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[p.alerts.filter(u=>u.name.toLowerCase().includes("auth")||u.name.toLowerCase().includes("session")||u.name.toLowerCase().includes("cookie")).length,"ê°œ ì•Œë¦¼"]})]})})]})}),e.jsx(ie,{title:"ë„¤íŠ¸ì›Œí¬ ìŠ¤ìº” ì •ë³´",size:"small",style:{marginBottom:16},children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{span:8,children:e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",background:"#f0f5ff",border:"1px solid #adc6ff"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#595959",marginBottom:"8px"},children:"ì—´ë¦° í¬íŠ¸"}),e.jsxs("div",{style:{fontSize:"18px",fontWeight:600,marginBottom:"4px"},children:[p.alerts.filter(u=>u.name.toLowerCase().includes("port")||u.name.toLowerCase().includes("server")).length,"ê°œ ê°ì§€"]}),e.jsx("div",{style:{fontSize:"11px",color:"#666"},children:"ì„œë²„ ë° í¬íŠ¸ ì •ë³´ ê´€ë ¨ ì•Œë¦¼"})]})}),e.jsx(Y,{span:8,children:e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",background:"#f0f5ff",border:"1px solid #adc6ff"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#595959",marginBottom:"8px"},children:"SSL/TLS ê²€ì‚¬"}),e.jsxs("div",{style:{fontSize:"18px",fontWeight:600,marginBottom:"4px"},children:[p.alerts.filter(u=>u.name.toLowerCase().includes("ssl")||u.name.toLowerCase().includes("tls")||u.name.toLowerCase().includes("certificate")).length,"ê°œ ì´ìŠˆ"]}),e.jsx("div",{style:{fontSize:"11px",color:"#666"},children:"ì¸ì¦ì„œ ë° ì•”í˜¸í™” ê´€ë ¨"})]})}),e.jsx(Y,{span:8,children:e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",background:"#f0f5ff",border:"1px solid #adc6ff"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#595959",marginBottom:"8px"},children:"í—¤ë” ë³´ì•ˆ"}),e.jsxs("div",{style:{fontSize:"18px",fontWeight:600,marginBottom:"4px"},children:[p.alerts.filter(u=>u.name.toLowerCase().includes("header")||u.name.toLowerCase().includes("content security policy")||u.name.toLowerCase().includes("x-frame-options")||u.name.toLowerCase().includes("x-content-type")).length,"ê°œ ê¶Œê³ ì‚¬í•­"]}),e.jsx("div",{style:{fontSize:"11px",color:"#666"},children:"ë³´ì•ˆ í—¤ë” ì„¤ì • ê´€ë ¨"})]})})]})})]},"summary"),e.jsx(_d,{tab:"ìƒì„¸ ê²°ê³¼",children:e.jsx(ie,{title:"ë°œê²¬ëœ ë³´ì•ˆ ì•Œë¦¼ ëª©ë¡",size:"small",children:e.jsx("div",{style:{maxHeight:"calc(100vh - 300px)",overflow:"auto"},children:(p.alerts||[]).map((u,m)=>e.jsx(ie,{size:"small",style:{marginBottom:8},title:`ì•Œë¦¼ #${m+1}: ${u.name}`,children:e.jsxs("div",{children:[e.jsxs("p",{style:{margin:"0 0 8px 0"},children:[e.jsx("strong",{children:"í”ŒëŸ¬ê·¸ì¸ ID:"})," ",u.pluginid]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(T,{color:$(u.riskcode),children:y(u.riskcode)}),e.jsxs(T,{color:"purple",children:["CWE-",u.cweid]}),e.jsxs(T,{color:"blue",children:["WASC-",u.wascid]})]}),u.description&&e.jsx("div",{style:{backgroundColor:"#f5f5f5",padding:8,borderRadius:4,marginTop:4},children:e.jsxs("p",{style:{margin:0,fontSize:"12px"},children:[e.jsx("strong",{children:"ì„¤ëª…:"})," ",u.description]})}),u.solution&&e.jsx("div",{style:{backgroundColor:"#f6ffed",padding:8,borderRadius:4,marginTop:4,border:"1px solid #b7eb8f"},children:e.jsxs("p",{style:{margin:0,fontSize:"12px"},children:[e.jsx("strong",{children:"í•´ê²° ë°©ë²•:"})," ",u.solution]})}),u.instances&&u.instances.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(mp,{strong:!0,style:{fontSize:"12px"},children:"ë°œê²¬ëœ ìœ„ì¹˜:"}),u.instances.map((j,b)=>e.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"4px",padding:"4px 8px",backgroundColor:"#fafafa",borderRadius:"3px"},children:[j.method," ",j.uri]},b))]})]})},m))})})},"details"),e.jsx(_d,{tab:"ì‹¤í–‰ ë¡œê·¸",children:e.jsx(ie,{title:"ë„ë©”ì¸ ë¶„ì„ ì‹¤í–‰ ë¡œê·¸",size:"small",children:e.jsx("div",{style:{maxHeight:"400px",overflow:"auto",padding:"8px",backgroundColor:"#1e1e1e",borderRadius:"4px",fontFamily:'Monaco, Menlo, "Ubuntu Mono", Consolas, "source-code-pro", monospace',fontSize:"12px",lineHeight:1.5,color:"#d4d4d4"},children:p.execution_log&&((v=p.execution_log)!=null&&v.log_messages)?p.execution_log.log_messages.map((u,m)=>e.jsx("div",{style:{marginBottom:"4px",fontSize:"12px",padding:"4px 8px",backgroundColor:"rgba(24, 144, 255, 0.1)",borderRadius:"3px",borderLeft:"3px solid #1890ff",color:"#d4d4d4"},children:u},m)):e.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#888"},children:e.jsx(mp,{type:"secondary",style:{color:"#888"},children:"ì‹¤í–‰ ë¡œê·¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})})})})},"logs")]})}):e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#999"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"ğŸŒ"}),e.jsx("p",{style:{fontSize:"16px",margin:0},children:"ë„ë©”ì¸ ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{style:{fontSize:"14px",margin:"8px 0 24px 0",color:"#ccc"},children:"ë¶„ì„ì„ ì‹œì‘í•´ì£¼ì„¸ìš”."}),i&&e.jsx(B,{type:"primary",icon:e.jsx(In,{}),onClick:I,size:"large",style:{minWidth:"120px",height:"40px"},children:"ë¶„ì„ ì‹œì‘í•˜ê¸°"})]}):e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(ni,{style:{fontSize:"48px",color:"#1890ff",marginBottom:"16px"}}),e.jsx("p",{style:{fontSize:"16px",margin:"0 0 8px 0"},children:"ë„ë©”ì¸ ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{style:{fontSize:"14px",color:"#666",margin:0},children:"ìŠ¤ìº”ì„ ì‹œì‘í•˜ì—¬ ë³´ì•ˆ ì·¨ì•½ì ì„ ë¶„ì„í•´ë³´ì„¸ìš”"})]})})},{Text:Ao,Title:H_}=we,V_={sast:{name:"ì •ì  ì½”ë“œ ë¶„ì„ (SAST)",description:"Semgrepê³¼ CodeQLì„ ì‚¬ìš©í•˜ì—¬ ì†ŒìŠ¤ ì½”ë“œì˜ ë³´ì•ˆ ì·¨ì•½ì ì„ ë¶„ì„í•©ë‹ˆë‹¤.",estimatedTime:180},sca:{name:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë¶„ì„ (SCA)",description:"Trivyë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì˜ ì·¨ì•½ì ì„ ìŠ¤ìº”í•©ë‹ˆë‹¤.",estimatedTime:120},dast:{name:"ë™ì  ë³´ì•ˆ ë¶„ì„ (DAST)",description:"OWASP ZAPì„ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰ ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³´ì•ˆ ì·¨ì•½ì ì„ ë¶„ì„í•©ë‹ˆë‹¤.",estimatedTime:300},sbom:{name:"SBOM ë¶„ì„",description:"ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„± ìš”ì†Œ(BOM)ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.",estimatedTime:60}},Ic=({scanType:s,visible:t,onClose:r,onCancel:n,startTime:a,estimatedSeconds:i,serviceName:l})=>{const[d,c]=o.useState(0),[p]=o.useState(a||new Date),h=V_[s],x=i||h.estimatedTime;o.useEffect(()=>{if(!t){c(0);return}const k=setInterval(()=>{const P=Math.floor((new Date().getTime()-p.getTime())/1e3);c(P)},1e3);return()=>clearInterval(k)},[t,p]);const _=k=>{const E=Math.floor(k/60),P=k%60;return E>0?`${E}ë¶„ ${P}ì´ˆ`:`${P}ì´ˆ`},S=Math.min(Math.round(d/x*100),99),L=o.useCallback(()=>{f.info({content:e.jsxs("span",{children:[e.jsx(Ko,{style:{marginRight:8}}),h.name,"ì´(ê°€) ë°±ê·¸ë¼ìš´ë“œì—ì„œ ê³„ì† ì‹¤í–‰ë©ë‹ˆë‹¤.",e.jsx("br",{}),"ì™„ë£Œë˜ë©´ ì•Œë¦¼ìœ¼ë¡œ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤."]}),duration:4}),r==null||r()},[r,h.name]);return t?e.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",background:"linear-gradient(180deg, #f0f5ff 0%, #ffffff 100%)",borderRadius:"12px",margin:"20px 0"},children:[e.jsx(gt,{indicator:e.jsx(jc,{style:{fontSize:48,color:"#1890ff"},spin:!0})}),e.jsx(H_,{level:4,style:{marginTop:24,marginBottom:8,color:"#1890ff"},children:h.name}),e.jsx(Ao,{type:"secondary",style:{display:"block",marginBottom:24},children:h.description}),e.jsxs("div",{style:{maxWidth:400,margin:"0 auto",marginBottom:20},children:[e.jsx(qt,{percent:S,status:"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"},showInfo:!1}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8},children:[e.jsxs(Ao,{type:"secondary",children:[e.jsx(wr,{style:{marginRight:4}}),"ê²½ê³¼: ",_(d)]}),e.jsxs(Ao,{type:"secondary",children:["ì˜ˆìƒ: ì•½ ",_(x)]})]})]}),e.jsx("div",{style:{background:"#e6f7ff",border:"1px solid #91d5ff",borderRadius:"8px",padding:"12px 16px",marginBottom:24,maxWidth:450,margin:"0 auto 24px"},children:e.jsxs(Ao,{style:{color:"#0050b3"},children:[e.jsx(Ko,{style:{marginRight:8}}),"ë¶„ì„ì´ ì™„ë£Œë˜ë©´ ì•Œë¦¼ìœ¼ë¡œ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",l&&e.jsxs("span",{style:{display:"block",marginTop:4},children:["ì„œë¹„ìŠ¤: ",e.jsx("strong",{children:l})]})]})}),e.jsxs(g,{size:"middle",children:[e.jsx(B,{type:"primary",icon:e.jsx(Ko,{}),onClick:L,size:"large",children:"ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰"}),n&&e.jsx(B,{icon:e.jsx(Gp,{}),onClick:n,size:"large",danger:!0,children:"ì·¨ì†Œ"})]}),e.jsx("div",{style:{marginTop:16},children:e.jsx(Ao,{type:"secondary",style:{fontSize:12},children:'"ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰"ì„ í´ë¦­í•˜ë©´ ì´ ì°½ì„ ë‹«ê³  ë‹¤ë¥¸ ì‘ì—…ì„ ê³„ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'})})]}):null},Bx=({visible:s,onClose:t,onConfirm:r,loading:n=!1,builtImages:a=[],registryConfig:i,defaultImageUrl:l})=>{const[d]=H.useForm(),[c,p]=Ct.useState(!1),h=!!(i!=null&&i.username&&(i!=null&&i.password));Ct.useEffect(()=>{s&&l&&d.setFieldValue("image_url",l)},[s,l,d]);const x=()=>{d.validateFields().then(S=>{const L={image_url:S.image_url,scan_type:S.scan_type||"vuln",registry_username:h?i==null?void 0:i.username:void 0,registry_password:h?i==null?void 0:i.password:void 0,generate_sbom:S.generate_sbom||!1,license_analysis:S.license_analysis||!1};r(L)})},_=()=>{d.resetFields(),p(!1),t()};return e.jsx(rt,{title:"ì´ë¯¸ì§€ ë¶„ì„",open:s,onCancel:_,width:700,footer:[e.jsx(B,{onClick:_,children:"ì·¨ì†Œ"},"cancel"),e.jsx(B,{type:"primary",onClick:()=>d.submit(),loading:n,children:"ë¶„ì„ ì‹œì‘"},"submit")],children:e.jsxs(gt,{spinning:n,children:[e.jsx(xe,{message:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì·¨ì•½ì  ë¶„ì„",description:a.length===0?`Docker ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì˜ ì·¨ì•½ì ì„ ë¶„ì„í•©ë‹ˆë‹¤. (ë¶„ì„ íƒ€ì…: ì·¨ì•½ì  ë¶„ì„)
âš ï¸ ë¹Œë“œëœ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë¹Œë“œë¥¼ ì‹¤í–‰í•˜ê±°ë‚˜ ìˆ˜ë™ìœ¼ë¡œ ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ì„¸ìš”.`:`Docker ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì˜ ì·¨ì•½ì ì„ ë¶„ì„í•©ë‹ˆë‹¤. (ë¶„ì„ íƒ€ì…: ì·¨ì•½ì  ë¶„ì„)
 ${a.length}ê°œì˜ ë¹Œë“œëœ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`,type:a.length===0?"warning":"info",showIcon:!0,style:{marginBottom:24,whiteSpace:"pre-line"}}),e.jsxs(H,{form:d,layout:"vertical",onFinish:x,autoComplete:"off",initialValues:{scan_type:"vuln",generate_sbom:!1,license_analysis:!1},children:[e.jsx(H.Item,{label:e.jsxs(g,{children:[e.jsx(Qr,{}),e.jsx(we.Text,{strong:!0,children:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€"}),a.length>0&&!c&&e.jsx(B,{type:"link",size:"small",onClick:()=>p(!0),style:{padding:0,height:"auto"},children:"ìˆ˜ë™ ì…ë ¥"}),a.length>0&&c&&e.jsx(B,{type:"link",size:"small",onClick:()=>p(!1),style:{padding:0,height:"auto"},children:"ë¹Œë“œ ì´ë¯¸ì§€ ì„ íƒ"})]}),name:"image_url",rules:[{required:!0,message:"ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ì…ë ¥í•´ì£¼ì„¸ìš”"},...c?[{pattern:/^[a-zA-Z0-9._/-]+(:[a-zA-Z0-9._-]+)?$/,message:"ì˜¬ë°”ë¥¸ ì´ë¯¸ì§€ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}]:[]],extra:!c&&a.length>0?"ë¹Œë“œëœ ì´ë¯¸ì§€ ì¤‘ì—ì„œ ì„ íƒí•˜ì„¸ìš”":"ì˜ˆ: nginx:latest, ubuntu:20.04, harbor.example.com/project/app:v1.0.0",children:!c&&a.length>0?e.jsx(Ee,{placeholder:"ë¹Œë“œëœ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”",showSearch:!0,optionFilterProp:"searchLabel",dropdownMatchSelectWidth:!1,dropdownStyle:{maxWidth:600},style:{width:"100%"},optionLabelProp:"shortLabel",children:a.map((S,L)=>{const k=S.image_url.split("/"),E=k[k.length-1]||S.image_url;return e.jsx(Ee.Option,{value:S.image_url,searchLabel:`${S.image_url} ${S.image_tag||""}`,shortLabel:E,children:e.jsx(Ie,{title:S.image_url,placement:"topLeft",children:e.jsxs("div",{style:{maxWidth:550},children:[e.jsx("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:S.image_url}),e.jsxs("div",{style:{fontSize:12,color:"#999",marginTop:4},children:["ë¹Œë“œ ì¼ì‹œ:"," ",new Date(S.build_date).toLocaleString("ko-KR"),S.image_tag&&` | íƒœê·¸: ${S.image_tag}`]})]})})},L)})}):e.jsx(ue,{placeholder:"nginx:latest"})}),e.jsx(H.Item,{name:"scan_type",style:{display:"none"},children:e.jsx(ue,{value:"vuln"})}),e.jsx(xt,{children:"Container Registry ì¸ì¦"}),e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:h?"#f6ffed":"#fff7e6",border:`1px solid ${h?"#b7eb8f":"#ffd591"}`,borderRadius:"8px",marginBottom:"16px"},children:[e.jsxs(g,{wrap:!0,children:[e.jsx(nc,{style:{fontSize:"16px",color:h?"#52c41a":"#fa8c16"}}),e.jsx(we.Text,{strong:!0,children:"Registry ì¸ì¦ ì •ë³´"}),h?e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:"ì €ì¥ë¨"}),e.jsxs(we.Text,{type:"secondary",style:{fontSize:"12px"},children:["(",(i==null?void 0:i.registry_type)==="harbor"?"Harbor":"Docker Hub",": ",(i==null?void 0:i.registry_url)||"N/A"," -"," ",i==null?void 0:i.username," / â—â—â—â—â—â—)"]}),(i==null?void 0:i.project_name)&&e.jsx(T,{color:"blue",children:(i==null?void 0:i.registry_type)==="harbor"?`í”„ë¡œì íŠ¸: ${i.project_name}`:i.project_name})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"warning",children:"ë¯¸ì„¤ì •"}),e.jsx(we.Text,{type:"secondary",style:{fontSize:"12px"},children:"ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì—ì„œ Registry ì¸ì¦ ì •ë³´ë¥¼ ì„¤ì •í•˜ì„¸ìš”"})]})]}),!h&&e.jsx(xe,{message:"Private Registry ì‚¬ìš© ì‹œ ì¸ì¦ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤",description:"Public Registry(ì˜ˆ: Docker Hub ê³µê°œ ì´ë¯¸ì§€)ëŠ” ì¸ì¦ ì •ë³´ê°€ í•„ìš” ì—†ìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginTop:12}})]}),e.jsx(xt,{children:"SBOM ìƒì„± ì˜µì…˜"}),e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#f5f5f5",border:"1px solid #d9d9d9",borderRadius:"8px",marginBottom:"16px"},children:[e.jsx(H.Item,{name:"generate_sbom",valuePropName:"checked",style:{marginBottom:12},children:e.jsxs(g,{children:[e.jsx(Zr,{}),e.jsxs(we.Text,{children:[e.jsx(ai,{style:{marginRight:6}}),"SBOM ìë™ ìƒì„±"]}),e.jsx(Ie,{title:"CycloneDX í˜•ì‹ì˜ SBOM(Software Bill of Materials)ì„ ìƒì„±í•©ë‹ˆë‹¤. ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„±ìš”ì†Œ ëª©ë¡ê³¼ ì˜ì¡´ì„± ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.",children:e.jsx(we.Text,{type:"secondary",style:{fontSize:12},children:"(ê¶Œì¥)"})})]})}),e.jsx(H.Item,{name:"license_analysis",valuePropName:"checked",style:{marginBottom:0},dependencies:["generate_sbom"],children:e.jsxs(g,{children:[e.jsx(Zr,{}),e.jsx(we.Text,{children:"ë¼ì´ì„ ìŠ¤ ë¶„ì„ í¬í•¨"}),e.jsx(Ie,{title:"SBOM ìƒì„± ì‹œ ê° êµ¬ì„±ìš”ì†Œì˜ ë¼ì´ì„ ìŠ¤ ì •ë³´ë¥¼ ë¶„ì„í•˜ì—¬ í¬í•¨í•©ë‹ˆë‹¤.",children:e.jsx(we.Text,{type:"secondary",style:{fontSize:12},children:"(SBOM ìƒì„± ì‹œ)"})})]})}),e.jsx(we.Paragraph,{type:"secondary",style:{fontSize:12,marginTop:12,marginBottom:0},children:"SBOMì„ ìƒì„±í•˜ë©´ ë¶„ì„ ê²°ê³¼ì—ì„œ SBOM/ë¼ì´ì„ ìŠ¤ íƒ­ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})]})]})]})})},$x=({visible:s,onClose:t,onConfirm:r,loading:n=!1,initialGitUrl:a,hideGitFields:i=!1})=>{const[l]=H.useForm(),d=p=>{const h={git_url:p.git_url,branch:p.branch||"main",git_token:p.git_token||void 0,generate_sbom:p.generate_sbom||!1,license_analysis:p.license_analysis||!1};r(h)},c=()=>{l.resetFields(),t()};return e.jsx(rt,{title:"SAST ì •ì  ë¶„ì„ ë³´ì•ˆ ìŠ¤ìº”",open:s,onCancel:c,width:700,footer:[e.jsx(B,{onClick:c,children:"ì·¨ì†Œ"},"cancel"),e.jsx(B,{type:"primary",onClick:()=>l.submit(),loading:n,children:"ìŠ¤ìº” ì‹œì‘"},"submit")],destroyOnClose:!0,children:e.jsxs(gt,{spinning:n,children:[e.jsx(xe,{message:"ì •ì  ë¶„ì„ ë³´ì•ˆ ìŠ¤ìº”",description:"ì†ŒìŠ¤ ì½”ë“œë¥¼ ë¶„ì„í•˜ì—¬ ë³´ì•ˆ ì·¨ì•½ì ì„ ì°¾ëŠ” ì •ì  ë¶„ì„ ë„êµ¬ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs(H,{form:l,layout:"vertical",onFinish:d,autoComplete:"off",initialValues:{git_url:a||"",branch:"main",generate_sbom:!1,license_analysis:!1},children:[!i&&e.jsxs(e.Fragment,{children:[e.jsx(H.Item,{label:e.jsxs(g,{children:[e.jsx(si,{}),e.jsx(we.Text,{strong:!0,children:"Git ì €ì¥ì†Œ URL"})]}),name:"git_url",rules:[{required:!0,message:"Git ì €ì¥ì†Œ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"https://github.com/username/repository.git"})}),e.jsx(H.Item,{label:e.jsxs(g,{children:[e.jsx(Jn,{}),e.jsx(we.Text,{strong:!0,children:"ë¸Œëœì¹˜"})]}),name:"branch",children:e.jsx(ue,{placeholder:"main"})}),e.jsx(xt,{children:e.jsx(we.Text,{type:"secondary",style:{fontSize:14},children:"Git ì €ì¥ì†Œ ì¸ì¦ (ì„ íƒì‚¬í•­)"})}),e.jsx(xe,{message:"Private Repository ì‚¬ìš© ì‹œì—ë§Œ ì…ë ¥í•˜ì„¸ìš”",description:"Public Repository(ì˜ˆ: GitHub public ì €ì¥ì†Œ)ëŠ” ì¸ì¦ ì •ë³´ê°€ í•„ìš” ì—†ìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(H.Item,{label:e.jsx(we.Text,{type:"secondary",style:{fontSize:12},children:"Git í† í° (ì„ íƒì‚¬í•­)"}),name:"git_token",tooltip:"GitLab, GitHub ë“±ì˜ Personal Access Token ë˜ëŠ” Deploy Token",children:e.jsx(ue.Password,{placeholder:"glpat-xxxxxxxxxxxxxxxxxxxx ë˜ëŠ” ghp_xxxxxxxxxxxxxxxxxxxx"})})]}),e.jsx(xt,{children:"SBOM ìƒì„± ì˜µì…˜"}),e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"#f5f5f5",border:"1px solid #d9d9d9",borderRadius:"8px",marginBottom:"16px"},children:[e.jsx(H.Item,{name:"generate_sbom",valuePropName:"checked",style:{marginBottom:12},children:e.jsxs(g,{children:[e.jsx(Zr,{}),e.jsxs(we.Text,{children:[e.jsx(ai,{style:{marginRight:6}}),"SBOM ìë™ ìƒì„±"]}),e.jsx(Ie,{title:"CycloneDX í˜•ì‹ì˜ SBOM(Software Bill of Materials)ì„ ìƒì„±í•©ë‹ˆë‹¤. ì†ŒìŠ¤ì½”ë“œì˜ ì˜ì¡´ì„± êµ¬ì„±ìš”ì†Œ ëª©ë¡ê³¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.",children:e.jsx(we.Text,{type:"secondary",style:{fontSize:12},children:"(ê¶Œì¥)"})})]})}),e.jsx(H.Item,{name:"license_analysis",valuePropName:"checked",style:{marginBottom:0},dependencies:["generate_sbom"],children:e.jsxs(g,{children:[e.jsx(Zr,{}),e.jsx(we.Text,{children:"ë¼ì´ì„ ìŠ¤ ë¶„ì„ í¬í•¨"}),e.jsx(Ie,{title:"SBOM ìƒì„± ì‹œ ê° êµ¬ì„±ìš”ì†Œì˜ ë¼ì´ì„ ìŠ¤ ì •ë³´ë¥¼ ë¶„ì„í•˜ì—¬ í¬í•¨í•©ë‹ˆë‹¤.",children:e.jsx(we.Text,{type:"secondary",style:{fontSize:12},children:"(SBOM ìƒì„± ì‹œ)"})})]})})]})]})]})})},kn={critical:"#ff4d4f",high:"#ff7875",medium:"#ffa940",low:"#52c41a",info:"#1890ff"},q_={INJ:{category_id:"INJ",category_name:"Injection",category_name_ko:"ì¸ì ì…˜",description:"SQL, Command, XSS ì¸ì ì…˜ ì·¨ì•½ì "},AUTH:{category_id:"AUTH",category_name:"Authentication",category_name_ko:"ì¸ì¦",description:"ì¸ì¦ ë° ì„¸ì…˜ ê´€ë¦¬ ì·¨ì•½ì "},SENS:{category_id:"SENS",category_name:"Sensitive Data",category_name_ko:"ë¯¼ê° ë°ì´í„°",description:"ë¯¼ê° ì •ë³´ ë…¸ì¶œ ì·¨ì•½ì "},CRYPTO:{category_id:"CRYPTO",category_name:"Cryptographic Issues",category_name_ko:"ì•”í˜¸í™”",description:"ì•”í˜¸í™” ê´€ë ¨ ì·¨ì•½ì "},CONFIG:{category_id:"CONFIG",category_name:"Security Misconfiguration",category_name_ko:"ë³´ì•ˆ ì„¤ì •",description:"ë³´ì•ˆ ì„¤ì • ì˜¤ë¥˜"},VULN_DEP:{category_id:"VULN_DEP",category_name:"Vulnerable Components",category_name_ko:"ì·¨ì•½ ì»´í¬ë„ŒíŠ¸",description:"ì·¨ì•½í•œ ì˜ì¡´ì„±/ì»´í¬ë„ŒíŠ¸"},INPUT:{category_id:"INPUT",category_name:"Input Validation",category_name_ko:"ì…ë ¥ ê²€ì¦",description:"ì…ë ¥ê°’ ê²€ì¦ ì·¨ì•½ì "},NETWORK:{category_id:"NETWORK",category_name:"Network Security",category_name_ko:"ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ",description:"ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì·¨ì•½ì "},ACCESS:{category_id:"ACCESS",category_name:"Access Control",category_name_ko:"ì ‘ê·¼ ì œì–´",description:"ì ‘ê·¼ ê¶Œí•œ ê´€ë¦¬ ì·¨ì•½ì "},OTHER:{category_id:"OTHER",category_name:"Other",category_name_ko:"ê¸°íƒ€",description:"ê¸°íƒ€ ë³´ì•ˆ ì´ìŠˆ"},CVE_CRITICAL:{category_id:"CVE_CRITICAL",category_name:"Critical CVEs",category_name_ko:"ê¸´ê¸‰ ì·¨ì•½ì ",description:"ì¦‰ì‹œ ì¡°ì¹˜ê°€ í•„ìš”í•œ ì‹¬ê°í•œ ë³´ì•ˆ ì·¨ì•½ì ì…ë‹ˆë‹¤. ì›ê²© ì½”ë“œ ì‹¤í–‰, ê¶Œí•œ ìƒìŠ¹ ë“± ì¹˜ëª…ì ì¸ ê³µê²©ì— ì•…ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤."},CVE_HIGH:{category_id:"CVE_HIGH",category_name:"High Severity CVEs",category_name_ko:"ë†’ì€ ìœ„í—˜ ì·¨ì•½ì ",description:"ë¹ ë¥¸ ì‹œì¼ ë‚´ ì¡°ì¹˜ê°€ ê¶Œì¥ë˜ëŠ” ì·¨ì•½ì ì…ë‹ˆë‹¤. ë°ì´í„° ìœ ì¶œì´ë‚˜ ì„œë¹„ìŠ¤ ì¥ì• ë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."},CVE_MEDIUM:{category_id:"CVE_MEDIUM",category_name:"Medium Severity CVEs",category_name_ko:"ë³´í†µ ìœ„í—˜ ì·¨ì•½ì ",description:"ê³„íšëœ ìœ ì§€ë³´ìˆ˜ ì‹œ ì¡°ì¹˜ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤. íŠ¹ì • ì¡°ê±´ì—ì„œ ì•…ìš© ê°€ëŠ¥í•œ ì·¨ì•½ì ì…ë‹ˆë‹¤."},CVE_LOW:{category_id:"CVE_LOW",category_name:"Low Severity CVEs",category_name_ko:"ë‚®ì€ ìœ„í—˜ ì·¨ì•½ì ",description:"ì¦‰ê°ì ì¸ ìœ„í—˜ì€ ë‚®ìœ¼ë‚˜, ë³´ì•ˆ ê°•í™”ë¥¼ ìœ„í•´ ì ì§„ì  ì—…ë°ì´íŠ¸ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤."},OS_PKG:{category_id:"OS_PKG",category_name:"OS Package Vulnerabilities",category_name_ko:"OS íŒ¨í‚¤ì§€",description:"ìš´ì˜ì²´ì œ íŒ¨í‚¤ì§€ ì·¨ì•½ì  (Alpine, Debian, Ubuntu ë“±)"},LANG_PKG:{category_id:"LANG_PKG",category_name:"Language Package Vulnerabilities",category_name_ko:"ì–¸ì–´ íŒ¨í‚¤ì§€",description:"í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ì˜ì¡´ì„± ì·¨ì•½ì  (npm, pip, go modules ë“±)"},FIXABLE:{category_id:"FIXABLE",category_name:"Fixable Vulnerabilities",category_name_ko:"ìˆ˜ì • ê°€ëŠ¥",description:"íŒ¨ì¹˜/ì—…ë°ì´íŠ¸ ë²„ì „ì´ ìˆëŠ” ì·¨ì•½ì "},NO_FIX:{category_id:"NO_FIX",category_name:"No Fix Available",category_name_ko:"ìˆ˜ì • ë¶ˆê°€",description:"í˜„ì¬ íŒ¨ì¹˜ê°€ ì—†ëŠ” ì·¨ì•½ì "}},Xl={INJ:"#ff4d4f",AUTH:"#ff7875",SENS:"#fa8c16",CRYPTO:"#faad14",CONFIG:"#a0d911",VULN_DEP:"#52c41a",INPUT:"#13c2c2",NETWORK:"#1890ff",ACCESS:"#722ed1",OTHER:"#8c8c8c",CVE_CRITICAL:"#a8071a",CVE_HIGH:"#cf1322",CVE_MEDIUM:"#d46b08",CVE_LOW:"#096dd9",OS_PKG:"#531dab",LANG_PKG:"#1d39c4",FIXABLE:"#389e0d",NO_FIX:"#ad6800"},Cu={CVE_CRITICAL:{id:"CVE_CRITICAL",label:"ê¸´ê¸‰",cvssRange:"CVSS 9.0 - 10.0",priority:"critical",priorityLabel:"ìµœìš°ì„ ",actionTimeframe:"ì¦‰ì‹œ ì¡°ì¹˜ (24ì‹œê°„ ì´ë‚´)",icon:"ğŸ”´",color:"#a8071a",bgColor:"#fff1f0",description:"ì‹œìŠ¤í…œ ì „ì²´ì— ì‹¬ê°í•œ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ",guidance:`â€¢ ì›ê²© ì½”ë“œ ì‹¤í–‰(RCE) ê°€ëŠ¥ì„±
â€¢ ê¶Œí•œ ìƒìŠ¹ ë° ì‹œìŠ¤í…œ íƒˆì·¨ ìœ„í—˜
â€¢ ì¸ì¦ ì—†ì´ ì•…ìš© ê°€ëŠ¥í•œ ê²½ìš° ë‹¤ìˆ˜`},CVE_HIGH:{id:"CVE_HIGH",label:"ë†’ìŒ",cvssRange:"CVSS 7.0 - 8.9",priority:"high",priorityLabel:"ìš°ì„ ",actionTimeframe:"1ì£¼ì¼ ì´ë‚´ ì¡°ì¹˜ ê¶Œì¥",icon:"ğŸŸ ",color:"#cf1322",bgColor:"#fff2e8",description:"ì£¼ìš” ê¸°ëŠ¥ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆëŠ” ì·¨ì•½ì ",guidance:`â€¢ ë¯¼ê° ë°ì´í„° ìœ ì¶œ ê°€ëŠ¥ì„±
â€¢ ì„œë¹„ìŠ¤ ê±°ë¶€(DoS) ê³µê²© ìœ„í—˜
â€¢ ì œí•œëœ ì¡°ê±´ì—ì„œ ì•…ìš© ê°€ëŠ¥`},CVE_MEDIUM:{id:"CVE_MEDIUM",label:"ë³´í†µ",cvssRange:"CVSS 4.0 - 6.9",priority:"medium",priorityLabel:"ì¼ë°˜",actionTimeframe:"1ê°œì›” ì´ë‚´ ì¡°ì¹˜ ê¶Œì¥",icon:"ğŸŸ¡",color:"#d46b08",bgColor:"#fffbe6",description:"ì œí•œëœ ìƒí™©ì—ì„œ ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆëŠ” ì·¨ì•½ì ",guidance:`â€¢ íŠ¹ì • ì„¤ì •/í™˜ê²½ì—ì„œë§Œ ì•…ìš© ê°€ëŠ¥
â€¢ ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í•„ìš”
â€¢ ì •ê¸° ì—…ë°ì´íŠ¸ ì‹œ í•¨ê»˜ í•´ê²°`},CVE_LOW:{id:"CVE_LOW",label:"ë‚®ìŒ",cvssRange:"CVSS 0.1 - 3.9",priority:"low",priorityLabel:"ì°¸ê³ ",actionTimeframe:"ë‹¤ìŒ ì •ê¸° ì—…ë°ì´íŠ¸ ì‹œ ì¡°ì¹˜",icon:"ğŸŸ¢",color:"#096dd9",bgColor:"#e6f7ff",description:"ì¦‰ê°ì ì¸ ìœ„í—˜ì€ ë‚®ìœ¼ë‚˜ ê°œì„ ì´ ê¶Œì¥ë˜ëŠ” ì·¨ì•½ì ",guidance:`â€¢ ì•…ìš© ë‚œì´ë„ ë†’ìŒ
â€¢ ì˜í–¥ ë²”ìœ„ ì œí•œì 
â€¢ ë³´ì•ˆ ê°•í™” ì°¨ì›ì—ì„œ ì—…ë°ì´íŠ¸ ê¶Œì¥`}},G_={critical:{label:"ê¸´ê¸‰",description:"ì¦‰ì‹œ ì¡°ì¹˜ê°€ í•„ìš”í•œ ì‹¬ê°í•œ ì·¨ì•½ì ",icon:"ğŸ”´",color:"#a8071a"},high:{label:"ë†’ìŒ",description:"ë¹ ë¥¸ ì‹œì¼ ë‚´ ì¡°ì¹˜ê°€ í•„ìš”í•œ ì·¨ì•½ì ",icon:"ğŸŸ ",color:"#cf1322"},medium:{label:"ë³´í†µ",description:"ê³„íšëœ ì¼ì • ë‚´ ì¡°ì¹˜ê°€ í•„ìš”í•œ ì·¨ì•½ì ",icon:"ğŸŸ¡",color:"#d46b08"},low:{label:"ë‚®ìŒ",description:"ê¶Œì¥ ì‚¬í•­ ìˆ˜ì¤€ì˜ ê°œì„ ì ",icon:"ğŸŸ¢",color:"#096dd9"},info:{label:"ì •ë³´",description:"ì°¸ê³ ìš© ì •ë³´ì„± í•­ëª©",icon:"ğŸ”µ",color:"#1890ff"}},W_={semgrep:"Semgrep (SAST)",codeql:"CodeQL (SAST)",trivy:"Trivy (SCA)",zap:"ZAP (DAST)",other:"Other"},$l={open:"ë¯¸í•´ê²°",resolved:"í•´ê²°ë¨",false_positive:"ì˜¤íƒ",accepted_risk:"ìœ„í—˜ ìˆ˜ìš©"},eu={permissive:{id:"permissive",label:"Permissive",labelKo:"í—ˆìš©ì ",description:"ììœ ë¡œìš´ ì‚¬ìš©, ìˆ˜ì •, ë°°í¬ê°€ ê°€ëŠ¥í•œ ë¼ì´ì„ ìŠ¤ì…ë‹ˆë‹¤.",riskLevel:"low",icon:"âœ…",color:"#52c41a",bgColor:"#f6ffed",examples:["MIT","Apache-2.0","BSD-2-Clause","BSD-3-Clause","ISC","Unlicense"]},weak_copyleft:{id:"weak_copyleft",label:"Weak Copyleft",labelKo:"ì•½í•œ ì¹´í”¼ë ˆí”„íŠ¸",description:"ë¼ì´ë¸ŒëŸ¬ë¦¬ ìˆ˜ì • ì‹œ í•´ë‹¹ ë¶€ë¶„ì˜ ì†ŒìŠ¤ ê³µê°œê°€ í•„ìš”í•©ë‹ˆë‹¤.",riskLevel:"medium",icon:"âš ï¸",color:"#faad14",bgColor:"#fffbe6",examples:["LGPL-2.1","LGPL-3.0","MPL-2.0","EPL-1.0","EPL-2.0"]},strong_copyleft:{id:"strong_copyleft",label:"Strong Copyleft",labelKo:"ê°•í•œ ì¹´í”¼ë ˆí”„íŠ¸",description:"ì‚¬ìš© ì‹œ ì „ì²´ í”„ë¡œì íŠ¸ì˜ ì†ŒìŠ¤ ì½”ë“œ ê³µê°œê°€ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",riskLevel:"high",icon:"ğŸ”´",color:"#ff4d4f",bgColor:"#fff1f0",examples:["GPL-2.0","GPL-3.0","AGPL-3.0","SSPL-1.0"]},proprietary:{id:"proprietary",label:"Proprietary",labelKo:"ìƒì—…ìš©",description:"ìƒì—…ì  ë¼ì´ì„ ìŠ¤ê°€ í•„ìš”í•˜ë©°, ë¹„ìš©ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",riskLevel:"critical",icon:"ğŸ’°",color:"#722ed1",bgColor:"#f9f0ff",examples:["Commercial","Proprietary","Enterprise"]},unknown:{id:"unknown",label:"Unknown",labelKo:"ë¯¸í™•ì¸",description:"ë¼ì´ì„ ìŠ¤ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ë™ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.",riskLevel:"medium",icon:"â“",color:"#8c8c8c",bgColor:"#fafafa",examples:[]}},K_={low:"#52c41a",medium:"#faad14",high:"#ff4d4f",critical:"#722ed1"},Y_={image:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€",source:"ì†ŒìŠ¤ì½”ë“œ"},wd={library:"ë¼ì´ë¸ŒëŸ¬ë¦¬",framework:"í”„ë ˆì„ì›Œí¬",application:"ì• í”Œë¦¬ì¼€ì´ì…˜",container:"ì»¨í…Œì´ë„ˆ","operating-system":"ìš´ì˜ì²´ì œ",device:"ì¥ì¹˜",file:"íŒŒì¼"},{Text:No,Paragraph:J_}=we,fp=({severity:s})=>{const t={critical:"CRITICAL",high:"HIGH",medium:"MEDIUM",low:"LOW",info:"INFO"};return e.jsx(T,{color:kn[s],style:{fontWeight:600,fontSize:"11px"},children:t[s]})},yp=({tool:s})=>{const t={semgrep:"blue",codeql:"purple",trivy:"green",zap:"orange",other:"default"};return e.jsx(T,{color:t[s],style:{fontSize:"10px"},children:W_[s]})},jp=({status:s})=>{switch(s){case"resolved":return e.jsx(Ze,{style:{color:"#52c41a"}});case"false_positive":return e.jsx(Es,{style:{color:"#8c8c8c"}});case"accepted_risk":return e.jsx(Yt,{style:{color:"#faad14"}});default:return null}},Z_=({item:s,onStatusChange:t,loading:r=!1,compact:n=!1})=>{const[a,i]=o.useState(!1),l=s.status!=="open",d=async()=>{if(!a){i(!0);try{const h=l?"open":"resolved";await t(s.item_id,h)}finally{i(!1)}}},c=async h=>{if(!(a||h===s.status)){i(!0);try{await t(s.item_id,h)}finally{i(!1)}}},p=[{key:"resolved",label:$l.resolved,icon:e.jsx(Ze,{style:{color:"#52c41a"}}),onClick:()=>c("resolved")},{key:"false_positive",label:$l.false_positive,icon:e.jsx(Es,{style:{color:"#8c8c8c"}}),onClick:()=>c("false_positive")},{key:"accepted_risk",label:$l.accepted_risk,icon:e.jsx(Yt,{style:{color:"#faad14"}}),onClick:()=>c("accepted_risk")},{type:"divider"},{key:"open",label:"ë¯¸í•´ê²°ë¡œ ë˜ëŒë¦¬ê¸°",onClick:()=>c("open")}];return n?e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid #f0f0f0",opacity:l?.6:1,backgroundColor:l?"#fafafa":"transparent"},children:[e.jsx(Kt,{title:l?"ë¯¸í•´ê²°ë¡œ ë˜ëŒë¦¬ì‹œê² ìŠµë‹ˆê¹Œ?":"í•´ê²° ì™„ë£Œë¡œ í‘œì‹œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:d,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",disabled:a||r,children:e.jsx(Vr,{checked:l,disabled:a||r,style:{marginRight:12}})}),e.jsxs(g,{style:{flex:1},children:[e.jsx(fp,{severity:s.severity}),e.jsx(No,{style:{textDecoration:l?"line-through":"none",color:l?"#8c8c8c":"inherit"},children:s.title}),l&&e.jsx(jp,{status:s.status})]}),e.jsxs(g,{children:[e.jsx(yp,{tool:s.source_tool}),s.cve_id&&e.jsx(T,{style:{fontSize:"10px"},children:s.cve_id})]})]}):e.jsx(ie,{size:"small",style:{marginBottom:8,opacity:l?.7:1,backgroundColor:l?"#fafafa":"#fff",borderLeft:`3px solid ${kn[s.severity]}`},bodyStyle:{padding:"12px 16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[e.jsx(Kt,{title:l?"ë¯¸í•´ê²°ë¡œ ë˜ëŒë¦¬ì‹œê² ìŠµë‹ˆê¹Œ?":"í•´ê²° ì™„ë£Œë¡œ í‘œì‹œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:d,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",disabled:a||r,children:e.jsx(Vr,{checked:l,disabled:a||r,style:{marginRight:12,marginTop:4}})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[e.jsx(fp,{severity:s.severity}),e.jsx(yp,{tool:s.source_tool}),s.cwe_id&&e.jsx(T,{style:{fontSize:"10px"},children:s.cwe_id}),s.cve_id&&e.jsx(T,{color:"red",style:{fontSize:"10px"},children:s.cve_id}),l&&e.jsxs(T,{color:s.status==="resolved"?"green":"default",style:{marginLeft:8},children:[e.jsx(jp,{status:s.status}),e.jsx("span",{style:{marginLeft:4},children:$l[s.status]})]})]}),e.jsx(No,{strong:!0,style:{textDecoration:l?"line-through":"none",color:l?"#8c8c8c":"inherit",display:"block",marginBottom:4},children:s.title}),s.description&&e.jsx(J_,{type:"secondary",style:{fontSize:"12px",marginBottom:8,textDecoration:l?"line-through":"none"},ellipsis:{rows:2,expandable:!0},children:s.description}),e.jsxs(g,{size:16,style:{fontSize:"12px"},children:[s.file_path&&e.jsx(Ie,{title:"íŒŒì¼ ìœ„ì¹˜",children:e.jsxs(g,{size:4,children:[e.jsx(Fr,{style:{color:"#8c8c8c"}}),e.jsxs(No,{type:"secondary",style:{fontSize:"11px"},children:[s.file_path,s.line_number&&`:${s.line_number}`]})]})}),s.reference_url&&e.jsx(Ie,{title:"ì°¸ì¡° ë§í¬",children:e.jsxs("a",{href:s.reference_url,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"11px"},children:[e.jsx(Ea,{})," ì°¸ì¡°"]})}),s.recommendation&&e.jsx(Ie,{title:s.recommendation,children:e.jsxs(g,{size:4,style:{color:"#1890ff",cursor:"pointer"},children:[e.jsx(Ks,{}),e.jsx(No,{style:{fontSize:"11px",color:"#1890ff"},children:"ê¶Œì¥ì‚¬í•­"})]})})]}),s.resolved_at&&e.jsx("div",{style:{marginTop:8},children:e.jsxs(No,{type:"secondary",style:{fontSize:"11px"},children:[new Date(s.resolved_at).toLocaleString("ko-KR"),"ì— ì²˜ë¦¬ë¨",s.resolved_by&&` (${s.resolved_by})`]})})]}),e.jsx(uu,{menu:{items:p},trigger:["click"],children:e.jsx(B,{type:"text",size:"small",icon:e.jsx(qp,{}),disabled:a||r})})]})})},{Title:ek,Text:na}=we,Q_=s=>{if(!s)return"ì •ë³´ ì—†ìŒ";try{const t=new Date(s);return isNaN(t.getTime())?"ì •ë³´ ì—†ìŒ":t.toLocaleString("ko-KR")}catch(t){return"ì •ë³´ ì—†ìŒ"}},X_=({severity:s})=>{const t={critical:e.jsx(Pa,{style:{color:kn.critical}}),high:e.jsx(Tr,{style:{color:kn.high}}),medium:e.jsx(Yt,{style:{color:kn.medium}}),low:e.jsx(Ks,{style:{color:kn.low}}),info:e.jsx(Ks,{style:{color:kn.info}})};return e.jsx(e.Fragment,{children:t[s]})},ew=({severity:s,count:t,total:r})=>{const n={critical:"Critical",high:"High",medium:"Medium",low:"Low",info:"Info"},a=r>0?Math.round(t/r*100):0;return e.jsx(ie,{size:"small",style:{borderRadius:12,border:`1px solid ${kn[s]}20`,background:`linear-gradient(135deg, ${kn[s]}08 0%, ${kn[s]}15 100%)`},styles:{body:{padding:"16px"}},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[e.jsx(X_,{severity:s}),e.jsx(na,{style:{fontSize:13,fontWeight:500,color:"#666"},children:n[s]})]}),e.jsx("div",{style:{fontSize:28,fontWeight:700,color:kn[s]},children:t})]}),e.jsx("div",{style:{width:50,height:50},children:e.jsx(qt,{type:"circle",percent:a,size:50,strokeColor:kn[s],strokeWidth:8,format:()=>e.jsxs("span",{style:{fontSize:11,color:"#999"},children:[a,"%"]})})})]})})},tw=({total:s,resolved:t,open:r})=>{const n=s>0?Math.round(t/s*100):0;return e.jsx(ie,{size:"small",style:{borderRadius:12,background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",border:"1px solid #bae6fd"},styles:{body:{padding:"20px"}},children:e.jsxs(Ke,{gutter:24,align:"middle",children:[e.jsxs(Y,{flex:"1",children:[e.jsx("div",{style:{marginBottom:12},children:e.jsx(na,{strong:!0,style:{fontSize:16},children:"í•´ê²° ì§„í–‰ë¥ "})}),e.jsx(qt,{percent:n,strokeColor:{"0%":"#3b82f6","100%":"#10b981"},strokeWidth:12,style:{marginBottom:8}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(g,{children:[e.jsx(ps,{color:"#10b981"}),e.jsxs(na,{type:"secondary",style:{fontSize:12},children:["í•´ê²°ë¨: ",t]})]}),e.jsxs(g,{children:[e.jsx(ps,{color:"#ef4444"}),e.jsxs(na,{type:"secondary",style:{fontSize:12},children:["ë¯¸í•´ê²°: ",r]})]})]})]}),e.jsx(Y,{children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:36,fontWeight:700,color:n===100?"#10b981":"#3b82f6"},children:[n,"%"]}),e.jsx(na,{type:"secondary",style:{fontSize:12},children:"ì™„ë£Œ"})]})})]})})},sw=s=>{const t=Cu[s];return t?e.jsxs("div",{style:{maxWidth:280,padding:4},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsxs(na,{strong:!0,style:{color:"#fff",fontSize:14},children:[t.icon," ",t.label," ìœ„í—˜ë„"]}),e.jsx(T,{style:{marginLeft:8,fontSize:11,background:t.bgColor,color:t.color,border:"none"},children:t.cvssRange})]}),e.jsx("div",{style:{marginBottom:8,color:"rgba(255,255,255,0.9)",fontSize:12},children:t.description}),e.jsx("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:4,padding:"6px 8px",marginBottom:8},children:e.jsxs(na,{style:{color:"#ffd666",fontSize:11,fontWeight:500},children:["â° ",t.actionTimeframe]})}),e.jsx("div",{style:{color:"rgba(255,255,255,0.8)",fontSize:11,whiteSpace:"pre-line"},children:t.guidance})]}):null},rw=({category:s,isSelected:t,onClick:r})=>{const n=s.total_count>0,a=s.open_count>0,i=s.category_id.startsWith("CVE_"),l=i?Cu[s.category_id]:null,d=e.jsx(ie,{size:"small",hoverable:!0,onClick:r,style:{borderRadius:10,cursor:"pointer",border:t?`2px solid ${Xl[s.category_id]}`:"1px solid #e5e7eb",background:t?`${Xl[s.category_id]}08`:i&&l?l.bgColor:n?"#fff":"#fafafa",opacity:n?1:.6},styles:{body:{padding:"12px 16px"}},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i&&l&&e.jsx("span",{style:{fontSize:16},children:l.icon}),e.jsx(T,{color:Xl[s.category_id],style:{fontWeight:600,fontSize:11,margin:0,borderRadius:4},children:i&&l?l.label:s.category_id}),e.jsxs("div",{children:[e.jsx(na,{strong:!0,style:{fontSize:13},children:s.category_name_ko}),i&&l&&e.jsxs("div",{style:{fontSize:10,color:"#666",marginTop:2},children:[l.cvssRange," Â· ",l.actionTimeframe]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[a&&e.jsx(ps,{count:s.open_count,style:{backgroundColor:"#ef4444",fontSize:10}}),s.resolved_count>0&&e.jsx(ps,{count:s.resolved_count,style:{backgroundColor:"#10b981",fontSize:10}}),!n&&e.jsx(Ze,{style:{color:"#10b981",fontSize:16}})]})]})});return i?e.jsx(Ie,{title:sw(s.category_id),placement:"right",color:"#1f1f1f",children:d}):d},Tc=({repoId:s,onRefresh:t,compact:r=!1,analysisType:n="all",selectedImageName:a})=>{var ce,D,M,K,J;const[i,l]=o.useState(!0),[d,c]=o.useState(null),[p,h]=o.useState(null),[x,_]=o.useState(!1),[S,L]=o.useState(null),[k,E]=o.useState("all"),[P,I]=o.useState(!1),$=o.useCallback(async()=>{l(!0),c(null);try{const te=x?await go.getPendingVulnerabilities(s,n,a):await go.getCategorizedVulnerabilities(s,n,a);if(te.data){h(te.data);const G=te.data.categories.find(q=>q.open_count>0);G?L(G.category_id):te.data.categories.length>0&&L(te.data.categories[0].category_id)}}catch(te){Qo(te)?c(te.message):c("ì·¨ì•½ì  ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{l(!1)}},[s,x,n,a]);o.useEffect(()=>{$()},[$]);const y=async(te,G)=>{I(!0);try{await go.resolveVulnerability({service_id:s,item_id:te,status:G}),f.success(G==="open"?"ë¯¸í•´ê²°ë¡œ ë˜ëŒë ¸ìŠµë‹ˆë‹¤.":"ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤."),await $(),t==null||t()}catch(q){Qo(q)?f.error(q.message):f.error("ìƒíƒœ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{I(!1)}},v=te=>{_(te)};if(i)return e.jsxs("div",{style:{textAlign:"center",padding:"60px"},children:[e.jsx(gt,{size:"large"}),e.jsx("div",{style:{marginTop:16,color:"#666"},children:"ì·¨ì•½ì  ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]});if(d)return e.jsx(xe,{type:"error",message:"ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨",description:d,showIcon:!0,action:e.jsx("a",{onClick:$,children:"ë‹¤ì‹œ ì‹œë„"})});if(!p||p.categories.length===0)return e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsx("span",{children:x?"ë¯¸í•´ê²° ì·¨ì•½ì ì´ ì—†ìŠµë‹ˆë‹¤.":"ë¶„ì„ëœ ì·¨ì•½ì ì´ ì—†ìŠµë‹ˆë‹¤."})});const u=p.summary,m=(D=(ce=u.by_status)==null?void 0:ce.open)!=null?D:u.total_vulnerabilities,j=(K=(M=u.by_status)==null?void 0:M.resolved)!=null?K:0,b=u.total_vulnerabilities,A=p.categories.find(te=>te.category_id===S),W=(A==null?void 0:A.checklist_items.filter(te=>!(x&&te.status!=="open"||k!=="all"&&te.severity!==k)))||[],Z=p.categories.filter(te=>!x||te.open_count>0),se=n==="sca";return e.jsxs("div",{style:{padding:r?0:"8px"},children:[se&&!r&&e.jsx(xe,{type:"info",showIcon:!0,icon:e.jsx(Ks,{}),style:{marginBottom:16,borderRadius:8},message:e.jsx("span",{style:{fontWeight:600},children:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì·¨ì•½ì  ë¶„ì„ (SCA)"}),description:e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{marginBottom:8,color:"#666"},children:"CVE(Common Vulnerabilities and Exposures)ëŠ” ê³µê°œì ìœ¼ë¡œ ì•Œë ¤ì§„ ë³´ì•ˆ ì·¨ì•½ì  ì‹ë³„ìì…ë‹ˆë‹¤. CVSS ì ìˆ˜ì— ë”°ë¼ ìœ„í—˜ë„ê°€ ë¶„ë¥˜ë©ë‹ˆë‹¤."}),e.jsx(Ke,{gutter:[8,8],children:Object.values(Cu).map(te=>e.jsx(Y,{xs:12,sm:6,children:e.jsxs("div",{style:{background:te.bgColor,padding:"8px 12px",borderRadius:6,border:`1px solid ${te.color}20`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[e.jsx("span",{children:te.icon}),e.jsx(na,{strong:!0,style:{color:te.color,fontSize:13},children:te.label})]}),e.jsx("div",{style:{fontSize:11,color:"#666"},children:te.cvssRange}),e.jsx("div",{style:{fontSize:10,color:"#888",marginTop:2},children:te.actionTimeframe})]})},te.id))})]})}),!r&&e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(Ke,{gutter:[12,12],style:{marginBottom:16},children:["critical","high","medium","low"].map(te=>e.jsx(Y,{xs:12,sm:6,children:e.jsx(ew,{severity:te,count:u.by_severity[te]||0,total:b})},te))}),e.jsx(tw,{total:b,resolved:j,open:m})]}),e.jsx(ie,{size:"small",style:{marginBottom:16,borderRadius:10},styles:{body:{padding:"12px 16px"}},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[e.jsxs(g,{size:"middle",children:[e.jsxs(g,{children:[e.jsx(Qp,{style:{color:"#666"}}),e.jsx(na,{children:"ë¯¸í•´ê²°ë§Œ"}),e.jsx(Zr,{checked:x,onChange:v,size:"small"})]}),e.jsx(Fm,{value:k,onChange:te=>E(te),options:[{label:"ì „ì²´",value:"all"},{label:e.jsx(T,{color:kn.critical,style:{margin:0},children:"Critical"}),value:"critical"},{label:e.jsx(T,{color:kn.high,style:{margin:0},children:"High"}),value:"high"},{label:e.jsx(T,{color:kn.medium,style:{margin:0},children:"Medium"}),value:"medium"},{label:e.jsx(T,{color:kn.low,style:{margin:0},children:"Low"}),value:"low"}],size:"small"})]}),e.jsxs(na,{type:"secondary",style:{fontSize:12},children:["ë§ˆì§€ë§‰ ìŠ¤ìº”:"," ",Q_(p.timestamp||p.generated_at)]})]})}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{xs:24,lg:8,children:e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(pr,{}),e.jsxs("span",{children:["ì¹´í…Œê³ ë¦¬ (",Z.length,")"]})]}),size:"small",style:{borderRadius:10,marginBottom:16},styles:{body:{padding:12,maxHeight:500,overflow:"auto"}},children:e.jsx(g,{direction:"vertical",style:{width:"100%"},size:8,children:Z.map(te=>e.jsx(rw,{category:te,isSelected:S===te.category_id,onClick:()=>L(te.category_id)},te.category_id))})})}),e.jsx(Y,{xs:24,lg:16,children:A?e.jsx(ie,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(g,{children:[e.jsx(T,{color:Xl[A.category_id],style:{fontWeight:600,fontSize:12},children:A.category_id}),e.jsx("span",{style:{fontWeight:600},children:A.category_name_ko}),e.jsxs(na,{type:"secondary",style:{fontSize:12},children:["(",A.category_name,")"]})]}),e.jsxs(g,{size:4,children:[A.open_count>0&&e.jsxs(T,{color:"error",children:["ë¯¸í•´ê²° ",A.open_count]}),A.resolved_count>0&&e.jsxs(T,{color:"success",children:["í•´ê²° ",A.resolved_count]})]})]}),size:"small",style:{borderRadius:10},styles:{body:{padding:12,maxHeight:500,overflow:"auto"}},extra:e.jsx(Ie,{title:(J=q_[A.category_id])==null?void 0:J.description,children:e.jsx(Ks,{style:{color:"#999"}})}),children:W.length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:k!=="all"?`${k.toUpperCase()} ì‹¬ê°ë„ì˜ ì·¨ì•½ì ì´ ì—†ìŠµë‹ˆë‹¤.`:x?"ë¯¸í•´ê²° ì·¨ì•½ì ì´ ì—†ìŠµë‹ˆë‹¤.":"ì·¨ì•½ì ì´ ì—†ìŠµë‹ˆë‹¤.",style:{padding:"40px 0"}}):e.jsx("div",{children:W.map(te=>e.jsx(Z_,{item:te,onStatusChange:y,loading:P,compact:!0},te.item_id))})}):e.jsxs(ie,{size:"small",style:{borderRadius:10,textAlign:"center",padding:40},children:[e.jsx(mn,{style:{fontSize:48,color:"#d9d9d9",marginBottom:16}}),e.jsx("div",{children:e.jsx(na,{type:"secondary",children:"ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”"})})]})})]})]})},{Text:$n,Title:nw}=we,aw=({summary:s})=>{const t=Object.entries(s.by_category).filter(([,n])=>n>0).sort(([,n],[,a])=>a-n);if(t.length===0)return e.jsx($n,{type:"secondary",children:"ë¼ì´ì„ ìŠ¤ ì •ë³´ ì—†ìŒ"});const r=t.reduce((n,[,a])=>n+a,0);return e.jsxs(g,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsx("div",{style:{display:"flex",gap:2,height:8,borderRadius:4,overflow:"hidden"},children:t.map(([n,a])=>{const i=eu[n],l=a/r*100;return e.jsx(Ie,{title:`${(i==null?void 0:i.labelKo)||n}: ${a}`,children:e.jsx("div",{style:{width:`${l}%`,backgroundColor:(i==null?void 0:i.color)||"#8c8c8c",minWidth:4}})},n)})}),e.jsx(Ke,{gutter:[8,4],children:t.slice(0,4).map(([n,a])=>{const i=eu[n];return e.jsx(Y,{children:e.jsxs(T,{color:(i==null?void 0:i.color)||"default",style:{margin:0},children:[i==null?void 0:i.icon," ",(i==null?void 0:i.labelKo)||n,": ",a]})},n)})})]})},iw=({summary:s})=>{const t=Object.entries(s.by_risk||{}).filter(([,r])=>r>0).sort(([r],[n])=>{const a={critical:0,high:1,medium:2,low:3};return(a[r]||4)-(a[n]||4)});return t.length===0?null:e.jsx(g,{size:4,children:t.map(([r,n])=>e.jsxs(T,{color:K_[r]||"default",style:{margin:0},children:[r,": ",n]},r))})},ow=({sbom:s,loading:t=!1})=>{const{summary:r,license_summary:n,sbom_type:a,target_name:i,created_at:l}=s||{};return r?e.jsxs(ie,{loading:t,size:"small",styles:{body:{padding:16}},children:[e.jsxs(Ke,{justify:"space-between",align:"middle",style:{marginBottom:16},children:[e.jsx(Y,{children:e.jsxs(g,{size:8,children:[e.jsx(ai,{style:{fontSize:20,color:"#1890ff"}}),e.jsx(nw,{level:5,style:{margin:0},children:"SBOM ìš”ì•½"}),e.jsxs(T,{color:"blue",children:[r.format||"Unknown"," ",r.spec_version||"-"]}),e.jsx(T,{color:a==="image"?"purple":"cyan",children:a?Y_[a]:"-"})]})}),e.jsx(Y,{children:e.jsx(Ie,{title:"ìƒì„± ì¼ì‹œ",children:e.jsxs(g,{size:4,children:[e.jsx(wr,{}),e.jsx($n,{type:"secondary",children:l?new Date(l).toLocaleString("ko-KR"):"-"})]})})})]}),i&&e.jsxs("div",{style:{marginBottom:16,padding:"8px 12px",background:"#f5f5f5",borderRadius:4},children:[e.jsx($n,{strong:!0,children:"ëŒ€ìƒ: "}),e.jsx($n,{code:!0,children:i})]}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsxs(g,{size:4,children:[e.jsx(Yu,{}),e.jsx("span",{children:"ì´ ì»´í¬ë„ŒíŠ¸"})]}),value:r.total_components||0,valueStyle:{color:"#1890ff",fontSize:28}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsxs(g,{size:4,children:[e.jsx(Yu,{style:{transform:"rotate(90deg)"}}),e.jsx("span",{children:"ì´ ì˜ì¡´ì„±"})]}),value:r.total_dependencies||0,valueStyle:{color:"#722ed1",fontSize:28}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsxs(g,{size:4,children:[e.jsx(Bs,{}),e.jsx("span",{children:"ë¼ì´ì„ ìŠ¤"})]}),value:(n==null?void 0:n.total_licenses)||"-",valueStyle:{color:"#52c41a",fontSize:28}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsxs(g,{size:4,children:[e.jsx(Ks,{}),e.jsx("span",{children:"ê²€í†  í•„ìš”"})]}),value:(n==null?void 0:n.needs_review)||0,valueStyle:{color:((n==null?void 0:n.needs_review)||0)>0?"#faad14":"#52c41a",fontSize:28}})})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{style:{margin:"16px 0"}}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsxs(Y,{span:16,children:[e.jsx($n,{strong:!0,style:{display:"block",marginBottom:8},children:"ë¼ì´ì„ ìŠ¤ ë¶„í¬"}),e.jsx(aw,{summary:n})]}),e.jsxs(Y,{span:8,children:[e.jsx($n,{strong:!0,style:{display:"block",marginBottom:8},children:"ìœ„í—˜ë„ ë¶„í¬"}),e.jsx(iw,{summary:n})]})]})]}),r.sbom_uuid&&e.jsx("div",{style:{marginTop:16},children:e.jsxs($n,{type:"secondary",style:{fontSize:12},children:["SBOM UUID:"," ",e.jsx($n,{copyable:!0,style:{fontSize:12},children:r.sbom_uuid})]})})]}):e.jsx(ie,{size:"small",children:e.jsxs(g,{direction:"vertical",size:12,style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(ai,{style:{fontSize:20,color:"#1890ff",marginRight:8}}),e.jsx($n,{strong:!0,style:{fontSize:16},children:"SBOM/ë¼ì´ì„ ìŠ¤ ë¶„ì„ì´ë€?"})]}),e.jsx("div",{style:{paddingLeft:28},children:e.jsxs(g,{direction:"vertical",size:8,children:[e.jsxs("div",{children:[e.jsx(Bs,{style:{color:"#52c41a",marginRight:6}}),e.jsxs($n,{children:[e.jsx($n,{strong:!0,children:"SBOM(Software Bill of Materials)"}),"ì€ ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„±ìš”ì†Œ ëª©ë¡ì…ë‹ˆë‹¤."]})]}),e.jsx($n,{type:"secondary",style:{fontSize:12,display:"block"},children:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë‚˜ ì†ŒìŠ¤ì½”ë“œì— í¬í•¨ëœ ëª¨ë“  íŒ¨í‚¤ì§€, ë¼ì´ë¸ŒëŸ¬ë¦¬, ì˜ì¡´ì„± ì •ë³´ë¥¼ CycloneDX í˜•ì‹ìœ¼ë¡œ ì œê³µí•©ë‹ˆë‹¤."}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx(Ks,{style:{color:"#1890ff",marginRight:6}}),e.jsxs($n,{children:[e.jsx($n,{strong:!0,children:"ë¼ì´ì„ ìŠ¤ ë¶„ì„"}),"ì€ ê° êµ¬ì„±ìš”ì†Œì˜ ë¼ì´ì„ ìŠ¤ ì •ë³´ì™€ ìœ„í—˜ë„ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤."]})]}),e.jsx($n,{type:"secondary",style:{fontSize:12,display:"block"},children:"SBOM ìƒì„± ì˜µì…˜ì„ í™œì„±í™”í•˜ë©´, ì·¨ì•½ì  ë¶„ì„ê³¼ í•¨ê»˜ SBOM ë° ë¼ì´ì„ ìŠ¤ ì •ë³´ê°€ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤."})]})})]})})},Ol={osv:"#1890ff",trivy:"#52c41a",semgrep:"#722ed1",codeql:"#3b82f6"},lw={osv:"OSV API",trivy:"Trivy SCA",semgrep:"Semgrep SAST",codeql:"CodeQL SAST"},On={critical:"#cf1322",high:"#fa541c",medium:"#faad14",low:"#52c41a"},Ox={critical:"Critical",high:"High",medium:"Medium",low:"Low"},tu={critical:"ì‹¬ê°",high:"ë†’ìŒ",medium:"ì¤‘ê°„",low:"ë‚®ìŒ"},cw={open:"#fa541c",ignored:"#8c8c8c",resolved:"#52c41a"},dw={open:"ë¯¸í•´ê²°",ignored:"ë¬´ì‹œë¨",resolved:"í•´ê²°ë¨"};function uw(s){try{return JSON.parse(s)||[]}catch(t){return[]}}function hw(s){return s?s.split(",").map(t=>t.trim()).filter(Boolean):[]}const{Text:Ta,Link:pw}=we,gw={library:"blue",framework:"purple",application:"green",container:"orange","operating-system":"red",device:"cyan",file:"default"},bp=s=>{if(!s)return"unknown";const t=s.match(/^pkg:([^/]+)\//);return t?t[1]:"unknown"},xw=({license:s})=>{const r=(l=>{if(typeof l=="string"){if(l.startsWith("ë¼ì´ì„ ìŠ¤:")||l.startsWith("["))try{const d=JSON.parse(l.replace(/^ë¼ì´ì„ ìŠ¤:\s*/,"").replace(/^\[|\]$/g,""));if(d&&typeof d=="object")return d.name||d.id||d.license||l}catch(d){return l}return l}if(l&&typeof l=="object"){const d=typeof l.id=="string"?l.id:"",c=typeof l.name=="string"?l.name:"",p=typeof l.license=="string"?l.license:"",h=d||c||p;if(h)return h;const _=JSON.stringify(l).match(/"name"\s*:\s*"([^"]+)"/);return _?_[1]:"Unknown"}return String(l||"Unknown")})(s),a=(l=>{if(!l||typeof l!="string")return null;const d=l.toUpperCase();return["MIT","APACHE","BSD","ISC","UNLICENSE","0BSD"].some(c=>d.includes(c))?"permissive":["LGPL","MPL","EPL","CDDL"].some(c=>d.includes(c))?"weak_copyleft":["GPL","AGPL","SSPL"].some(c=>d.includes(c))?"strong_copyleft":["COMMERCIAL","PROPRIETARY"].some(c=>d.includes(c))?"proprietary":null})(r),i=a?eu[a]:null;return e.jsx(Ie,{title:i==null?void 0:i.description,children:e.jsxs(T,{color:(i==null?void 0:i.color)||"default",style:{margin:"2px 4px 2px 0"},children:[i==null?void 0:i.icon," ",r]})})},mw=({refs:s})=>{if(s.length===0)return e.jsx(Ta,{type:"secondary",children:"-"});const t=e.jsx(g,{direction:"vertical",size:4,style:{maxWidth:400},children:s.map((r,n)=>e.jsxs("div",{children:[e.jsx(T,{color:"default",style:{marginRight:4},children:r.type}),e.jsx(pw,{href:r.url,target:"_blank",ellipsis:!0,style:{maxWidth:280},children:r.url})]},n))});return e.jsx(Xp,{content:t,title:"ì™¸ë¶€ ì°¸ì¡°",trigger:"click",children:e.jsxs(B,{type:"link",size:"small",icon:e.jsx(Bd,{}),children:[s.length,"ê°œ"]})})},fw=({components:s,loading:t=!1,pageSize:r=20,vulnerabilities:n=[],onViewVulnerability:a})=>{const[i,l]=o.useState(""),[d,c]=o.useState("all"),[p,h]=o.useState("all"),[x,_]=o.useState("all"),[S,L]=o.useState({columnKey:"vulnerabilities",order:"descend"});o.useEffect(()=>{n.length>0&&L({columnKey:"vulnerabilities",order:"descend"})},[n.length]);const k=o.useMemo(()=>{const y=new Map;return n.forEach(v=>{var A,W;const u=((A=v.component_name)==null?void 0:A.toLowerCase().trim())||"",m=((W=v.component_version)==null?void 0:W.toLowerCase().trim())||"",j=`${u}@${m}`;y.has(j)||y.set(j,{total:0,critical:0,high:0,medium:0,low:0,vulnerabilities:[]});const b=y.get(j);switch(b.total+=1,b.vulnerabilities.push(v),v.severity){case"critical":b.critical+=1;break;case"high":b.high+=1;break;case"medium":b.medium+=1;break;case"low":b.low+=1;break}}),y},[n]),E=o.useCallback((y,v)=>{const u=(y==null?void 0:y.toLowerCase().trim())||"",m=(v==null?void 0:v.toLowerCase().trim())||"",j=`${u}@${m}`;if(k.has(j))return k.get(j);for(const[b,A]of k.entries()){const[W]=b.split("@");if(W===u||u.includes(W)||W.includes(u))return A}return null},[k]),P=o.useMemo(()=>{const y=new Set;return s.forEach(v=>{v.licenses&&Array.isArray(v.licenses)&&v.licenses.forEach(u=>{if(u){const m=typeof u=="string"?u:u&&typeof u=="object"?u.id||u.name||u.license:String(u);m&&y.add(m)}})}),Array.from(y).sort()},[s]),I=o.useMemo(()=>{const y=u=>{if(typeof u=="string"){if(u.startsWith("ë¼ì´ì„ ìŠ¤:")||u.startsWith("["))try{const m=JSON.parse(u.replace(/^ë¼ì´ì„ ìŠ¤:\s*/,"").replace(/^\[|\]$/g,""));if(m&&typeof m=="object")return m.name||m.id||m.license||u}catch(m){return u}return u}if(u&&typeof u=="object"){const m=typeof u.id=="string"?u.id:"",j=typeof u.name=="string"?u.name:"",b=typeof u.license=="string"?u.license:"",A=m||j||b;if(A)return A;const Z=JSON.stringify(u).match(/"name"\s*:\s*"([^"]+)"/);return Z?Z[1]:""}return String(u||"")};return s.filter(u=>{var m,j;if(i){const b=i.toLowerCase();if(!(u.name&&u.name.toLowerCase().includes(b)||u.version&&u.version.toLowerCase().includes(b)||u.purl&&u.purl.toLowerCase().includes(b)||((m=u.licenses)==null?void 0:m.some(W=>y(W).toLowerCase().includes(b)))))return!1}if(d!=="all"&&u.type!==d||p!=="all"&&!((j=u.licenses)==null?void 0:j.some(A=>y(A)===p)))return!1;if(x!=="all"){const b=E(u.name||"",u.version||""),A=b!==null&&b.total>0;if(x==="vulnerable"&&!A||x==="safe"&&A)return!1}return!0})},[s,i,d,p,x,E]),$=[{title:"ì»´í¬ë„ŒíŠ¸",dataIndex:"name",key:"name",width:200,ellipsis:!0,sorter:(y,v)=>(y.name||"").localeCompare(v.name||""),render:(y,v)=>e.jsxs(g,{direction:"vertical",size:0,children:[e.jsx(Ta,{strong:!0,ellipsis:!0,style:{maxWidth:180},children:e.jsx(Ie,{title:y||"-",children:y||"-"})}),v.description&&e.jsx(Ta,{type:"secondary",style:{fontSize:12},ellipsis:!0,children:v.description})]})},{title:"ë²„ì „",dataIndex:"version",key:"version",width:120,sorter:(y,v)=>(y.version||"").localeCompare(v.version||""),render:y=>e.jsx(Ta,{code:!0,style:{fontSize:12},children:y||"-"})},...n.length>0?[{title:e.jsx(Ie,{title:"ë³´ì•ˆ ì·¨ì•½ì  ì •ë³´",children:e.jsxs(g,{size:4,children:[e.jsx(mn,{style:{color:"#cf1322"}}),e.jsx("span",{children:"ì·¨ì•½ì "})]})}),key:"vulnerabilities",width:150,sortOrder:S.columnKey==="vulnerabilities"?S.order:null,sorter:(y,v)=>{const u=E(y.name||"",y.version||""),m=E(v.name||"",v.version||""),j=((u==null?void 0:u.critical)||0)*1e3+((u==null?void 0:u.high)||0)*100+((u==null?void 0:u.medium)||0)*10+((u==null?void 0:u.low)||0),b=((m==null?void 0:m.critical)||0)*1e3+((m==null?void 0:m.high)||0)*100+((m==null?void 0:m.medium)||0)*10+((m==null?void 0:m.low)||0);return j-b},render:(y,v)=>{const u=E(v.name||"",v.version||"");if(!u||u.total===0)return e.jsx(Ie,{title:"ì·¨ì•½ì  ì—†ìŒ",children:e.jsxs(T,{color:"success",style:{margin:0},children:[e.jsx(Bs,{})," ì•ˆì „"]})});const m=e.jsxs("div",{style:{maxWidth:350},children:[e.jsxs("div",{style:{marginBottom:8,fontWeight:500},children:["ì´ ",u.total,"ê°œì˜ ì·¨ì•½ì  ë°œê²¬"]}),e.jsxs(g,{direction:"vertical",size:4,style:{width:"100%"},children:[u.vulnerabilities.slice(0,5).map((j,b)=>e.jsxs("div",{style:{padding:"4px 8px",borderRadius:4,backgroundColor:On[j.severity]+"15",borderLeft:`3px solid ${On[j.severity]}`,cursor:a?"pointer":"default"},onClick:()=>a==null?void 0:a(j),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Ta,{strong:!0,style:{fontSize:12},children:j.cve_id}),e.jsx(T,{color:On[j.severity],style:{margin:0,fontSize:10},children:tu[j.severity]})]}),e.jsx(Ta,{type:"secondary",style:{fontSize:11},ellipsis:!0,children:j.title})]},b)),u.total>5&&e.jsxs(Ta,{type:"secondary",style:{fontSize:11,textAlign:"center",display:"block"},children:["ì™¸ ",u.total-5,"ê°œ ë” ìˆìŒ..."]})]})]});return e.jsx(Xp,{content:m,title:e.jsxs(g,{children:[e.jsx(Yt,{style:{color:"#cf1322"}}),"ì·¨ì•½ì  ëª©ë¡"]}),trigger:"hover",placement:"right",children:e.jsx("div",{style:{cursor:"pointer"},children:e.jsxs(g,{size:4,wrap:!0,children:[u.critical>0&&e.jsxs(T,{color:On.critical,style:{margin:0,fontSize:11},children:["C:",u.critical]}),u.high>0&&e.jsxs(T,{color:On.high,style:{margin:0,fontSize:11},children:["H:",u.high]}),u.medium>0&&e.jsxs(T,{color:On.medium,style:{margin:0,fontSize:11},children:["M:",u.medium]}),u.low>0&&e.jsxs(T,{color:On.low,style:{margin:0,fontSize:11},children:["L:",u.low]})]})})})}}]:[],{title:"íƒ€ì…",dataIndex:"type",key:"type",width:110,filters:Object.entries(wd).map(([y,v])=>({text:v,value:y})),onFilter:(y,v)=>v.type===y,render:y=>e.jsx(T,{color:gw[y]||"default",children:wd[y]||y})},{title:"íŒ¨í‚¤ì§€ íƒ€ì…",key:"packageType",width:100,render:(y,v)=>{const u=bp(v.purl);return e.jsx(T,{color:"default",style:{fontFamily:"monospace"},children:u})}},{title:"ë¼ì´ì„ ìŠ¤",dataIndex:"licenses",key:"licenses",width:200,render:y=>{if(!y||!Array.isArray(y)||y.length===0)return e.jsx(Ta,{type:"secondary",children:"-"});const v=u=>{if(typeof u=="string"){if(u.startsWith("ë¼ì´ì„ ìŠ¤:")||u.startsWith("["))try{const m=JSON.parse(u.replace(/^ë¼ì´ì„ ìŠ¤:\s*/,"").replace(/^\[|\]$/g,""));if(m&&typeof m=="object")return m.name||m.id||m.license||u}catch(m){return u}return u}if(u&&typeof u=="object"){const m=typeof u.id=="string"?u.id:"",j=typeof u.name=="string"?u.name:"",b=typeof u.license=="string"?u.license:"",A=m||j||b;if(A)return A;const Z=JSON.stringify(u).match(/"name"\s*:\s*"([^"]+)"/);return Z?Z[1]:"Unknown"}return String(u||"Unknown")};return e.jsxs("div",{style:{maxWidth:180},children:[y.slice(0,2).map((u,m)=>e.jsx(xw,{license:u},m)),y.length>2&&e.jsx(Ie,{title:y.slice(2).map(v).join(", "),children:e.jsxs(T,{color:"default",children:["+",y.length-2]})})]})}},{title:"PURL",dataIndex:"purl",key:"purl",width:220,render:y=>{if(!y)return e.jsx(Ta,{type:"secondary",children:"-"});const u=(j=>{try{const A=j.split("@")[0].split("/");return A[A.length-1]||j}catch(b){return j}})(y),m=bp(y);return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:4},children:e.jsx(Ta,{strong:!0,style:{fontSize:13},children:u})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(T,{color:"blue",style:{fontSize:10,padding:"0 4px",margin:0},children:m}),e.jsx(Ie,{title:`ì „ì²´ PURL: ${y}`,children:e.jsx(B,{type:"text",size:"small",icon:e.jsx(Nd,{}),onClick:()=>{navigator.clipboard.writeText(y),f.success("PURLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤")},style:{padding:0,height:18,fontSize:11}})})]})]})}},{title:"ì°¸ì¡°",dataIndex:"externalReferences",key:"externalReferences",width:80,align:"center",render:y=>y&&y.length>0?e.jsx(mw,{refs:y}):e.jsx(Ta,{type:"secondary",children:"-"})}];return e.jsxs("div",{children:[e.jsxs(g,{style:{marginBottom:16,flexWrap:"wrap"},size:12,children:[e.jsx(ue,{placeholder:"ì»´í¬ë„ŒíŠ¸ ê²€ìƒ‰...",prefix:e.jsx(Fi,{}),value:i,onChange:y=>l(y.target.value),style:{width:250},allowClear:!0}),e.jsx(Ee,{placeholder:"íƒ€ì… í•„í„°",value:d,onChange:c,style:{width:140},options:[{label:"ëª¨ë“  íƒ€ì…",value:"all"},...Object.entries(wd).map(([y,v])=>({label:v,value:y}))]}),e.jsx(Ee,{placeholder:"ë¼ì´ì„ ìŠ¤ í•„í„°",value:p,onChange:h,style:{width:180},showSearch:!0,allowClear:!0,options:[{label:"ëª¨ë“  ë¼ì´ì„ ìŠ¤",value:"all"},...P.map(y=>({label:y,value:y}))]}),n.length>0&&e.jsx(Ee,{placeholder:"ì·¨ì•½ì  í•„í„°",value:x,onChange:_,style:{width:160},options:[{label:"ëª¨ë“  ì»´í¬ë„ŒíŠ¸",value:"all"},{label:"ğŸ”´ ì·¨ì•½ì  ìˆìŒ",value:"vulnerable"},{label:" ì•ˆì „",value:"safe"}]}),e.jsx(ps,{count:I.length,showZero:!0,color:"#1890ff",children:e.jsx(T,{icon:e.jsx(Qp,{}),children:"í•„í„° ê²°ê³¼"})})]}),e.jsx(wt,{columns:$,dataSource:I,rowKey:y=>`${y.purl}-${y.version}`,loading:t,size:"middle",onChange:(y,v,u)=>{L(u)},pagination:{pageSize:r,showSizeChanger:!0,showTotal:(y,v)=>`${v[0]}-${v[1]} / ì´ ${y}ê°œ`,pageSizeOptions:["10","20","50","100"]},scroll:{x:1200},locale:{emptyText:i||d!=="all"||p!=="all"?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤":"ì»´í¬ë„ŒíŠ¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤"},rowClassName:(y,v)=>v%2===0?"":"sbom-table-row-alt",style:{background:"#fff",borderRadius:8}})]})},Ca="/vuln",Sd={checkVulnerabilities:async(s,t="all",r="all")=>{const n=new URLSearchParams;t!=="all"&&n.append("severity",t),r!=="all"&&n.append("status",r);const a=n.toString(),i=`${Ca}/check/${s}${a?`?${a}`:""}`;return Kn.get(i)},getServiceSummary:async s=>Kn.get(`${Ca}/summary/${s}`),getCombinedVulnerabilities:async(s,t="all",r,n="all")=>{const a=new URLSearchParams;t!=="all"&&a.append("severity",t),r&&a.append("image",r),n!=="all"&&a.append("source_type",n);const i=a.toString(),l=`${Ca}/combined/${s}${i?`?${i}`:""}`;return Kn.get(l)},scanVulnerabilities:async s=>Kn.post(`${Ca}/scan`,s),rescanVulnerabilities:async(s,t)=>{const r=t?`?service_id=${t}`:"";return Kn.post(`${Ca}/rescan/${s}${r}`,{})},ignoreVulnerability:async s=>Kn.post(`${Ca}/ignore`,s),unignoreVulnerability:async s=>Kn.delete(`${Ca}/ignore/${s}`),getIgnoredVulnerabilities:async s=>Kn.get(`${Ca}/ignored/${s}`),createException:async s=>Kn.post(`${Ca}/exception`,s),getExceptions:async s=>{const t=s?`?service_id=${s}`:"";return Kn.get(`${Ca}/exceptions${t}`)},deleteException:async s=>Kn.delete(`${Ca}/exception/${s}`)},{Text:oo}=we,yw=({summary:s,loading:t=!1,onViewDetails:r,onRescan:n,compact:a=!1})=>{var L,k,E,P,I,$,y;const i=(k=(L=s==null?void 0:s.open_critical)!=null?L:s==null?void 0:s.critical_count)!=null?k:0,l=(P=(E=s==null?void 0:s.open_high)!=null?E:s==null?void 0:s.high_count)!=null?P:0,d=(I=s==null?void 0:s.total_vulnerabilities)!=null?I:0,c=(y=($=s==null?void 0:s.patchable_count)!=null?$:s==null?void 0:s.patchable_count)!=null?y:0;if(!t&&d===0)return e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(pr,{style:{color:"#52c41a"}}),e.jsx(oo,{strong:!0,children:"ë³´ì•ˆ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤"})]}),type:"success",showIcon:!1,style:{marginBottom:16}});if(!t&&i===0&&l===0)return e.jsx(xe,{message:e.jsxs(g,{size:"middle",wrap:!0,children:[e.jsxs(g,{children:[e.jsx(Ze,{style:{color:"#52c41a"}}),e.jsx(oo,{children:"ì‹¬ê°í•œ ì·¨ì•½ì ì´ ì—†ìŠµë‹ˆë‹¤"})]}),d>0&&e.jsxs(oo,{type:"secondary",children:["(Medium/Low ",d,"ê±´)"]}),r&&e.jsxs(B,{type:"link",size:"small",onClick:r,children:["ìƒì„¸ ë³´ê¸° ",e.jsx(Md,{})]})]}),type:"info",showIcon:!1,style:{marginBottom:16}});const p=i>0,h=p?"error":"warning",x=p?e.jsx(Tr,{}):e.jsx(Yt,{}),_=i+l,S=_>0?Math.round(c/_*100):0;return a?e.jsx(xe,{message:e.jsxs(g,{size:"middle",children:[i>0&&e.jsxs(T,{color:On.critical,children:["Critical ",i]}),l>0&&e.jsxs(T,{color:On.high,children:["High ",l]}),c>0&&e.jsx(Ie,{title:"íŒ¨ì¹˜ ê°€ëŠ¥í•œ ì·¨ì•½ì ",children:e.jsxs(T,{color:"blue",children:[c,"ê±´ íŒ¨ì¹˜ ê°€ëŠ¥"]})}),r&&e.jsx(B,{type:"link",size:"small",onClick:r,children:"ìƒì„¸ ë³´ê¸°"})]}),type:h,icon:x,showIcon:!0,style:{marginBottom:16}}):e.jsx(xe,{message:e.jsxs(g,{direction:"vertical",size:8,style:{width:"100%"},children:[e.jsxs(g,{size:"middle",wrap:!0,style:{justifyContent:"space-between",width:"100%"},children:[e.jsxs(g,{size:"middle",children:[e.jsx(oo,{strong:!0,style:{fontSize:14},children:p?"ì‹¬ê°í•œ ë³´ì•ˆ ì·¨ì•½ì  ë°œê²¬":"ë³´ì•ˆ ì·¨ì•½ì  ë°œê²¬"}),e.jsxs(g,{size:4,children:[i>0&&e.jsxs(T,{color:On.critical,style:{margin:0},children:[tu.critical," ",i,"ê±´"]}),l>0&&e.jsxs(T,{color:On.high,style:{margin:0},children:[tu.high," ",l,"ê±´"]})]})]}),e.jsxs(g,{children:[n&&e.jsx(Ie,{title:"ì·¨ì•½ì  ì¬ìŠ¤ìº”",children:e.jsx(B,{size:"small",icon:e.jsx(Pt,{spin:t}),onClick:n,loading:t,children:"ì¬ìŠ¤ìº”"})}),r&&e.jsxs(B,{type:"primary",size:"small",onClick:r,children:["ìƒì„¸ ë³´ê¸° ",e.jsx(Md,{})]})]})]}),c>0&&e.jsxs(g,{size:"middle",style:{marginTop:4},children:[e.jsxs(oo,{type:"secondary",style:{fontSize:12},children:["íŒ¨ì¹˜ ê°€ëŠ¥: ",c,"ê±´ (",S,"%)"]}),e.jsx(qt,{percent:S,size:"small",style:{width:120},strokeColor:"#1890ff",showInfo:!1}),e.jsx(oo,{type:"secondary",style:{fontSize:12},children:"ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—…ê·¸ë ˆì´ë“œë¡œ í•´ê²° ê°€ëŠ¥"})]})]}),type:h,icon:x,showIcon:!0,style:{marginBottom:16}})},{Text:tk,Link:sk}=we,{Text:Ba,Link:vd,Paragraph:jw,Title:bw}=we,_w=({visible:s,vulnerability:t,onClose:r,onIgnore:n})=>{var p,h;if(!t)return null;const a=uw(t.references),i=hw(t.cwe_ids),l=(p=t.cve_id)==null?void 0:p.startsWith("CVE-"),d=()=>{t.upgrade_command&&(navigator.clipboard.writeText(t.upgrade_command),f.success("ì—…ê·¸ë ˆì´ë“œ ëª…ë ¹ì–´ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤"))},c=()=>{navigator.clipboard.writeText(t.cve_id),f.success("CVE IDê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤")};return e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(Yt,{style:{color:On[t.severity]}}),e.jsx("span",{children:"ì·¨ì•½ì  ìƒì„¸ ì •ë³´"}),e.jsx(T,{color:On[t.severity],children:Ox[t.severity]})]}),open:s,onCancel:r,width:800,footer:[t.status==="open"&&n&&e.jsx(B,{danger:!0,onClick:()=>{n(t),r()},children:"ë¬´ì‹œí•˜ê¸°"},"ignore"),e.jsx(B,{type:"primary",onClick:r,children:"ë‹«ê¸°"},"close")],children:[t.patch_available&&e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(pr,{}),e.jsx(Ba,{strong:!0,children:"íŒ¨ì¹˜ ê°€ëŠ¥"}),e.jsxs(Ba,{children:["ë²„ì „ ",e.jsx(Ba,{code:!0,children:t.fixed_version}),"ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]})]}),type:"success",showIcon:!1,style:{marginBottom:16},action:t.upgrade_command&&e.jsx(B,{size:"small",type:"primary",onClick:d,children:"ëª…ë ¹ì–´ ë³µì‚¬"})}),e.jsxs(Se,{column:2,bordered:!0,size:"small",children:[e.jsx(Se.Item,{label:"CVE ID",span:1,children:e.jsxs(g,{children:[e.jsxs(vd,{href:l?`https://nvd.nist.gov/vuln/detail/${t.cve_id}`:`https://osv.dev/vulnerability/${t.cve_id}`,target:"_blank",children:[t.cve_id," ",e.jsx(Bd,{})]}),e.jsx(Ie,{title:"ë³µì‚¬",children:e.jsx(B,{type:"text",size:"small",icon:e.jsx(Nd,{}),onClick:c})})]})}),e.jsx(Se.Item,{label:"CVSS ì ìˆ˜",span:1,children:e.jsxs(g,{children:[e.jsx(T,{color:On[t.severity],style:{fontWeight:"bold",fontSize:14},children:t.cvss_score.toFixed(1)}),e.jsxs(Ba,{type:"secondary",children:["(",t.cvss_version||"CVSS 3.1",")"]})]})}),e.jsx(Se.Item,{label:"ìƒíƒœ",span:1,children:e.jsx(T,{color:cw[t.status],children:dw[t.status]})}),e.jsx(Se.Item,{label:"ë°ì´í„° ì†ŒìŠ¤",span:1,children:e.jsx(T,{children:((h=t.data_source)==null?void 0:h.toUpperCase())||"OSV"})}),e.jsx(Se.Item,{label:"ì»´í¬ë„ŒíŠ¸",span:2,children:e.jsxs(g,{direction:"vertical",size:0,children:[e.jsx(Ba,{strong:!0,children:t.component_name}),e.jsxs(Ba,{type:"secondary",children:["ë²„ì „: ",t.component_version||"-"]}),t.purl&&e.jsxs(Ba,{type:"secondary",copyable:{text:t.purl},children:["PURL: ",t.purl]})]})})]}),e.jsx(xt,{orientation:"left",style:{marginTop:24},children:e.jsxs(g,{children:[e.jsx(Yt,{}),"ì·¨ì•½ì  ì •ë³´"]})}),e.jsx(bw,{level:5,style:{marginBottom:8},children:t.title||"ì œëª© ì—†ìŒ"}),e.jsx(jw,{ellipsis:{rows:5,expandable:!0,symbol:"ë” ë³´ê¸°"},style:{marginBottom:16},children:t.description||"ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤."}),i.length>0&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(Ba,{strong:!0,children:"CWE: "}),e.jsx(g,{size:4,wrap:!0,children:i.map(x=>e.jsx(vd,{href:`https://cwe.mitre.org/data/definitions/${x.replace("CWE-","")}.html`,target:"_blank",children:e.jsx(T,{children:x})},x))})]}),t.patch_available&&t.fixed_version&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",children:e.jsxs(g,{children:[e.jsx(Ze,{style:{color:"#52c41a"}}),"í•´ê²° ë°©ë²•"]})}),e.jsxs(Se,{column:1,bordered:!0,size:"small",children:[e.jsx(Se.Item,{label:"ìˆ˜ì •ëœ ë²„ì „",children:e.jsx(T,{color:"blue",style:{fontSize:14},children:t.fixed_version})}),t.upgrade_command&&e.jsx(Se.Item,{label:"ì—…ê·¸ë ˆì´ë“œ ëª…ë ¹ì–´",children:e.jsxs(g,{style:{width:"100%",justifyContent:"space-between"},children:[e.jsx(Ba,{code:!0,style:{fontSize:13},children:t.upgrade_command}),e.jsx(B,{type:"primary",size:"small",icon:e.jsx(Nd,{}),onClick:d,children:"ë³µì‚¬"})]})})]})]}),a.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",children:e.jsxs(g,{children:[e.jsx(Bd,{}),"ì°¸ì¡° (",a.length,"ê°œ)"]})}),e.jsx(ar,{size:"small",dataSource:a.slice(0,10),renderItem:x=>e.jsx(ar.Item,{style:{padding:"4px 0"},children:e.jsx(vd,{href:x,target:"_blank",ellipsis:!0,style:{maxWidth:"100%"},children:x})}),style:{maxHeight:200,overflow:"auto"}}),a.length>10&&e.jsxs(Ba,{type:"secondary",style:{display:"block",marginTop:8},children:["ì™¸ ",a.length-10,"ê°œì˜ ì°¸ì¡° URLì´ ìˆìŠµë‹ˆë‹¤."]})]}),e.jsx(xt,{orientation:"left",children:e.jsxs(g,{children:[e.jsx(wr,{}),"íƒ€ì„ë¼ì¸"]})}),e.jsxs(Se,{column:2,size:"small",children:[e.jsx(Se.Item,{label:"ê³µê°œì¼",children:t.published_at?new Date(t.published_at).toLocaleDateString("ko-KR"):"-"}),e.jsx(Se.Item,{label:"ìˆ˜ì •ì¼",children:t.modified_at?new Date(t.modified_at).toLocaleDateString("ko-KR"):"-"}),e.jsx(Se.Item,{label:"ë°œê²¬ì¼",children:new Date(t.created_at).toLocaleDateString("ko-KR")}),t.status==="ignored"&&t.ignored_at&&e.jsxs(Se.Item,{label:"ë¬´ì‹œ ì²˜ë¦¬ì¼",children:[new Date(t.ignored_at).toLocaleDateString("ko-KR"),t.ignored_by&&` (${t.ignored_by})`]})]}),t.status==="ignored"&&t.ignored_reason&&e.jsx(xe,{message:"ë¬´ì‹œ ì‚¬ìœ ",description:t.ignored_reason,type:"warning",style:{marginTop:16}})]})},{TextArea:ww}=ue,{Text:Bo}=we,Sw=({visible:s,vulnerability:t,loading:r=!1,onConfirm:n,onCancel:a})=>{const[i]=H.useForm(),[l,d]=o.useState(!1),c=async()=>{try{const h=await i.validateFields();d(!0),t&&(await n(t.id,h.reason),i.resetFields(),f.success("ì·¨ì•½ì ì´ ë¬´ì‹œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤"))}catch(h){}finally{d(!1)}},p=()=>{i.resetFields(),a()};return t?e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(Yt,{style:{color:"#faad14"}}),e.jsx("span",{children:"ì·¨ì•½ì  ë¬´ì‹œ"})]}),open:s,onOk:c,onCancel:p,confirmLoading:l||r,okText:"ë¬´ì‹œí•˜ê¸°",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},width:600,children:[e.jsx(xe,{message:"ì£¼ì˜: ì´ ì‘ì—…ì€ ê°ì‚¬ ë¡œê·¸ì— ê¸°ë¡ë©ë‹ˆë‹¤",description:"ë¬´ì‹œëœ ì·¨ì•½ì ì€ ê²½ê³ ì—ì„œ ì œì™¸ë˜ì§€ë§Œ, ì‹¤ì œ ìœ„í—˜ì´ ì™„ì „íˆ ì‚¬ë¼ì§€ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. íƒ€ë‹¹í•œ ì‚¬ìœ ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ ë¬´ì‹œ ì²˜ë¦¬í•´ ì£¼ì„¸ìš”.",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx("div",{style:{background:"#fafafa",padding:12,borderRadius:8,marginBottom:16},children:e.jsxs(g,{direction:"vertical",size:4,children:[e.jsxs(g,{children:[e.jsx(T,{color:On[t.severity],children:Ox[t.severity]}),e.jsx(Bo,{strong:!0,children:t.cve_id}),e.jsxs(Bo,{type:"secondary",children:["CVSS ",t.cvss_score.toFixed(1)]})]}),e.jsxs(Bo,{children:[t.component_name,"@",t.component_version]}),e.jsx(Bo,{type:"secondary",ellipsis:!0,children:t.title})]})}),e.jsx(H,{form:i,layout:"vertical",children:e.jsx(H.Item,{name:"reason",label:"ë¬´ì‹œ ì‚¬ìœ ",rules:[{required:!0,message:"ë¬´ì‹œ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"},{min:10,message:"ìµœì†Œ 10ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ww,{rows:4,placeholder:"ì´ ì·¨ì•½ì ì„ ë¬´ì‹œí•˜ëŠ” ì‚¬ìœ ë¥¼ ìƒì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì˜ˆ: í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ, ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥, ë‹¤ë¥¸ ë³´ì•ˆ ì¡°ì¹˜ë¡œ ì™„í™”ë¨ ë“±)",maxLength:500,showCount:!0})})}),e.jsx(Bo,{type:"secondary",style:{fontSize:12},children:"* ë¬´ì‹œëœ ì·¨ì•½ì ì€ ì–¸ì œë“ ì§€ ë¬´ì‹œ í•´ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})]}):null},pc=({serviceId:s,loading:t=!1,onRefresh:r,selectedImageName:n,sbomType:a})=>{var Ue;const[i,l]=o.useState(!1),[d,c]=o.useState([]),[p,h]=o.useState(null),[x,_]=o.useState(null),[S,L]=o.useState(!1),[k,E]=o.useState(null),[P,I]=o.useState([]),[$,y]=o.useState([]),[v,u]=o.useState([]),[m,j]=o.useState(!1),[b,A]=o.useState(null),[W,Z]=o.useState(null),[se,ce]=o.useState(!1),[D,M]=o.useState(!1),K=o.useCallback(async()=>{if(s){l(!0),E(null);try{const N=await Xt.getSbomResults(s),ge=N.data,Ce=(ge==null?void 0:ge.sboms)||(ge==null?void 0:ge.results)||[];let je=Array.isArray(Ce)?Ce:[];if(a&&je.length>0&&(a==="image"?je=je.filter(Pe=>{var w,R;return Pe.sbom_type==="image"||((w=Pe.sbom_type)==null?void 0:w.includes("image"))||((R=Pe.sbom_type)==null?void 0:R.includes("container"))}):a==="source"?je=je.filter(Pe=>{var w,R,U;return Pe.sbom_type==="source"||((w=Pe.sbom_type)==null?void 0:w.includes("source"))||((R=Pe.sbom_type)==null?void 0:R.includes("repo"))||((U=Pe.sbom_type)==null?void 0:U.includes("code"))}):je=je.filter(Pe=>Pe.sbom_type===a)),n&&je.length>0){const Pe=je.filter(w=>w.target_name===n);if(Pe.length>0)je=Pe;else{const w=n.split(":")[0],R=je.filter(U=>{var V;return((V=U.target_name)==null?void 0:V.includes(w))||n.includes(U.target_name||"")});R.length>0&&(je=R)}}N.success&&je.length>0?(c(je),h(je[0])):(c([]),h(null))}catch(N){E("SBOM ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),c([])}finally{l(!1)}}},[s,n,a]),J=o.useCallback(async()=>{if(s){j(!0);try{const N=a==="image"?"sca":a==="source"?"sast":"all",ge=await Sd.getCombinedVulnerabilities(s,"all",void 0,N);if(ge.success&&ge.data){y(ge.data.vulnerabilities||[]),u(ge.data.data_sources||[]);const Ce=ge.data.vulnerabilities||[],je=Ce.map((w,R)=>({id:w.id||R,sbom_id:(p==null?void 0:p.sbom_id)||0,service_id:s,component_name:w.component_name,component_version:w.component_version,purl:"",package_type:w.data_source,cve_id:w.cve_id,cvss_score:w.cvss_score,cvss_version:"3.1",severity:w.severity,title:w.title,description:w.description,cwe_ids:"",references:w.references||"",published_at:null,modified_at:null,fixed_version:w.fixed_version||null,patch_available:w.patch_available,upgrade_command:null,status:w.status,data_source:w.data_source,source_id:w.source_tool,created_at:w.last_scanned_at,updated_at:w.last_scanned_at}));I(je);const Pe=Ce.filter(w=>w.patch_available===!0).length;A({critical:ge.data.critical_count||0,high:ge.data.high_count||0,medium:ge.data.medium_count||0,low:ge.data.low_count||0,patchable:Pe})}else I([]),y([]),u([]),A(null)}catch(N){I([]),y([]),u([]),A(null)}finally{j(!1)}}},[s,p==null?void 0:p.sbom_id,a]),te=o.useCallback(async()=>{if(s){L(!0);try{const N=await go.getLicenseAnalysis(s);N.success&&N.data?_(N.data):_(null)}catch(N){_(null)}finally{L(!1)}}},[s]);o.useEffect(()=>{K(),te()},[K,te]),o.useEffect(()=>{p&&J()},[p,J]);const G=async(N,ge="json")=>{try{const w=(await(await vn(async()=>{const{apiClient:V}=await Promise.resolve().then(()=>nf);return{apiClient:V}},void 0)).apiClient.getAxiosInstance().get(`/sbom/download/${N}?format=${ge}`,{responseType:"blob"})).data;if(!w||w.size===0){f.error("ë‹¤ìš´ë¡œë“œí•  SBOM ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const R=URL.createObjectURL(w),U=document.createElement("a");U.href=R,U.download=`sbom_${N}.${ge}`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(R),f.success("SBOM íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(Ce){console.error("[SBOM Download Error]",Ce),f.error("SBOM ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},q=async()=>{if(p){j(!0);try{const N=await Sd.scanVulnerabilities({sbom_id:p.sbom_id,service_id:s,force_refresh:!0});N.success&&N.data&&(f.success(`OSV API ìŠ¤ìº” ì™„ë£Œ: ${N.data.total_vulnerabilities}ê°œ ë°œê²¬`),await J())}catch(N){f.error("ì·¨ì•½ì  ìŠ¤ìº”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{j(!1)}}},oe=N=>{Z(N),M(!0)},be=async(N,ge)=>{try{await Sd.ignoreVulnerability({alert_id:N,reason:ge}),M(!1),Z(null),await J()}catch(Ce){throw f.error("ì·¨ì•½ì  ë¬´ì‹œ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),new Error("ì·¨ì•½ì  ë¬´ì‹œ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},ne=async()=>{await K(),await te(),r==null||r()};return i||t?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px",color:"#666"},children:"SBOM ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."})]}):k?e.jsx(xe,{message:"ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜",description:k,type:"error",showIcon:!0,action:e.jsx(B,{size:"small",onClick:ne,children:"ë‹¤ì‹œ ì‹œë„"})}):d.length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsxs("span",{children:["SBOM ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.",e.jsx("br",{}),e.jsxs("span",{style:{fontSize:12,color:"#999"},children:["SBOM(Software Bill of Materials)ì€ ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„±ìš”ì†Œ ëª©ë¡ì…ë‹ˆë‹¤.",e.jsx("br",{}),"ìœ„ì˜ ë¹Œë“œëœ ì´ë¯¸ì§€ ëª©ë¡ì—ì„œ ìŠ¤ìº” ì‹œ"," ",e.jsx("strong",{children:'"SBOM ìë™ ìƒì„±"'})," ì˜µì…˜ì„ í™œì„±í™”í•˜ë©´",e.jsx("br",{}),"ì·¨ì•½ì  ë¶„ì„ê³¼ í•¨ê»˜ SBOMì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤."]})]}),children:e.jsx(B,{onClick:ne,icon:e.jsx(zs,{}),children:"ìƒˆë¡œê³ ì¹¨"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(g,{children:d.length>1&&e.jsx(Ee,{value:(Ue=p==null?void 0:p.sbom_id)==null?void 0:Ue.toString(),onChange:N=>{const ge=d.find(Ce=>Ce.sbom_id.toString()===N);ge&&h(ge)},style:{minWidth:200},options:d.map(N=>{const ge=N.target_name||"Unknown",Ce=ge.split("/").pop()||ge;return{value:N.sbom_id.toString(),label:`${Ce} (${new Date(N.created_at).toLocaleDateString("ko-KR")})`}})})}),e.jsxs(g,{children:[p&&e.jsxs(e.Fragment,{children:[e.jsx(Ie,{title:"ì·¨ì•½ì  ìŠ¤ìº”",children:e.jsx(B,{icon:e.jsx($d,{}),onClick:q,loading:m,children:"ì·¨ì•½ì  ìŠ¤ìº”"})}),e.jsx(Ie,{title:"SBOM ë‹¤ìš´ë¡œë“œ (CycloneDX JSON)",children:e.jsx(B,{icon:e.jsx(Um,{}),onClick:()=>G(p.sbom_id,"json"),children:"ë‹¤ìš´ë¡œë“œ"})})]}),e.jsx(B,{icon:e.jsx(zs,{}),onClick:ne,children:"ìƒˆë¡œê³ ì¹¨"})]})]}),p&&e.jsxs("div",{children:[e.jsx(ow,{sbom:p}),v.length>0&&e.jsx("div",{style:{marginTop:16},children:e.jsx(xe,{message:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{style:{fontWeight:500},children:[e.jsx(Bs,{style:{marginRight:8}}),"ì·¨ì•½ì  ë°ì´í„° ì†ŒìŠ¤"]}),e.jsx(g,{size:"large",children:v.map(N=>e.jsx(Ie,{title:e.jsxs("div",{children:[e.jsx("div",{children:N.source_name}),e.jsxs("div",{style:{fontSize:11,color:"#aaa",marginTop:4},children:[N.is_cached?"ìºì‹œëœ ë°ì´í„°":"ì‹¤ì‹œê°„ ìŠ¤ìº” ê²°ê³¼",N.last_scan_at&&e.jsxs("span",{children:[" â€¢ ë§ˆì§€ë§‰ ìŠ¤ìº”: ",new Date(N.last_scan_at).toLocaleString("ko-KR")]})]})]}),children:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",padding:"2px 8px",borderRadius:4,backgroundColor:Ol[N.source]+"15",border:`1px solid ${Ol[N.source]}40`,color:Ol[N.source],fontSize:12,cursor:"pointer"},children:[e.jsx("span",{style:{width:6,height:6,borderRadius:"50%",backgroundColor:Ol[N.source],marginRight:6}}),lw[N.source]||N.source_name,e.jsxs("span",{style:{marginLeft:4,fontWeight:600},children:["(",N.vuln_count,")"]})]})},N.source))})]}),type:"info",style:{marginBottom:8}})}),(P.length>0||b)&&e.jsx("div",{style:{marginTop:16},children:e.jsx(yw,{summary:{sbom_id:p.sbom_id,alerts:P,total_vulnerabilities:P.length,critical_count:(b==null?void 0:b.critical)||0,high_count:(b==null?void 0:b.high)||0,medium_count:P.filter(N=>N.severity==="medium").length,low_count:P.filter(N=>N.severity==="low").length,open_count:P.filter(N=>N.status==="open").length,patchable_count:(b==null?void 0:b.patchable)||0},loading:m,onRescan:q})}),e.jsx("div",{style:{marginTop:16},children:e.jsx(fw,{components:p.components||[],loading:i,vulnerabilities:$,onViewVulnerability:N=>{const ge={id:N.id||0,sbom_id:p.sbom_id,service_id:s,component_name:N.component_name,component_version:N.component_version,purl:"",package_type:N.data_source,cve_id:N.cve_id,cvss_score:N.cvss_score,cvss_version:"3.1",severity:N.severity,title:N.title,description:N.description,cwe_ids:"",references:N.references||"",published_at:null,modified_at:null,fixed_version:N.fixed_version||null,patch_available:N.patch_available,upgrade_command:null,status:N.status,data_source:N.data_source,source_id:N.source_tool,created_at:N.last_scanned_at,updated_at:N.last_scanned_at};Z(ge),ce(!0)}})})]}),e.jsx(_w,{visible:se,vulnerability:W,onClose:()=>{ce(!1),Z(null)},onIgnore:oe}),e.jsx(Sw,{visible:D,vulnerability:W,loading:m,onConfirm:be,onCancel:()=>{M(!1),Z(null)}})]})},{Text:rk,Title:nk}=we,{Text:ak}=we,{Option:ik}=Ee,{TextArea:ok}=ue,vw=({icon:s,title:t,description:r,onAction:n,actionText:a="ìŠ¤ìº” ì‹œì‘",actionLoading:i=!1})=>e.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[s&&Ct.cloneElement(s,{style:{fontSize:"48px",color:"#1890ff",marginBottom:"16px"}}),e.jsx("p",{style:{fontSize:"16px",margin:"0 0 8px 0",color:"#262626"},children:t}),e.jsx("p",{style:{fontSize:"14px",color:"#8c8c8c",margin:"0 0 24px 0"},children:r}),n&&e.jsx(B,{type:"primary",size:"large",icon:e.jsx(In,{}),onClick:n,loading:i,style:{minWidth:"120px"},children:a})]}),{Text:lk}=we,ra={critical:{primary:"#cf1322",background:"#fff1f0",backgroundEnd:"#ffccc7",border:"#ffa39e",light:"#fff2f0"},high:{primary:"#d46b08",background:"#fff7e6",backgroundEnd:"#ffd591",border:"#ffc069",light:"#fff7e6"},medium:{primary:"#d48806",background:"#fffbe6",backgroundEnd:"#fff1b8",border:"#ffe58f",light:"#fffbe6"},low:{primary:"#389e0d",background:"#f6ffed",backgroundEnd:"#d9f7be",border:"#b7eb8f",light:"#f6ffed"},info:{primary:"#096dd9",background:"#e6f7ff",backgroundEnd:"#bae7ff",border:"#91d5ff",light:"#e6f7ff"}},Rc={critical:"Critical",high:"High",medium:"Medium",low:"Low",info:"Info"},yr={sm:8,md:12,lg:16},ma={sm:4,md:8,lg:12},kd={card:"0 2px 8px rgba(0, 0, 0, 0.08)"},Si={base:{borderRadius:ma.lg,boxShadow:kd.card},severitySummary:s=>({borderRadius:ma.lg,border:`2px solid ${ra[s].border}`,background:`linear-gradient(135deg, ${ra[s].background} 0%, ${ra[s].backgroundEnd} 100%)`,textAlign:"center",transition:"all 0.3s ease"}),vulnerabilityDetail:s=>({borderRadius:ma.lg,border:`2px solid ${ra[s].border}`,boxShadow:kd.card,marginBottom:yr.lg,overflow:"hidden"}),vulnerabilityDetailHeader:s=>({background:`linear-gradient(135deg, ${ra[s].background} 0%, ${ra[s].backgroundEnd} 100%)`,borderBottom:`2px solid ${ra[s].border}`,padding:`${yr.md}px ${yr.lg}px`}),info:{borderRadius:ma.lg,border:"1px solid #f0f0f0",boxShadow:kd.card,background:"#fafafa"}},_p={severityValue:s=>({color:ra[s].primary,fontSize:28,fontWeight:"bold"}),severityTitle:s=>({color:ra[s].primary,fontWeight:600,fontSize:13})};function Iu(s){if(!s)return"info";const t=s.toLowerCase();return t==="critical"||t==="error"?"critical":t==="high"||t==="warning"?"high":t==="medium"?"medium":t==="low"||t==="note"?"low":"info"}function Tu(s){return{critical:"red",high:"orange",medium:"gold",low:"green",info:"blue"}[s]}function kw(s){return s.toLocaleString()}const{Text:Cw}=we,Iw={critical:e.jsx(Tr,{}),high:e.jsx(Yt,{}),medium:e.jsx(Yt,{}),low:e.jsx(Ks,{}),info:e.jsx(Ze,{})},Tw=({severity:s,count:t,total:r,showProgress:n,size:a})=>{const i=r>0?Math.round(t/r*100):0,l=ra[s],d=Si.severitySummary(s);return e.jsx(ie,{size:"small",style:d,hoverable:!0,children:e.jsxs(g,{direction:"vertical",size:a==="small"?4:8,style:{width:"100%"},children:[e.jsxs(g,{size:4,children:[e.jsx("span",{style:{color:l.primary,fontSize:a==="small"?14:16},children:Iw[s]}),e.jsx(Cw,{strong:!0,style:_p.severityTitle(s),children:Rc[s]})]}),e.jsx($e,{value:t,valueStyle:{..._p.severityValue(s),fontSize:a==="small"?24:28},formatter:c=>kw(Number(c))}),n&&r>0&&e.jsx(Ie,{title:`ì „ì²´ ${r}ê±´ ì¤‘ ${i}%`,children:e.jsx(qt,{percent:i,size:"small",strokeColor:l.primary,trailColor:l.light,showInfo:!1,style:{marginTop:4}})})]})})},Dx=({counts:s,total:t,visibleLevels:r=["critical","high","medium","low"],showProgress:n=!1,size:a="default",colSpan:i=6,style:l})=>{const d=s.critical+s.high+s.medium+s.low+(s.info||0),c=t!=null?t:d;return e.jsx(Ke,{gutter:[yr.lg,yr.lg],style:l,children:r.map(p=>{const h=p==="info"?s.info||0:s[p];return e.jsx(Y,{span:i,children:e.jsx(Tw,{severity:p,count:h,total:c,showProgress:n,size:a})},p)})})},{Text:ck,Paragraph:dk}=we,{Text:Dl}=we,Rw={sast:{name:"ì •ì  ì½”ë“œ ë¶„ì„",icon:"ğŸ”"},sca:{name:"ì´ë¯¸ì§€ ë¶„ì„",icon:"ğŸ“¦"},dast:{name:"ë„ë©”ì¸ ê²€ì‚¬",icon:"ğŸŒ"}},wp=s=>{if(!s)return"";const t=Math.floor((Date.now()-s.getTime())/1e3),r=Math.floor(t/60),n=t%60;return r>0?`${r}ë¶„ ${n}ì´ˆ ê²½ê³¼`:`${n}ì´ˆ ê²½ê³¼`},Ru=({scanType:s,startTime:t,targetName:r,message:n})=>{const a=Rw[s]||{name:"ë³´ì•ˆ ë¶„ì„",icon:"ğŸ”’"},[i,l]=Ct.useState(wp(t));return Ct.useEffect(()=>{if(!t)return;const d=setInterval(()=>{l(wp(t))},1e3);return()=>clearInterval(d)},[t]),e.jsx(xe,{type:"info",showIcon:!0,icon:e.jsx(Pt,{spin:!0,style:{fontSize:18}}),style:{marginBottom:16,borderRadius:8,background:"linear-gradient(135deg, #e6f7ff 0%, #bae7ff 100%)",border:"1px solid #91d5ff",animation:"pulse 2s infinite"},message:e.jsxs(g,{size:8,children:[e.jsxs(Dl,{strong:!0,style:{fontSize:14},children:[a.icon," ",a.name," ì§„í–‰ ì¤‘"]}),r&&e.jsxs(Dl,{type:"secondary",style:{fontSize:13},children:["(",r,")"]})]}),description:e.jsx("div",{style:{marginTop:8},children:e.jsxs(g,{direction:"vertical",size:8,style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx(jc,{style:{color:"#1890ff"}}),e.jsx(Dl,{style:{fontSize:13},children:n||"ìƒˆë¡œìš´ ìŠ¤ìº” ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì•„ë˜ëŠ” ì´ì „ ë¶„ì„ ê²°ê³¼ì…ë‹ˆë‹¤."})]}),t&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(qt,{percent:100,showInfo:!1,strokeColor:{"0%":"#1890ff","100%":"#52c41a"},style:{flex:1,maxWidth:200},status:"active"}),e.jsx(Dl,{type:"secondary",style:{fontSize:12},children:i})]})]})})})},zu=({isScanning:s,children:t})=>e.jsxs("div",{style:{position:"relative",opacity:s?.7:1,transition:"opacity 0.3s ease",pointerEvents:s?"none":"auto"},children:[t,s&&e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(255, 255, 255, 0.1)",pointerEvents:"none"}})]}),{Text:Us}=we,{TabPane:Fl}=xs,Fx=({repoId:s,serviceId:t,repoUrl:r,serviceName:n,onStartScan:a,onScanStateChange:i,onClose:l,sastResult:d,loading:c,showTabs:p=!0})=>{var be,ne,ye,Ue;const[h,x]=o.useState(!1),[_,S]=o.useState(null),[L,k]=o.useState(null),[E,P]=o.useState(!1),[I,$]=o.useState(null),[y,v]=o.useState("checklist"),[u,m]=o.useState(!1),[j,b]=o.useState(null),A=c!==void 0?c:h,W=d!==void 0?d:_,Z=o.useCallback(async()=>{if(d!==void 0)return;const N=t||s;if(N){x(!0),k(null);try{const ge=await Xt.getSastResult(N),Ce=ge==null?void 0:ge.data;if(!Ce){S(null),k("ì •ì  ì½”ë“œ ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}if(Ce.status==="not_found"){S(null),k("ì •ì  ì½”ë“œ ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}const je=Ce;if(je.semgrep!==void 0||je.codeql!==void 0||je.status!==void 0){const Pe={semgrep:je.semgrep,codeql:je.codeql,status:je.status,summary:je.summary,categories:je.categories,hot_spots:je.hot_spots,history:je.history,executionLogs:{semgrep:je.semgrep_command_log||"",codeql:je.codeql_command_log||""}};S(Pe)}else S(null),k("ì •ì  ì½”ë“œ ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}catch(ge){const Ce=ge instanceof Error?ge.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";k("ì •ì  ì½”ë“œ ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+Ce)}finally{x(!1)}}},[t,s,d]),se=o.useRef({});o.useEffect(()=>{const N=t||s,ge=se.current.serviceId||se.current.repoId;N&&N!==ge&&(se.current={serviceId:t,repoId:s},Z())},[t,s]),o.useEffect(()=>{(async()=>{const ge=t||s;if(ge)try{const Ce=await Xt.getRepoById(ge);if(Ce.success&&Ce.data){const je=Ce.data;b({gitUrl:je.gitlabUrl||r||"",branch:je.gitlabBranch||"main"})}}catch(Ce){r&&b({gitUrl:r,branch:"main"})}})()},[t,s,r]);const ce=o.useCallback(()=>{m(!0)},[]),D=o.useCallback(async N=>{m(!1);const ge=t||s;if(!ge){k("ìŠ¤ìº”ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: Repository IDê°€ ì—†ìŠµë‹ˆë‹¤.");return}if(!j||!j.gitUrl){k("Git ì €ì¥ì†Œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");return}P(!0),$(new Date),k(null),i==null||i("analyzing");try{await Xt.executeSastScan({repo_id:ge,git_url:j.gitUrl,branch:j.branch,git_token:void 0,generate_sbom:N.generate_sbom,license_analysis:N.license_analysis}),Z(),i==null||i("completed")}catch(Ce){const je=Ce instanceof Error?Ce.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";k("ì •ì  ì½”ë“œ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+je),i==null||i("failed")}finally{P(!1),$(null)}},[t,s,j,i,Z]),M=o.useCallback(()=>{l==null||l()},[l]),K=N=>{if(!N)return N;const ge=/^\/tmp\/[^/]+\//;return N.replace(ge,"/")},J=N=>{var ge,Ce;try{const Pe=((Ce=(ge=JSON.parse(N).runs)==null?void 0:ge[0])==null?void 0:Ce.results)||[];return Pe.length>0,Pe.map(R=>{var U;return R.ruleId&&R.message&&typeof R.message=="object"?R:R.rule?{ruleId:R.rule.id||R.rule.name||"unknown",level:R.rule.level||"note",message:{text:typeof R.rule.message=="string"?R.rule.message:((U=R.rule.message)==null?void 0:U.text)||"No description"},locations:R.locations||[],properties:R.rule.properties||R.properties||{},...R}:R})}catch(je){return[]}},te=o.useCallback(()=>{var Mt,Ve,Me,ot,Bt,Ps,ir,Ut;const N=W==null?void 0:W.summary,ge=W==null?void 0:W.categories,Ce=W==null?void 0:W.hot_spots,je=(W==null?void 0:W.history)||[],Pe=N&&N.severity_counts&&Object.keys(N.severity_counts).length>0,w=ge&&Array.isArray(ge)&&ge.length>0,R=Ce&&Array.isArray(Ce)&&Ce.length>0;if(Pe&&w&&R){const Ge=N.severity_counts||{critical:0,high:0,medium:0,low:0};let et="N/A";if(je&&je.length>=2){const tt=Number(((Mt=je[0])==null?void 0:Mt.security_score)||0),Vt=Number(((Ve=je[1])==null?void 0:Ve.security_score)||0);tt>Vt?et="decreasing":tt<Vt?et="increasing":et="flat"}return{severity:{critical:Ge.critical||0,high:Ge.high||0,medium:Ge.medium||0,low:Ge.low||0},categoriesCount:Object.fromEntries(ge.map(tt=>[tt.name,tt.count])),hotSpots:Ce.map((tt,Vt)=>{var lt;return{file:tt.file,count:tt.finding_count,priority:(lt=tt.priority)!=null?lt:Vt+1}}),total:(Ge.critical||0)+(Ge.high||0)+(Ge.medium||0)+(Ge.low||0),scoreRaw:(Me=N.security_score)!=null?Me:0,grade:(ot=N.grade)!=null?ot:"N/A",trend:et}}const U=J(((Ps=(Bt=W==null?void 0:W.semgrep)==null?void 0:Bt.results)==null?void 0:Ps.sarif_json)||"[]"),V=J(((Ut=(ir=W==null?void 0:W.codeql)==null?void 0:ir.results)==null?void 0:Ut.sarif_json)||"[]"),F=[...U,...V],X={critical:0,high:0,medium:0,low:0},de={},Ne={},ae=Ge=>{var et;return((et=Ge==null?void 0:Ge.toLowerCase)==null?void 0:et.call(Ge))||""},pe=Ge=>{var et,tt,Vt,lt;if(Ge.level&&typeof Ge.level=="string")return Ge.level;if((et=Ge.properties)!=null&&et.securitySeverity)return Ge.properties.securitySeverity;if((tt=Ge.properties)!=null&&tt["security-severity"])return Ge.properties["security-severity"];if(Ge.rank)return Ge.rank;if((Vt=Ge.properties)!=null&&Vt.severity)return Ge.properties.severity;if((lt=Ge.properties)!=null&&lt.tags&&Array.isArray(Ge.properties.tags)){const Rt=Ge.properties.tags.find(St=>typeof St=="string"&&(St.includes("critical")||St.includes("high")||St.includes("medium")||St.includes("low")));if(Rt)return Rt}return"low"},Xe=Ge=>{const et=ae(Ge);return et==="error"||et==="critical"||et.includes("critical")?"critical":et==="warning"||et==="high"||et.includes("high")?"high":et==="note"||et==="medium"||et==="moderate"||et.includes("medium")?"medium":"low"};F.forEach((Ge,et)=>{var ms,Ts,ds,fs,Cs,gr,Rr,Ss,Rn,fn,Os;const tt=pe(Ge),Vt=Xe(tt);X[Vt]+=1;const lt=((fs=(ds=(Ts=(ms=Ge.locations)==null?void 0:ms[0])==null?void 0:Ts.physicalLocation)==null?void 0:ds.artifactLocation)==null?void 0:fs.uri)||"unknown",Rt=K(lt);Ne[Rt]=(Ne[Rt]||0)+1;const St=[];if(Ge.ruleId&&typeof Ge.ruleId=="string"&&St.push(Ge.ruleId),(Cs=Ge.properties)!=null&&Cs.tags){const Ms=Ge.properties.tags;Array.isArray(Ms)?St.push(...Ms.filter(Ht=>typeof Ht=="string")):typeof Ms=="string"&&St.push(...Ms.split(",").map(Ht=>Ht.trim()))}(gr=Ge.properties)!=null&&gr.kind&&St.push(Ge.properties.kind),(Ss=(Rr=Ge.properties)==null?void 0:Rr.problem)!=null&&Ss.category&&St.push(Ge.properties.problem.category),(fn=(Rn=Ge.properties)==null?void 0:Rn.cwe)!=null&&fn.id&&St.push(Ge.properties.cwe.id),(Os=Ge.properties)!=null&&Os.precision&&St.push(Ge.properties.precision),St.filter(Boolean).forEach(Ms=>{const Ht=ae(Ms);if(!Ht||Ht.length<2)return;let Dt=Ms;Ht.includes("sql")||Ht.includes("sqli")?Dt="SQL Injection":Ht.includes("xss")||Ht.includes("cross-site")?Dt="XSS":Ht.includes("auth")||Ht.includes("access")||Ht.includes("authorization")?Dt="Authentication/Authorization":Ht.includes("secret")||Ht.includes("credential")||Ht.includes("token")||Ht.includes("hardcoded")?Dt="Hardcoded Secrets":Ht.includes("injection")?Dt="Injection":Ht.includes("csrf")||Ht.includes("cross-site-request")?Dt="CSRF":Ht.includes("crypto")||Ht.includes("encryption")?Dt="Cryptography":Ht.includes("path")&&Ht.includes("traversal")?Dt="Path Traversal":Ht.startsWith("cwe-")||Ht.startsWith("cwe")?Dt=Ms.toUpperCase():(Ht.includes("security")||Ht.includes("vulnerability"))&&Ge.ruleId&&(Dt=Ge.ruleId),de[Dt]=(de[Dt]||0)+1})});const Nt=Object.entries(Ne).sort((Ge,et)=>et[1]-Ge[1]).slice(0,5).map(([Ge,et],tt)=>({file:Ge,count:et,priority:tt+1})),Fe=Object.values(X).reduce((Ge,et)=>Ge+et,0),Le=Fe===0?100:Math.max(0,100-(X.critical*4+X.high*3+X.medium*2+X.low*1)*3),Oe=Le>=90?"A":Le>=80?"B":Le>=70?"C":Le>=60?"D":"E";return{severity:X,categoriesCount:de,hotSpots:Nt,total:Fe,scoreRaw:Le,grade:Oe,trend:"N/A"}},[W]),G=N=>{var Pe;const ge=N==="semgrep"?W==null?void 0:W.semgrep:W==null?void 0:W.codeql;if(!ge||!ge.results)return e.jsx(xe,{message:"ìƒì„¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.",type:"warning"});const Ce=J(ge.results.sarif_json),je=w=>{var Le,Oe,Mt,Ve,Me,ot,Bt,Ps,ir,Ut,Ge,et,tt,Vt,lt,Rt,St,ms,Ts,ds,fs,Cs,gr,Rr,Ss,Rn,fn,Os,Ms,Ht,Dt,zr,nn,zn;const R=((Le=w.message)==null?void 0:Le.text)||((Oe=w.message)==null?void 0:Oe.markdown)||((Mt=w.shortDescription)==null?void 0:Mt.text)||((Ve=w.fullDescription)==null?void 0:Ve.text)||((Me=w.help)==null?void 0:Me.text)||null,U=w.ruleId||((ot=w.rule)==null?void 0:ot.id)||w.id||null;let V=w.level||((Bt=w.properties)==null?void 0:Bt.securitySeverity)||((Ps=w.properties)==null?void 0:Ps.severity)||w.rank||null;if(V){const Ys=V.toLowerCase();Ys==="error"?V="critical":Ys==="warning"?V="high":Ys==="note"||Ys==="moderate"?V="medium":Ys==="info"&&(V="low")}const F=((et=(Ge=(Ut=(ir=w.locations)==null?void 0:ir[0])==null?void 0:Ut.physicalLocation)==null?void 0:Ge.artifactLocation)==null?void 0:et.uri)||null,X=F?K(F):null,de=((Rt=(lt=(Vt=(tt=w.locations)==null?void 0:tt[0])==null?void 0:Vt.physicalLocation)==null?void 0:lt.region)==null?void 0:Rt.startLine)||null,Ne=((ds=(Ts=(ms=(St=w.locations)==null?void 0:St[0])==null?void 0:ms.physicalLocation)==null?void 0:Ts.region)==null?void 0:ds.endLine)||null;let ae=null;if((Cs=(fs=w.properties)==null?void 0:fs.cwe)!=null&&Cs.id)ae=w.properties.cwe.id;else if(w.cwe)ae=typeof w.cwe=="string"?w.cwe:w.cwe.id;else if((gr=w.properties)!=null&&gr.tags){const Ys=(Ss=(Rr=w.properties.tags).find)==null?void 0:Ss.call(Rr,En=>typeof En=="string"&&En.toUpperCase().startsWith("CWE"));Ys&&(ae=Ys)}const pe=((Os=(fn=(Rn=w.fixes)==null?void 0:Rn[0])==null?void 0:fn.description)==null?void 0:Os.text)||((Ms=w.properties)==null?void 0:Ms.fix)||null,Xe=((Ht=w.properties)==null?void 0:Ht["security-severity"])||((Dt=w.properties)==null?void 0:Dt.securitySeverity)||null;let Nt=[];(zr=w.properties)!=null&&zr.tags&&Array.isArray(w.properties.tags)?Nt=w.properties.tags.filter(Ys=>typeof Ys=="string"):w.tags&&Array.isArray(w.tags)&&(Nt=w.tags.filter(Ys=>typeof Ys=="string"));const Fe=((nn=w.help)==null?void 0:nn.text)||((zn=w.properties)==null?void 0:zn.help)||null;return{message:R,ruleId:U,level:V,location:X,startLine:de,endLine:Ne,cwe:ae,fix:pe,severityScore:Xe,tags:Nt,helpText:Fe}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:yr.lg,padding:`${yr.md}px ${yr.lg}px`,background:"#f8fafc",borderRadius:ma.lg,marginBottom:yr.lg,border:"1px solid #e2e8f0"},children:[e.jsxs(g,{children:[e.jsx(mn,{style:{color:"#64748b"}}),e.jsxs(Us,{strong:!0,children:[ge.results.total_findings,"ê±´ ë°œê²¬"]})]}),e.jsx("div",{style:{width:1,height:16,background:"#e2e8f0"}}),e.jsxs(g,{children:[ge.success?e.jsx(Ze,{style:{color:"#22c55e"}}):e.jsx(Yt,{style:{color:"#ef4444"}}),e.jsx(Us,{type:"secondary",children:ge.success?"ë¶„ì„ ì™„ë£Œ":"ë¶„ì„ ì‹¤íŒ¨"})]}),((Pe=ge.summary)==null?void 0:Pe.analysis_time)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:1,height:16,background:"#e2e8f0"}}),e.jsxs(Us,{type:"secondary",style:{fontSize:12},children:[Number(ge.summary.analysis_time).toFixed(1),"ì´ˆ"]})]})]}),Ce.length===0?e.jsx(xe,{message:"ë³´ì•ˆ ì·¨ì•½ì  ì—†ìŒ",type:"success",showIcon:!0,style:{borderRadius:ma.lg}}):e.jsx("div",{style:{maxHeight:550,overflow:"auto"},children:Ce.map((w,R)=>{const U=je(w),V=Iu(U.level||"low"),F=ra[V];return e.jsx(ie,{size:"small",style:Si.vulnerabilityDetail(V),styles:{header:Si.vulnerabilityDetailHeader(V),body:{padding:yr.lg}},title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:yr.sm},children:[e.jsxs(g,{size:yr.sm,children:[e.jsx("div",{style:{width:24,height:24,borderRadius:"50%",background:F.primary,color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:"bold"},children:R+1}),e.jsx(T,{color:Tu(V),style:{margin:0},children:Rc[V]}),e.jsx(Us,{strong:!0,style:{fontSize:14},children:U.ruleId||`Issue #${R+1}`})]}),e.jsx(g,{size:4,children:U.cwe&&e.jsx(T,{color:"volcano",style:{margin:0},children:U.cwe})})]}),children:e.jsxs(g,{direction:"vertical",size:yr.md,style:{width:"100%"},children:[U.message&&e.jsx(Us,{style:{fontSize:13,color:"#595959",display:"block",lineHeight:1.6},children:U.message.length>300?`${U.message.slice(0,300)}...`:U.message}),e.jsx(Se,{size:"small",column:2,children:U.location&&e.jsx(Se.Item,{label:e.jsxs(g,{children:[e.jsx(Fr,{}),"íŒŒì¼"]}),span:2,children:e.jsxs(Us,{code:!0,style:{fontSize:12},children:[U.location,U.startLine&&`:${U.startLine}`,U.endLine&&U.endLine!==U.startLine&&`-${U.endLine}`]})})}),U.tags&&U.tags.length>0&&e.jsx(nr,{ghost:!0,expandIcon:({isActive:X})=>e.jsx(yc,{rotate:X?90:0,style:{fontSize:10}}),items:[{key:"1",label:e.jsxs(g,{children:[e.jsx(Jn,{}),e.jsxs(Us,{style:{fontSize:13},children:["ê´€ë ¨ íƒœê·¸ (",U.tags.length,")"]})]}),children:e.jsx(g,{wrap:!0,size:4,children:U.tags.map((X,de)=>e.jsx(T,{style:{margin:0},children:X},de))})}]}),U.fix&&e.jsxs("div",{style:{background:"#f6ffed",padding:yr.md,borderRadius:ma.md,border:"1px solid #b7eb8f"},children:[e.jsxs(Us,{type:"secondary",style:{fontSize:12},children:[e.jsx(Ze,{style:{marginRight:4}})," ","ìˆ˜ì • ì œì•ˆ:"]}),e.jsx("div",{style:{marginTop:4},children:e.jsx(Us,{style:{fontSize:12},children:U.fix})})]})]})},R)})})]})},q=N=>{try{let ge=null;if(typeof N=="string"?ge=JSON.parse(N):N&&typeof N=="object"&&(ge=N),ge){if(Array.isArray(ge.log_messages))return ge.log_messages;const Ce=ge.full_execution_log;if(Ce!=null&&Ce.log_messages&&Array.isArray(Ce.log_messages))return Ce.log_messages;const je=ge.git_clone;if(je!=null&&je.log_messages&&Array.isArray(je.log_messages))return je.log_messages;const Pe=ge.semgrep_analysis;if(Pe!=null&&Pe.log_messages&&Array.isArray(Pe.log_messages))return Pe.log_messages;const w=[];if(je!=null&&je.log_messages&&Array.isArray(je.log_messages)&&w.push(...je.log_messages),Pe!=null&&Pe.log_messages&&Array.isArray(Pe.log_messages)&&w.push(...Pe.log_messages),w.length>0)return w}return[]}catch(ge){return[]}},oe=()=>{const N=W==null?void 0:W.executionLogs,ge=q(N==null?void 0:N.semgrep),Ce=q(N==null?void 0:N.codeql),je=[];return ge.length>0&&je.push({tool:"Semgrep",logs:ge}),Ce.length>0&&je.push({tool:"CodeQL",logs:Ce}),e.jsx(ie,{title:"ì •ì  ì½”ë“œ ë¶„ì„ ì‹¤í–‰ ë¡œê·¸",size:"small",children:e.jsx("div",{style:{maxHeight:400,overflowY:"auto",backgroundColor:"#1e1e1e",padding:"16px",borderRadius:"4px",fontFamily:'Monaco, Menlo, "Ubuntu Mono", Consolas, "source-code-pro", monospace',fontSize:"12px",lineHeight:1.5,color:"#d4d4d4"},children:je.length>0?je.map((Pe,w)=>e.jsxs("div",{children:[e.jsxs(Us,{strong:!0,style:{color:"#fa8c16",display:"block",marginBottom:"8px"},children:[Pe.tool," ìŠ¤ìº”:"]}),Pe.logs.map((R,U)=>e.jsx("pre",{style:{margin:0,marginBottom:4},children:R},U)),w<je.length-1&&e.jsx("div",{style:{margin:"16px 0",borderTop:"1px solid #333"}})]},w)):e.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#888"},children:e.jsx(Us,{type:"secondary",style:{color:"#888"},children:"ì‹¤í–‰ ë¡œê·¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})})})})};return e.jsxs("div",{style:{padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",paddingBottom:"12px",borderBottom:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(pr,{style:{color:"#1890ff",fontSize:"18px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:"ì •ì  ì½”ë“œ ë¶„ì„ ê²°ê³¼"})]}),a&&e.jsx(B,{type:"primary",icon:e.jsx(In,{}),onClick:ce,disabled:E,loading:E,size:"small",style:{minWidth:"100px"},children:E?"ìŠ¤ìº” ì¤‘...":"ìŠ¤ìº” ì‹¤í–‰"})]}),A?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px",fontSize:"16px",color:"#666"},children:"ì •ì  ì½”ë“œ ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."})]}):E&&!W?e.jsx(Ic,{scanType:"sast",visible:E,onClose:M,startTime:I||void 0,serviceName:n}):L?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#ff4d4f"},children:[e.jsx(mn,{style:{fontSize:"48px",marginBottom:"16px"}}),e.jsx("p",{style:{fontSize:"16px",margin:0},children:L})]}):W?e.jsxs("div",{children:[E&&W&&e.jsx(Ru,{scanType:"sast",startTime:I||void 0,targetName:n}),e.jsx(zu,{isScanning:E,children:p?e.jsxs(xs,{activeKey:y,onChange:N=>v(N),style:{marginBottom:16},children:[e.jsxs(Fl,{tab:e.jsxs("span",{children:[e.jsx(bc,{style:{marginRight:6}}),"ì·¨ì•½ì  ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜"]}),children:[e.jsx(xe,{type:"info",showIcon:!0,icon:e.jsx(Ks,{}),style:{marginBottom:16,borderRadius:8},message:e.jsx("span",{style:{fontWeight:600},children:"ì •ì  ì½”ë“œ ë¶„ì„ (SAST)"}),description:e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{marginBottom:12,color:"#666"},children:"CWE(Common Weakness Enumeration) ê¸°ë°˜ì˜ ì†ŒìŠ¤ì½”ë“œ ë³´ì•ˆ ì•½ì  ë¶„ë¥˜ì…ë‹ˆë‹¤. Semgrepê³¼ CodeQL ìŠ¤ìºë„ˆë¥¼ í†µí•´ ë°œê²¬ëœ ì·¨ì•½ì ë“¤ì´ ìœ„í—˜ë„ì— ë”°ë¼ ë¶„ë¥˜ë©ë‹ˆë‹¤."}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(Us,{strong:!0,children:"ì£¼ìš” ì¹´í…Œê³ ë¦¬:"}),e.jsx("div",{style:{marginTop:8,display:"flex",flexWrap:"wrap",gap:6},children:[{name:"ì¸ì ì…˜",color:"#f5222d",icon:"ğŸ”"},{name:"XSS",color:"#fa8c16",icon:"âš ï¸"},{name:"ì¸ì¦/í—ˆìœ„ì„±",color:"#faad14",icon:"ğŸ”‘"},{name:"ì ‘ê·¼í†µì œ",color:"#52c41a",icon:"ğŸšª"},{name:"ë³´ì•ˆì„¤ì •ì˜¤ë¥˜",color:"#1890ff",icon:"âš™ï¸"},{name:"CSRF",color:"#722ed1",icon:"ğŸ¯"},{name:"SSRF",color:"#eb2f96",icon:"ğŸŒ"}].map(N=>e.jsxs(T,{style:{padding:"4px 12px",borderRadius:4,border:`1px solid ${N.color}`,background:`${N.color}10`,color:N.color},children:[e.jsx("span",{style:{marginRight:4},children:N.icon}),N.name]},N.name))})]}),e.jsxs("div",{style:{fontSize:12,color:"#888"},children:[e.jsx("strong",{children:"ë¶„ì„ ë„êµ¬:"})," Semgrep (ì˜¤í”ˆì†ŒìŠ¤ íŒ¨í„´ ê¸°ë°˜ ë¶„ì„), CodeQL (ì‹œë§¨í‹± ì½”ë“œ ë¶„ì„)"]})]})}),e.jsx(Tc,{repoId:t||s||0,onRefresh:()=>Z(),analysisType:"sast"})]},"checklist"),e.jsxs(Fl,{tab:e.jsxs("span",{children:[e.jsx(mn,{style:{marginRight:6}}),"ì·¨ì•½ì  ìƒì„¸"]}),children:[e.jsx(xs,{type:"card",size:"small",items:[...(be=W==null?void 0:W.semgrep)!=null&&be.results?[{key:"semgrep",label:e.jsxs(g,{size:6,children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:"#22c55e",display:"inline-block"}}),e.jsx("span",{children:"Semgrep"}),e.jsx(T,{color:"green",style:{margin:0,fontSize:11},children:W.semgrep.results.total_findings||0})]}),children:G("semgrep")}]:[],...(ne=W==null?void 0:W.codeql)!=null&&ne.results?[{key:"codeql",label:e.jsxs(g,{size:6,children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:"#3b82f6",display:"inline-block"}}),e.jsx("span",{children:"CodeQL"}),e.jsx(T,{color:"blue",style:{margin:0,fontSize:11},children:W.codeql.results.total_findings||0})]}),children:G("codeql")}]:[]]}),!((ye=W==null?void 0:W.semgrep)!=null&&ye.results)&&!((Ue=W==null?void 0:W.codeql)!=null&&Ue.results)&&e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsx(Us,{type:"secondary",children:"ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤"})})]},"details"),e.jsxs(Fl,{tab:e.jsxs("span",{children:[e.jsx(pr,{style:{marginRight:6}}),"ë¶„ì„ ì •ë³´"]}),children:[e.jsxs(ie,{title:e.jsxs("span",{children:[e.jsx(pr,{style:{marginRight:8}}),"ìŠ¤ìº” ìš”ì•½"]}),size:"small",style:{marginBottom:16,borderRadius:8},children:[(()=>{const N=te();return e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{span:6,children:e.jsx($e,{title:"ì´ ì·¨ì•½ì ",value:N.total,valueStyle:{color:N.total>0?"#ff4d4f":"#52c41a"},prefix:N.total>0?e.jsx(Yt,{}):e.jsx(Ze,{})})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"CRITICAL / HIGH",value:N.severity.critical+N.severity.high,valueStyle:{color:"#ff4d4f"}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"MEDIUM",value:N.severity.medium,valueStyle:{color:"#fa8c16"}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"LOW",value:N.severity.low,valueStyle:{color:"#1890ff"}})})]})})(),(()=>{const N=te();return N.grade&&N.grade!=="N/A"&&e.jsxs("div",{style:{marginTop:12,color:"#666",fontSize:13},children:[e.jsx(pr,{style:{marginRight:6}}),"ë³´ì•ˆ ë“±ê¸‰:"," ",e.jsx(T,{color:N.grade==="A"?"green":N.grade==="B"?"blue":N.grade==="C"?"gold":"red",children:N.grade}),"(ì ìˆ˜: ",N.scoreRaw,"ì )"]})})()]}),e.jsx(ie,{title:e.jsxs("span",{children:[e.jsx(Yt,{style:{marginRight:8,color:"#ef4444"}}),"Hot Spots (ì·¨ì•½ì  ì§‘ì¤‘ íŒŒì¼ TOP 5)"]}),size:"small",style:{marginBottom:16,borderRadius:8},children:(()=>{const{hotSpots:N}=te(),ge=Math.max(...N.map(Ce=>Ce.count),1);return N.length?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:N.map(({file:Ce,count:je},Pe)=>{const w=Math.round(je/ge*100),U=["#ef4444","#f97316","#eab308","#22c55e","#3b82f6"][Pe]||"#94a3b8";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{width:20,height:20,borderRadius:"50%",background:U,color:"#fff",fontSize:11,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center"},children:Pe+1}),e.jsx(Us,{style:{fontSize:13,fontFamily:"monospace"},ellipsis:{tooltip:Ce},children:Ce})]}),e.jsxs(T,{style:{background:U,color:"#fff",border:"none",fontWeight:600,fontSize:12},children:[je,"ê±´"]})]}),e.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{width:`${w}%`,height:"100%",background:`linear-gradient(90deg, ${U} 0%, ${U}99 100%)`,borderRadius:4,transition:"width 0.3s ease"}})})]},Ce)})}):e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsx(Us,{type:"secondary",children:"Hot Spots ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"}),style:{padding:"20px 0"}})})()}),e.jsx(ie,{title:e.jsxs("span",{children:[e.jsx(In,{style:{marginRight:8}}),"ì‹¤í–‰ ë¡œê·¸"]}),size:"small",style:{borderRadius:8},children:oe()})]},"info"),e.jsx(Fl,{tab:e.jsxs("span",{children:[e.jsx(ai,{style:{marginRight:6}}),"SBOM / ë¼ì´ì„ ìŠ¤"]}),children:e.jsx(pc,{serviceId:t||s||0,onRefresh:()=>Z(),sbomType:"source"})},"sbom")]}):e.jsxs("div",{children:[e.jsx(ie,{title:e.jsx(Us,{strong:!0,style:{fontSize:"15px"},children:"ì·¨ì•½ì  ì‹¬ê°ë„ ë¶„ì„"}),size:"small",style:{marginBottom:20,...Si.base},children:(()=>{const N=te();return e.jsxs(e.Fragment,{children:[e.jsx(Dx,{counts:N.severity,showProgress:!0,total:N.total}),N.trend&&N.trend!=="N/A"&&e.jsx("div",{style:{marginTop:yr.lg,textAlign:"center"},children:(()=>{const ge=N.trend,Ce=ge==="decreasing"?"success":ge==="increasing"?"error":"info";return e.jsx(xe,{message:`ë³´ì•ˆ íŠ¸ë Œë“œ: ${ge==="decreasing"?"ê°œì„  ì¤‘":ge==="increasing"?"ì•…í™”ë¨":"ë³€í™” ì—†ìŒ"}`,type:Ce,showIcon:!0,style:{display:"inline-block",borderRadius:ma.md}})})()})]})})()}),e.jsx(ie,{title:e.jsx(Us,{strong:!0,style:{fontSize:"15px"},children:"ì·¨ì•½ì  ì¹´í…Œê³ ë¦¬ ë¶„í¬"}),size:"small",style:{marginBottom:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",borderRadius:"8px"},children:(()=>{const{categoriesCount:N}=te(),Ce=Object.entries(N).map(([Pe,w])=>[Pe,Number(w)]);Ce.sort((Pe,w)=>w[1]-Pe[1]);const je=Ce.slice(0,12);return Ce.length?e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:je.map(([Pe,w],R)=>e.jsxs(T,{color:"geekblue",style:{fontSize:"13px",padding:"4px 12px",borderRadius:"4px",fontWeight:R<3?"bold":"normal"},children:[Pe," ",e.jsxs("span",{style:{fontWeight:"bold"},children:["(",Number(w),")"]})]},Pe))}):e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsx(Us,{type:"secondary",children:"ì¹´í…Œê³ ë¦¬ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤"})})})()}),e.jsx(ie,{title:e.jsx(Us,{strong:!0,style:{fontSize:"15px"},children:"Hot Spots (ê°€ì¥ ì·¨ì•½í•œ íŒŒì¼ TOP 5)"}),size:"small",style:{marginBottom:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",borderRadius:"8px"},children:(()=>{const{hotSpots:N}=te(),ge=N;return ge.length?e.jsx("div",{children:ge.map(({file:Ce,count:je},Pe)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",background:Pe%2===0?"#fafafa":"#ffffff",borderRadius:"4px",marginBottom:"8px",border:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[e.jsxs(T,{color:Pe===0?"red":Pe===1?"orange":Pe===2?"gold":"default",style:{fontWeight:"bold",minWidth:"32px",textAlign:"center"},children:["#",Pe+1]}),e.jsx(Us,{style:{flex:1,fontSize:"13px"},ellipsis:{tooltip:Ce},children:Ce})]}),e.jsxs(T,{color:"red",style:{fontSize:"14px",fontWeight:"bold",padding:"4px 12px",borderRadius:"4px"},children:[je," ê±´"]})]},Ce))}):e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsx(Us,{type:"secondary",children:"Hot Spots ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"})})})()})]})})]}):e.jsx("div",{style:{padding:"40px 20px"},children:e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,imageStyle:{height:80},description:e.jsxs(g,{direction:"vertical",size:"large",style:{width:"100%",maxWidth:"600px",margin:"0 auto"},children:[e.jsxs("div",{children:[e.jsx(Us,{style:{fontSize:"18px",fontWeight:600,display:"block",marginBottom:"8px"},children:"ì •ì  ì½”ë“œ ë¶„ì„ì´ ìˆ˜í–‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤"}),e.jsx(Us,{type:"secondary",style:{fontSize:"14px"},children:"ì •ì  ì½”ë“œ ë¶„ì„ì„ í†µí•´ ì½”ë“œì˜ ë³´ì•ˆ ì·¨ì•½ì ì„ íƒì§€í•˜ì„¸ìš”"})]}),e.jsx(ie,{size:"small",style:{textAlign:"left",background:"#f6f8fa",border:"1px solid #e8e8e8"},children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsxs(Us,{strong:!0,style:{fontSize:"14px",display:"block",marginBottom:"12px"},children:[e.jsx(pr,{style:{color:"#1890ff",marginRight:"8px"}}),"ì •ì  ì½”ë“œ ë¶„ì„ì´ ì œê³µí•˜ëŠ” ì •ë³´:"]}),e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[e.jsx(Ze,{style:{color:"#52c41a",marginRight:"8px",marginTop:"4px"}}),e.jsxs(Us,{style:{fontSize:"13px"},children:[e.jsx(Us,{strong:!0,children:"ë³´ì•ˆ ì·¨ì•½ì  íƒì§€:"})," SQL Injection, XSS, ì¸ì¦/ì¸ê°€ ì´ìŠˆ ë“± ì£¼ìš” ë³´ì•ˆ ì·¨ì•½ì  ìë™ íƒì§€"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[e.jsx(Ze,{style:{color:"#52c41a",marginRight:"8px",marginTop:"4px"}}),e.jsxs(Us,{style:{fontSize:"13px"},children:[e.jsx(Us,{strong:!0,children:"ì½”ë“œ í’ˆì§ˆ ë¶„ì„:"})," Semgrepê³¼ CodeQL ì—”ì§„ì„ ì‚¬ìš©í•œ ì •ë°€í•œ ì •ì  ë¶„ì„"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[e.jsx(Ze,{style:{color:"#52c41a",marginRight:"8px",marginTop:"4px"}}),e.jsxs(Us,{style:{fontSize:"13px"},children:[e.jsx(Us,{strong:!0,children:"ë³´ì•ˆ ì ìˆ˜ ì‚°ì¶œ:"})," ë°œê²¬ëœ ì·¨ì•½ì ì„ ê¸°ë°˜ìœ¼ë¡œ ë³´ì•ˆ ë“±ê¸‰(A~E) ì œê³µ"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[e.jsx(Ze,{style:{color:"#52c41a",marginRight:"8px",marginTop:"4px"}}),e.jsxs(Us,{style:{fontSize:"13px"},children:[e.jsx(Us,{strong:!0,children:"Hot Spots íŒŒì•…:"})," ê°€ì¥ ì·¨ì•½í•œ íŒŒì¼ ë° ìœ„ì¹˜ë¥¼ ìš°ì„ ìˆœìœ„ë³„ë¡œ ì œê³µ"]})]})]})]}),e.jsx(xe,{message:"ê¶Œì¥ì‚¬í•­",description:"ì •ê¸°ì ì¸ ì •ì  ì½”ë“œ ë¶„ì„ì„ í†µí•´ ë°°í¬ ì „ ë³´ì•ˆ ì´ìŠˆë¥¼ ì‚¬ì „ì— ë°œê²¬í•˜ê³  í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒë‹¨ì˜ 'ìŠ¤ìº” ì‹¤í–‰' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì²« ë¶„ì„ì„ ì‹œì‘í•˜ì„¸ìš”.",type:"info",showIcon:!0,icon:e.jsx(Yt,{}),style:{marginTop:"8px"}})]})}),a&&e.jsx(B,{type:"primary",size:"large",icon:e.jsx(In,{}),onClick:ce,disabled:E,loading:E,style:{marginTop:"16px"},children:E?"ìŠ¤ìº” ì¤‘...":"ì§€ê¸ˆ ìŠ¤ìº” ì‹œì‘í•˜ê¸°"})]})})}),e.jsx($x,{visible:u,onClose:()=>m(!1),onConfirm:D,initialGitUrl:r,hideGitFields:!0})]})},{Text:lo}=we,{TabPane:Cd}=xs;function zw(s){return"name"in s&&"version"in s&&"fix_available"in s}function Ew(s,t){return zw(s)?{key:`vuln-${t}`,cve:s.cve||"",name:s.name,version:s.version,severity:s.severity.toLowerCase(),description:s.description,fix_available:s.fix_available,fixed_version:s.fixed_version}:{key:`vuln-${t}`,cve:s.vulnerability_id,name:s.pkg_name,version:s.installed_version,severity:s.severity.toLowerCase(),description:s.description,fix_available:!!s.fixed_version,fixed_version:s.fixed_version}}const Pw=({scaResult:s,loading:t=!1,showTabs:r=!0})=>{const[n,a]=o.useState("summary"),i=h=>{switch(h==null?void 0:h.toLowerCase()){case"critical":return"red";case"high":return"red";case"medium":return"orange";case"low":return"blue";default:return"default"}},l=[{title:"CVE",dataIndex:"cve",key:"cve",width:150,render:h=>e.jsx(lo,{code:!0,style:{fontSize:"11px"},children:h})},{title:"íŒ¨í‚¤ì§€",dataIndex:"name",key:"name",width:150},{title:"í˜„ì¬ ë²„ì „",dataIndex:"version",key:"version",width:120},{title:"ì‹¬ê°ë„",dataIndex:"severity",key:"severity",width:100,render:h=>e.jsx(T,{color:i(h),children:h==null?void 0:h.toUpperCase()})},{title:"ìˆ˜ì • ê°€ëŠ¥",dataIndex:"fix_available",key:"fix_available",width:100,align:"center",render:(h,x)=>h&&x.fixed_version?e.jsxs("div",{children:[e.jsx(Ze,{style:{color:"#52c41a",marginRight:4}}),e.jsx(lo,{style:{fontSize:"11px"},children:x.fixed_version})]}):e.jsx(Yt,{style:{color:"#faad14"}})},{title:"ì„¤ëª…",dataIndex:"description",key:"description",ellipsis:!0,render:h=>e.jsx(lo,{style:{fontSize:"12px"},ellipsis:{tooltip:h},children:h})}];if(!s||!s.summary||!s.summary.severity_breakdown)return e.jsx(Je,{image:e.jsx(bi,{style:{fontSize:48,color:"#8c8c8c"}}),description:e.jsxs("div",{children:[e.jsx(lo,{style:{color:"#8c8c8c",fontSize:14},children:"SCA ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("br",{}),e.jsx(lo,{type:"secondary",style:{fontSize:12},children:"ìŠ¤ìº”ì„ ì‹¤í–‰í•˜ì—¬ ì´ë¯¸ì§€ ì·¨ì•½ì ì„ ë¶„ì„í•´ë³´ì„¸ìš”"})]})});const d=s.summary.severity_breakdown||{high:0,medium:0,low:0},c=s.vulnerabilities.map((h,x)=>Ew(h,x)),p=()=>e.jsxs(e.Fragment,{children:[e.jsx(ie,{title:"ì·¨ì•½ì  ìš”ì•½",size:"small",style:{marginBottom:16},children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{span:6,children:e.jsx($e,{title:"ì´ ì·¨ì•½ì ",value:s.summary.total_vulnerabilities,valueStyle:{color:s.summary.total_vulnerabilities>0?"#ff4d4f":"#52c41a"},prefix:e.jsx(mn,{})})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"HIGH",value:d.high,valueStyle:{color:"#ff4d4f"}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"MEDIUM",value:d.medium,valueStyle:{color:"#fa8c16"}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"LOW",value:d.low,valueStyle:{color:"#1890ff"}})})]})}),e.jsx(ie,{title:"ìˆ˜ì • ì •ë³´",size:"small",style:{marginBottom:16},children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{span:12,children:e.jsxs("div",{style:{padding:"16px",borderRadius:"8px",background:"#f6ffed",border:"1px solid #b7eb8f",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#52c41a"},children:c.filter(h=>h.fix_available).length}),e.jsxs("div",{style:{fontSize:"14px",color:"#595959",marginTop:"8px"},children:[e.jsx(Ze,{style:{marginRight:"4px"}}),"ìˆ˜ì • ê°€ëŠ¥í•œ ì·¨ì•½ì "]})]})}),e.jsx(Y,{span:12,children:e.jsxs("div",{style:{padding:"16px",borderRadius:"8px",background:"#fff1f0",border:"1px solid #ffa39e",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#ff4d4f"},children:c.filter(h=>!h.fix_available).length}),e.jsxs("div",{style:{fontSize:"14px",color:"#595959",marginTop:"8px"},children:[e.jsx(Yt,{style:{marginRight:"4px"}}),"ìˆ˜ì • ë¶ˆê°€ëŠ¥í•œ ì·¨ì•½ì "]})]})})]})}),c.filter(h=>h.severity==="high"||h.severity==="critical").length>0&&e.jsx(ie,{title:"ì£¼ìš” ì·¨ì•½ì  (HIGH ì´ìƒ)",size:"small",children:e.jsx(wt,{dataSource:c.filter(h=>h.severity==="high"||h.severity==="critical").slice(0,5),columns:l,size:"small",pagination:!1,scroll:{x:"max-content"},rowKey:"key"})})]});return r?e.jsxs(xs,{activeKey:n,onChange:a,children:[e.jsx(Cd,{tab:"ìš”ì•½",children:p()},"summary"),e.jsx(Cd,{tab:"ìƒì„¸ ê²°ê³¼",children:e.jsx(ie,{title:"ì „ì²´ ì·¨ì•½ì  ëª©ë¡",size:"small",children:e.jsx(wt,{dataSource:c,columns:l,size:"small",pagination:{pageSize:10,showSizeChanger:!0,showTotal:h=>`ì´ ${h}ê°œ`},scroll:{x:"max-content",y:400},rowKey:"key"})})},"details"),e.jsx(Cd,{tab:"íŒ¨í‚¤ì§€ë³„",children:e.jsx(ie,{title:"íŒ¨í‚¤ì§€ë³„ ì·¨ì•½ì ",size:"small",children:e.jsx("div",{style:{maxHeight:"400px",overflow:"auto"},children:Array.from(new Set(c.map(h=>h.name))).map((h,x)=>{var L;const _=c.filter(k=>k.name===h),S=_.reduce((k,E)=>{const P=["critical","high","medium","low","info"],I=P.indexOf(k.severity.toLowerCase());return P.indexOf(E.severity.toLowerCase())<I?E:k});return e.jsx(ie,{size:"small",style:{marginBottom:8},title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(lo,{strong:!0,children:h}),e.jsxs(T,{color:i(S.severity),children:[_.length,"ê°œ ì·¨ì•½ì "]})]}),children:e.jsxs("div",{children:[e.jsxs("p",{style:{margin:"0 0 8px 0",fontSize:"12px"},children:[e.jsx("strong",{children:"í˜„ì¬ ë²„ì „:"})," ",_[0].version]}),_.some(k=>k.fix_available)&&e.jsxs("p",{style:{margin:"0 0 8px 0",fontSize:"12px"},children:[e.jsx("strong",{children:"ìˆ˜ì • ê°€ëŠ¥ ë²„ì „:"})," ",(L=_.find(k=>k.fix_available))==null?void 0:L.fixed_version]}),e.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:_.map((k,E)=>e.jsx(T,{color:i(k.severity),children:k.cve},E))})]})},x)})})})},"packages")]}):e.jsx("div",{children:p()})},{Text:Ia}=we,{TabPane:Id}=xs,Ux=({repoId:s,serviceId:t,repoName:r="ì €ì¥ì†Œ",serviceName:n,onStartScan:a,onScanStateChange:i,onClose:l,dastResult:d,loading:c,showTabs:p=!0})=>{var K,J,te,G,q,oe,be,ne,ye,Ue;const[h,x]=o.useState(!1),[_,S]=o.useState(null),[L,k]=o.useState(null),[E,P]=o.useState(!1),[I,$]=o.useState(null),[y,v]=o.useState("checklist"),u=c!==void 0?c:h,m=d!==void 0?d:_,j=o.useCallback(async()=>{var ge,Ce,je,Pe,w,R,U;if(d!==void 0)return;const N=t||s;if(N){x(!0),k(null);try{const F=await Xt.getDastResult(N);if(F&&F.status==="completed"&&F.result){const X=F.result;if(X.result&&X.result.results&&X.result.results.alerts){const de=X.result.results,Ne={alerts:de.alerts||[],summary:{total_alerts:de.total_alerts||0,high_alerts:de.high_alerts||0,medium_alerts:de.medium_alerts||0,low_alerts:de.low_alerts||0,info_alerts:de.info_alerts||0,scan_time:((ge=X.result.summary)==null?void 0:ge.scan_time)||0},execution_log:X.execution_log||{log_messages:[],total_duration:0}};S(Ne)}else if(X.result&&X.result.alerts){const de={alerts:X.result.alerts||[],summary:{total_alerts:((Ce=X.result.summary)==null?void 0:Ce.total_alerts)||0,high_alerts:((je=X.result.summary)==null?void 0:je.high_alerts)||0,medium_alerts:((Pe=X.result.summary)==null?void 0:Pe.medium_alerts)||0,low_alerts:((w=X.result.summary)==null?void 0:w.low_alerts)||0,info_alerts:((R=X.result.summary)==null?void 0:R.info_alerts)||0,scan_time:((U=X.result.summary)==null?void 0:U.scan_time)||0},execution_log:X.execution_log||{log_messages:[],total_duration:0}};S(de)}else S(X)}else F&&F.status==="pending"?(S(null),k("DAST ìŠ¤ìº”ì´ ì•„ì§ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.")):(S(null),k("ë„ë©”ì¸ ê²€ì‚¬ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."))}catch(V){k("ë„ë©”ì¸ ê²€ì‚¬ ê²°ê³¼ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+(V.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}finally{x(!1)}}},[s,t,d]);o.useEffect(()=>{(t||s)&&d===void 0&&j()},[s,t,j,d]);const b=o.useCallback(async()=>{if(a){P(!0),$(new Date),i==null||i("analyzing");try{await a(),await j(),i==null||i("completed")}catch(N){k("ë„ë©”ì¸ ê²€ì‚¬ ì‹œì‘ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+(N instanceof Error?N.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜")),i==null||i("failed")}finally{P(!1),$(null)}}},[a,i,j]),A=o.useCallback(()=>{l==null||l()},[l]);if(u)return e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px",fontSize:"16px",color:"#666"},children:"ë„ë©”ì¸ ê²€ì‚¬ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."})]});if(E&&!m)return e.jsx(Ic,{scanType:"dast",visible:E,onClose:A,startTime:I||void 0,serviceName:n});if(L)return e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(mn,{style:{fontSize:"48px",marginBottom:"16px",color:"#ff4d4f"}}),e.jsx("p",{style:{fontSize:"16px",margin:"0 0 24px 0",color:"#ff4d4f"},children:L}),e.jsxs(g,{children:[e.jsx(B,{icon:e.jsx(zs,{}),onClick:j,size:"large",children:"ìƒˆë¡œê³ ì¹¨"}),a&&e.jsx(B,{type:"primary",icon:e.jsx(In,{}),onClick:b,size:"large",children:"ìƒˆë¡œ ê²€ì‚¬í•˜ê¸°"})]})]});if(!m)return e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(ni,{style:{fontSize:"48px",color:"#1890ff",marginBottom:"16px"}}),e.jsx("p",{style:{fontSize:"16px",margin:"0 0 8px 0"},children:"ë„ë©”ì¸ ê²€ì‚¬ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{style:{fontSize:"14px",color:"#666",margin:"0 0 24px 0"},children:"ê²€ì‚¬ë¥¼ ì‹œì‘í•˜ì—¬ ì›¹ ë³´ì•ˆ ì·¨ì•½ì ì„ ë¶„ì„í•´ë³´ì„¸ìš”"}),a&&e.jsx(B,{type:"primary",icon:e.jsx(In,{}),onClick:b,size:"large",children:"ê²€ì‚¬ ì‹œì‘í•˜ê¸°"})]});const W=e.jsx(ie,{title:"ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼",size:"small",style:{marginBottom:16},children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{span:8,children:e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",background:(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("sql")).length>0?"#fff1f0":"#f6ffed",border:`1px solid ${(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("sql")).length>0?"#ffa39e":"#b7eb8f"}`},children:[e.jsx("div",{style:{fontSize:"12px",color:"#595959",marginBottom:"8px"},children:"SQL Injection"}),e.jsx("div",{style:{fontSize:"18px",fontWeight:600,marginBottom:"4px"},children:(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("sql")).length>0?"ë°œê²¬ë¨":"ì•ˆì „"}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("sql")).length,"ê°œ ì•Œë¦¼"]})]})}),e.jsx(Y,{span:8,children:e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",background:(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("cross site scripting")||N.name.toLowerCase().includes("xss")).length>0?"#fff1f0":"#f6ffed",border:`1px solid ${(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("cross site scripting")||N.name.toLowerCase().includes("xss")).length>0?"#ffa39e":"#b7eb8f"}`},children:[e.jsx("div",{style:{fontSize:"12px",color:"#595959",marginBottom:"8px"},children:"XSS (Cross-Site Scripting)"}),e.jsx("div",{style:{fontSize:"18px",fontWeight:600,marginBottom:"4px"},children:(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("cross site scripting")||N.name.toLowerCase().includes("xss")).length>0?"ë°œê²¬ë¨":"ì•ˆì „"}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("cross site scripting")||N.name.toLowerCase().includes("xss")).length,"ê°œ ì•Œë¦¼"]})]})}),e.jsx(Y,{span:8,children:e.jsxs("div",{style:{padding:"12px",borderRadius:"8px",background:(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("auth")||N.name.toLowerCase().includes("session")||N.name.toLowerCase().includes("cookie")).length>0?"#fff1f0":"#f6ffed",border:`1px solid ${(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("auth")||N.name.toLowerCase().includes("session")||N.name.toLowerCase().includes("cookie")).length>0?"#ffa39e":"#b7eb8f"}`},children:[e.jsx("div",{style:{fontSize:"12px",color:"#595959",marginBottom:"8px"},children:"ì¸ì¦/ì„¸ì…˜ ë³´ì•ˆ"}),e.jsx("div",{style:{fontSize:"18px",fontWeight:600,marginBottom:"4px"},children:(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("auth")||N.name.toLowerCase().includes("session")||N.name.toLowerCase().includes("cookie")).length>0?"ì·¨ì•½ì  ë°œê²¬":"ì•ˆì „"}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[(m.alerts||[]).filter(N=>N.name.toLowerCase().includes("auth")||N.name.toLowerCase().includes("session")||N.name.toLowerCase().includes("cookie")).length,"ê°œ ì•Œë¦¼"]})]})})]})}),Z=e.jsxs(ie,{title:"ë°œê²¬ëœ ë³´ì•ˆ ì•Œë¦¼ ëª©ë¡",size:"small",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,padding:"12px 16px",background:"#f8fafc",borderRadius:8,marginBottom:16,border:"1px solid #e2e8f0"},children:[e.jsxs(g,{children:[e.jsx(mn,{style:{color:"#64748b"}}),e.jsxs(Ia,{strong:!0,children:[(m.alerts||[]).length,"ê±´ ë°œê²¬"]})]}),e.jsx("div",{style:{width:1,height:16,background:"#e2e8f0"}}),e.jsxs(g,{children:[e.jsxs(T,{color:"red",children:[((K=m.summary)==null?void 0:K.high_alerts)||0," High"]}),e.jsxs(T,{color:"orange",children:[((J=m.summary)==null?void 0:J.medium_alerts)||0," Medium"]}),e.jsxs(T,{color:"blue",children:[(((te=m.summary)==null?void 0:te.low_alerts)||0)+(((G=m.summary)==null?void 0:G.info_alerts)||0)," ","Low/Info"]})]})]}),e.jsx("div",{style:{maxHeight:"600px",overflow:"auto",paddingRight:"8px"},children:(m.alerts||[]).length===0?e.jsx(xe,{message:"ë³´ì•ˆ ì·¨ì•½ì  ì—†ìŒ",description:"ë¶„ì„ ê²°ê³¼ ë³´ì•ˆ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.",type:"success",showIcon:!0,icon:e.jsx(Ze,{}),style:{marginBottom:yr.lg,borderRadius:ma.lg,border:"2px solid #b7eb8f"}}):(m.alerts||[]).map((N,ge)=>{const je=Iu({4:"critical",3:"high",2:"medium",1:"low",0:"info"}[N.riskcode]||"low"),Pe=ra[je];return e.jsx(ie,{size:"small",style:Si.vulnerabilityDetail(je),styles:{header:Si.vulnerabilityDetailHeader(je),body:{padding:yr.lg}},title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:yr.sm},children:[e.jsxs(g,{size:yr.sm,children:[e.jsx("div",{style:{width:24,height:24,borderRadius:"50%",background:Pe.primary,color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:"bold"},children:ge+1}),e.jsx(T,{color:Tu(je),style:{margin:0},children:Rc[je]}),e.jsx(Ia,{strong:!0,style:{fontSize:14},children:N.name})]}),e.jsx(g,{size:4,children:e.jsxs(T,{color:"volcano",style:{margin:0},children:["CWE-",N.cweid]})})]}),children:e.jsxs(g,{direction:"vertical",size:yr.md,style:{width:"100%"},children:[N.description&&e.jsx(Ia,{style:{fontSize:13,color:"#595959",display:"block",lineHeight:1.6},children:N.description}),e.jsxs(Se,{size:"small",column:2,children:[e.jsx(Se.Item,{label:e.jsxs(g,{children:[e.jsx(ni,{}),"í”ŒëŸ¬ê·¸ì¸ ID"]}),children:e.jsx(Ia,{code:!0,children:N.pluginid})}),e.jsx(Se.Item,{label:"WASC",children:e.jsxs(T,{color:"blue",children:["WASC-",N.wascid]})})]}),N.solution&&e.jsxs("div",{style:{background:"#f6ffed",padding:yr.md,borderRadius:ma.md,border:"1px solid #b7eb8f"},children:[e.jsxs(Ia,{type:"secondary",style:{fontSize:12},children:[e.jsx(Ze,{style:{marginRight:4}})," í•´ê²° ë°©ë²•:"]}),e.jsx("div",{style:{marginTop:4},children:e.jsx(Ia,{style:{fontSize:13,lineHeight:1.6},children:N.solution})})]}),N.instances&&N.instances.length>0&&e.jsx(nr,{ghost:!0,expandIcon:({isActive:w})=>e.jsx(yc,{rotate:w?90:0,style:{fontSize:10}}),items:[{key:"1",label:e.jsxs(g,{children:[e.jsx(eg,{}),e.jsxs(Ia,{style:{fontSize:13},children:["ë°œê²¬ëœ ìœ„ì¹˜ (",N.instances.length,"ê±´)"]})]}),children:e.jsxs("div",{style:{maxHeight:"150px",overflow:"auto"},children:[N.instances.slice(0,5).map((w,R)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,padding:"6px 8px",background:"#fff",borderRadius:ma.sm,border:"1px solid #e8e8e8"},children:[e.jsx(T,{color:"geekblue",style:{margin:0,fontSize:11},children:w.method}),e.jsx(Ia,{code:!0,style:{fontSize:11,wordBreak:"break-all"},children:w.uri})]},R)),N.instances.length>5&&e.jsxs(Ia,{type:"secondary",style:{fontSize:11},children:["+ ",N.instances.length-5,"ê±´ ë” ìˆìŒ"]})]})}]})]})},ge)})})]}),se=e.jsx(ie,{title:"ë„ë©”ì¸ ê²€ì‚¬ ì‹¤í–‰ ë¡œê·¸",size:"small",children:e.jsx("div",{style:{maxHeight:400,overflowY:"auto",backgroundColor:"#1e1e1e",padding:"16px",borderRadius:"4px",fontFamily:'Monaco, Menlo, "Ubuntu Mono", Consolas, "source-code-pro", monospace',fontSize:"12px",lineHeight:1.5,color:"#d4d4d4"},children:m.execution_log&&((q=m.execution_log)!=null&&q.log_messages)&&m.execution_log.log_messages.length>0?e.jsxs("div",{children:[e.jsx(Ia,{strong:!0,style:{color:"#fa8c16",display:"block",marginBottom:"8px"},children:"ZAP ìŠ¤ìº”:"}),m.execution_log.log_messages.map((N,ge)=>e.jsx("pre",{style:{margin:0,marginBottom:4},children:N},ge))]}):e.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#888"},children:e.jsx(Ia,{type:"secondary",style:{color:"#888"},children:"ì‹¤í–‰ ë¡œê·¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})})})}),ce=e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",paddingBottom:"12px",borderBottom:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(ur,{style:{color:"#1890ff",fontSize:"18px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:"ë„ë©”ì¸ ê²€ì‚¬ ê²°ê³¼"})]}),a&&e.jsx(B,{type:"primary",icon:e.jsx(In,{}),onClick:b,disabled:E,loading:E,size:"small",style:{minWidth:"100px"},children:E?"ìŠ¤ìº” ì¤‘...":"ìŠ¤ìº” ì‹¤í–‰"})]});if(!p)return e.jsxs("div",{style:{padding:"16px"},children:[ce,W]});const D=e.jsx(xe,{type:"info",showIcon:!0,icon:e.jsx(Ks,{}),style:{marginBottom:16,borderRadius:8},message:e.jsx("span",{style:{fontWeight:600},children:"ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì·¨ì•½ì  ë¶„ì„ (DAST)"}),description:e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{marginBottom:12,color:"#666"},children:"OWASP(Open Web Application Security Project) ê¸°ë°˜ì˜ ì›¹ ë³´ì•ˆ ì·¨ì•½ì  ë¶„ë¥˜ì…ë‹ˆë‹¤. ZAP ìŠ¤ìºë„ˆë¥¼ í†µí•´ ë°œê²¬ëœ ì·¨ì•½ì ë“¤ì´ ìœ„í—˜ë„ì— ë”°ë¼ ë¶„ë¥˜ë©ë‹ˆë‹¤."}),e.jsx(Ke,{gutter:[8,8],children:Object.values(G_).map(N=>e.jsx(Y,{xs:12,sm:4,children:e.jsx(Ie,{title:N.description,placement:"top",children:e.jsxs("div",{style:{padding:"8px 12px",background:"#fff",borderRadius:6,border:"1px solid #f0f0f0",cursor:"help",textAlign:"center"},children:[e.jsx("span",{style:{marginRight:4},children:N.icon}),e.jsx("span",{style:{fontWeight:500,color:N.color},children:N.label})]})})},N.label))}),e.jsxs("div",{style:{marginTop:12,fontSize:12,color:"#888"},children:[e.jsx("strong",{children:"ì£¼ìš” ì¹´í…Œê³ ë¦¬:"})," ì¸ì ì…˜, XSS, ì¸ì¦ì·¨ì•½ì , ì ‘ê·¼í†µì œ, ë³´ì•ˆì„¤ì •ì˜¤ë¥˜, CSRF, SSRF ë“±"]})]})}),M=e.jsxs("div",{children:[e.jsxs(ie,{title:e.jsxs("span",{children:[e.jsx(ni,{style:{marginRight:8}}),"ìŠ¤ìº” ìš”ì•½"]}),size:"small",style:{marginBottom:16,borderRadius:8},children:[e.jsx(Dx,{counts:{critical:0,high:((oe=m.summary)==null?void 0:oe.high_alerts)||0,medium:((be=m.summary)==null?void 0:be.medium_alerts)||0,low:((ne=m.summary)==null?void 0:ne.low_alerts)||0,info:((ye=m.summary)==null?void 0:ye.info_alerts)||0},visibleLevels:["high","medium","low","info"],showProgress:!0,size:"small"}),((Ue=m.summary)==null?void 0:Ue.scan_time)&&e.jsxs("div",{style:{marginTop:12,color:"#666",fontSize:13,textAlign:"center"},children:[e.jsx(pr,{style:{marginRight:6}}),"ìŠ¤ìº” ì†Œìš” ì‹œê°„: ",m.summary.scan_time,"ì´ˆ"]})]}),W,se]});return e.jsxs("div",{style:{padding:"16px"},children:[ce,E&&m&&e.jsx(Ru,{scanType:"dast",startTime:I||void 0,targetName:n}),e.jsx(zu,{isScanning:E,children:e.jsxs(xs,{activeKey:y,onChange:N=>v(N),style:{marginBottom:16},children:[e.jsxs(Id,{tab:e.jsxs("span",{children:[e.jsx(bc,{style:{marginRight:6}}),"ì·¨ì•½ì  ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜"]}),children:[D,e.jsx(Tc,{repoId:t||s||0,onRefresh:()=>j(),analysisType:"dast"})]},"checklist"),e.jsx(Id,{tab:e.jsxs("span",{children:[e.jsx(mn,{style:{marginRight:6}}),"ì·¨ì•½ì  ìƒì„¸"]}),children:Z},"details"),e.jsx(Id,{tab:e.jsxs("span",{children:[e.jsx(pr,{style:{marginRight:6}}),"ë¶„ì„ ì •ë³´"]}),children:M},"info")]})})]})},{Text:uk}=we,Mw=({visible:s,onClose:t,repoId:r,repoName:n="ì €ì¥ì†Œ",repoUrl:a,analysisType:i,serviceId:l,infraType:d="kubernetes",onScanStateChange:c})=>{const[p,h]=o.useState(!1),[x,_]=o.useState(null),[S,L]=o.useState(!1),[k,E]=o.useState(null),[P,I]=o.useState([]),[$,y]=o.useState(""),[v,u]=o.useState([]),[m,j]=o.useState(""),[b,A]=o.useState(""),[W,Z]=o.useState(""),{updateSecurityState:se,updateSecurityLastUpdate:ce}=Gs(),[D,M]=o.useState(null),[K,J]=o.useState(!1),[te,G]=o.useState(!1),[q,oe]=o.useState(!1),[be,ne]=o.useState(void 0);o.useEffect(()=>{(async()=>{if(l&&i==="sca")try{const R=await vo(l);if(R.registry_config){const U=JSON.parse(R.registry_config);ne({registry_type:U.registry_type==="dockerhub"?"dockerhub":"harbor",registry_url:U.registry_url||"",username:U.username||"",password:U.password||"",project_name:U.project_name||""})}}catch(R){console.error("Registry config ì¡°íšŒ ì‹¤íŒ¨:",R)}})()},[l,i]);const Ue=(()=>{switch(i){case"sast":return{title:"SAST ë¶„ì„ ê²°ê³¼",icon:e.jsx(pr,{}),emptyIcon:e.jsx(pr,{}),emptyMessage:"SAST ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤",emptyDescription:"ìŠ¤ìº”ì„ ì‹œì‘í•˜ì—¬ ë³´ì•ˆ ì·¨ì•½ì ì„ ë¶„ì„í•´ë³´ì„¸ìš”",tabs:[{key:"summary",label:"ìš”ì•½"},{key:"semgrep",label:"Semgrep ìƒì„¸"},{key:"codeql",label:"CodeQL ìƒì„¸"},{key:"logs",label:"ì‹¤í–‰ ë¡œê·¸"}]};case"sca":return{title:"SCA ë¶„ì„ ê²°ê³¼",icon:e.jsx(bi,{}),emptyIcon:e.jsx(bi,{}),emptyMessage:"SCA ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤",emptyDescription:"ìŠ¤ìº”ì„ ì‹œì‘í•˜ì—¬ ì˜ì¡´ì„± ì·¨ì•½ì ì„ ë¶„ì„í•´ë³´ì„¸ìš”",tabs:[{key:"summary",label:"ìš”ì•½"},{key:"vulnerabilities",label:"ì·¨ì•½ì  ëª©ë¡"},{key:"logs",label:"ì‹¤í–‰ ë¡œê·¸"}]};case"dast":return{title:"DAST ë¶„ì„ ê²°ê³¼",icon:e.jsx(ur,{}),emptyIcon:e.jsx(ni,{}),emptyMessage:"DAST ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤",emptyDescription:"ìŠ¤ìº”ì„ ì‹œì‘í•˜ì—¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì·¨ì•½ì ì„ ë¶„ì„í•´ë³´ì„¸ìš”",tabs:[{key:"summary",label:"ìš”ì•½"},{key:"alerts",label:"ë³´ì•ˆ ì•Œë¦¼"},{key:"logs",label:"ì‹¤í–‰ ë¡œê·¸"}]};case"sbom":return{title:"SBOM ë¶„ì„ ê²°ê³¼",icon:e.jsx(ai,{}),emptyIcon:e.jsx(ai,{}),emptyMessage:"SBOM ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤",emptyDescription:"SCA ìŠ¤ìº”ì„ ì‹¤í–‰í•˜ë©´ SBOMì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤",tabs:[{key:"sbom",label:"SBOM êµ¬ì„±ìš”ì†Œ"},{key:"license",label:"ë¼ì´ì„ ìŠ¤ ë¶„ì„"}]};default:return{title:"ë³´ì•ˆ ë¶„ì„ ê²°ê³¼",icon:e.jsx(pr,{}),emptyIcon:e.jsx(pr,{}),emptyMessage:"ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤",emptyDescription:"ìŠ¤ìº”ì„ ì‹œì‘í•˜ì—¬ ë³´ì•ˆ ì·¨ì•½ì ì„ ë¶„ì„í•´ë³´ì„¸ìš”",tabs:[{key:"summary",label:"ìš”ì•½"}]}}})(),N=o.useCallback(async()=>{var w,R,U;if(!(!s||!r)){h(!0),_(null);try{let V;switch(i){case"sast":V=await Xt.getSastResult(r);break;case"sca":V=await Xt.getScaResult(r);break;case"dast":V=await Xt.getDastResult(r);break;case"sbom":M({sbom:!0}),h(!1);return;default:throw new Error("ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¶„ì„ íƒ€ì…ì…ë‹ˆë‹¤.")}const F=V.data?V.data:V,X=F;if(X.status==="completed")if(i==="sca"&&X.result){const de=X.result;if(de.tool==="trivy"&&de.result&&de.result.scan_result){const Ne=de.result.scan_result;let ae=[];Ne.results&&Array.isArray(Ne.results)&&Ne.results.forEach(Fe=>{Fe.vulnerabilities&&Array.isArray(Fe.vulnerabilities)&&(ae=ae.concat(Fe.vulnerabilities.map(Le=>({name:Le.pkg_name,version:Le.installed_version,severity:Le.severity,description:Le.description,cve:Le.vulnerability_id,fix_available:!!Le.fixed_version,fixed_version:Le.fixed_version,references:Le.references}))))});const pe={high:ae.filter(Fe=>{const Le=String(Fe.severity).toLowerCase();return Le==="high"||Le==="critical"}).length,medium:ae.filter(Fe=>String(Fe.severity).toLowerCase()==="medium").length,low:ae.filter(Fe=>String(Fe.severity).toLowerCase()==="low").length,info:ae.filter(Fe=>{const Le=String(Fe.severity).toLowerCase();return Le==="info"||Le==="unknown"}).length},Xe=X.execution_log||de.execution_logs||((w=de.summary)==null?void 0:w.execution_logs)||{log_messages:[],total_duration:0},Nt={...de,vulnerabilities:ae,dependencies:[],summary:{total_vulnerabilities:ae.length,total_dependencies:0,severity_breakdown:pe,scan_time:((R=X.summary)==null?void 0:R.scan_time)||((U=de.summary)==null?void 0:U.scan_time)||0},execution_log:Xe};M(Nt)}else M(de)}else if(i==="dast"&&X.result){const de=X.result;let Ne={},ae={log_messages:[],total_duration:0},pe=[],Xe={};de.result&&(Ne=de.result,Ne.results&&Ne.results.alerts?(pe=Ne.results.alerts,Ne.results.total_alerts!==void 0&&(Xe={total_alerts:Ne.results.total_alerts,high_alerts:Ne.results.high_alerts||0,medium_alerts:Ne.results.medium_alerts||0,low_alerts:Ne.results.low_alerts||0,info_alerts:Ne.results.info_alerts||0,scan_time:Ne.results.scan_time||0})):Ne.site&&Array.isArray(Ne.site)&&Ne.site.length>0&&(pe=Ne.site[0].alerts||[]),Ne.summary&&Object.keys(Xe).length===0&&(Xe=Ne.summary),Object.keys(Xe).length===0&&pe.length>0&&(Xe={total_alerts:pe.length,high_alerts:pe.filter(Le=>{var Oe,Mt;return Le.riskcode==="3"||Le.riskcode==="4"||((Oe=Le.riskdesc)==null?void 0:Oe.toLowerCase().includes("high"))||((Mt=Le.riskdesc)==null?void 0:Mt.toLowerCase().includes("critical"))}).length,medium_alerts:pe.filter(Le=>{var Oe;return Le.riskcode==="2"||((Oe=Le.riskdesc)==null?void 0:Oe.toLowerCase().includes("medium"))}).length,low_alerts:pe.filter(Le=>{var Oe;return Le.riskcode==="1"||((Oe=Le.riskdesc)==null?void 0:Oe.toLowerCase().includes("low"))}).length,info_alerts:pe.filter(Le=>{var Oe;return Le.riskcode==="0"||((Oe=Le.riskdesc)==null?void 0:Oe.toLowerCase().includes("info"))}).length})),de.alerts&&(pe=de.alerts),de.summary&&(Xe=de.summary),de.execution_log&&(ae=de.execution_log);const Nt={alerts:pe,summary:{total_alerts:Xe.total_alerts||pe.length,high_alerts:Xe.high_alerts||0,medium_alerts:Xe.medium_alerts||0,low_alerts:Xe.low_alerts||0,info_alerts:Xe.info_alerts||0,scan_time:Xe.scan_time||0},execution_log:ae};M(Nt)}else M(X.result?X.result:F);else X.status==="pending"?(M(null),_(`${i.toUpperCase()} ìŠ¤ìº”ì´ ì•„ì§ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.`)):X.status==="not_found"?(M(null),_(`${i.toUpperCase()} ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìŠ¤ìº”ì„ ì‹œì‘í•˜ì—¬ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.`)):(M(null),_(`${i.toUpperCase()} ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`))}catch(V){const F=V instanceof Error?V.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";_(`${i.toUpperCase()} ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${F}`)}finally{h(!1)}}},[s,r,i]);o.useEffect(()=>{s&&N()},[s,r,N]),o.useEffect(()=>{if(!s)return;const w=async()=>{try{const{useCredsStore:U}=await vn(async()=>{const{useCredsStore:F}=await Promise.resolve().then(()=>Vo);return{useCredsStore:F}},void 0),V=U.getState();switch(i){case"sast":{const{sourceRepository:F}=V;if(!a)break;const X=a.replace(new RegExp("/[^/]+\\.git$"),"").replace(new RegExp("/$"),"");F.some(Ne=>{var ae;return X.includes(Ne.baseUrl)||((ae=Ne.baseUrl)==null?void 0:ae.includes(X))})||J(!0);break}case"sca":{const{imageRegistry:F}=V;F.length===0&&G(!0);break}case"dast":{D||oe(!0);break}}}catch(U){}},R=setTimeout(()=>{w()},300);return()=>clearTimeout(R)},[s,i,a,D]);const ge=o.useCallback(async()=>{switch(i){case"sast":J(!0);break;case"sca":G(!0);break;case"dast":oe(!0);break;case"sbom":f.info("SBOMì€ SCA ìŠ¤ìº” ì‹œ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤. SCA ë¶„ì„ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.");break;default:_("ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¶„ì„ íƒ€ì…ì…ë‹ˆë‹¤.")}},[i]),Ce=o.useCallback(async w=>{J(!1);try{L(!0),E(new Date),c==null||c(i,"analyzing"),a&&se(a,"sast","analyzing"),await Xt.executeSastScan({repo_id:r,git_url:w.git_url,branch:w.branch,git_token:w.git_token,generate_sbom:w.generate_sbom,license_analysis:w.license_analysis}),await N(),c==null||c(i,"completed"),a&&(se(a,"sast","completed"),ce(a,"sast",new Date().toISOString())),f.success("SAST ìŠ¤ìº”ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(R){let U="SAST ìŠ¤ìº” ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";Qo(R)?(U=`SAST ìŠ¤ìº” ì‹¤íŒ¨: ${R.message}`,O.error("[SAST] ìŠ¤ìº” ì‹¤íŒ¨:",new Error(`[${R.code}] ${R.message}`))):R instanceof Error&&(U=`SAST ìŠ¤ìº” ì‹¤íŒ¨: ${R.message}`,O.error("[SAST] ìŠ¤ìº” ì—ëŸ¬:",R)),c==null||c(i,"failed"),a&&se(a,"sast","failed"),_(U),f.error(U)}finally{L(!1),E(null)}},[r,N,c,se,ce,a]),je=o.useCallback(async w=>{G(!1);try{if(L(!0),E(new Date),c==null||c(i,"analyzing"),a&&se(a,"sca","analyzing"),await Xt.trivyScanImage({repo_id:r,image_url:w.image_url,scan_type:w.scan_type||"vuln",registry_username:w.registry_username,registry_password:w.registry_password}),w.generate_sbom)try{await Xt.generateImageSbom({repo_id:r,image_url:w.image_url,license_analysis:w.license_analysis||!1,registry_username:w.registry_username,registry_password:w.registry_password}),f.success("SBOMì´ ìë™ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(R){const U=R instanceof Error?R.message:"SBOM ìƒì„± ì„œë¹„ìŠ¤ ì˜¤ë¥˜";console.error("[SBOM] Generation failed:",U),f.warning(`SBOM ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${U}`)}await N(),c==null||c(i,"completed"),a&&(se(a,"sca","completed"),ce(a,"sca",new Date().toISOString())),f.success("SCA ìŠ¤ìº”ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(R){let U="SCA ìŠ¤ìº” ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";Qo(R)?(U=`SCA ìŠ¤ìº” ì‹¤íŒ¨: ${R.message}`,O.error("[SCA] ìŠ¤ìº” ì‹¤íŒ¨:",new Error(`[${R.code}] ${R.message}`))):R instanceof Error&&(U=`SCA ìŠ¤ìº” ì‹¤íŒ¨: ${R.message}`,O.error("[SCA] ìŠ¤ìº” ì—ëŸ¬:",R)),c==null||c(i,"failed"),a&&se(a,"sca","failed"),_(U),f.error(U)}finally{L(!1),E(null)}},[r,N,c,se,ce,a]),Pe=o.useCallback(async w=>{oe(!1);try{L(!0),E(new Date),c==null||c(i,"analyzing"),a&&se(a,"dast","analyzing"),await Xt.dastScanWeb({repo_id:r,target_url:w.target_url,scan_type:w.scan_type||"baseline",options:w.options}),await N(),c==null||c(i,"completed"),a&&(se(a,"dast","completed"),ce(a,"dast",new Date().toISOString())),f.success("DAST ìŠ¤ìº”ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(R){let U="DAST ìŠ¤ìº” ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";Qo(R)?(U=`DAST ìŠ¤ìº” ì‹¤íŒ¨: ${R.message}`,O.error("[DAST] ìŠ¤ìº” ì‹¤íŒ¨:",new Error(`[${R.code}] ${R.message}`))):R instanceof Error&&(U=`DAST ìŠ¤ìº” ì‹¤íŒ¨: ${R.message}`,O.error("[DAST] ìŠ¤ìº” ì—ëŸ¬:",R)),c==null||c(i,"failed"),a&&se(a,"dast","failed"),_(U),f.error(U)}finally{L(!1),E(null)}},[r,N,c,se,ce,a]);return e.jsxs(rt,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",paddingRight:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[Ue.icon,e.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold"},children:[Ue.title," - ",n]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexShrink:0},children:[e.jsx(B,{size:"small",onClick:t,style:{marginRight:"4px"},children:"ë‹«ê¸°"}),e.jsx(B,{type:"primary",size:"small",icon:e.jsx(In,{}),onClick:()=>ge(),disabled:S,loading:S,style:{minWidth:"100px",height:"28px"},children:S?"ìŠ¤ìº” ì¤‘...":"ìŠ¤ìº” ì‹œì‘"})]})]}),open:s,onCancel:t,closeIcon:!1,footer:null,width:1400,style:{top:20},styles:{body:{maxHeight:"calc(100vh - 200px)",overflow:"auto",padding:"16px"}},destroyOnClose:!0,children:[p?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsxs("p",{style:{marginTop:"16px",fontSize:"16px",color:"#666"},children:[Ue.title,"ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."]})]}):S?e.jsx(Ic,{scanType:i,visible:S,onClose:t,startTime:k||void 0,serviceName:n}):x?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#ff4d4f"},children:[e.jsx(mn,{style:{fontSize:"48px",marginBottom:"16px"}}),e.jsx("p",{style:{fontSize:"16px",margin:0},children:x})]}):D?e.jsx(xs,{defaultActiveKey:"result",items:[{key:"result",label:e.jsxs("span",{children:[e.jsx(pu,{}),"ë¶„ì„ ê²°ê³¼"]}),children:e.jsxs("div",{children:[i==="sast"&&e.jsx(Fx,{sastResult:D,loading:!1,showTabs:!1}),i==="sca"&&e.jsx(Pw,{scaResult:D,loading:!1}),i==="dast"&&e.jsx(Ux,{dastResult:D,loading:!1,onScanStateChange:w=>{c==null||c("dast",w)}}),i==="sbom"&&l&&e.jsx(pc,{serviceId:l,onRefresh:()=>N(),sbomType:"image"})]})},{key:"checklist",label:e.jsxs("span",{children:[e.jsx(bc,{}),"ì²´í¬ë¦¬ìŠ¤íŠ¸"]}),children:e.jsx(Tc,{repoId:r,onRefresh:()=>N()})},...i==="sca"&&l?[{key:"sbom",label:e.jsxs("span",{children:[e.jsx(ai,{}),"SBOM / ë¼ì´ì„ ìŠ¤"]}),children:e.jsx(pc,{serviceId:l,onRefresh:()=>N(),sbomType:"image"})}]:[]]}):e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[Ct.cloneElement(Ue.emptyIcon,{style:{fontSize:"48px",color:"#1890ff",marginBottom:"16px"}}),e.jsx("p",{style:{fontSize:"16px",margin:"0 0 8px 0"},children:Ue.emptyMessage}),e.jsx("p",{style:{fontSize:"14px",color:"#666",margin:0},children:Ue.emptyDescription})]}),e.jsx($x,{visible:K,onClose:()=>J(!1),onConfirm:Ce,loading:S,initialGitUrl:a}),e.jsx(Bx,{visible:te,onClose:()=>G(!1),onConfirm:je,loading:S,registryConfig:be}),e.jsx(ku,{visible:q,onClose:()=>oe(!1),onConfirm:Pe,loading:S,serviceId:l,infraType:d})]})},{Text:Bn}=we,Sp={JavaScript:"#f1e05a",TypeScript:"#3178c6",Go:"#00ADD8",Python:"#3572A5",Java:"#b07219","C++":"#f34b7d",C:"#555555",Ruby:"#701516",PHP:"#4F5D95",Swift:"#F05138",Kotlin:"#A97BFF",Rust:"#dea584",Shell:"#89e051",HTML:"#e34c26",CSS:"#563d7c",Vue:"#41b883",React:"#61dafb"},Lw=({statistics:s,loading:t=!1})=>{var a,i;if(!s)return e.jsx(ie,{loading:t,children:e.jsx(Bn,{type:"secondary",children:"ì €ì¥ì†Œ í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."})});const r=((a=s.languages)==null?void 0:a.slice(0,3))||[],n=((i=s.languages)==null?void 0:i.slice(3).reduce((l,d)=>l+d.percentage,0))||0;return e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(ie,{size:"small",variant:"borderless",children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ì´ ì»¤ë°‹",value:s.commit_count,prefix:e.jsx(Jn,{}),valueStyle:{fontSize:"20px"}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ë¸Œëœì¹˜",value:s.branches_count,prefix:e.jsx(Od,{}),valueStyle:{fontSize:"20px"}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ê¸°ì—¬ì",value:s.contributors_count,prefix:e.jsx(Jp,{}),valueStyle:{fontSize:"20px"}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"íƒœê·¸",value:s.tags_count,prefix:e.jsx(Ju,{}),valueStyle:{fontSize:"20px"}})})]})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,md:12,children:e.jsx(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(wr,{}),e.jsx("span",{children:"ìµœê·¼ í™œë™"})]}),variant:"borderless",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(Bn,{type:"secondary",children:"ìµœê·¼ 7ì¼ ì»¤ë°‹"}),e.jsx("div",{style:{marginTop:8},children:e.jsx(qt,{percent:s.commit_count>0?Math.min(s.recent_commits_7d/s.commit_count*1e3,100):0,strokeColor:"#52c41a",format:()=>`${s.recent_commits_7d}ê±´`})})]}),e.jsxs("div",{children:[e.jsx(Bn,{type:"secondary",children:"ìµœê·¼ 30ì¼ ì»¤ë°‹"}),e.jsx("div",{style:{marginTop:8},children:e.jsx(qt,{percent:s.commit_count>0?Math.min(s.recent_commits_30d/s.commit_count*500,100):0,strokeColor:"#1890ff",format:()=>`${s.recent_commits_30d}ê±´`})})]}),e.jsx(xt,{style:{margin:"12px 0"}}),e.jsx("div",{children:e.jsxs(g,{children:[e.jsx(Bn,{type:"secondary",children:"ë§ˆì§€ë§‰ í™œë™:"}),e.jsx(Bn,{strong:!0,children:f0(s.last_activity_at,"relative")})]})})]})})}),s.languages&&s.languages.length>0&&e.jsx(Y,{xs:24,md:12,children:e.jsx(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(Jn,{}),e.jsx("span",{children:"ì–¸ì–´ ë¶„í¬"})]}),variant:"borderless",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"small",children:[r.map(l=>e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsxs(g,{size:"small",children:[e.jsx("div",{style:{width:12,height:12,borderRadius:2,backgroundColor:Sp[l.name]||"#8c8c8c"}}),e.jsx(Bn,{children:l.name})]}),e.jsxs(Bn,{strong:!0,children:[l.percentage.toFixed(1),"%"]})]}),e.jsx(qt,{percent:l.percentage,strokeColor:Sp[l.name]||"#8c8c8c",showInfo:!1,size:"small"})]},l.name)),n>0&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsxs(g,{size:"small",children:[e.jsx("div",{style:{width:12,height:12,borderRadius:2,backgroundColor:"#d9d9d9"}}),e.jsx(Bn,{type:"secondary",children:"ê¸°íƒ€"})]}),e.jsxs(Bn,{children:[n.toFixed(1),"%"]})]}),e.jsx(qt,{percent:n,strokeColor:"#d9d9d9",showInfo:!1,size:"small"})]})]})})})]}),s.top_contributors&&s.top_contributors.length>0&&e.jsx(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(Un,{}),e.jsx("span",{children:"ì£¼ìš” ê¸°ì—¬ì TOP 5"})]}),variant:"borderless",children:e.jsx(Ke,{gutter:[8,8],children:s.top_contributors.map((l,d)=>e.jsx(Y,{xs:24,sm:12,md:8,children:e.jsx(ie,{size:"small",style:{textAlign:"center"},children:e.jsxs(g,{direction:"vertical",size:"small",children:[e.jsxs(T,{color:d===0?"gold":d===1?"silver":d===2?"#cd7f32":"default",children:["#",d+1]}),e.jsx(Ie,{title:l.email,children:e.jsx(Bn,{strong:!0,children:l.name})}),e.jsxs(Bn,{type:"secondary",children:[l.commits," ì»¤ë°‹"]}),(l.additions>0||l.deletions>0)&&e.jsxs(g,{size:"small",children:[e.jsxs(Bn,{type:"success",style:{fontSize:"12px"},children:["+",l.additions.toLocaleString()]}),e.jsxs(Bn,{type:"danger",style:{fontSize:"12px"},children:["-",l.deletions.toLocaleString()]})]})]})})},l.email))})}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",variant:"borderless",children:e.jsx($e,{title:"Open Issues",value:s.open_issues_count,prefix:e.jsx(Hm,{}),valueStyle:{color:s.open_issues_count>0?"#faad14":"#52c41a",fontSize:"20px"}})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx(ie,{size:"small",variant:"borderless",children:e.jsx($e,{title:"Open MRs",value:s.open_merge_requests_count,prefix:e.jsx(Zp,{}),valueStyle:{color:s.open_merge_requests_count>0?"#1890ff":"#52c41a",fontSize:"20px"}})})}),e.jsx(Y,{xs:24,sm:12,children:e.jsx(ie,{size:"small",variant:"borderless",children:e.jsxs(g,{direction:"vertical",children:[e.jsx(Bn,{type:"secondary",children:"ê¸°ë³¸ ë¸Œëœì¹˜"}),e.jsx(T,{color:"blue",icon:e.jsx(Od,{}),children:s.default_branch}),s.latest_tag&&e.jsxs(e.Fragment,{children:[e.jsx(Bn,{type:"secondary",children:"ìµœì‹  íƒœê·¸"}),e.jsx(T,{color:"green",icon:e.jsx(Ju,{}),children:s.latest_tag.name})]})]})})})]})]})},{Text:ti}=we,Aw=({visible:s,onClose:t,serviceId:r,missingVars:n,errorAnalysis:a})=>{const[i]=H.useForm(),[l,d]=o.useState(!1),[c,p]=o.useState(null),h=async _=>{var S;d(!0),p(null);try{const L=await ee.pipeline("createEnvFile",{id:r,missing_vars:n,env_values:_});if(L.success)p({success:!0,message:`.env íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì–´ ${((S=L.data)==null?void 0:S.git_branch)||"main"} ë¸Œëœì¹˜ì— ì»¤ë°‹ë˜ì—ˆìŠµë‹ˆë‹¤.`}),O.info(".env íŒŒì¼ ìƒì„± ì„±ê³µ:",L.data),setTimeout(()=>{i.resetFields(),p(null),t()},2e3);else throw new Error(L.error||".env íŒŒì¼ ìƒì„± ì‹¤íŒ¨")}catch(L){O.error(".env íŒŒì¼ ìƒì„± ì‹¤íŒ¨:",L),p({success:!1,message:L.message||".env íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}finally{d(!1)}},x=()=>{i.resetFields(),p(null),t()};return e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(Ks,{style:{color:"#1890ff"}}),e.jsx(ti,{strong:!0,children:".env íŒŒì¼ ìë™ ìƒì„±"})]}),open:s,onCancel:x,footer:null,width:600,maskClosable:!l,children:[a&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{message:a.title,description:a.description,type:"warning",showIcon:!0,style:{marginBottom:20}}),e.jsx(xt,{})]}),e.jsx(xe,{message:"âš ï¸ Git ì €ì¥ì†Œ ì§ì ‘ ì»¤ë°‹",description:e.jsx("div",{children:e.jsxs("ul",{style:{margin:"8px 0",paddingLeft:20},children:[e.jsx("li",{style:{marginBottom:4},children:e.jsx(ti,{strong:!0,children:"ìƒì„±ëœ .env íŒŒì¼ì€ Git ì €ì¥ì†Œì— ì§ì ‘ ì»¤ë°‹ë©ë‹ˆë‹¤"})}),e.jsx("li",{style:{marginBottom:4},children:e.jsxs(ti,{children:["ì´ë¯¸ .env íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°"," ",e.jsx(ti,{type:"danger",strong:!0,children:"ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤"})]})}),e.jsx("li",{style:{marginBottom:4},children:e.jsx(ti,{children:"ì„œë¹„ìŠ¤ì— ì„¤ì •ëœ ë¸Œëœì¹˜(ë˜ëŠ” main)ì— ì €ì¥ë©ë‹ˆë‹¤"})}),e.jsx("li",{children:e.jsx(ti,{type:"secondary",style:{fontSize:12},children:"ì…ë ¥í•œ í™˜ê²½ ë³€ìˆ˜ ê°’ì€ Git ì´ë ¥ì— ë‚¨ìœ¼ë¯€ë¡œ ë¯¼ê°í•œ ì •ë³´ëŠ” ì£¼ì˜í•˜ì„¸ìš”"})})]})}),type:"warning",showIcon:!0,style:{marginBottom:20}}),e.jsx("div",{style:{marginBottom:16},children:e.jsx(ti,{type:"secondary",children:'ë‹¤ìŒ í™˜ê²½ ë³€ìˆ˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. ê°’ì„ ì…ë ¥í•˜ê³  "ìƒì„± ë° ì»¤ë°‹" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.'})}),c&&e.jsx(xe,{message:c.success?"ì„±ê³µ":"ì‹¤íŒ¨",description:c.message,type:c.success?"success":"error",icon:c.success?e.jsx(Ze,{}):e.jsx(Es,{}),showIcon:!0,style:{marginBottom:20}}),e.jsxs(H,{form:i,layout:"vertical",onFinish:h,disabled:l||(c==null?void 0:c.success)===!0,children:[n.map(_=>e.jsx(H.Item,{label:e.jsxs(g,{children:[e.jsx(ti,{strong:!0,children:_}),e.jsx(ti,{type:"secondary",style:{fontSize:12},children:"(í™˜ê²½ ë³€ìˆ˜)"})]}),name:_,rules:[{required:!0,message:`${_} ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.`}],children:e.jsx(ue,{placeholder:`${_} ê°’ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: harbor.mipllab.com)`,size:"large"})},_)),e.jsx(xt,{}),e.jsx("div",{style:{marginBottom:16},children:e.jsx(xe,{message:"ì¶”ê°€ ì •ë³´",description:e.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[e.jsx("li",{children:"ìƒì„± í›„ ë³€ê²½ì´ í•„ìš”í•˜ë©´ Git ì €ì¥ì†Œì—ì„œ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"}),e.jsx("li",{children:"í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” .env íŒŒì¼ì„ .gitignoreì— ì¶”ê°€í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤"})]}),type:"info",showIcon:!0})}),e.jsx(H.Item,{style:{marginBottom:0},children:e.jsxs(g,{style:{width:"100%",justifyContent:"flex-end"},children:[e.jsx(B,{onClick:x,disabled:l,children:"ì·¨ì†Œ"}),e.jsx(B,{type:"primary",htmlType:"submit",loading:l,disabled:(c==null?void 0:c.success)===!0,children:l?"ìƒì„± ì¤‘...":"ìƒì„± ë° ì»¤ë°‹"})]})})]})]})},{Text:vr,Title:Td}=we,{Search:Nw}=ue,Bw=s=>{if(s.includes(" ")||["[","successfully ","fetch ","COMMIT ","Resolving ","Trying ","Getting ","Copying ","Writing ","Storing "].some(d=>s.startsWith(d))||s.startsWith("dist/")||s.startsWith("src/")||s.startsWith("assets/"))return!1;const r=(s.match(/\//g)||[]).length,n=(s.match(/:/g)||[]).length;if(r<2||n!==1)return!1;const a=s.split("/");if(a.length<3)return!1;const l=a[a.length-1].split(":");return!(l.length!==2||!l[0]||!l[1])},$w=({statistics:s,buildEnvironment:t,serviceId:r})=>{var u,m,j,b,A,W;const[n,a]=o.useState(""),[i,l]=o.useState(!1),[d,c]=o.useState(null),p=Z=>{if(!Z)return"0ì´ˆ";const se=Math.floor(Z/60),ce=Z%60;return se>0?`${se}ë¶„ ${ce}ì´ˆ`:`${ce}ì´ˆ`},h=y0,x=Z=>{const se={success:{color:"success",icon:e.jsx(Ze,{}),text:"ì„±ê³µ",badgeStatus:"success"},failed:{color:"error",icon:e.jsx(Es,{}),text:"ì‹¤íŒ¨",badgeStatus:"error"},running:{color:"processing",icon:e.jsx(wr,{}),text:"ì‹¤í–‰ ì¤‘",badgeStatus:"processing"},pending:{color:"default",icon:e.jsx(wr,{}),text:"ëŒ€ê¸°",badgeStatus:"default"},cancelled:{color:"warning",icon:e.jsx(Es,{}),text:"ì·¨ì†Œë¨",badgeStatus:"warning"}};return se[Z]||se.pending},_=Z=>{const se=x(Z);return e.jsx(T,{color:se.color,icon:se.icon,children:se.text})},S=Z=>{if(!Z)return null;try{let se;return typeof Z=="string"?se=JSON.parse(Z):Z.Valid&&Z.String?se=JSON.parse(Z.String):se=Z,se}catch(se){return console.error("[BuildStatistics] Failed to parse build details:",se),null}},L=Z=>{if(!(Z!=null&&Z.Valid)||!Z.String)return[];if(Z.String==="null"||Z.String==="[]")return[];try{const se=JSON.parse(Z.String);return Array.isArray(se)?se:[]}catch(se){return console.error("[BuildStatistics] Failed to parse execution_logs:",se),[]}},k=(u=s.latest_build)!=null&&u.details_data?S(s.latest_build.details_data):null,E=(Z,se)=>{if(!se.trim())return Z;const ce=se.toLowerCase();return Z.filter(D=>{var M,K,J;return((M=D.command)==null?void 0:M.toLowerCase().includes(ce))||((K=D.output)==null?void 0:K.toLowerCase().includes(ce))||((J=D.error)==null?void 0:J.toLowerCase().includes(ce))})},P=(Z,se)=>{const ce=E(Z,n);return Z.length===0?e.jsx(Je,{description:"ë¹Œë“œ ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE}):ce.length===0?e.jsx(Je,{description:`"${n}"ì— ëŒ€í•œ ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.`,image:Je.PRESENTED_IMAGE_SIMPLE}):e.jsx("div",{style:{maxHeight:"450px",overflowY:"auto",backgroundColor:"#1e1e1e",padding:"16px",borderRadius:"8px",fontFamily:'Monaco, Menlo, "Ubuntu Mono", Consolas, "source-code-pro", monospace',fontSize:"12px",lineHeight:"1.6"},children:ce.map((D,M)=>e.jsxs("div",{style:{marginBottom:"12px",padding:"12px",backgroundColor:D.exit_code!==0?"rgba(255, 77, 79, 0.08)":"rgba(255, 255, 255, 0.02)",borderRadius:"6px",borderLeft:`3px solid ${D.exit_code!==0?"#ff4d4f":D.error?"#faad14":"#52c41a"}`,transition:"all 0.2s"},children:[e.jsx("div",{style:{marginBottom:"6px"},children:e.jsxs(vr,{type:"secondary",style:{fontSize:"11px",color:"#888",fontFamily:"inherit"},children:["[",D.timestamp||"N/A","]"]})}),D.command&&e.jsx("div",{style:{marginBottom:"6px"},children:e.jsxs(vr,{strong:!0,style:{color:"#4dabf7",fontFamily:"inherit"},children:["$ ",D.command]})}),D.output&&e.jsx("div",{style:{marginBottom:D.error?"6px":"0",whiteSpace:"pre-wrap",wordBreak:"break-word",color:"#d4d4d4",fontFamily:"inherit"},children:D.output}),D.error&&e.jsxs("div",{style:{marginTop:"6px",whiteSpace:"pre-wrap",wordBreak:"break-word",color:"#f85149",fontFamily:"inherit"},children:[e.jsx(vr,{strong:!0,style:{color:"#f85149"},children:"ERROR:"})," ",D.error]}),D.exit_code!==void 0&&D.exit_code!==0&&e.jsx("div",{style:{marginTop:"6px"},children:e.jsxs(T,{color:D.exit_code===0?"success":"error",style:{margin:0},children:["Exit Code: ",D.exit_code]})})]},`${se}-${M}`))})},I=Z=>Z>=80?"#52c41a":Z>=60?"#faad14":"#ff4d4f",$=s.latest_build,y=$?x($.status):null,v=({errorAnalysis:Z})=>{const[se,ce]=o.useState(!1);return e.jsxs("div",{style:{marginTop:16},children:[e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(Es,{}),e.jsx(vr,{strong:!0,children:Z.title})]}),description:e.jsxs("div",{children:[e.jsx(vr,{children:Z.description}),Z.error_type==="env_file_missing"&&Z.is_fixable&&e.jsxs("div",{style:{marginTop:16,padding:"12px 16px",backgroundColor:"#fff7e6",border:"1px solid #ffd591",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx(vr,{strong:!0,style:{color:"#d46b08",fontSize:13},children:"ğŸ’¡ ìë™ í•´ê²° ê°€ëŠ¥"}),e.jsx("div",{style:{marginTop:4},children:e.jsx(vr,{type:"secondary",style:{fontSize:12},children:".env íŒŒì¼ì„ ìë™ìœ¼ë¡œ ìƒì„±í•˜ê³  Gitì— ì»¤ë°‹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"})})]}),e.jsx(B,{type:"primary",size:"middle",onClick:()=>{c(Z),l(!0)},style:{backgroundColor:"#fa8c16",borderColor:"#fa8c16",fontWeight:600},children:".env íŒŒì¼ ìë™ ìƒì„±"})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx(B,{type:"link",size:"small",icon:e.jsx(xc,{}),onClick:()=>ce(!se),style:{padding:0},children:se?"ê°€ì´ë“œ ì ‘ê¸°":"í•´ê²° ê°€ì´ë“œ ë³´ê¸°"})})]}),type:"error",showIcon:!1}),se&&e.jsxs("div",{style:{marginTop:12},children:[Z.solutions&&Z.solutions.length>0&&e.jsx(ie,{title:"ğŸ’¡ í•´ê²° ë°©ë²•",size:"small",style:{marginBottom:12},children:e.jsx("ol",{style:{paddingLeft:20,margin:0},children:Z.solutions.map((D,M)=>e.jsx("li",{style:{marginBottom:8},children:e.jsx(vr,{children:D})},M))})}),Z.dockerfile_fix&&Z.dockerfile_fix.trim()!==""&&e.jsx(ie,{title:"ğŸ“ Dockerfile ìˆ˜ì • ì œì•ˆ",size:"small",style:{marginBottom:12},children:e.jsx("pre",{style:{backgroundColor:"#f5f5f5",padding:12,borderRadius:4,overflow:"auto",margin:0,fontSize:12,fontFamily:'Consolas, Monaco, "Courier New", monospace',maxHeight:"300px"},children:Z.dockerfile_fix})}),Z.related_docs&&Z.related_docs.length>0&&e.jsx(ie,{title:"ğŸ“š ê´€ë ¨ ë¬¸ì„œ",size:"small",children:e.jsx(g,{direction:"vertical",size:"small",children:Z.related_docs.map((D,M)=>e.jsx("a",{href:D,target:"_blank",rel:"noopener noreferrer",children:D},M))})})]})]})};return e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsxs(Ke,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(Y,{xs:24,lg:8,children:e.jsx(ie,{style:{background:y?`linear-gradient(135deg, ${y.color==="success"?"#f6ffed":y.color==="error"?"#fff1f0":"#e6f7ff"} 0%, #ffffff 100%)`:"#ffffff",borderColor:y?y.color==="success"?"#b7eb8f":y.color==="error"?"#ffccc7":"#91d5ff":"#d9d9d9",height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(vr,{type:"secondary",style:{fontSize:"14px"},children:[e.jsx(mo,{style:{marginRight:"8px"}}),"ìµœê·¼ ë¹Œë“œ"]}),y&&e.jsx(ps,{status:y.badgeStatus})]}),$?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(Td,{level:2,style:{margin:0,marginBottom:"8px"},children:_($.status)}),e.jsx(vr,{type:"secondary",style:{fontSize:"13px"},children:yx($.started_at)})]}),((m=$.duration_seconds)==null?void 0:m.Int64)!==void 0&&e.jsx($e,{title:"ì†Œìš” ì‹œê°„",value:p($.duration_seconds.Int64),prefix:e.jsx(wr,{}),valueStyle:{fontSize:"18px"}}),$.pipeline_id&&e.jsxs(vr,{type:"secondary",style:{fontSize:"12px"},children:["íŒŒì´í”„ë¼ì¸ #",$.pipeline_id]})]}):e.jsx(Je,{description:"ë¹Œë“œ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.",image:Je.PRESENTED_IMAGE_SIMPLE})]})})}),e.jsx(Y,{xs:24,lg:8,children:e.jsx(ie,{style:{height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(vr,{type:"secondary",style:{fontSize:"14px"},children:[e.jsx(dr,{style:{marginRight:"8px"}}),"ë¹Œë“œ ì„±ê³µë¥ "]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsxs(Td,{level:1,style:{margin:0,color:I(s.success_rate)},children:[s.success_rate.toFixed(1),"%"]}),e.jsx(qt,{percent:Number(s.success_rate.toFixed(1)),strokeColor:I(s.success_rate),showInfo:!1,strokeWidth:12,style:{marginTop:"16px"}})]}),e.jsxs(Ke,{gutter:16,style:{marginTop:"8px"},children:[e.jsxs(Y,{span:12,style:{textAlign:"center"},children:[e.jsx($e,{value:s.successful_builds,suffix:`/ ${s.total_builds}`,prefix:e.jsx(Ze,{style:{color:"#52c41a"}}),valueStyle:{fontSize:"16px",color:"#52c41a"}}),e.jsx(vr,{type:"secondary",style:{fontSize:"12px"},children:"ì„±ê³µ"})]}),e.jsxs(Y,{span:12,style:{textAlign:"center"},children:[e.jsx($e,{value:s.failed_builds,suffix:`/ ${s.total_builds}`,prefix:e.jsx(Es,{style:{color:"#ff4d4f"}}),valueStyle:{fontSize:"16px",color:"#ff4d4f"}}),e.jsx(vr,{type:"secondary",style:{fontSize:"12px"},children:"ì‹¤íŒ¨"})]})]})]})})}),e.jsx(Y,{xs:24,lg:8,children:e.jsx(ie,{style:{height:"100%"},children:e.jsxs(g,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(vr,{type:"secondary",style:{fontSize:"14px"},children:[e.jsx(wr,{style:{marginRight:"8px"}}),"í‰ê·  ë¹Œë“œ ì‹œê°„"]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(Td,{level:1,style:{margin:0,color:"#1890ff"},children:p(Math.round(s.average_build_time))})}),((j=$==null?void 0:$.build_infra_name)==null?void 0:j.Valid)&&e.jsxs("div",{style:{marginTop:"16px"},children:[e.jsx(xt,{style:{margin:"12px 0"}}),e.jsxs(g,{children:[e.jsx(_t,{style:{color:"#1890ff"}}),e.jsx(vr,{strong:!0,children:$.build_infra_name.String}),((b=$.build_infra_type)==null?void 0:b.Valid)&&e.jsx(T,{color:"blue",children:$.build_infra_type.String})]})]})]})})})]}),t&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(eg,{}),e.jsx("span",{children:"ë¹Œë“œ í™˜ê²½ ì„¤ì •"})]}),size:"small",style:{marginBottom:"16px"},children:e.jsxs(Se,{column:{xs:1,sm:2,md:3},size:"small",children:[e.jsx(Se.Item,{label:e.jsxs(g,{size:4,children:[e.jsx(Od,{}),e.jsx("span",{children:"Git ë¸Œëœì¹˜"})]}),children:e.jsx(T,{color:"blue",children:t.gitlab_branch})}),e.jsx(Se.Item,{label:"ë ˆì§€ìŠ¤íŠ¸ë¦¬",children:e.jsx(vr,{copyable:{text:t.registry_url},children:t.docker_registry})}),e.jsx(Se.Item,{label:"í”„ë¡œì íŠ¸",children:e.jsx(T,{color:"green",children:t.project_name})}),e.jsx(Se.Item,{label:"ë¹Œë“œ ë„êµ¬",children:e.jsx(T,{color:"purple",children:t.build_tool})}),e.jsx(Se.Item,{label:"ì¸í”„ë¼ íƒ€ì…",children:e.jsx(T,{children:t.infra_type})}),t.docker_compose_files.length>0&&e.jsx(Se.Item,{label:"Compose íŒŒì¼",children:e.jsx(g,{size:4,wrap:!0,children:t.docker_compose_files.map((Z,se)=>e.jsx(T,{icon:e.jsx(Jn,{}),children:Z},se))})})]})}),$&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(Fr,{}),e.jsx("span",{children:"ìµœê·¼ ë¹Œë“œ ìƒì„¸ ì •ë³´"})]}),size:"small",style:{marginBottom:"16px"},children:e.jsxs(Se,{column:{xs:1,sm:2,md:3},size:"small",children:[e.jsx(Se.Item,{label:"ì‹œì‘ ì‹œê°„",children:h($.started_at)}),((A=$.completed_at)==null?void 0:A.String)&&e.jsx(Se.Item,{label:"ì™„ë£Œ ì‹œê°„",children:h($.completed_at.String)}),e.jsx(Se.Item,{label:"ì‹¤í–‰ì",children:$.triggered_by}),k&&k.built_images&&Array.isArray(k.built_images)&&k.built_images.length>0&&e.jsx(Se.Item,{label:"ë¹Œë“œëœ ì´ë¯¸ì§€",span:3,children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[k.built_images.filter(Z=>Bw(Z)).map((Z,se)=>e.jsx(vr,{code:!0,copyable:{text:Z},style:{display:"block",fontSize:"12px"},children:Z},se)),k.image_tag&&e.jsxs(T,{color:"blue",children:["íƒœê·¸: ",k.image_tag]})]})}),k&&!k.built_images&&k.imageName&&e.jsx(Se.Item,{label:"ë¹Œë“œëœ ì´ë¯¸ì§€",span:2,children:e.jsxs(g,{children:[e.jsx(vr,{code:!0,children:k.imageName}),k.imageTag&&e.jsx(T,{color:"blue",children:k.imageTag})]})}),k&&k.registry&&e.jsx(Se.Item,{label:"ë ˆì§€ìŠ¤íŠ¸ë¦¬",children:e.jsx(vr,{copyable:{text:k.registry},children:k.registry})}),((W=$.error_message)==null?void 0:W.String)&&e.jsx(Se.Item,{label:"ì—ëŸ¬ ë©”ì‹œì§€",span:3,children:e.jsx(vr,{type:"danger",style:{fontSize:"12px"},children:$.error_message.String})})]})}),($==null?void 0:$.status)==="failed"&&(k==null?void 0:k.error_analysis)&&typeof k.error_analysis=="object"&&e.jsx(v,{errorAnalysis:k.error_analysis}),s.recent_builds&&s.recent_builds.length>0&&e.jsx(ie,{title:e.jsx(g,{style:{width:"100%",justifyContent:"space-between"},children:e.jsxs(g,{children:[e.jsx(Fr,{}),e.jsx("span",{children:"ë¹Œë“œ ë¡œê·¸"}),e.jsxs(T,{color:"blue",children:[s.recent_builds.length,"ê°œ"]})]})}),extra:e.jsx(Nw,{placeholder:"ë¡œê·¸ ê²€ìƒ‰...",allowClear:!0,size:"small",style:{width:200},prefix:e.jsx(Fi,{}),onChange:Z=>a(Z.target.value)}),style:{marginBottom:"16px"},children:e.jsx(xs,{defaultActiveKey:"0",items:s.recent_builds.map((Z,se)=>{var M;const ce=Z.execution_logs?L(Z.execution_logs):[],D=x(Z.status);return{key:String(se),label:e.jsx(Ie,{title:`íŒŒì´í”„ë¼ì¸ #${Z.pipeline_id} - ${h(Z.started_at)}`,children:e.jsxs(g,{size:4,children:[e.jsx(ps,{status:D.badgeStatus}),e.jsxs("span",{children:["#",Z.pipeline_id]}),ce.length>0&&e.jsx(T,{color:"blue",style:{fontSize:"11px",marginLeft:"4px"},children:ce.length})]})}),children:e.jsxs("div",{children:[e.jsxs(g,{style:{marginBottom:"12px",flexWrap:"wrap"},children:[_(Z.status),e.jsx(vr,{type:"secondary",style:{fontSize:"12px"},children:h(Z.started_at)}),((M=Z.duration_seconds)==null?void 0:M.Int64)!==void 0&&e.jsxs(vr,{type:"secondary",style:{fontSize:"12px"},children:["ì†Œìš”: ",p(Z.duration_seconds.Int64)]}),Z.triggered_by&&e.jsxs(vr,{type:"secondary",style:{fontSize:"12px"},children:["ì‹¤í–‰ì: ",Z.triggered_by]})]}),P(ce,Z.id)]})}})})}),r&&d&&e.jsx(Aw,{visible:i,onClose:()=>{l(!1),c(null)},serviceId:r,missingVars:(()=>{var se;const Z=(se=d.solutions)==null?void 0:se.find(ce=>ce.includes("ëˆ„ë½ëœ í™˜ê²½ ë³€ìˆ˜:"));return Z?Z.replace("ëˆ„ë½ëœ í™˜ê²½ ë³€ìˆ˜:","").trim().split(",").map(D=>D.trim()).filter(Boolean):[]})(),errorAnalysis:{error_type:d.error_type,title:d.title,description:d.description}})]})},{Text:Rd,Link:Ow}=we,Dw=({visible:s,onCancel:t,onSuccess:r,serviceId:n,serviceName:a,gitlabUrl:i})=>{const[l]=H.useForm(),[d,c]=o.useState(!1),p=async()=>{try{const S=await l.validateFields();c(!0),await wu(n,S.gitlabAccessToken),f.success("GitLab í† í°ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤."),l.resetFields(),r()}catch(S){console.error("GitLab í† í° ë“±ë¡ ì‹¤íŒ¨:",S),S instanceof Error?f.error(`í† í° ë“±ë¡ ì‹¤íŒ¨: ${S.message}`):f.error("GitLab í† í° ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{c(!1)}},h=()=>{l.resetFields(),t()},_=(S=>{try{const L=new URL(S);return`${L.protocol}//${L.host}`}catch(L){return S}})(i);return e.jsx(rt,{title:e.jsxs(g,{children:[e.jsx(za,{}),e.jsx("span",{children:"GitLab Access Token ì…ë ¥"})]}),open:s,onCancel:h,footer:[e.jsx(B,{onClick:h,children:"ì·¨ì†Œ"},"cancel"),e.jsx(B,{type:"primary",loading:d,onClick:p,icon:e.jsx(za,{}),children:"í† í° ë“±ë¡"},"submit")],width:600,destroyOnClose:!0,children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(xe,{message:"GitLab í† í°ì´ í•„ìš”í•©ë‹ˆë‹¤",description:e.jsxs(g,{direction:"vertical",size:"small",children:[e.jsxs(Rd,{children:[e.jsx("strong",{children:a})," ì„œë¹„ìŠ¤ì˜ ì†ŒìŠ¤ ì½”ë“œì— ì ‘ê·¼í•˜ë ¤ë©´ GitLab Access Tokenì´ í•„ìš”í•©ë‹ˆë‹¤."]}),e.jsxs(Rd,{type:"secondary",children:["GitLab URL: ",i]})]}),type:"info",showIcon:!0,icon:e.jsx(Ks,{})}),e.jsx(H,{form:l,layout:"vertical",children:e.jsx(H.Item,{label:"GitLab Access Token",name:"gitlabAccessToken",rules:[{required:!0,message:"GitLab Access Tokenì„ ì…ë ¥í•´ì£¼ì„¸ìš”."},{min:20,message:"ìœ íš¨í•œ GitLab Access Tokenì„ ì…ë ¥í•´ì£¼ì„¸ìš”."}],extra:e.jsxs(g,{direction:"vertical",size:"small",style:{marginTop:8},children:[e.jsxs(Rd,{type:"secondary",children:[e.jsx(Ks,{})," í† í° ìƒì„± ë°©ë²•:"]}),e.jsxs("ol",{style:{marginLeft:16,marginTop:4},children:[e.jsx("li",{children:e.jsx(Ow,{href:`${_}/-/profile/personal_access_tokens`,target:"_blank",children:"GitLab â†’ Settings â†’ Access Tokens"})}),e.jsx("li",{children:"Token name ì…ë ¥ (ì˜ˆ: K8sControl)"}),e.jsxs("li",{children:["Scopes ì„ íƒ: ",e.jsx("strong",{children:"read_api, read_repository"})]}),e.jsx("li",{children:'"Create personal access token" í´ë¦­'}),e.jsx("li",{children:"ìƒì„±ëœ í† í°ì„ ë³µì‚¬í•˜ì—¬ ì•„ë˜ì— ë¶™ì—¬ë„£ê¸°"})]})]}),children:e.jsx(ue.Password,{placeholder:"glpat-xxxxxxxxxxxxxxxxxxxx",autoComplete:"off",visibilityToggle:!0})})}),e.jsx(xe,{message:"ë³´ì•ˆ ì•ˆë‚´",description:"ì…ë ¥í•˜ì‹  í† í°ì€ ì•ˆì „í•˜ê²Œ ì•”í˜¸í™”ë˜ì–´ ì„œë²„ì— ì €ì¥ë©ë‹ˆë‹¤. í† í°ì€ GitLab ì €ì¥ì†Œ ì ‘ê·¼ ì‹œì—ë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.",type:"warning",showIcon:!0})]})})},{Text:Mi}=we,Fw=({containers:s,loadingContainers:t,allContainerStats:r,loadingAllStats:n,containerActionLoading:a,onLoadStats:i,onRefresh:l,onContainerRestart:d})=>{const[c,p]=o.useState(!1),[h,x]=o.useState(null),_=o.useRef(!1);o.useEffect(()=>{let k=null;return c&&s.length>0&&(k=setInterval(()=>{l(),x(new Date)},3e4)),()=>{k&&clearInterval(k)}},[c,s.length,l]);const S=()=>{l(),x(new Date)};o.useEffect(()=>{s.length>0&&r.length===0&&!n&&!_.current&&(_.current=!0,i())},[s.length,r.length,n,i]),o.useEffect(()=>{_.current=!1},[s]);const L=k=>r.find(E=>E.container_id===k||E.container_id.startsWith(k.substring(0,12)));return e.jsxs("div",{children:[e.jsx(xe,{message:"ì»¨í…Œì´ë„ˆ ê´€ë¦¬",description:"Docker/Podman ì»¨í…Œì´ë„ˆë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤. ë¦¬ì†ŒìŠ¤ í†µê³„ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx("span",{children:"ì»¨í…Œì´ë„ˆ ëª©ë¡"}),h&&e.jsxs(Mi,{type:"secondary",style:{fontSize:12,fontWeight:"normal"},children:["(ë§ˆì§€ë§‰ ê°±ì‹ : ",h.toLocaleTimeString(),")"]})]}),loading:t,extra:e.jsxs(g,{children:[e.jsx(Ie,{title:"30ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ìƒíƒœë¥¼ ê°±ì‹ í•©ë‹ˆë‹¤",children:e.jsxs(g,{children:[e.jsx(Mi,{style:{fontSize:14},children:"ìë™ ê°±ì‹ "}),e.jsx(Zr,{checked:c,onChange:p,size:"small",disabled:s.length===0})]})}),e.jsx(B,{icon:e.jsx(Jo,{}),onClick:i,loading:n,disabled:s.length===0,children:"ë¦¬ì†ŒìŠ¤ í†µê³„"}),e.jsx(B,{icon:e.jsx(zs,{}),onClick:S,loading:t,children:"ìƒˆë¡œê³ ì¹¨"})]}),children:s.length>0?e.jsx(wt,{dataSource:s,columns:[{title:"ì»¨í…Œì´ë„ˆ ID",dataIndex:"id",key:"id",width:120,render:k=>e.jsx(T,{color:"blue",children:k.substring(0,12)})},{title:"ì´ë¦„",dataIndex:"name",key:"name",width:180},{title:"ì´ë¯¸ì§€",dataIndex:"image",key:"image",ellipsis:{showTitle:!1},render:k=>e.jsx(Ie,{placement:"topLeft",title:k,children:k})},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:120,render:k=>{const E=k.toLowerCase().includes("up");return e.jsx(T,{color:E?"green":"red",children:k})}},{title:"CPU",key:"cpu",width:100,render:(k,E)=>{const P=L(E.id);if(!P)return e.jsx(Mi,{type:"secondary",children:"-"});const I=parseFloat(P.cpu_percent.replace("%",""));return e.jsx(qt,{percent:I,size:"small",strokeColor:I>80?"#ff4d4f":I>50?"#faad14":"#52c41a",format:()=>P.cpu_percent})}},{title:"ë©”ëª¨ë¦¬",key:"memory",width:150,render:(k,E)=>{const P=L(E.id);if(!P)return e.jsx(Mi,{type:"secondary",children:"-"});const I=parseFloat(P.memory_percent.replace("%",""));return e.jsxs("div",{children:[e.jsx(qt,{percent:I,size:"small",strokeColor:I>80?"#ff4d4f":I>50?"#faad14":"#52c41a",format:()=>P.memory_percent}),e.jsx(Mi,{type:"secondary",style:{fontSize:11},children:P.memory_usage})]})}},{title:"ë„¤íŠ¸ì›Œí¬",key:"network",width:120,render:(k,E)=>{const P=L(E.id);return P?e.jsx(Ie,{title:`ì…ë ¥: ${P.network_io.split("/")[0].trim()}, ì¶œë ¥: ${P.network_io.split("/")[1].trim()}`,children:e.jsx(Mi,{style:{fontSize:11},children:P.network_io})}):e.jsx(Mi,{type:"secondary",children:"-"})}},{title:"í¬íŠ¸",dataIndex:"ports",key:"ports",width:150,ellipsis:{showTitle:!1},render:k=>e.jsx(Ie,{placement:"topLeft",title:k,children:k})},{title:"ì‘ì—…",key:"actions",width:100,render:(k,E)=>{const P=a===E.id;return e.jsx(Kt,{title:"ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘",description:`"${E.name}" ì»¨í…Œì´ë„ˆë¥¼ ì¬ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,onConfirm:()=>d(E.id,E.name),okText:"ì¬ì‹œì‘",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",type:"link",icon:e.jsx(Pt,{spin:P}),loading:P,children:"ì¬ì‹œì‘"})})}}],rowKey:"id",pagination:{pageSize:10},scroll:{x:1e3}}):e.jsx(Je,{description:"ì»¨í…Œì´ë„ˆê°€ ì—†ìŠµë‹ˆë‹¤"})})]})},{Text:Li}=we,Uw=({pruningResources:s,onPruneResources:t,isDockerInfra:r})=>e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:`${r?"Docker":"Podman"} ìš´ì˜ ê´€ë¦¬`,description:"ì»¨í…Œì´ë„ˆ ìš´ì˜ì— í•„ìš”í•œ ê´€ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¹´í…Œê³ ë¦¬ë¥¼ í´ë¦­í•˜ì—¬ ê´€ë ¨ ê¸°ëŠ¥ì„ í™•ì¸í•˜ì„¸ìš”.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(nr,{defaultActiveKey:["cleanup"],style:{background:"#fff"},items:[{key:"cleanup",label:e.jsxs(g,{children:[e.jsx($a,{style:{color:"#52c41a"}}),e.jsx(Li,{strong:!0,children:"ë¦¬ì†ŒìŠ¤ ì •ë¦¬"}),e.jsx(T,{color:"green",children:"ì´ë¯¸ì§€ Â· ì»¨í…Œì´ë„ˆ Â· ë³¼ë¥¨ Â· ë„¤íŠ¸ì›Œí¬"})]}),children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(xe,{message:"ì£¼ì˜: ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì‹œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ê°€ ì˜êµ¬ ì‚­ì œë©ë‹ˆë‹¤.",type:"warning",showIcon:!0}),e.jsxs(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx($a,{})," ê°œë³„ ë¦¬ì†ŒìŠ¤ ì •ë¦¬"]}),children:[e.jsx(Li,{type:"secondary",style:{display:"block",marginBottom:12},children:"ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ê°œë³„ì ìœ¼ë¡œ ì •ë¦¬í•©ë‹ˆë‹¤."}),e.jsxs(g,{wrap:!0,children:[e.jsx(Kt,{title:"ì´ë¯¸ì§€ ì •ë¦¬",description:"ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>t("images"),okText:"ì •ë¦¬",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{type:"primary",size:"small",icon:e.jsx($a,{}),loading:s,children:"ì´ë¯¸ì§€"})}),e.jsx(Kt,{title:"ì»¨í…Œì´ë„ˆ ì •ë¦¬",description:"ì¤‘ì§€ëœ ëª¨ë“  ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œí•©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>t("containers"),okText:"ì •ë¦¬",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",icon:e.jsx(gs,{}),loading:s,children:"ì»¨í…Œì´ë„ˆ"})}),e.jsx(Kt,{title:"ë³¼ë¥¨ ì •ë¦¬",description:"ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ë³¼ë¥¨ì„ ì‚­ì œí•©ë‹ˆë‹¤. ë°ì´í„°ê°€ ì˜êµ¬ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>t("volumes"),okText:"ì •ë¦¬",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",icon:e.jsx(_s,{}),loading:s,children:"ë³¼ë¥¨"})}),e.jsx(Kt,{title:"ë„¤íŠ¸ì›Œí¬ ì •ë¦¬",description:"ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>t("networks"),okText:"ì •ë¦¬",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",icon:e.jsx(ya,{}),loading:s,children:"ë„¤íŠ¸ì›Œí¬"})})]})]}),e.jsxs(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(fa,{})," ì „ì²´ ì •ë¦¬ (System Prune)"]}),children:[e.jsx(Li,{type:"secondary",style:{display:"block",marginBottom:12},children:"ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€, ì»¨í…Œì´ë„ˆ, ë³¼ë¥¨, ë„¤íŠ¸ì›Œí¬ë¥¼ ëª¨ë‘ ì‚­ì œí•©ë‹ˆë‹¤."}),e.jsx(Kt,{title:"ì „ì²´ ì •ë¦¬",description:"ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>t("all"),okText:"ì „ì²´ ì •ë¦¬",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(B,{danger:!0,type:"primary",size:"small",icon:e.jsx(fa,{}),loading:s,children:"ì „ì²´ ì •ë¦¬ ì‹¤í–‰"})})]})]})},{key:"backup",label:e.jsxs(g,{children:[e.jsx(Ui,{style:{color:"#fa8c16"}}),e.jsx(Li,{strong:!0,children:"ë°±ì—… ë° ë³µêµ¬"}),e.jsx(T,{color:"orange",children:"í†µí•© ê´€ë¦¬"})]}),children:e.jsx(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:e.jsx(xe,{message:"ë°±ì—… ê´€ë¦¬ í˜ì´ì§€ë¡œ ì´ë™í•˜ì„¸ìš”",description:e.jsxs(g,{direction:"vertical",children:[e.jsxs(Li,{children:["Docker/Podman ë°±ì—… ê¸°ëŠ¥ì€ ",e.jsx(Li,{strong:!0,children:"ë°±ì—… ê´€ë¦¬"})," ","í˜ì´ì§€ì—ì„œ í†µí•© ê´€ë¦¬ë©ë‹ˆë‹¤."]}),e.jsx(Li,{type:"secondary",children:'ì‚¬ì´ë“œ ë©”ë‰´ì˜ "ë°±ì—… ê´€ë¦¬"ë¥¼ í´ë¦­í•˜ì—¬ ë°±ì—… ìƒì„±, ë³µêµ¬, ì´ë ¥ ì¡°íšŒë¥¼ ìˆ˜í–‰í•˜ì„¸ìš”.'})]}),type:"info",showIcon:!0})})}]})]}),Hw=({service:s,containerCount:t,containers:r=[],dockerImages:n=[],isDockerInfra:a})=>{const i=r.filter(c=>{var p;return(p=c.status)==null?void 0:p.toLowerCase().includes("up")}).length,l=t-i,d=Array.from(new Set(r.map(c=>c.image))).map(c=>{const p=n.find(h=>c.includes(h.repository)||c.includes(`${h.repository}:${h.tag}`));return{name:c,info:p}});return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(xe,{message:`${a?"Docker":"Podman"} ë°°í¬ ê´€ë¦¬`,description:`${a?"Docker":"Podman"} í™˜ê²½ì—ì„œ ë°°í¬ëœ ì„œë¹„ìŠ¤ì˜ ì´ë¯¸ì§€, ì»¨í…Œì´ë„ˆ, í™˜ê²½ ì •ë³´ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.`,type:"info",showIcon:!0,icon:e.jsx(dr,{}),style:{marginBottom:24}}),e.jsxs(Ke,{gutter:16,style:{marginBottom:24},children:[e.jsx(Y,{span:8,children:e.jsx(ie,{children:e.jsx($e,{title:"ì „ì²´ ì»¨í…Œì´ë„ˆ",value:t,prefix:e.jsx(Qr,{}),suffix:"ê°œ"})})}),e.jsx(Y,{span:8,children:e.jsx(ie,{children:e.jsx($e,{title:"ì‹¤í–‰ ì¤‘",value:i,valueStyle:{color:"#3f8600"},suffix:"ê°œ"})})}),e.jsx(Y,{span:8,children:e.jsx(ie,{children:e.jsx($e,{title:"ì¤‘ì§€ë¨",value:l,valueStyle:{color:"#cf1322"},suffix:"ê°œ"})})})]}),e.jsx(ie,{title:"ì„œë¹„ìŠ¤ ì •ë³´",style:{marginBottom:24},children:e.jsxs(Se,{column:2,bordered:!0,children:[e.jsx(Se.Item,{label:"ì„œë¹„ìŠ¤ ì´ë¦„",children:(s==null?void 0:s.name)||"-"}),e.jsx(Se.Item,{label:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤",children:(s==null?void 0:s.namespace)||"-"}),e.jsx(Se.Item,{label:"ì¸í”„ë¼ íƒ€ì…",children:(s==null?void 0:s.infraType)||"-"}),e.jsx(Se.Item,{label:"Git ì €ì¥ì†Œ",children:(s==null?void 0:s.repository_url)||(s==null?void 0:s.gitlab_url)||"-"}),e.jsx(Se.Item,{label:"ìƒì„±ì¼",span:2,children:s!=null&&s.created_at?new Date(s.created_at).toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"-"})]})}),e.jsx(ie,{title:e.jsxs(e.Fragment,{children:[e.jsx(_s,{})," ë°°í¬ ì´ë¯¸ì§€"]}),style:{marginBottom:24},children:d.length>0?e.jsx(wt,{dataSource:d,pagination:!1,size:"small",columns:[{title:"ì´ë¯¸ì§€",dataIndex:"name",key:"name",render:c=>e.jsx(T,{color:"blue",children:c})},{title:"í¬ê¸°",key:"size",width:120,render:(c,p)=>{var h;return((h=p.info)==null?void 0:h.size)||"-"}},{title:"ìƒì„±ì¼",key:"created",width:200,render:(c,p)=>{var x;const h=(x=p.info)==null?void 0:x.created;return h?h.replace(/\s*\+\d{4}\s*[A-Z]{3}$/i,""):"-"}},{title:"ì‚¬ìš© ì»¨í…Œì´ë„ˆ",key:"usage",width:120,render:(c,p)=>`${r.filter(x=>x.image===p.name).length}ê°œ`}]}):e.jsx("p",{children:"ì´ë¯¸ì§€ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."})})]})},{Text:Zs,Title:Vw}=we,{TextArea:qw}=ue,Gw=({pods:s,deployments:t,selectedDeployment:r,deploymentStatus:n,scalingReplicas:a,scalingLoading:i,hpaData:l,hpaList:d,loadingHPA:c,showHPAForm:p,metricsServerStatus:h,metricsServerDiagnostics:x,loadingMetricsStatus:_,installingMetrics:S,showDiagnostics:L,deployedImageInfo:k,onDeploymentChange:E,onScaleDeployment:P,onScaleToZero:I,onSetScalingReplicas:$,onCreateHPA:y,onDeleteHPA:v,onSetShowHPAForm:u,onLoadHPA:m,onDeletePod:j,onBulkDeletePendingPods:b,onCheckMetricsServerStatus:A,onInstallMetricsServer:W,onCleanMetricsServerNode:Z,onSetShowDiagnostics:se,onLoadPodDetails:ce})=>{var te;const D=G=>d.some(q=>q.targetDeployment===G),M=G=>{const q=G.toLowerCase();return q==="running"?"success":q==="pending"?"warning":q==="failed"||q==="error"?"error":"default"},K=G=>{const q=G.toLowerCase();return q==="running"?e.jsx(Ze,{style:{color:"#52c41a"}}):q==="pending"?e.jsx(Pt,{spin:!0,style:{color:"#faad14"}}):q==="failed"||q==="error"?e.jsx(Es,{style:{color:"#ff4d4f"}}):e.jsx(Yt,{style:{color:"#d9d9d9"}})},J=[{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:150,fixed:"left",render:(G,q)=>{const oe=["ImagePullBackOff","ErrImagePull","CrashLoopBackOff","Error","Failed","Pending"].includes(G);return e.jsxs(g,{direction:"vertical",size:"small",children:[e.jsx(T,{color:M(G),icon:K(G),children:G}),oe&&e.jsx(B,{type:"link",size:"small",danger:G!=="Pending",style:{fontSize:11,padding:0,height:"auto",color:G==="Pending"?"#faad14":"#ff4d4f"},onClick:()=>{rt.info({title:`${G} ë¬¸ì œ í•´ê²° ë°©ë²•`,width:600,content:e.jsx("div",{style:{marginTop:16},children:G==="ImagePullBackOff"||G==="ErrImagePull"?e.jsxs(e.Fragment,{children:[e.jsx(Zs,{strong:!0,children:"ì›ì¸:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Harbor ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŒ"}),e.jsx("li",{children:"ì´ë¯¸ì§€ ì´ë¦„/íƒœê·¸ê°€ ì˜ëª»ë˜ì—ˆê±°ë‚˜ ì¡´ì¬í•˜ì§€ ì•ŠìŒ"}),e.jsx("li",{children:"Harbor ì¸ì¦ ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŒ"})]}),e.jsx(Zs,{strong:!0,children:"í•´ê²° ë°©ë²•:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Harborì—ì„œ ì´ë¯¸ì§€ ì¡´ì¬ ì—¬ë¶€ í™•ì¸"}),e.jsx("li",{children:"ì„œë¹„ìŠ¤ì˜ ì´ë¯¸ì§€ íƒœê·¸ í™•ì¸ ë° ì¬ë°°í¬"}),e.jsx("li",{children:"kubectl describe podë¡œ ìì„¸í•œ ì˜¤ë¥˜ í™•ì¸"})]})]}):G==="CrashLoopBackOff"?e.jsxs(e.Fragment,{children:[e.jsx(Zs,{strong:!0,children:"ì›ì¸:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ í›„ ì¦‰ì‹œ ì¢…ë£Œë¨"}),e.jsx("li",{children:"ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ì˜¤ë¥˜ ë˜ëŠ” ì„¤ì • ë¬¸ì œ"})]}),e.jsx(Zs,{strong:!0,children:"í•´ê²° ë°©ë²•:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Pod ë¡œê·¸ë¥¼ í™•ì¸í•˜ì—¬ ì˜¤ë¥˜ ì›ì¸ íŒŒì•…"}),e.jsx("li",{children:"í™˜ê²½ ë³€ìˆ˜ ë° ConfigMap ì„¤ì • í™•ì¸"}),e.jsx("li",{children:"í—¬ìŠ¤ì²´í¬ ì„¤ì • í™•ì¸"})]})]}):G==="Pending"?e.jsxs(e.Fragment,{children:[e.jsx(Zs,{strong:!0,children:"ì›ì¸:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"ë…¸ë“œì— ì¶©ë¶„í•œ ë¦¬ì†ŒìŠ¤(CPU/ë©”ëª¨ë¦¬)ê°€ ì—†ìŒ"}),e.jsx("li",{children:"PVCë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ"}),e.jsx("li",{children:"ë…¸ë“œ ì„ íƒì ì¡°ê±´ì´ ë§ì§€ ì•ŠìŒ"})]}),e.jsx(Zs,{strong:!0,children:"í•´ê²° ë°©ë²•:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"kubectl describe podë¡œ ìì„¸í•œ ì´ë²¤íŠ¸ í™•ì¸"}),e.jsx("li",{children:"í´ëŸ¬ìŠ¤í„° ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸"}),e.jsx("li",{children:"ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ ë° PVC ìƒíƒœ í™•ì¸"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Zs,{strong:!0,children:"ì›ì¸:"}),e.jsx("ul",{children:e.jsx("li",{children:"Pod ì‹¤í–‰ ì¤‘ ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ ë°œìƒ"})}),e.jsx(Zs,{strong:!0,children:"í•´ê²° ë°©ë²•:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Pod ë¡œê·¸ ë° ì´ë²¤íŠ¸ í™•ì¸"}),e.jsx("li",{children:"kubectl describe podë¡œ ìƒì„¸ ì •ë³´ í™•ì¸"}),e.jsx("li",{children:"í•„ìš”ì‹œ Pod ì¬ì‹œì‘ ì‹œë„"})]})]})})})},children:"í´ë¦­í•˜ì—¬ í•´ê²° ë°©ë²• í™•ì¸"})]})}},{title:"Pod ì´ë¦„",dataIndex:"name",key:"name",width:250,ellipsis:!0,render:G=>e.jsx(Zs,{strong:!0,style:{fontSize:13},children:G})},{title:"CPU",dataIndex:"cpuUsage",key:"cpuUsage",width:90,align:"center",render:G=>G?e.jsx(T,{color:"blue",style:{minWidth:60},children:G}):e.jsx(Zs,{type:"secondary",style:{fontSize:12},children:"-"})},{title:"ë©”ëª¨ë¦¬",dataIndex:"memoryUsage",key:"memoryUsage",width:100,align:"center",render:G=>G?e.jsx(T,{color:"cyan",style:{minWidth:70},children:G}):e.jsx(Zs,{type:"secondary",style:{fontSize:12},children:"-"})},{title:"ì´ë¯¸ì§€",dataIndex:"image",key:"image",ellipsis:!1,render:G=>G&&G!=="<none>"&&G.trim()!==""?e.jsx(Ie,{title:G,placement:"topLeft",children:e.jsx(Zs,{style:{fontSize:12,wordBreak:"break-all"},code:!0,children:G})}):e.jsx(Zs,{type:"secondary",style:{fontSize:12},children:"ì´ë¯¸ì§€ ì •ë³´ ì—†ìŒ"})},{title:"ì‘ì—…",key:"actions",width:100,render:(G,q)=>e.jsx(Kt,{title:"Podë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:"Deploymentê°€ ìë™ìœ¼ë¡œ ìƒˆ Podë¥¼ ìƒì„±í•©ë‹ˆë‹¤.",onConfirm:()=>j(q.name),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),children:"ì¬ì‹œì‘"})})}];return e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:"Pod ìƒíƒœ ëª¨ë‹ˆí„°ë§",description:"ë°°í¬ëœ ëª¨ë“  Podì˜ ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(ie,{title:e.jsxs(g,{direction:"vertical",size:0,children:[e.jsxs(g,{children:[e.jsx(Qc,{style:{color:"#1890ff"}}),e.jsx(Zs,{strong:!0,children:"ìˆ˜ë™ Pod ê°œìˆ˜ ì¡°ì •"})]}),e.jsx(Zs,{type:"secondary",style:{fontSize:"12px"},children:"ì„ íƒí•œ Deploymentì˜ Pod ê°œìˆ˜ë¥¼ ì§ì ‘ ì¡°ì •í•©ë‹ˆë‹¤"})]}),style:{marginBottom:16},children:t.length>0?e.jsxs("div",{children:[e.jsx(Zs,{strong:!0,style:{display:"block",marginBottom:12},children:"Deployment ì„ íƒ:"}),e.jsx(xs,{activeKey:r,onChange:E,items:t.map(G=>{var q,oe,be;return{key:((q=G.metadata)==null?void 0:q.name)||"",label:e.jsxs(g,{children:[e.jsx(Cn,{}),(oe=G.metadata)==null?void 0:oe.name,D(((be=G.metadata)==null?void 0:be.name)||"")&&e.jsx(T,{color:"orange",style:{marginLeft:4},children:"ìë™ ì¡°ì • ì¤‘"})]})}})}),l&&e.jsx(xe,{message:"í˜„ì¬ ìë™ ìŠ¤ì¼€ì¼ë§(HPA)ì´ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤",description:e.jsxs("div",{children:[e.jsx("strong",{children:l.targetDeployment})," DeploymentëŠ” CPU ì‚¬ìš©ë¥ ì— ë”°ë¼"," ",e.jsxs("strong",{children:[l.minReplicas,"~",l.maxReplicas,"ê°œ"]})," ","Podê°€ ìë™ìœ¼ë¡œ ì¡°ì •ë©ë‹ˆë‹¤.",e.jsx("br",{}),"ìˆ˜ë™ ì¡°ì •ì„ ì‚¬ìš©í•˜ë ¤ë©´ ì•„ë˜ HPA ì¹´ë“œì—ì„œ ìë™ ìŠ¤ì¼€ì¼ë§ì„ ë¨¼ì € ì œê±°í•´ì£¼ì„¸ìš”."]}),type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsxs(Ke,{gutter:16,style:{marginBottom:16},children:[e.jsx(Y,{span:12,children:e.jsxs(ie,{size:"small",children:[e.jsx($e,{title:"í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Pod ê°œìˆ˜",value:(n==null?void 0:n.availableReplicas)||0,suffix:`/ ${(n==null?void 0:n.replicas)||0}`,prefix:(n==null?void 0:n.availableReplicas)===(n==null?void 0:n.replicas)?e.jsx(Ze,{style:{color:"#52c41a"}}):e.jsx(Yt,{style:{color:"#faad14"}}),valueStyle:{color:(n==null?void 0:n.availableReplicas)===(n==null?void 0:n.replicas)?"#52c41a":"#faad14"}}),e.jsx(Zs,{type:"secondary",style:{fontSize:"12px"},children:(n==null?void 0:n.availableReplicas)===(n==null?void 0:n.replicas)?"ëª¨ë“  Podê°€ ì •ìƒ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤":`${((n==null?void 0:n.replicas)||0)-((n==null?void 0:n.availableReplicas)||0)}ê°œ Podê°€ ì‹œì‘ ì¤‘ì…ë‹ˆë‹¤`})]})}),e.jsx(Y,{span:12,children:e.jsxs(ie,{size:"small",children:[e.jsx($e,{title:"ëª©í‘œ Pod ê°œìˆ˜ ì„¤ì •",value:a,prefix:e.jsx(Qc,{})}),e.jsx(xn,{min:0,max:100,value:a,onChange:G=>$(G||1),style:{width:"100%",marginTop:8},disabled:!!l,addonAfter:"ê°œ"})]})})]}),e.jsxs(g,{children:[e.jsx(B,{type:"primary",icon:e.jsx(Qc,{}),onClick:P,loading:i,disabled:!!l,size:"large",children:"Pod ê°œìˆ˜ ì ìš©"}),e.jsx(Kt,{title:"ëª¨ë“  Podë¥¼ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:"DeploymentëŠ” ìœ ì§€ë˜ë©° Pod ê°œìˆ˜ê°€ 0ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.",onConfirm:I,okText:"ì œê±°",cancelText:"ì·¨ì†Œ",disabled:!!l,children:e.jsx(B,{danger:!0,loading:i,disabled:!!l,size:"large",children:"ëª¨ë“  Pod ì œê±° (0ê°œë¡œ ì„¤ì •)"})})]})]}):e.jsx(Je,{description:"ë°°í¬ëœ Deploymentê°€ ì—†ìŠµë‹ˆë‹¤"})}),e.jsx(ie,{title:e.jsxs(g,{direction:"vertical",size:0,children:[e.jsxs(g,{children:[e.jsx(Vm,{style:{color:"#1890ff"}}),e.jsx(Zs,{strong:!0,children:"HPA (Horizontal Pod Autoscaler)"})]}),e.jsx(Zs,{type:"secondary",style:{fontSize:"12px"},children:"ì„ íƒí•œ Deploymentì— ëŒ€í•œ ìë™ ìŠ¤ì¼€ì¼ë§ ì„¤ì • (ê° Deploymentë§ˆë‹¤ ê°œë³„ ì ìš©)"})]}),style:{marginBottom:16},extra:e.jsxs(g,{children:[e.jsx(B,{icon:e.jsx(Pt,{}),onClick:m,loading:c,children:"ìƒˆë¡œê³ ì¹¨"}),!p&&e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:()=>u(!0),children:"HPA ìƒì„±"})]}),children:p?e.jsxs(H,{layout:"vertical",onFinish:y,initialValues:{minReplicas:1,maxReplicas:10,targetCPU:80},children:[e.jsx(xe,{message:r?`"${r}" Deploymentì— ëŒ€í•œ HPAë¥¼ ìƒì„±í•©ë‹ˆë‹¤`:"Deploymentë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”",description:e.jsxs("div",{children:["HPAëŠ” ì„ íƒí•œ Deploymentì˜ Podë§Œ ìë™ìœ¼ë¡œ ìŠ¤ì¼€ì¼ë§í•©ë‹ˆë‹¤.",e.jsx("br",{}),"ì˜ˆ) ìµœì†Œ 1, ìµœëŒ€ 8 ì„¤ì • ì‹œ â†’ í•´ë‹¹ Deploymentì˜ Podê°€ 1~8ê°œ ì‚¬ì´ì—ì„œ ìë™ ì¡°ì •ë©ë‹ˆë‹¤."]}),type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:8,children:e.jsx(H.Item,{label:"ìµœì†Œ Pod ê°œìˆ˜",name:"minReplicas",rules:[{required:!0,message:"ìµœì†Œê°’ì„ ì…ë ¥í•˜ì„¸ìš”"}],tooltip:"CPU ì‚¬ìš©ë¥ ì´ ë‚®ì„ ë•Œ ìœ ì§€í•  ìµœì†Œ Pod ê°œìˆ˜",children:e.jsx(xn,{min:1,max:100,style:{width:"100%"},addonAfter:"ê°œ"})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{label:"ìµœëŒ€ Pod ê°œìˆ˜",name:"maxReplicas",rules:[{required:!0,message:"ìµœëŒ€ê°’ì„ ì…ë ¥í•˜ì„¸ìš”"}],tooltip:"CPU ì‚¬ìš©ë¥ ì´ ë†’ì„ ë•Œ í™•ì¥í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ Pod ê°œìˆ˜",children:e.jsx(xn,{min:1,max:100,style:{width:"100%"},addonAfter:"ê°œ"})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{label:"ëª©í‘œ CPU ì‚¬ìš©ë¥ ",name:"targetCPU",rules:[{required:!0,message:"CPU ì‚¬ìš©ë¥ ì„ ì…ë ¥í•˜ì„¸ìš”"}],tooltip:"ì´ ì‚¬ìš©ë¥ ì„ ìœ ì§€í•˜ë„ë¡ Pod ê°œìˆ˜ë¥¼ ìë™ ì¡°ì •í•©ë‹ˆë‹¤",children:e.jsx(xn,{min:1,max:100,style:{width:"100%"},addonAfter:"%"})})})]}),e.jsx(H.Item,{children:e.jsxs(g,{children:[e.jsx(B,{type:"primary",htmlType:"submit",loading:c,children:"ìƒì„±"}),e.jsx(B,{onClick:()=>u(!1),children:"ì·¨ì†Œ"})]})})]}):l?e.jsxs("div",{children:[e.jsx(xe,{message:"ìë™ ìŠ¤ì¼€ì¼ë§ì´ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤",description:e.jsxs("div",{children:[e.jsx("strong",{children:l.targetDeployment})," Deploymentì˜ Podê°€ CPU ì‚¬ìš©ë¥ ì— ë”°ë¼"," ",e.jsxs("strong",{children:[l.minReplicas,"~",l.maxReplicas,"ê°œ"]})," ","ì‚¬ì´ì—ì„œ ìë™ìœ¼ë¡œ ì¡°ì •ë©ë‹ˆë‹¤.",e.jsx("br",{}),"(ë‹¤ë¥¸ DeploymentëŠ” ì˜í–¥ë°›ì§€ ì•Šìœ¼ë©°, ê°ê° ë³„ë„ì˜ HPA ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤)"]}),type:"success",showIcon:!0,style:{marginBottom:16}}),e.jsxs(Se,{bordered:!0,size:"small",children:[e.jsx(Se.Item,{label:"HPA ì´ë¦„",span:3,children:l.name||"-"}),e.jsx(Se.Item,{label:"ëŒ€ìƒ Deployment",span:3,children:e.jsx(T,{color:"blue",children:l.targetDeployment||"-"})}),e.jsxs(Se.Item,{label:"ìµœì†Œ Pod ê°œìˆ˜",children:[l.minReplicas||"-","ê°œ"]}),e.jsxs(Se.Item,{label:"ìµœëŒ€ Pod ê°œìˆ˜",children:[l.maxReplicas||"-","ê°œ"]}),e.jsxs(Se.Item,{label:"ëª©í‘œ CPU ì‚¬ìš©ë¥ ",children:[l.targetCPU||"-","%"]}),e.jsx(Se.Item,{label:"í˜„ì¬ ì‹¤í–‰ Pod ê°œìˆ˜",span:3,children:e.jsxs(T,{color:"green",children:[l.currentReplicas||"-","ê°œ"]})})]}),e.jsx("div",{style:{marginTop:16},children:e.jsx(Kt,{title:"HPAë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>v(l.name),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{danger:!0,icon:e.jsx(gs,{}),loading:c,children:"HPA ì‚­ì œ"})})})]}):e.jsx(Je,{description:"HPAê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”."})}),h&&e.jsx(xe,{type:h.ready?"success":h.installed?"warning":"info",showIcon:!0,message:h.ready?"Metrics Server ì •ìƒ ë™ì‘ ì¤‘":h.installed?"Metrics Server ì¤€ë¹„ ì¤‘":"Metrics Server ë¯¸ì„¤ì¹˜",description:e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:12},children:e.jsx("strong",{children:h.message})}),h.installed&&h.pod_name&&e.jsxs("div",{style:{marginBottom:12,fontSize:12,color:"#666"},children:[e.jsxs("div",{children:["Pod: ",e.jsx("code",{children:h.pod_name})]}),h.pod_status&&e.jsxs("div",{children:["ìƒíƒœ:"," ",e.jsx(T,{color:h.ready?"green":"orange",children:h.pod_status})]})]}),h.ready&&e.jsxs("div",{style:{marginBottom:12,fontSize:13,background:"#f6ffed",padding:"8px 12px",borderRadius:4,border:"1px solid #b7eb8f"},children:["Pod CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì •ìƒì ìœ¼ë¡œ ìˆ˜ì§‘í•˜ê³  ìˆìŠµë‹ˆë‹¤.",e.jsx("br",{}),"ìœ„ í…Œì´ë¸”ì—ì„œ ê° Podì˜ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© í˜„í™©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]}),h.installed&&!h.ready&&e.jsxs("div",{style:{marginBottom:12,fontSize:13,background:"#fff9e6",padding:"8px 12px",borderRadius:4},children:["ğŸ’¡ Metrics Server Podê°€ ì‹œì‘ë˜ëŠ” ì¤‘ì…ë‹ˆë‹¤. ë³´í†µ 1-2ë¶„ì´ ì†Œìš”ë˜ë©°, ìë™ìœ¼ë¡œ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.",e.jsx("br",{}),"ë¬¸ì œê°€ ì§€ì†ë˜ë©´ ",e.jsx("strong",{children:"ì¬ì„¤ì¹˜"}),"ë¥¼ ì‹œë„í•˜ê±°ë‚˜ ì•„ë˜"," ",e.jsx("strong",{children:"ì§„ë‹¨ ì •ë³´"}),"ë¥¼ í™•ì¸í•˜ì„¸ìš”."]}),!h.ready&&x&&L&&e.jsxs(ie,{size:"small",title:"ğŸ” ì§„ë‹¨ ì •ë³´",style:{marginBottom:12,background:"#f5f5f5"},extra:e.jsx(B,{size:"small",type:"link",onClick:()=>se(!1),children:"ë‹«ê¸°"}),children:[x.error_message&&e.jsx(xe,{type:"error",message:x.error_message,style:{marginBottom:8},showIcon:!0}),x.pod_events&&x.pod_events.length>0&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsx(Zs,{strong:!0,children:"Pod ì´ë²¤íŠ¸:"}),e.jsx("div",{style:{maxHeight:150,overflow:"auto",background:"white",padding:8,marginTop:4,fontSize:12,fontFamily:"monospace"},children:x.pod_events.map((G,q)=>e.jsx("div",{children:G},q))})]}),x.pod_logs&&e.jsxs("div",{children:[e.jsx(Zs,{strong:!0,children:"Pod ë¡œê·¸ (ìµœê·¼ 50ì¤„):"}),e.jsx(qw,{value:x.pod_logs,readOnly:!0,rows:8,style:{marginTop:4,fontSize:11,fontFamily:"monospace",background:"white"}})]})]}),!h.ready&&h.installed&&!L&&x&&e.jsx(B,{size:"small",type:"link",onClick:()=>se(!0),style:{marginBottom:8,paddingLeft:0},children:"ğŸ” ì§„ë‹¨ ì •ë³´ ë³´ê¸°"}),e.jsxs(g,{size:"small",children:[!h.installed&&e.jsx(B,{type:"primary",size:"small",loading:S,onClick:W,icon:e.jsx(_t,{}),children:"Metrics Server ì„¤ì¹˜"}),h.installed&&e.jsxs(e.Fragment,{children:[e.jsx(B,{size:"small",loading:_,onClick:A,icon:e.jsx(Pt,{}),children:"ìƒíƒœ ìƒˆë¡œê³ ì¹¨"}),e.jsx(Kt,{title:"Metrics Server ì¬ì„¤ì¹˜",description:"ê¸°ì¡´ ì„¤ì¹˜ë¥¼ ì œê±°í•˜ê³  ë‹¤ì‹œ ì„¤ì¹˜í•©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:W,okText:"ì¬ì„¤ì¹˜",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(B,{size:"small",danger:!0,loading:S,icon:e.jsx(Pt,{}),children:"ì¬ì„¤ì¹˜"})}),((te=x==null?void 0:x.pod_events)==null?void 0:te.some(G=>G.includes("blob not found")||G.includes("FailedCreatePodSandBox")))&&e.jsx(Kt,{title:"ì´ë¯¸ì§€ ìºì‹œ ì •ë¦¬",description:"ë…¸ë“œì˜ ì†ìƒëœ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì œê±°í•˜ê³  ì¬ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:Z,okText:"ì •ë¦¬ ì‹œì‘",cancelText:"ì·¨ì†Œ",okButtonProps:{type:"primary"},children:e.jsx(B,{size:"small",type:"primary",icon:e.jsx(_t,{}),children:"ì´ë¯¸ì§€ ìºì‹œ ì •ë¦¬"})})]})]})]}),style:{marginBottom:16},closable:!0}),s.length===0?e.jsx(Je,{description:"Pod ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ê°œìš” íƒ­ì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì„¸ìš”."}):e.jsxs(e.Fragment,{children:[s.filter(G=>G.status.toLowerCase()==="pending").length>0&&e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(g,{children:[e.jsx(Yt,{style:{color:"#faad14"}}),e.jsxs(Zs,{type:"warning",children:["Pending ìƒíƒœì˜ Podê°€"," ",s.filter(G=>G.status.toLowerCase()==="pending").length,"ê°œ ìˆìŠµë‹ˆë‹¤."]})]}),e.jsx(Kt,{title:"ëª¨ë“  Pending Podë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:e.jsxs("div",{style:{maxWidth:300},children:[e.jsxs("p",{children:["ì´"," ",s.filter(G=>G.status.toLowerCase()==="pending").length,"ê°œì˜ Pending Podê°€ ê°•ì œë¡œ ì‚­ì œë©ë‹ˆë‹¤."]}),e.jsxs("p",{style:{marginBottom:0},children:[e.jsx("strong",{children:"ì£¼ì˜:"})," ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë©°, Deploymentê°€ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´ Podê°€ ìë™ìœ¼ë¡œ ì¬ìƒì„±ë©ë‹ˆë‹¤."]})]}),onConfirm:b,okText:"ëª¨ë‘ ì‚­ì œ",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(B,{danger:!0,icon:e.jsx(gs,{}),children:"Pending Pod ì¼ê´„ ì‚­ì œ"})})]}),e.jsx(wt,{dataSource:s,columns:J,rowKey:"name",pagination:{pageSize:10},size:"small",scroll:{x:1e3},expandable:{expandedRowRender:G=>{if(!["ImagePullBackOff","ErrImagePull","CrashLoopBackOff","Error","Failed","Pending"].includes(G.status))return null;if(!G.events)return ce(G.name),e.jsx("div",{style:{padding:"24px",textAlign:"center"},children:e.jsx(xe,{message:"Pod ì´ë²¤íŠ¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...",type:"info",showIcon:!0})});const be=(ye=>{switch(ye){case"ImagePullBackOff":case"ErrImagePull":return{bgColor:"#fff2e8",borderColor:"#ff7a45",iconColor:"#ff7a45",title:"ì´ë¯¸ì§€ Pull ì‹¤íŒ¨"};case"CrashLoopBackOff":return{bgColor:"#fff1f0",borderColor:"#ff4d4f",iconColor:"#ff4d4f",title:"ì»¨í…Œì´ë„ˆ ë°˜ë³µ ì‹¤íŒ¨"};case"Failed":case"Error":return{bgColor:"#fff1f0",borderColor:"#ff4d4f",iconColor:"#ff4d4f",title:"Pod ì‹¤íŒ¨"};default:return{bgColor:"#fff9e6",borderColor:"#faad14",iconColor:"#faad14",title:"Pending ìƒíƒœ"}}})(G.status),ne=ye=>{switch(ye){case"ImagePullBackOff":case"ErrImagePull":return e.jsx(xe,{message:"ì´ë¯¸ì§€ Pull ì‹¤íŒ¨ í•´ê²° ë°©ë²•",description:e.jsxs("ul",{style:{marginTop:8,marginBottom:0,paddingLeft:20},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"ì´ë¯¸ì§€ ê²½ë¡œ í™•ì¸:"})," ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì£¼ì†Œ, í”„ë¡œì íŠ¸/ì €ì¥ì†Œ ì´ë¦„, íƒœê·¸ê°€ ì •í™•í•œì§€ í™•ì¸"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"imagePullSecrets í™•ì¸:"})," Private RegistryëŠ” ì¸ì¦ ì •ë³´(Secret) í•„ìš”"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"ë„¤íŠ¸ì›Œí¬ í™•ì¸:"})," ë…¸ë“œì—ì„œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì ‘ê·¼ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìƒíƒœ í™•ì¸:"})," Harbor ë“± ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë¹„ìŠ¤ ì •ìƒ ì‘ë™ í™•ì¸"]})]}),type:"error",showIcon:!0,style:{marginTop:12}});case"CrashLoopBackOff":return e.jsx(xe,{message:"ì»¨í…Œì´ë„ˆ ë°˜ë³µ ì‹¤íŒ¨ í•´ê²° ë°©ë²•",description:e.jsxs("ul",{style:{marginTop:8,marginBottom:0,paddingLeft:20},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"ë¡œê·¸ í™•ì¸:"})," Pod ë¡œê·¸ë¥¼ í™•ì¸í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì˜¤ë¥˜ ì›ì¸ íŒŒì•…"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"í™˜ê²½ë³€ìˆ˜ í™•ì¸:"})," ConfigMap, Secret ì„¤ì •ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"í—¬ìŠ¤ì²´í¬ í™•ì¸:"})," ","liveness/readiness probe ì„¤ì •ì´ ì ì ˆí•œì§€ í™•ì¸"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"ë¦¬ì†ŒìŠ¤ í™•ì¸:"})," ë©”ëª¨ë¦¬ ë¶€ì¡±(OOMKilled)ì´ ì›ì¸ì¼ ìˆ˜ ìˆìŒ"]})]}),type:"error",showIcon:!0,style:{marginTop:12}});case"Pending":return e.jsx(xe,{message:"Pending ìƒíƒœ í•´ê²° ë°©ë²•",description:e.jsxs("ul",{style:{marginTop:8,marginBottom:0,paddingLeft:20},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"ë¦¬ì†ŒìŠ¤ ë¶€ì¡±:"})," í´ëŸ¬ìŠ¤í„°ì— ì¶©ë¶„í•œ CPU/ë©”ëª¨ë¦¬/ë””ìŠ¤í¬ê°€ ìˆëŠ”ì§€ í™•ì¸"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"nodeSelector/affinity:"})," Podì˜ ë…¸ë“œ ì„ íƒ ì¡°ê±´ì„ ì¶©ì¡±í•˜ëŠ” ë…¸ë“œê°€ ìˆëŠ”ì§€ í™•ì¸"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PVC ë°”ì¸ë”©:"})," ","PersistentVolumeClaimì´ ë°”ì¸ë”©ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Taints/Tolerations:"})," ë…¸ë“œì˜ taintë¥¼ Podê°€ tolerateí•˜ëŠ”ì§€ í™•ì¸"]})]}),type:"warning",showIcon:!0,style:{marginTop:12}});default:return e.jsx(xe,{message:"ì¼ë°˜ì ì¸ í•´ê²° ë°©ë²•",description:e.jsxs("ul",{style:{marginTop:8,marginBottom:0,paddingLeft:20},children:[e.jsx("li",{children:"Pod ì´ë²¤íŠ¸ ë° ë¡œê·¸ë¥¼ í™•ì¸í•˜ì—¬ ì •í™•í•œ ì›ì¸ íŒŒì•…"}),e.jsx("li",{children:"ê´€ë ¨ ë¦¬ì†ŒìŠ¤(Deployment, Service, ConfigMap ë“±) ì„¤ì • í™•ì¸"}),e.jsx("li",{children:"í´ëŸ¬ìŠ¤í„° ìƒíƒœ ë° ë…¸ë“œ ìƒíƒœ í™•ì¸"})]}),type:"info",showIcon:!0,style:{marginTop:12}})}};return e.jsx("div",{style:{padding:"20px 24px",backgroundColor:be.bgColor,borderLeft:`4px solid ${be.borderColor}`},children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{span:24,children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(Yt,{style:{color:be.iconColor,fontSize:18}}),e.jsxs(Vw,{level:5,style:{margin:0,color:be.iconColor},children:[be.title," ì›ì¸ ë¶„ì„"]})]}),ne(G.status)]})}),e.jsxs(Y,{span:24,children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx(Zs,{strong:!0,style:{fontSize:14},children:"ğŸ” ì´ë²¤íŠ¸ ëª©ë¡"}),e.jsxs(Zs,{type:"secondary",style:{fontSize:12,marginLeft:8},children:["(",G.events.length,"ê°œ)"]})]}),G.events&&G.events.length>0?e.jsx(g,{direction:"vertical",size:"small",style:{width:"100%"},children:G.events.map((ye,Ue)=>e.jsx(ie,{size:"small",style:{backgroundColor:ye.type==="Warning"?"#fff2e8":"#f6ffed",borderColor:ye.type==="Warning"?"#ffbb96":"#b7eb8f"},bodyStyle:{padding:"12px 16px"},children:e.jsxs(g,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[ye.type==="Warning"?e.jsx(Yt,{style:{color:"#ff7a45",fontSize:16}}):e.jsx(Ze,{style:{color:"#52c41a",fontSize:16}}),e.jsx(T,{color:ye.type==="Warning"?"error":"success",children:ye.type}),e.jsx(Zs,{strong:!0,style:{fontSize:14},children:ye.reason}),ye.count>1&&e.jsxs(T,{color:"orange",children:["ë°œìƒ ",ye.count,"íšŒ"]}),e.jsx(Zs,{type:"secondary",style:{fontSize:12,marginLeft:"auto"},children:ye.timestamp})]}),e.jsx(Zs,{style:{fontSize:13,paddingLeft:24},children:ye.message})]})},Ue))}):e.jsx(Je,{description:"ì´ë²¤íŠ¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤",image:Je.PRESENTED_IMAGE_SIMPLE})]}),e.jsx(Y,{span:24,children:e.jsxs("div",{style:{padding:"16px",backgroundColor:"#fff",borderRadius:8,border:"1px solid #d9d9d9",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(g,{direction:"vertical",size:0,children:[e.jsx(Zs,{strong:!0,children:"Pod ê°•ì œ ì‚­ì œ"}),e.jsx(Zs,{type:"secondary",style:{fontSize:12},children:"ë¬¸ì œê°€ ì§€ì†ë˜ë©´ Podë¥¼ ì‚­ì œí•˜ì—¬ ì¬ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"})]}),e.jsx(Kt,{title:"Pending Podë¥¼ ê°•ì œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:e.jsxs("div",{style:{maxWidth:300},children:[e.jsx("p",{children:"ì´ ì‘ì—…ì€ ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ì´ˆë˜í•©ë‹ˆë‹¤:"}),e.jsxs("ul",{style:{paddingLeft:20,margin:"8px 0"},children:[e.jsx("li",{children:"Podê°€ ì¦‰ì‹œ ì¢…ë£Œë©ë‹ˆë‹¤"}),e.jsx("li",{children:"Deploymentê°€ ìƒˆ Podë¥¼ ìë™ ìƒì„±í•©ë‹ˆë‹¤"}),e.jsx("li",{children:"ê·¼ë³¸ ì›ì¸ì´ í•´ê²°ë˜ì§€ ì•Šìœ¼ë©´ ë™ì¼í•œ ë¬¸ì œê°€ ë°˜ë³µë©ë‹ˆë‹¤"})]})]}),onConfirm:()=>j(G.name),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},icon:e.jsx(Yt,{style:{color:"#ff4d4f"}}),children:e.jsx(B,{danger:!0,icon:e.jsx(gs,{}),size:"large",children:"ê°•ì œ ì‚­ì œ"})})]})})]})})},rowExpandable:G=>G.status.toLowerCase()==="pending",expandIcon:({expanded:G,onExpand:q,record:oe})=>oe.status.toLowerCase()==="pending"?e.jsx(B,{size:"small",type:G?"default":"primary",ghost:!G,icon:e.jsx(Yt,{}),onClick:be=>q(oe,be),style:{borderColor:"#faad14",color:G?"#595959":"#faad14"},children:G?"ì ‘ê¸°":"ì›ì¸ ë³´ê¸°"}):null,expandIconColumnIndex:0},rowClassName:G=>G.status.toLowerCase()==="pending"?"pod-pending-row":""})]})]})},{TextArea:Ww}=ue,{Text:zd}=we,Kw=({serviceId:s,readOnly:t=!1})=>{const[r,n]=o.useState(!1),[a,i]=o.useState(null),[l,d]=o.useState(""),[c,p]=o.useState([]),[h,x]=o.useState([]),[_,S]=o.useState([]),[L,k]=o.useState(!1),[E,P]=o.useState(""),[I,$]=o.useState(!1),[y,v]=o.useState(null),u=async()=>{n(!0),i(null);try{const D=await ic(s);d(D.namespace),p(D.deployments||[]),x(D.services||[]),S(D.ingresses||[])}catch(D){const M=`ë¦¬ì†ŒìŠ¤ ì¡°íšŒ ì‹¤íŒ¨: ${D.message}`;i(M),f.error(M)}finally{n(!1)}};o.useEffect(()=>{s&&u()},[s]);const m=async(D,M)=>{v({type:D,name:M}),k(!0),$(!0);try{const K=await Hg({service_id:s,resource_type:D,resource_name:M});P(K)}catch(K){f.error(`YAML ì¡°íšŒ ì‹¤íŒ¨: ${K.message}`),k(!1)}finally{$(!1)}},j=async()=>{var D;if(!E.trim()){f.warning("YAML ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”");return}$(!0);try{const M=await by({service_id:s,yaml:E,resource_type:y==null?void 0:y.type,resource_name:y==null?void 0:y.name});(D=M.git_sync)!=null&&D.success?f.success(`${M.message} (âœ“ Git ì €ì¥ì†Œì— ì»¤ë°‹ë¨)`):M.git_sync&&!M.git_sync.success?f.warning(`${M.message} (âš ï¸ Git ë™ê¸°í™” ì‹¤íŒ¨: ${M.git_sync.message})`,5):f.success(M.message),k(!1),u()}catch(M){f.error(`ì ìš© ì‹¤íŒ¨: ${M.message}`)}finally{$(!1)}},b=async(D,M)=>{var K;try{const J=await _y({service_id:s,resource_type:D,resource_name:M});(K=J.git_sync)!=null&&K.success?f.success(`${J.message} (âœ“ Git ì €ì¥ì†Œì—ì„œ ì œê±°ë¨)`):J.git_sync&&!J.git_sync.success?f.warning(`${J.message} (âš ï¸ Git ë™ê¸°í™” ì‹¤íŒ¨: ${J.git_sync.message})`,5):f.success(J.message),u()}catch(J){f.error(`ì‚­ì œ ì‹¤íŒ¨: ${J.message}`)}},A=()=>{v(null),P(`# ìƒˆ Kubernetes ë¦¬ì†ŒìŠ¤ YAMLì„ ì…ë ¥í•˜ì„¸ìš”
apiVersion: v1
kind: Service
metadata:
  name: my-service
spec:
  selector:
    app: my-app
  ports:
    - protocol: TCP
      port: 80
      targetPort: 8080`),k(!0)},W=[{title:"ì´ë¦„",dataIndex:["metadata","name"],key:"name",render:D=>e.jsx(zd,{strong:!0,children:D})},{title:"ìƒì„± ì‹œê°„",dataIndex:["metadata","creationTimestamp"],key:"creationTimestamp",render:D=>new Date(D).toLocaleString()},{title:"ì‘ì—…",key:"actions",render:(D,M)=>e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:t?e.jsx(xa,{}):e.jsx(ln,{}),onClick:()=>m("deployment",M.metadata.name),children:t?"YAML ë³´ê¸°":"í¸ì§‘"}),!t&&e.jsx(Kt,{title:"ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>b("deployment",M.metadata.name),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),children:"ì‚­ì œ"})})]})}],Z=[{title:"ì´ë¦„",dataIndex:["metadata","name"],key:"name",render:D=>e.jsx(zd,{strong:!0,children:D})},{title:"íƒ€ì…",dataIndex:["spec","type"],key:"type",render:D=>e.jsx(T,{color:"blue",children:D})},{title:"ìƒì„± ì‹œê°„",dataIndex:["metadata","creationTimestamp"],key:"creationTimestamp",render:D=>new Date(D).toLocaleString()},{title:"ì‘ì—…",key:"actions",render:(D,M)=>e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:t?e.jsx(xa,{}):e.jsx(ln,{}),onClick:()=>m("service",M.metadata.name),children:t?"YAML ë³´ê¸°":"í¸ì§‘"}),!t&&e.jsx(Kt,{title:"ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>b("service",M.metadata.name),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),children:"ì‚­ì œ"})})]})}],se=[{title:"ì´ë¦„",dataIndex:["metadata","name"],key:"name",render:D=>e.jsx(zd,{strong:!0,children:D})},{title:"í˜¸ìŠ¤íŠ¸",dataIndex:["spec","rules"],key:"hosts",render:D=>!D||D.length===0?"-":D.map(M=>e.jsx(T,{color:"green",children:M.host},M.host))},{title:"ìƒì„± ì‹œê°„",dataIndex:["metadata","creationTimestamp"],key:"creationTimestamp",render:D=>new Date(D).toLocaleString()},{title:"ì‘ì—…",key:"actions",render:(D,M)=>e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:t?e.jsx(xa,{}):e.jsx(ln,{}),onClick:()=>m("ingress",M.metadata.name),children:t?"YAML ë³´ê¸°":"í¸ì§‘"}),!t&&e.jsx(Kt,{title:"ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>b("ingress",M.metadata.name),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),children:"ì‚­ì œ"})})]})}],ce=[{key:"deployments",label:e.jsxs("span",{children:[e.jsx(_t,{}),"Deployment (",c.length,")"]}),children:e.jsx(wt,{size:"small",columns:W,dataSource:c,rowKey:D=>D.metadata.name,pagination:!1,locale:{emptyText:"Deploymentê°€ ì—†ìŠµë‹ˆë‹¤"}})},{key:"services",label:e.jsxs("span",{children:[e.jsx(ya,{}),"Service (",h.length,")"]}),children:e.jsx(wt,{size:"small",columns:Z,dataSource:h,rowKey:D=>D.metadata.name,pagination:!1,locale:{emptyText:"Serviceê°€ ì—†ìŠµë‹ˆë‹¤"}})},{key:"ingresses",label:e.jsxs("span",{children:[e.jsx(ur,{}),"Ingress (",_.length,")"]}),children:e.jsx(wt,{size:"small",columns:se,dataSource:_,rowKey:D=>D.metadata.name,pagination:!1,locale:{emptyText:"Ingressê°€ ì—†ìŠµë‹ˆë‹¤"}})}];return e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:"small",title:e.jsxs(g,{children:[e.jsx(Fr,{}),e.jsx("span",{children:"Kubernetes ë¦¬ì†ŒìŠ¤ ê´€ë¦¬"}),l&&e.jsx(T,{color:"cyan",children:l})]}),extra:e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:e.jsx(zs,{}),onClick:u,loading:r,children:"ìƒˆë¡œê³ ì¹¨"}),!t&&e.jsx(B,{size:"small",type:"primary",icon:e.jsx(rr,{}),onClick:A,children:"ë¦¬ì†ŒìŠ¤ ì¶”ê°€"})]}),children:a?e.jsx(xe,{message:"ë¦¬ì†ŒìŠ¤ ì¡°íšŒ ì‹¤íŒ¨",description:a,type:"error",showIcon:!0,action:e.jsx(B,{size:"small",onClick:u,children:"ë‹¤ì‹œ ì‹œë„"})}):r&&!c.length&&!h.length&&!_.length?e.jsx("div",{style:{textAlign:"center",padding:"40px"},children:e.jsx(gt,{tip:"ë¦¬ì†ŒìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})}):e.jsxs(e.Fragment,{children:[!l&&e.jsx(xe,{message:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",description:"ì„œë¹„ìŠ¤ì— ë„¤ì„ìŠ¤í˜ì´ìŠ¤ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx(xs,{items:ce})]})}),e.jsx(rt,{title:y?t?`${y.type}/${y.name} YAML ì¡°íšŒ`:`${y.type}/${y.name} í¸ì§‘`:"ìƒˆ ë¦¬ì†ŒìŠ¤ ì¶”ê°€",open:L,onCancel:()=>k(!1),onOk:t?()=>k(!1):j,okText:t?"ë‹«ê¸°":"ì ìš©",cancelText:t?void 0:"ì·¨ì†Œ",cancelButtonProps:t?{style:{display:"none"}}:void 0,width:800,confirmLoading:I,children:I&&!E?e.jsx("div",{style:{textAlign:"center",padding:"40px"},children:e.jsx(gt,{tip:"YAMLì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{message:t?"YAML ì¡°íšŒ":"YAML í¸ì§‘",description:t?"Kubernetes ë¦¬ì†ŒìŠ¤ YAML ë‚´ìš©ì…ë‹ˆë‹¤. (ì½ê¸° ì „ìš©)":"Kubernetes ë¦¬ì†ŒìŠ¤ YAMLì„ í¸ì§‘í•˜ê³  ì ìš©í•˜ì„¸ìš”. ì˜ëª»ëœ YAMLì€ ì ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(Ww,{value:E,onChange:D=>P(D.target.value),placeholder:"Kubernetes YAML ì…ë ¥",autoSize:{minRows:20,maxRows:30},style:{fontFamily:"monospace",fontSize:12},readOnly:t})]})})]})},Yw=({service:s})=>e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:"Kubernetes ë¦¬ì†ŒìŠ¤ í˜„í™©",description:"Deployment, Service, Ingress ë“±ì˜ K8s ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),s!=null&&s.id?e.jsx(Kw,{serviceId:s.id,readOnly:!0}):e.jsx(Je,{description:"ì„œë¹„ìŠ¤ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})]}),{Text:pn}=we,Ed=s=>s?Array.isArray(s)?s:"items"in s&&Array.isArray(s.items)?s.items:[]:[],co=s=>s?Array.isArray(s)?s.length:"items"in s&&Array.isArray(s.items)?s.items.length:0:0,Jw=({service:s,infraId:t,hops:r,onOverviewDataRefresh:n})=>{const a=(s==null?void 0:s.namespace)||"k8s",i=ae=>ae.map(pe=>({host:pe.host,port:pe.port||22,username:pe.username||"",password:pe.password||""})),[l,d]=o.useState(!1),[c,p]=o.useState(!1),[h,x]=o.useState(!1),[_,S]=o.useState(!1),[L,k]=o.useState(!1),[E,P]=o.useState(null),[I,$]=o.useState([]),[y,v]=o.useState(!1),[u,m]=o.useState(!1),[j,b]=o.useState(!1),[A,W]=o.useState(!1),[Z,se]=o.useState(!1),[ce,D]=o.useState(null),[M,K]=o.useState(!1),[J,te]=o.useState(!1),[G,q]=o.useState(7),[oe,be]=o.useState(null),[ne,ye]=o.useState(!1),[Ue,N]=o.useState(!1),ge=async()=>{if(!t){f.error("ì¸í”„ë¼ IDê°€ ì—†ìŠµë‹ˆë‹¤");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}d(!0);try{const ae=i(r),pe=await Ly({infra_id:t,namespace:a,hops:ae});at.success({message:"ReplicaSet ì •ë¦¬ ì™„ë£Œ",description:`ì´ ${pe.deleted_count}ê°œì˜ ì˜¤ë˜ëœ ReplicaSetì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.`,duration:5}),pe.errors&&pe.errors.length>0&&at.warning({message:"ì¼ë¶€ í•­ëª© ì²˜ë¦¬ ì‹¤íŒ¨",description:`${pe.errors.length}ê°œì˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,duration:5})}catch(ae){const pe=ae;at.error({message:"ReplicaSet ì •ë¦¬ ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{d(!1)}},Ce=async()=>{if(!t||!E){f.error("ë…¸ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}m(!0);try{const ae=i(r),pe=await Ay({infra_id:t,node_name:E,hops:ae});at.success({message:"Node Drain ì™„ë£Œ",description:`ë…¸ë“œ ${pe.node_name}ì„ ì„±ê³µì ìœ¼ë¡œ drainí–ˆìŠµë‹ˆë‹¤.`,duration:5})}catch(ae){const pe=ae;at.error({message:"Node Drain ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{m(!1)}},je=async()=>{if(!t||!E){f.error("ë…¸ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}b(!0);try{const ae=i(r),pe=await Ny({infra_id:t,node_name:E,hops:ae});at.success({message:"Node Cordon ì™„ë£Œ",description:`ë…¸ë“œ ${pe.node_name}ì„ ì„±ê³µì ìœ¼ë¡œ cordoní–ˆìŠµë‹ˆë‹¤. (ìƒˆ Pod í• ë‹¹ ë°©ì§€)`,duration:5})}catch(ae){const pe=ae;at.error({message:"Node Cordon ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{b(!1)}},Pe=async()=>{if(!t||!E){f.error("ë…¸ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}W(!0);try{const ae=i(r),pe=await By({infra_id:t,node_name:E,hops:ae});at.success({message:"Node Uncordon ì™„ë£Œ",description:`ë…¸ë“œ ${pe.node_name}ì„ ì„±ê³µì ìœ¼ë¡œ uncordoní–ˆìŠµë‹ˆë‹¤. (ìŠ¤ì¼€ì¤„ë§ ì¬í™œì„±í™”)`,duration:5})}catch(ae){const pe=ae;at.error({message:"Node Uncordon ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{W(!1)}},w=async()=>{if(!t){f.error("ì¸í”„ë¼ IDê°€ ì—†ìŠµë‹ˆë‹¤");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}v(!0);try{const ae=i(r),pe=await Vg({infra_id:t,hops:ae});$(Array.isArray(pe.nodes)?pe.nodes:[]),f.success("ë…¸ë“œ ëª©ë¡ì„ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤")}catch(ae){const pe=ae;at.error({message:"ë…¸ë“œ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{v(!1)}},R=async()=>{if(!t){f.error("ì¸í”„ë¼ IDê°€ ì—†ìŠµë‹ˆë‹¤");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}se(!0);try{const ae=i(r),pe=await $y({infra_id:t,namespace:a,hops:ae}),Xe=pe.pvcs?JSON.parse(pe.pvcs):null,Nt=pe.pvs?JSON.parse(pe.pvs):null,Fe=pe.storageclasses?JSON.parse(pe.storageclasses):null;D({pvcs:Xe,pvs:Nt,storageclasses:Fe}),f.success("PVC ìƒíƒœë¥¼ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤")}catch(ae){const pe=ae;at.error({message:"PVC ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{se(!1)}},U=async()=>{if(!t){f.error("ì¸í”„ë¼ IDê°€ ì—†ìŠµë‹ˆë‹¤");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}p(!0);try{const ae=i(r),pe=await Oy({infra_id:t,namespace:a,hops:ae});at.success({message:"Evicted Pod ì •ë¦¬ ì™„ë£Œ",description:`ì´ ${pe.deleted_count}ê°œì˜ Evicted Podë¥¼ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.`,duration:5}),n==null||n()}catch(ae){const pe=ae;at.error({message:"Evicted Pod ì •ë¦¬ ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{p(!1)}},V=async()=>{if(!t){f.error("ì¸í”„ë¼ IDê°€ ì—†ìŠµë‹ˆë‹¤");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}x(!0);try{const ae=i(r),pe=await Dy({infra_id:t,namespace:a,hops:ae});at.success({message:"Failed Pod ì •ë¦¬ ì™„ë£Œ",description:`ì´ ${pe.deleted_count}ê°œì˜ Failed/Error Podë¥¼ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.`,duration:5}),n==null||n()}catch(ae){const pe=ae;at.error({message:"Failed Pod ì •ë¦¬ ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{x(!1)}},F=async()=>{if(!t){f.error("ì¸í”„ë¼ IDê°€ ì—†ìŠµë‹ˆë‹¤");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}S(!0);try{const ae=i(r),pe=await Fy({infra_id:t,namespace:a,hops:ae});at.success({message:"Completed Pod ì •ë¦¬ ì™„ë£Œ",description:`ì´ ${pe.deleted_count}ê°œì˜ Completed Podë¥¼ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.`,duration:5}),n==null||n()}catch(ae){const pe=ae;at.error({message:"Completed Pod ì •ë¦¬ ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{S(!1)}},X=async()=>{if(!t){f.error("ì¸í”„ë¼ IDê°€ ì—†ìŠµë‹ˆë‹¤");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}k(!0);try{const ae=i(r),pe=await Uy({infra_id:t,node_name:E||void 0,hops:ae});at.success({message:"Docker ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì™„ë£Œ",description:pe.message||"Docker ì´ë¯¸ì§€/ì»¨í…Œì´ë„ˆ/ìºì‹œë¥¼ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.",duration:5})}catch(ae){const pe=ae;at.error({message:"Docker ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{k(!1)}},de=async()=>{if(!t){f.error("ì¸í”„ë¼ IDê°€ ì—†ìŠµë‹ˆë‹¤");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}K(!0);try{const ae=i(r),pe=await Hy({infra_id:t,node_name:E||void 0,hops:ae});at.success({message:"ë””ìŠ¤í¬ ê³µê°„ í™•ë³´ ì™„ë£Œ",description:pe.message||"Journal ë¡œê·¸, APT ìºì‹œ, ì„ì‹œ íŒŒì¼ ë“±ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.",duration:5})}catch(ae){const pe=ae;at.error({message:"ë””ìŠ¤í¬ ê³µê°„ í™•ë³´ ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{K(!1)}},Ne=async()=>{if(!t){f.error("ì¸í”„ë¼ IDê°€ ì—†ìŠµë‹ˆë‹¤");return}if(!r||r.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤");return}te(!0);try{const ae=i(r);await Vy({infra_id:t,days:G,hops:ae}),at.success({message:"Pod ë¡œê·¸ ì •ë¦¬ ì™„ë£Œ",description:`${G}ì¼ ì´ìƒ ëœ Pod ë¡œê·¸ë¥¼ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.`,duration:5})}catch(ae){const pe=ae;at.error({message:"Pod ë¡œê·¸ ì •ë¦¬ ì‹¤íŒ¨",description:pe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{te(!1)}};return e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:"Kubernetes ìš´ì˜ ê´€ë¦¬",description:"í´ëŸ¬ìŠ¤í„° ìš´ì˜ì— í•„ìš”í•œ ê´€ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¹´í…Œê³ ë¦¬ë¥¼ í´ë¦­í•˜ì—¬ ê´€ë ¨ ê¸°ëŠ¥ì„ í™•ì¸í•˜ì„¸ìš”.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(nr,{defaultActiveKey:["cleanup"],style:{background:"#fff"},items:[{key:"cleanup",label:e.jsxs(g,{children:[e.jsx($a,{style:{color:"#1890ff"}}),e.jsx(pn,{strong:!0,children:"ë¦¬ì†ŒìŠ¤ ì •ë¦¬"}),e.jsx(T,{color:"blue",children:"ReplicaSet Â· Pod Â· Docker"})]}),children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx($a,{})," ReplicaSet ì •ë¦¬"]}),style:{marginBottom:16},children:[e.jsx(pn,{type:"secondary",style:{display:"block",marginBottom:12},children:"ì˜¤ë˜ëœ ReplicaSet (desired=0)ì„ ì¼ê´„ ì‚­ì œí•˜ì—¬ í´ëŸ¬ìŠ¤í„°ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤."}),e.jsxs(g,{children:[e.jsxs(T,{children:["Namespace: ",a]}),e.jsx(Kt,{title:"ReplicaSet ì •ë¦¬",description:"ì˜¤ë˜ëœ ReplicaSetì„ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:ge,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{type:"primary",size:"small",icon:e.jsx($a,{}),loading:l,disabled:!t,children:"ì‹¤í–‰"})})]})]}),e.jsxs(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(gs,{})," Pod ì •ë¦¬"]}),style:{marginBottom:16},children:[e.jsx(pn,{type:"secondary",style:{display:"block",marginBottom:12},children:"Evicted, Failed, Completed ìƒíƒœì˜ Podë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤."}),e.jsxs(g,{wrap:!0,children:[e.jsx(Kt,{title:"Evicted Pod ì •ë¦¬",description:"ëª¨ë“  Evicted Podë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:U,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",icon:e.jsx($a,{}),loading:c,disabled:!t,children:"Evicted"})}),e.jsx(Kt,{title:"Failed Pod ì •ë¦¬",description:"ëª¨ë“  Failed/Error Podë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:V,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),loading:h,disabled:!t,children:"Failed"})}),e.jsx(B,{size:"small",icon:e.jsx(Ze,{}),loading:_,disabled:!t,onClick:F,children:"Completed"})]})]}),e.jsxs(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(fa,{})," Docker ë¦¬ì†ŒìŠ¤ ì •ë¦¬"]}),children:[e.jsxs(pn,{type:"secondary",style:{display:"block",marginBottom:12},children:["Dangling ì´ë¯¸ì§€, ì¤‘ì§€ëœ ì»¨í…Œì´ë„ˆ, ë¹Œë“œ ìºì‹œë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤.",e.jsx("br",{}),"ëŒ€ìƒ: ",e.jsx(T,{children:E||"ëª¨ë“  ë…¸ë“œ"})]}),e.jsx(Kt,{title:"Docker ë¦¬ì†ŒìŠ¤ ì •ë¦¬",description:"Docker ë¦¬ì†ŒìŠ¤ë¥¼ ì •ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:X,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",type:"primary",icon:e.jsx(fa,{}),loading:L,disabled:!t,children:"ì‹¤í–‰"})})]})]})},{key:"node",label:e.jsxs(g,{children:[e.jsx(tg,{style:{color:"#52c41a"}}),e.jsx(pn,{strong:!0,children:"ë…¸ë“œ ê´€ë¦¬"}),e.jsx(T,{color:"green",children:"Drain Â· Cordon Â· Uncordon"})]}),children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(xe,{message:"ë…¸ë“œ ê´€ë¦¬ ê¸°ëŠ¥",description:e.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Drain"}),": ë…¸ë“œì˜ ëª¨ë“  Podë¥¼ ë‹¤ë¥¸ ë…¸ë“œë¡œ ì´ë™ (ìœ ì§€ë³´ìˆ˜ìš©)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cordon"}),": ìƒˆë¡œìš´ Pod í• ë‹¹ ë°©ì§€ (ê¸°ì¡´ Pod ìœ ì§€)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Uncordon"}),": Cordon í•´ì œí•˜ì—¬ ìŠ¤ì¼€ì¤„ë§ ì¬í™œì„±í™”"]})]}),type:"info",style:{marginBottom:16}}),e.jsxs("div",{children:[e.jsxs(g,{style:{marginBottom:12},children:[e.jsx(pn,{strong:!0,children:"ë…¸ë“œ ì„ íƒ:"}),e.jsx(B,{type:"link",size:"small",icon:e.jsx(Pt,{}),onClick:w,loading:y,children:"ìƒˆë¡œê³ ì¹¨"}),I.length>0&&e.jsxs(T,{color:"blue",children:[I.length,"ê°œ ë…¸ë“œ"]})]}),e.jsx(Ee,{placeholder:y?"ë…¸ë“œ ë¡œë”© ì¤‘...":I.length===0?"ìƒˆë¡œê³ ì¹¨ì„ ëˆŒëŸ¬ ë…¸ë“œë¥¼ ì¡°íšŒí•˜ì„¸ìš”":"ë…¸ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”",value:E||void 0,onChange:ae=>P(ae),style:{width:"100%"},loading:y,notFoundContent:y?"ë¡œë”© ì¤‘...":"ë…¸ë“œê°€ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ì„ í´ë¦­í•˜ì„¸ìš”.",children:I.map(ae=>e.jsx(Ee.Option,{value:ae.name,children:e.jsxs(g,{children:[e.jsx(T,{color:ae.status==="Ready"?"success":"error",children:ae.status}),ae.roles!=="worker"&&e.jsx(T,{color:"blue",children:ae.roles}),e.jsx(pn,{strong:!0,children:ae.name})]})},ae.name))})]}),e.jsxs(g,{wrap:!0,style:{marginTop:12},children:[e.jsx(Kt,{title:"Node Drain",description:`ë…¸ë“œ ${E}ì˜ ëª¨ë“  Podë¥¼ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,onConfirm:Ce,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",disabled:!E,children:e.jsx(B,{type:"primary",danger:!0,icon:e.jsx(gs,{}),loading:u,disabled:!t||!E,children:"Drain"})}),e.jsx(Kt,{title:"Node Cordon",description:`ë…¸ë“œ ${E}ì— ìƒˆ Pod í• ë‹¹ì„ ë°©ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,onConfirm:je,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",disabled:!E,children:e.jsx(B,{icon:e.jsx(Yt,{}),loading:j,disabled:!t||!E,children:"Cordon"})}),e.jsx(B,{icon:e.jsx(Ze,{}),loading:A,disabled:!t||!E,onClick:Pe,children:"Uncordon"})]})]})},{key:"storage",label:e.jsxs(g,{children:[e.jsx(_s,{style:{color:"#722ed1"}}),e.jsx(pn,{strong:!0,children:"ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬"}),e.jsx(T,{color:"purple",children:"PVC Â· PV Â· StorageClass"})]}),children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(pn,{type:"secondary",children:["PersistentVolumeClaim, PersistentVolume, StorageClassì˜ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.",e.jsx("br",{}),"Namespace: ",e.jsx(T,{children:a})]}),e.jsx(B,{type:"primary",icon:e.jsx(Pt,{}),loading:Z,onClick:R,disabled:!t,children:"ìƒíƒœ ì¡°íšŒ"}),ce&&e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsx(ie,{type:"inner",title:`PVCs (${co(ce.pvcs)})`,size:"small",style:{marginBottom:16},children:co(ce.pvcs)>0?e.jsx(wt,{size:"small",pagination:{pageSize:10},dataSource:Ed(ce.pvcs),rowKey:ae=>{var pe;return((pe=ae.metadata)==null?void 0:pe.name)||ae.name||""},columns:[{title:"Name",dataIndex:["metadata","name"],key:"name",render:(ae,pe)=>{var Xe;return((Xe=pe.metadata)==null?void 0:Xe.name)||pe.name}},{title:"Status",dataIndex:["status","phase"],key:"status",render:(ae,pe)=>{var Xe,Nt;return e.jsx(T,{color:((Xe=pe.status)==null?void 0:Xe.phase)==="Bound"?"green":"orange",children:(Nt=pe.status)==null?void 0:Nt.phase})}},{title:"Capacity",dataIndex:["status","capacity","storage"],key:"capacity",render:(ae,pe)=>{var Xe,Nt;return((Nt=(Xe=pe.status)==null?void 0:Xe.capacity)==null?void 0:Nt.storage)||pe.capacity}}]}):e.jsx(pn,{type:"secondary",children:"PVCê°€ ì—†ìŠµë‹ˆë‹¤"})}),e.jsx(ie,{type:"inner",title:`PVs (${co(ce.pvs)})`,size:"small",style:{marginBottom:16},children:co(ce.pvs)>0?e.jsx(wt,{size:"small",pagination:{pageSize:10},dataSource:Ed(ce.pvs),rowKey:ae=>{var pe;return((pe=ae.metadata)==null?void 0:pe.name)||ae.name||""},columns:[{title:"Name",dataIndex:["metadata","name"],key:"name",render:(ae,pe)=>{var Xe;return((Xe=pe.metadata)==null?void 0:Xe.name)||pe.name}},{title:"Status",dataIndex:["status","phase"],key:"status",render:(ae,pe)=>{var Xe,Nt;return e.jsx(T,{color:((Xe=pe.status)==null?void 0:Xe.phase)==="Bound"?"green":"blue",children:(Nt=pe.status)==null?void 0:Nt.phase})}},{title:"Capacity",dataIndex:["spec","capacity","storage"],key:"capacity",render:(ae,pe)=>{var Xe,Nt;return((Nt=(Xe=pe.spec)==null?void 0:Xe.capacity)==null?void 0:Nt.storage)||pe.capacity}}]}):e.jsx(pn,{type:"secondary",children:"PVê°€ ì—†ìŠµë‹ˆë‹¤"})}),e.jsx(ie,{type:"inner",title:`StorageClasses (${co(ce.storageclasses)})`,size:"small",children:co(ce.storageclasses)>0?e.jsx(wt,{size:"small",pagination:{pageSize:10},dataSource:Ed(ce.storageclasses),rowKey:ae=>{var pe;return((pe=ae.metadata)==null?void 0:pe.name)||ae.name||""},columns:[{title:"Name",dataIndex:["metadata","name"],key:"name",render:(ae,pe)=>{var Xe;return((Xe=pe.metadata)==null?void 0:Xe.name)||pe.name}},{title:"Provisioner",dataIndex:"provisioner",key:"provisioner"},{title:"ReclaimPolicy",dataIndex:"reclaimPolicy",key:"reclaimPolicy"}]}):e.jsx(pn,{type:"secondary",children:"StorageClassê°€ ì—†ìŠµë‹ˆë‹¤"})})]})]})},{key:"system",label:e.jsxs(g,{children:[e.jsx(rn,{style:{color:"#fa8c16"}}),e.jsx(pn,{strong:!0,children:"ì‹œìŠ¤í…œ ì •ë¦¬"}),e.jsx(T,{color:"orange",children:"ë””ìŠ¤í¬ Â· ë¡œê·¸"})]}),children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(_s,{})," ë””ìŠ¤í¬ ê³µê°„ í™•ë³´"]}),style:{marginBottom:16},children:[e.jsxs(pn,{type:"secondary",style:{display:"block",marginBottom:12},children:["Journal ë¡œê·¸, APT ìºì‹œ, ì„ì‹œ íŒŒì¼ ë“±ì„ ì •ë¦¬í•©ë‹ˆë‹¤.",e.jsx("br",{}),"ëŒ€ìƒ: ",e.jsx(T,{children:E||"Master ë…¸ë“œ"})]}),e.jsx(Kt,{title:"ë””ìŠ¤í¬ ê³µê°„ í™•ë³´",description:"ë””ìŠ¤í¬ ê³µê°„ì„ í™•ë³´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:de,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",type:"primary",icon:e.jsx(_s,{}),loading:M,disabled:!t,children:"ì‹¤í–‰"})})]}),e.jsxs(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(Fr,{})," Pod ë¡œê·¸ ì •ë¦¬"]}),children:[e.jsx(pn,{type:"secondary",style:{display:"block",marginBottom:12},children:"/var/log/pods ë° /var/log/containersì˜ ì˜¤ë˜ëœ ë¡œê·¸ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤."}),e.jsxs(g,{children:[e.jsx(pn,{children:"ë³´ê´€ ê¸°ê°„:"}),e.jsx(xn,{min:1,max:30,value:G,onChange:ae=>q(ae||7),style:{width:80}}),e.jsx(pn,{type:"secondary",children:"ì¼"}),e.jsx(Kt,{title:"Pod ë¡œê·¸ ì •ë¦¬",description:`${G}ì¼ ì´ìƒ ëœ ë¡œê·¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,onConfirm:Ne,okText:"í™•ì¸",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",type:"primary",icon:e.jsx(Fr,{}),loading:J,disabled:!t,children:"ì‹¤í–‰"})})]})]})]})}]})]})},{Text:$o}=we,{TextArea:Zw}=ue,Qw=({service:s,infraId:t,deployments:r,selectedDeployment:n,onDeploymentChange:a,deploymentStatus:i,sshHops:l})=>{const[d,c]=o.useState(""),[p,h]=o.useState(!1),x=async()=>{if(!(s!=null&&s.id)||!n){f.warning("Deploymentë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”");return}h(!0);try{const S=l&&l.length>0?l.map(k=>({host:k.host,port:k.port||22,username:k.username||"",password:k.password||""})):void 0,L=await ky({service_id:s.id,deployment_name:n,hops:S});c(L.history||"ë°°í¬ íˆìŠ¤í† ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤"),f.success("ë°°í¬ íˆìŠ¤í† ë¦¬ë¥¼ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤")}catch(S){const L=S;f.error(`ë°°í¬ íˆìŠ¤í† ë¦¬ ì¡°íšŒ ì‹¤íŒ¨: ${L.message}`),c("ë°°í¬ íˆìŠ¤í† ë¦¬ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}finally{h(!1)}},_=async()=>{if(!(s!=null&&s.id)||!n){f.error("Deploymentë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”");return}h(!0);try{const S=l&&l.length>0?l.map(k=>({host:k.host,port:k.port||22,username:k.username||"",password:k.password||""})):void 0,L=await Cy({service_id:s.id,deployment_name:n,hops:S});at.success({message:"ë¡¤ë°± ì™„ë£Œ",description:L.message||"ì´ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ë°±í–ˆìŠµë‹ˆë‹¤",duration:5}),x()}catch(S){const L=S;at.error({message:"ë¡¤ë°± ì‹¤íŒ¨",description:L.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{h(!1)}};return e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:"Deployment ë°°í¬ ê´€ë¦¬",description:"ë°°í¬ íˆìŠ¤í† ë¦¬ ì¡°íšŒ ë° ë¡¤ë°±ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),r.length>0&&e.jsx(ie,{style:{marginBottom:16},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx($o,{strong:!0,children:"Deployment ì„ íƒ: "}),e.jsx(Ee,{style:{width:400},value:n,onChange:a,placeholder:"Deploymentë¥¼ ì„ íƒí•˜ì„¸ìš”",children:r.map(S=>{var L,k,E;return e.jsx(Ee.Option,{value:(L=S.metadata)==null?void 0:L.name,children:(k=S.metadata)==null?void 0:k.name},(E=S.metadata)==null?void 0:E.name)})})]}),e.jsxs("div",{children:[e.jsxs($o,{type:"secondary",children:["ì„ íƒëœ Deployment: ",e.jsx(T,{color:"blue",children:n})]}),e.jsxs($o,{type:"secondary",style:{marginLeft:16},children:["í˜„ì¬ Pod ê°œìˆ˜:"," ",e.jsx(T,{color:"green",children:(i==null?void 0:i.replicas)||0})]}),e.jsxs($o,{type:"secondary",style:{marginLeft:16},children:["ê°€ìš© Pod:"," ",e.jsx(T,{color:"cyan",children:(i==null?void 0:i.availableReplicas)||0})]})]})]})}),e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(dr,{style:{color:"#52c41a"}}),e.jsx($o,{strong:!0,children:"ë°°í¬ íˆìŠ¤í† ë¦¬ & ë¡¤ë°±"})]}),style:{marginBottom:16},extra:e.jsxs(g,{children:[e.jsx(B,{icon:e.jsx(Pt,{}),onClick:x,loading:p,children:"íˆìŠ¤í† ë¦¬ ì¡°íšŒ"}),e.jsx(Kt,{title:"ìµœê·¼ ë°°í¬ë¡œ ë¡¤ë°±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>_(),okText:"ë¡¤ë°±",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{type:"primary",danger:!0,icon:e.jsx(hu,{}),loading:p,children:"ì¦‰ì‹œ ë¡¤ë°±"})})]}),children:e.jsx(Zw,{value:d,readOnly:!0,rows:10,placeholder:"ë°°í¬ íˆìŠ¤í† ë¦¬ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...",style:{fontFamily:'Consolas, Monaco, "Courier New", monospace',fontSize:12}})})]})};function nl(s){return s?s.startsWith("external_")?s.substring(9):s:""}function vp(s){if(!s)return!1;const t=s.toLowerCase();return t==="kubernetes"||t==="external_kubernetes"}function su(s){if(!s)return!1;const t=s.toLowerCase();return t==="docker"||t==="external_docker"}function ru(s){if(!s)return!1;const t=s.toLowerCase();return t==="podman"||t==="external_podman"}function Xw(s){return su(s)||ru(s)}function eS(s){if(!s)return"#666";const t=nl(s).toLowerCase();return{kubernetes:"#1890ff",docker:"#52c41a",podman:"#fa8c16",baremetal:"#8c8c8c",cloud:"#722ed1"}[t]||"#666"}const{Text:kr,Title:Oo}=we,tS=({service:s,loading:t,onRefresh:r,isContainerInfra:n,isDockerInfra:a,isPodmanInfra:i,containers:l=[],loadingContainers:d=!1,dockerSystemInfo:c,dockerImages:p=[],dockerVolumes:h=[],dockerNetworks:x=[],deployedImageInfo:_,pods:S=[],deploymentStatus:L,deploymentDetails:k,ingressDomains:E=[],latestBuildImageTag:P,resourceInfo:I,loadingResource:$=!1})=>{var b,A,W;if(n){const Z=a?"Docker":"Podman",se=l.filter(M=>{var K;return(K=M.status)==null?void 0:K.toLowerCase().includes("up")}).length,ce=l.filter(M=>{var J;const K=((J=M.status)==null?void 0:J.toLowerCase())||"";return K.includes("exited")||K.includes("stopped")||K.includes("created")}).length,D=l.filter(M=>{var K;return(K=M.status)==null?void 0:K.toLowerCase().includes("paused")}).length;return e.jsx(gt,{spinning:d,children:e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(ii,{style:{fontSize:20,color:"#1890ff"}}),e.jsx("span",{style:{fontSize:16,fontWeight:600},children:"ì„œë¹„ìŠ¤ ìƒíƒœ"})]}),style:{marginBottom:16},children:[e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ì„œë¹„ìŠ¤ ì´ë¦„",value:(s==null?void 0:s.name)||"-",prefix:e.jsx(_t,{}),valueStyle:{fontSize:16}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ì¸í”„ë¼ íƒ€ì…",value:nl((s==null?void 0:s.infraType)||""),prefix:e.jsx(ya,{}),valueStyle:{fontSize:16}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ì»¨í…Œì´ë„ˆ ê°œìˆ˜",value:l.length,suffix:"ê°œ",prefix:se===l.length&&l.length>0?e.jsx(Ze,{style:{color:"#52c41a"}}):e.jsx(Yt,{style:{color:"#faad14"}}),valueStyle:{fontSize:16,color:se===l.length&&l.length>0?"#52c41a":"#faad14"}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ìƒíƒœ",value:se>0?"Running":l.length===0?"No Containers":"Stopped",prefix:se>0?e.jsx(Ze,{style:{color:"#52c41a"}}):e.jsx(Yt,{style:{color:"#faad14"}}),valueStyle:{fontSize:16,color:se>0?"#52c41a":"#faad14"}})})]}),(_==null?void 0:_.deployed_image_tag)&&e.jsx(Ke,{gutter:[16,16],style:{marginTop:16},children:e.jsx(Y,{span:24,children:e.jsxs("div",{children:[e.jsx(kr,{type:"secondary",style:{display:"block",marginBottom:8},children:"ë°°í¬ëœ ì´ë¯¸ì§€ ë²„ì „:"}),e.jsx(T,{color:"blue",icon:e.jsx(dr,{}),style:{fontSize:14,padding:"4px 12px"},children:_.deployed_image_tag})]})})})]}),e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(_s,{style:{fontSize:20,color:"#52c41a"}}),e.jsx("span",{style:{fontSize:16,fontWeight:600},children:"ì»¨í…Œì´ë„ˆ ìƒíƒœ"})]}),style:{marginBottom:16},children:[e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,sm:8,children:e.jsx($e,{title:"ì‹¤í–‰ ì¤‘",value:se,suffix:`/ ${l.length}`,prefix:e.jsx(Ze,{}),valueStyle:{color:"#52c41a",fontSize:20}})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx($e,{title:"ì¤‘ì§€ë¨",value:ce,suffix:`/ ${l.length}`,prefix:e.jsx(Es,{}),valueStyle:{color:"#ff4d4f",fontSize:20}})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx($e,{title:"ì¼ì‹œ ì¤‘ì§€",value:D,suffix:`/ ${l.length}`,prefix:e.jsx(Yt,{}),valueStyle:{color:"#faad14",fontSize:20}})})]}),l.length>0&&e.jsx("div",{style:{marginTop:16},children:e.jsx(qt,{percent:Math.round(se/l.length*100),success:{percent:Math.round(se/l.length*100)},strokeColor:"#52c41a"})})]}),c&&e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(fa,{style:{fontSize:20,color:"#722ed1"}}),e.jsxs("span",{style:{fontSize:16,fontWeight:600},children:[Z," ì‹œìŠ¤í…œ ì •ë³´"]})]}),style:{marginBottom:16},children:[e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:`${a?"Docker":"Podman"} ë²„ì „`,value:c.docker_version||"-",valueStyle:{fontSize:14}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"API ë²„ì „",value:c.api_version||"-",valueStyle:{fontSize:14}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ì „ì²´ ì»¨í…Œì´ë„ˆ",value:((b=c.containers)==null?void 0:b.total)||0,suffix:"ê°œ",valueStyle:{fontSize:14}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ì „ì²´ ì´ë¯¸ì§€",value:c.images_total||0,suffix:"ê°œ",valueStyle:{fontSize:14}})})]}),c.disk_usage&&c.disk_usage.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx(kr,{strong:!0,style:{display:"block",marginBottom:12},children:"ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰:"}),e.jsx(wt,{dataSource:c.disk_usage,columns:[{title:"íƒ€ì…",dataIndex:"type",key:"type",render:M=>e.jsx(T,{color:M==="Images"?"blue":M==="Containers"?"green":M==="Volumes"?"orange":"purple",children:M})},{title:"ê°œìˆ˜",dataIndex:"total_count",key:"total_count"},{title:"ì „ì²´ í¬ê¸°",dataIndex:"size",key:"size"},{title:"íšŒìˆ˜ ê°€ëŠ¥",dataIndex:"reclaimable",key:"reclaimable"}],rowKey:"type",pagination:!1,size:"small"})]})]}),e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(tg,{style:{fontSize:20,color:"#13c2c2"}}),e.jsx("span",{style:{fontSize:16,fontWeight:600},children:"ë¦¬ì†ŒìŠ¤ í˜„í™©"})]}),children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,sm:8,children:e.jsx($e,{title:"ì´ë¯¸ì§€",value:p.length,suffix:"ê°œ",prefix:e.jsx(_s,{}),valueStyle:{color:"#1890ff"}})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx($e,{title:"ë³¼ë¥¨",value:h.length,suffix:"ê°œ",prefix:e.jsx(_s,{}),valueStyle:{color:"#52c41a"}})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx($e,{title:"ë„¤íŠ¸ì›Œí¬",value:x.length,suffix:"ê°œ",prefix:e.jsx(ur,{}),valueStyle:{color:"#722ed1"}})})]})})]})})}if(i)return e.jsx(e.Fragment,{});const y=S.length,v=S.filter(Z=>Z.status==="Running").length,u=S.filter(Z=>Z.status==="Pending").length,m=S.filter(Z=>Z.status==="Failed"||Z.status==="CrashLoopBackOff").length,j=_!=null&&_.deployed_image_tag?S.filter(Z=>{var se;return(se=Z.image)==null?void 0:se.includes(_.deployed_image_tag||"")}).length:0;return e.jsx(gt,{spinning:t,children:e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(ii,{style:{fontSize:20,color:"#1890ff"}}),e.jsx(Oo,{level:5,style:{margin:0},children:"ì„œë¹„ìŠ¤ ìƒíƒœ"})]}),style:{marginBottom:16},children:[e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ì„œë¹„ìŠ¤ ì´ë¦„",value:(s==null?void 0:s.name)||"-",prefix:e.jsx(_t,{}),valueStyle:{fontSize:16}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤",value:(s==null?void 0:s.namespace)||"default",prefix:e.jsx(ya,{}),valueStyle:{fontSize:16}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"Pod ê°œìˆ˜",value:S.length,suffix:"ê°œ",prefix:v===y&&y>0?e.jsx(Ze,{style:{color:"#52c41a"}}):e.jsx(Yt,{style:{color:"#faad14"}}),valueStyle:{fontSize:16,color:v===y&&y>0?"#52c41a":"#faad14"}})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx($e,{title:"ìƒíƒœ",value:L!=null&&L.availableReplicas&&L.availableReplicas>0?"Running":(L==null?void 0:L.replicas)===0?"Stopped":"Starting",prefix:L!=null&&L.availableReplicas&&L.availableReplicas>0?e.jsx(Ze,{style:{color:"#52c41a"}}):e.jsx(Yt,{style:{color:"#faad14"}}),valueStyle:{fontSize:16,color:L!=null&&L.availableReplicas&&L.availableReplicas>0?"#52c41a":"#faad14"}})})]}),(E.length>0||(_==null?void 0:_.deployed_image_tag))&&e.jsxs(Ke,{gutter:[16,16],style:{marginTop:16},children:[E.length>0&&e.jsx(Y,{xs:24,md:_!=null&&_.deployed_image_tag?12:24,children:e.jsxs("div",{children:[e.jsx(kr,{type:"secondary",style:{display:"block",marginBottom:8},children:"ë„ë©”ì¸:"}),e.jsx(g,{wrap:!0,children:E.map((Z,se)=>e.jsx(T,{color:"blue",icon:e.jsx(ur,{}),style:{fontSize:14,padding:"4px 12px"},children:e.jsx("a",{href:`https://${Z}`,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit"},children:Z})},se))})]})}),(_==null?void 0:_.deployed_image_tag)&&e.jsx(Y,{xs:24,md:E.length>0?12:24,children:e.jsxs("div",{children:[e.jsx(kr,{type:"secondary",style:{display:"block",marginBottom:8},children:"ë°°í¬ëœ ì´ë¯¸ì§€ ë²„ì „:"}),e.jsxs(g,{children:[e.jsx(T,{color:"blue",style:{fontSize:14,padding:"4px 12px"},children:_.deployed_image_tag}),P&&_.deployed_image_tag===P&&e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),style:{fontSize:13},children:"ìµœì‹ "})]})]})})]})]}),_&&P&&_.deployed_image_tag!==P&&e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(dr,{style:{fontSize:20,color:"#faad14"}}),e.jsx(Oo,{level:5,style:{margin:0},children:"ë°°í¬ ì—…ë°ì´íŠ¸ ê°€ëŠ¥"})]}),style:{marginBottom:16},children:[e.jsxs(Se,{bordered:!0,size:"small",column:1,children:[e.jsx(Se.Item,{label:"í˜„ì¬ ë°°í¬ëœ ì´ë¯¸ì§€",children:e.jsx(T,{color:"blue",style:{fontSize:14},children:_.deployed_image_tag})}),e.jsx(Se.Item,{label:"ìµœì‹  ë¹Œë“œ ì´ë¯¸ì§€",children:e.jsx(T,{color:"green",style:{fontSize:14},children:P})}),_.deployed_image&&e.jsx(Se.Item,{label:"ì´ë¯¸ì§€ ê²½ë¡œ",children:e.jsx(kr,{code:!0,style:{fontSize:13},children:_.deployed_image})})]}),e.jsx(xe,{message:"ìƒˆë¡œìš´ ë¹Œë“œê°€ ìˆìŠµë‹ˆë‹¤",description:e.jsxs("div",{children:["ìµœì‹  ë¹Œë“œ ì´ë¯¸ì§€"," ",e.jsx(T,{color:"green",children:P}),"ë¡œ ì¬ë°°í¬ë¥¼ ê³ ë ¤í•´ë³´ì„¸ìš”."]}),type:"info",showIcon:!0,style:{marginTop:12}})]}),k&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(Fr,{style:{fontSize:20,color:"#1890ff"}}),e.jsx(Oo,{level:5,style:{margin:0},children:"ë°°í¬ ìƒì„¸ ì •ë³´"})]}),style:{marginBottom:16},children:e.jsxs(Se,{bordered:!0,size:"small",column:1,children:[(_==null?void 0:_.primary_deployed_image)&&e.jsxs(Se.Item,{label:"ë¹Œë“œëœ ì´ë¯¸ì§€",children:[e.jsx(kr,{code:!0,copyable:!0,style:{fontSize:13},children:_.primary_deployed_image}),e.jsx(kr,{type:"secondary",style:{fontSize:12,display:"block",marginTop:4},children:"Harborì— Pushëœ ì´ë¯¸ì§€ ê²½ë¡œ"})]}),(_==null?void 0:_.actual_deployed_images)&&_.actual_deployed_images.length>0&&e.jsx(Se.Item,{label:"ì‹¤ì œ ì‚¬ìš© ì¤‘ì¸ ì´ë¯¸ì§€",children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[_.actual_deployed_images.map((Z,se)=>e.jsx(kr,{code:!0,copyable:!0,style:{fontSize:12,display:"block"},children:Z},se)),e.jsx(kr,{type:"secondary",style:{fontSize:12},children:"í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Podë“¤ì´ ì‚¬ìš©í•˜ëŠ” ì´ë¯¸ì§€"})]})}),(_==null?void 0:_.deployed_image)&&e.jsxs(Se.Item,{label:"ë°°í¬ ì´ë¯¸ì§€ ê²½ë¡œ (ì˜ˆìƒ)",children:[e.jsx(kr,{code:!0,copyable:!0,style:{fontSize:13},children:_.deployed_image}),e.jsx(kr,{type:"secondary",style:{fontSize:12,display:"block",marginTop:4},children:"ì„œë¹„ìŠ¤ ì´ë¦„ ê¸°ë°˜ ê²½ë¡œ (ì°¸ê³ ìš©)"})]}),(_==null?void 0:_.namespace)&&e.jsx(Se.Item,{label:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤",children:e.jsx(T,{color:"blue",children:_.namespace})}),(_==null?void 0:_.deployed_at)&&e.jsx(Se.Item,{label:"ë°°í¬ ì‹œê°",children:new Date(_.deployed_at).toLocaleString("ko-KR")}),k.kubectl_apply&&e.jsx(Se.Item,{label:"ì ìš©ëœ kubectl ëª…ë ¹",children:e.jsx(kr,{code:!0,style:{fontSize:12,whiteSpace:"pre-wrap",display:"block"},children:k.kubectl_apply})}),k.kubectl_restart&&e.jsx(Se.Item,{label:"ì¬ì‹œì‘ ëª…ë ¹",children:e.jsx(kr,{code:!0,style:{fontSize:12,whiteSpace:"pre-wrap",display:"block"},children:k.kubectl_restart})})]})}),e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(Jo,{style:{fontSize:20,color:"#52c41a"}}),e.jsx(Oo,{level:5,style:{margin:0},children:"Pod ìƒíƒœ ìš”ì•½"})]}),style:{marginBottom:16},children:[e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:"ì „ì²´",value:y,suffix:"ê°œ",valueStyle:{color:"#1890ff"}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:"ì‹¤í–‰ ì¤‘",value:v,suffix:"ê°œ",valueStyle:{color:"#52c41a"},prefix:e.jsx(Ze,{})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:"ëŒ€ê¸° ì¤‘",value:u,suffix:"ê°œ",valueStyle:{color:"#faad14"},prefix:e.jsx(Pt,{spin:!0})})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:"ì‹¤íŒ¨",value:m,suffix:"ê°œ",valueStyle:{color:"#ff4d4f"},prefix:e.jsx(Es,{})})})]}),e.jsx(xt,{}),e.jsxs("div",{children:[e.jsx(kr,{strong:!0,children:"ê°€ìš©ë¥ : "}),e.jsx(qt,{percent:y>0?Math.round(v/y*100):0,status:v===y?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}})]}),(_==null?void 0:_.deployed_image_tag)&&y>0&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{}),e.jsxs("div",{children:[e.jsx(kr,{strong:!0,children:"ì´ë¯¸ì§€ ë²„ì „: "}),e.jsx(qt,{percent:Math.round(j/y*100),status:j===y?"success":"active",format:()=>`${j} / ${y} Pod`,strokeColor:{"0%":"#faad14","100%":"#52c41a"}}),j===y?e.jsxs(kr,{type:"success",style:{fontSize:12,marginTop:4,display:"block"},children:[e.jsx(Ze,{})," ëª¨ë“  Podê°€ ë°°í¬ëœ ì´ë¯¸ì§€(",_.deployed_image_tag,")ë¥¼ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤."]}):e.jsxs(kr,{type:"warning",style:{fontSize:12,marginTop:4,display:"block"},children:[e.jsx(Yt,{})," ",y-j,"ê°œ Podê°€ ì´ì „ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤."]})]})]})]}),I&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(_t,{style:{fontSize:20,color:"#722ed1"}}),e.jsx(Oo,{level:5,style:{margin:0},children:"ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥ "})]}),loading:$,children:e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:24,md:12,children:e.jsx(ie,{type:"inner",title:"CPU",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(kr,{type:"secondary",children:["ëª¨ë¸: ",I.cpu_model]}),e.jsxs(kr,{type:"secondary",children:["ì½”ì–´ ìˆ˜: ",I.cpu_cores]}),e.jsx(qt,{percent:parseFloat(I.cpu_usage)||0,status:parseFloat(I.cpu_usage)>80?"exception":"normal"})]})})}),e.jsx(Y,{xs:24,md:12,children:e.jsx(ie,{type:"inner",title:"ë©”ëª¨ë¦¬",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(kr,{type:"secondary",children:[I.mem_used,"MB / ",I.mem_total,"MB"]}),e.jsx(qt,{percent:parseFloat(I.mem_usage)||0,status:parseFloat(I.mem_usage)>80?"exception":"normal"})]})})}),e.jsx(Y,{xs:24,md:12,children:e.jsx(ie,{type:"inner",title:"ë””ìŠ¤í¬",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(kr,{type:"secondary",children:[I.disk_used," / ",I.disk_total]}),e.jsx(qt,{percent:parseFloat(((A=I.disk_usage)==null?void 0:A.replace("%",""))||"0")||0,status:parseFloat(((W=I.disk_usage)==null?void 0:W.replace("%",""))||"0")>80?"exception":"normal"})]})})}),e.jsx(Y,{xs:24,md:12,children:e.jsx(ie,{type:"inner",title:"ì‹œìŠ¤í…œ ì •ë³´",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(kr,{type:"secondary",children:["í˜¸ìŠ¤íŠ¸: ",I.hostname]}),e.jsxs(kr,{type:"secondary",children:["OS: ",I.os_name]}),e.jsxs(kr,{type:"secondary",children:["ì»¤ë„: ",I.kernel]})]})})})]})}),e.jsx("div",{style:{marginTop:16,textAlign:"center"},children:e.jsx(B,{type:"primary",icon:e.jsx(Pt,{}),onClick:r,loading:t,children:"ìƒˆë¡œê³ ì¹¨"})})]})})},sS=({repoId:s,repoName:t,service:r,isContainerInfra:n,isDockerInfra:a,onStartScan:i,onScanStateChange:l})=>{var c;if(!s)return e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(ur,{style:{fontSize:64,color:"#1890ff",marginBottom:"24px"}}),e.jsx("p",{style:{fontSize:"18px",marginBottom:"16px",color:"#333"},children:"DAST ë„ë©”ì¸ ë¶„ì„"}),e.jsx("p",{style:{fontSize:"14px",marginBottom:"24px",color:"#666"},children:"ì €ì¥ì†Œ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤"}),e.jsx("p",{style:{fontSize:"12px",color:"#999"},children:"Git ì €ì¥ì†Œì™€ ì—°ê²°ëœ ì„œë¹„ìŠ¤ì—ì„œë§Œ ë„ë©”ì¸ ê²€ì‚¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"})]});const d=(c=r==null?void 0:r.domain)==null?void 0:c.trim();return n&&!d?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(ur,{style:{fontSize:64,color:"#faad14",marginBottom:"24px"}}),e.jsx("p",{style:{fontSize:"18px",marginBottom:"16px",color:"#333"},children:"ë„ë©”ì¸ ê²€ì‚¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsxs("p",{style:{fontSize:"14px",marginBottom:"16px",color:"#666"},children:[a?"Docker":"Podman"," ì„œë¹„ìŠ¤ì— ë„ë©”ì¸ì´ ì—°ê²°ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤."]}),e.jsx("p",{style:{fontSize:"12px",color:"#999"},children:"ì„œë¹„ìŠ¤ ì„¤ì •ì—ì„œ ë„ë©”ì¸ì„ ë¨¼ì € ì—°ê²°í•œ í›„ ë„ë©”ì¸ ê²€ì‚¬ë¥¼ ì‹¤í–‰í•´ì£¼ì„¸ìš”."})]}):e.jsx(Ux,{repoId:s,repoName:t||(r==null?void 0:r.name)||"",onStartScan:i,onScanStateChange:p=>{l(p==="analyzing"?"analyzing":p)}})},{Text:Ul}=we,{TextArea:kp}=ue,rS=({isContainerInfra:s,isDockerInfra:t,containers:r=[],selectedContainer:n,onSelectedContainerChange:a,loadingContainers:i=!1,dockerServerId:l,pods:d=[],selectedPod:c,onSelectedPodChange:p,logs:h,loadingLogs:x,onGetLogs:_,onClearLogs:S,getPodStatusIcon:L})=>s?e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:`${t?"Docker":"Podman"} ì»¨í…Œì´ë„ˆ ë¡œê·¸ ì¡°íšŒ`,description:"ì„ íƒí•œ ì»¨í…Œì´ë„ˆì˜ ìµœê·¼ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs(g,{style:{width:"100%"},direction:"vertical",children:[e.jsxs("div",{children:[e.jsx(Ul,{strong:!0,children:"ì»¨í…Œì´ë„ˆ ì„ íƒ:"}),e.jsx(Ee,{value:n,onChange:a,style:{width:"100%",marginTop:8},placeholder:"ì»¨í…Œì´ë„ˆë¥¼ ì„ íƒí•˜ì„¸ìš”",disabled:r.length===0||i,loading:i,children:r.map(k=>e.jsx(Ee.Option,{value:k.id,children:e.jsxs(g,{children:[e.jsx(Ul,{children:k.name}),e.jsxs(Ul,{type:"secondary",style:{fontSize:12},children:["(",k.image,")"]})]})},k.id))})]}),e.jsxs(g,{children:[e.jsx(B,{type:"primary",icon:e.jsx(Fr,{}),onClick:_,loading:x,disabled:!n||!l,children:"ë¡œê·¸ ì¡°íšŒ"}),e.jsx(B,{icon:e.jsx(Pt,{}),onClick:S,children:"ì´ˆê¸°í™”"})]})]})}),e.jsx(kp,{value:h,readOnly:!0,rows:20,placeholder:"ë¡œê·¸ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...",style:{fontFamily:'Consolas, Monaco, "Courier New", monospace',fontSize:12,backgroundColor:"#1e1e1e",color:"#d4d4d4"}})]}):e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:"Pod ë¡œê·¸ ì¡°íšŒ",description:"ì„ íƒí•œ Podì˜ ìµœê·¼ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs(g,{style:{width:"100%"},direction:"vertical",children:[e.jsxs("div",{children:[e.jsx(Ul,{strong:!0,children:"Pod ì„ íƒ:"}),e.jsx(Ee,{value:c,onChange:p,style:{width:"100%",marginTop:8},placeholder:"Podë¥¼ ì„ íƒí•˜ì„¸ìš”",disabled:d.length===0,children:d.map(k=>{const E=typeof k.name=="string"?k.name.trim():String(k.name||"").trim();return e.jsx(Ee.Option,{value:E,children:e.jsxs(g,{children:[L==null?void 0:L(k.status),E]})},E)})})]}),e.jsxs(g,{children:[e.jsx(B,{type:"primary",icon:e.jsx(Fr,{}),onClick:_,loading:x,disabled:!c,children:"ë¡œê·¸ ì¡°íšŒ"}),e.jsx(B,{icon:e.jsx(Pt,{}),onClick:S,children:"ì´ˆê¸°í™”"})]})]})}),e.jsx(kp,{value:h,readOnly:!0,rows:20,placeholder:"ë¡œê·¸ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...",style:{fontFamily:'Consolas, Monaco, "Courier New", monospace',fontSize:12,backgroundColor:"#1e1e1e",color:"#d4d4d4"}})]}),{Text:Do}=we,{TextArea:Cp}=ue,nS=({isContainerInfra:s,isDockerInfra:t,containers:r=[],selectedContainerId:n,onSelectedContainerIdChange:a,commandInput:i,commandOutput:l,executingCommand:d,onCommandInputChange:c,onExecuteCommand:p,onClearOutput:h})=>{var _;const x=S=>{S.key==="Enter"&&!d&&i.trim()&&p()};return s?e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:`${t?"Docker":"Podman"} ëª…ë ¹ ì‹¤í–‰`,description:`${t?"Docker":"Podman"} ì„œë²„ì—ì„œ ì§ì ‘ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì»¨í…Œì´ë„ˆë¥¼ ì„ íƒí•˜ë©´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ, ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ í˜¸ìŠ¤íŠ¸ì—ì„œ ëª…ë ¹ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.`,type:"warning",showIcon:!0,icon:e.jsx(Jn,{}),style:{marginBottom:16}}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsx(Do,{strong:!0,children:"ì»¨í…Œì´ë„ˆ ì„ íƒ (ì„ íƒì ):"}),e.jsx(Ee,{style:{width:"100%"},value:n,onChange:a,placeholder:"í˜¸ìŠ¤íŠ¸ì—ì„œ ëª…ë ¹ ì‹¤í–‰ (ì»¨í…Œì´ë„ˆ ì„ íƒ ì•ˆ í•¨)",allowClear:!0,children:r.map(S=>e.jsxs(Ee.Option,{value:S.id,children:[S.name," (",S.id.substring(0,12),") -"," ",S.status]},S.id))}),n&&e.jsx(xe,{message:`ì„ íƒëœ ì»¨í…Œì´ë„ˆ: ${(_=r.find(S=>S.id===n))==null?void 0:_.name}`,type:"info",showIcon:!0,closable:!0,onClose:()=>a==null?void 0:a("")})]})}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsx(Do,{strong:!0,children:"ëª…ë ¹ì–´ ì…ë ¥:"}),e.jsxs(g.Compact,{style:{width:"100%"},children:[e.jsx(ue,{value:i,onChange:S=>c(S.target.value),onKeyPress:x,placeholder:n?"ì˜ˆ: ls -la /app":"ì˜ˆ: docker ps -a ë˜ëŠ” podman ps -a",style:{flex:1},disabled:d}),e.jsx(B,{type:"primary",icon:e.jsx(In,{}),onClick:p,loading:d,disabled:!i.trim(),children:"ì‹¤í–‰"})]})]})}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs(g,{children:[e.jsx(B,{icon:e.jsx(Pt,{}),onClick:h,children:"ì¶œë ¥ ì´ˆê¸°í™”"}),n&&e.jsx(B,{onClick:()=>a==null?void 0:a(""),icon:e.jsx(Es,{}),children:"ì»¨í…Œì´ë„ˆ ì„ íƒ í•´ì œ"})]})}),e.jsxs("div",{children:[e.jsx(Do,{type:"secondary",style:{fontSize:12,marginBottom:8,display:"block"},children:"ğŸ’¡ ê° ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ íƒ€ì„ìŠ¤íƒ¬í”„ì™€ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸(ì»¨í…Œì´ë„ˆ/í˜¸ìŠ¤íŠ¸)ê°€ í•¨ê»˜ í‘œì‹œë©ë‹ˆë‹¤."}),e.jsx(Cp,{value:l,readOnly:!0,rows:20,placeholder:"ëª…ë ¹ì–´ ì‹¤í–‰ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...\\n\\nê° ì‹¤í–‰ì€ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ë¶„ë©ë‹ˆë‹¤:\\nâ”â”â” [ì‹œê°„] ì»¨í…Œì´ë„ˆëª…/í˜¸ìŠ¤íŠ¸ â”â”â”\\n$ ëª…ë ¹ì–´\\nì¶œë ¥ ê²°ê³¼",style:{fontFamily:'Consolas, Monaco, "Courier New", monospace',fontSize:12,backgroundColor:"#1e1e1e",color:"#d4d4d4",whiteSpace:"pre-wrap"}})]})]}):e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:"SSH ëª…ë ¹ì–´ ì‹¤í–‰",description:"kubectl, docker ë“±ì˜ ëª…ë ¹ì–´ë¥¼ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsx(Do,{strong:!0,children:"ëª…ë ¹ì–´ ì…ë ¥:"}),e.jsxs(g.Compact,{style:{width:"100%"},children:[e.jsx(ue,{value:i,onChange:S=>c(S.target.value),onKeyPress:x,placeholder:"ì˜ˆ: kubectl get pods -n default",style:{flex:1},disabled:d}),e.jsx(B,{type:"primary",icon:e.jsx(In,{}),onClick:p,loading:d,disabled:!i.trim(),children:"ì‹¤í–‰"})]})]})}),e.jsx("div",{style:{marginBottom:16},children:e.jsx(B,{icon:e.jsx(Pt,{}),onClick:h,children:"ì¶œë ¥ ì´ˆê¸°í™”"})}),e.jsxs("div",{children:[e.jsx(Do,{type:"secondary",style:{fontSize:12,marginBottom:8,display:"block"},children:"ğŸ’¡ ê° ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ íƒ€ì„ìŠ¤íƒ¬í”„ì™€ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ í•¨ê»˜ í‘œì‹œë©ë‹ˆë‹¤."}),e.jsx(Cp,{value:l,readOnly:!0,rows:20,placeholder:"ëª…ë ¹ì–´ ì‹¤í–‰ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...\\n\\nê° ì‹¤í–‰ì€ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ë¶„ë©ë‹ˆë‹¤:\\nâ”â”â” [ì‹œê°„] ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ â”â”â”\\n$ ëª…ë ¹ì–´\\nì¶œë ¥ ê²°ê³¼",style:{fontFamily:'Consolas, Monaco, "Courier New", monospace',fontSize:12,backgroundColor:"#1e1e1e",color:"#d4d4d4",whiteSpace:"pre-wrap"}})]})]})},aS=async s=>{try{const t=await ze.nginx.request("checkNginxContainer",s);if(!t.data.success)throw new Error(t.data.error||"Nginx ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("Nginx ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},iS=async s=>{try{const t=await ze.nginx.request("createNginxContainer",{...s});if(!t.data.success)throw new Error(t.data.error||"Nginx ì»¨í…Œì´ë„ˆ ìƒì„± ì‹¤íŒ¨");return t.data}catch(t){throw O.error("Nginx ì»¨í…Œì´ë„ˆ ìƒì„± ì‹¤íŒ¨",void 0,{error:String(t)}),t}},oS=async s=>{try{const t=await ze.nginx.request("listNginxConfigs",s);if(!t.data.success)throw new Error(t.data.error||"Nginx ì„¤ì • íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("Nginx ì„¤ì • íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},lS=async s=>{var t;try{const r=await ze.nginx.request("createNginxConfig",{infra_id:s.infra_id,hops:s.hops,domain:s.config.domain,upstream_host:s.config.backend_host,upstream_port:s.config.backend_port,enable_ssl:(t=s.config.ssl)!=null?t:!1,cert_path:s.config.cert_path,key_path:s.config.key_path});if(!r.data.success)throw new Error(r.data.error||"Nginx ì„¤ì • íŒŒì¼ ìƒì„± ì‹¤íŒ¨");return r.data}catch(r){throw O.error("Nginx ì„¤ì • íŒŒì¼ ìƒì„± ì‹¤íŒ¨",void 0,{error:String(r)}),r}},cS=async s=>{try{const t=await ze.nginx.request("deleteNginxConfig",s);if(!t.data.success)throw new Error(t.data.error||"Nginx ì„¤ì • íŒŒì¼ ì‚­ì œ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("Nginx ì„¤ì • íŒŒì¼ ì‚­ì œ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},Hl=async s=>{try{const t=await ze.nginx.request("reloadNginx",s);if(!t.data.success)throw new Error(t.data.error||"Nginx ë¦¬ë¡œë“œ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("Nginx ë¦¬ë¡œë“œ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},Ip=async s=>{try{const t=await ze.nginx.request("getNginxConfigContent",s);if(!t.data.success)throw new Error(t.data.error||"Nginx ì„¤ì • íŒŒì¼ ì¡°íšŒ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("Nginx ì„¤ì • íŒŒì¼ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},Tp=async s=>{try{const t=await ze.nginx.request("updateNginxConfigContent",s);if(!t.data.success)throw new Error(t.data.error||"Nginx ì„¤ì • íŒŒì¼ ìˆ˜ì • ì‹¤íŒ¨");return t.data}catch(t){throw O.error("Nginx ì„¤ì • íŒŒì¼ ìˆ˜ì • ì‹¤íŒ¨",void 0,{error:String(t)}),t}},dS=async s=>{try{const t=await ze.nginx.request("externalNginxConnect",s);if(!t.data.success)throw new Error(t.data.error||"ì™¸ë¶€ Nginx ì„œë²„ ì—°ê²° ì‹¤íŒ¨");return t.data}catch(t){throw O.error("ì™¸ë¶€ Nginx ì„œë²„ ì—°ê²° ì‹¤íŒ¨",void 0,{error:String(t)}),t}},uS=async s=>{try{const t=await ze.nginx.request("externalNginxListConfigs",s);if(!t.data.success)throw new Error(t.data.error||"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},hS=async s=>{try{const t=await ze.nginx.request("externalNginxCreateConfig",s);if(!t.data.success)throw new Error(t.data.error||"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ìƒì„± ì‹¤íŒ¨");return t.data}catch(t){throw O.error("ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ìƒì„± ì‹¤íŒ¨",void 0,{error:String(t)}),t}},pS=async s=>{try{const t=await ze.nginx.request("externalNginxDeleteConfig",s);if(!t.data.success)throw new Error(t.data.error||"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ì‚­ì œ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ì‚­ì œ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},gS=async s=>{try{const t=await ze.nginx.request("externalNginxReload",s);if(!t.data.success)throw new Error(t.data.error||"ì™¸ë¶€ Nginx ë¦¬ë¡œë“œ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("ì™¸ë¶€ Nginx ë¦¬ë¡œë“œ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},xS=async s=>{try{const t=await ze.nginx.request("uploadCertificate",s);if(!t.data.success)throw new Error(t.data.error||"ì¸ì¦ì„œ ì—…ë¡œë“œ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("ì¸ì¦ì„œ ì—…ë¡œë“œ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},mS=async s=>{try{const t=await ze.nginx.request("listCertificates",s);if(!t.data.success)throw new Error(t.data.error||"ì¸ì¦ì„œ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("ì¸ì¦ì„œ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},fS=async s=>{try{const t=await ze.nginx.request("deleteCertificate",s);if(!t.data.success)throw new Error(t.data.error||"ì¸ì¦ì„œ ì‚­ì œ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("ì¸ì¦ì„œ ì‚­ì œ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},yS=async s=>{try{const t=await ze.nginx.request("validateCertificate",s);if(!t.data.success)throw new Error(t.data.error||"ì¸ì¦ì„œ ê²€ì¦ ì‹¤íŒ¨");return t.data}catch(t){throw O.error("ì¸ì¦ì„œ ê²€ì¦ ì‹¤íŒ¨",void 0,{error:String(t)}),t}},{Text:_r}=we,jS=({service:s,infraId:t,serverHops:r,isContainerInfra:n,isDockerInfra:a})=>{const{user:i}=Tn(),l=(s==null?void 0:s.namespace)||"k8s",[d,c]=o.useState(null),[p,h]=o.useState(!1),[x,_]=o.useState(!1),[S,L]=o.useState([]),[k,E]=o.useState(!1),[P,I]=o.useState(!1),[$,y]=o.useState(!1),[v]=H.useForm(),[u,m]=o.useState(null),[j,b]=o.useState(!1),[A,W]=o.useState(!1),[Z,se]=o.useState(""),[ce,D]=o.useState([]),[M,K]=o.useState(!1),[J,te]=o.useState(!1),[G,q]=o.useState(!1),[oe,be]=o.useState(null),[ne]=H.useForm(),[ye,Ue]=o.useState(null),[N,ge]=o.useState(!1),[Ce,je]=o.useState(!1),[Pe,w]=o.useState(0),[R,U]=o.useState(null),[V,F]=o.useState(!1),[X]=H.useForm(),[de,Ne]=o.useState(!1),[ae,pe]=o.useState([]),[Xe,Nt]=o.useState([]),[Fe,Le]=o.useState(!1),[Oe,Mt]=o.useState(!1),[Ve,Me]=o.useState(!1),[ot]=H.useForm(),[Bt,Ps]=o.useState([]),[ir,Ut]=o.useState(!1),[Ge,et]=o.useState([{deviceId:null,host:"",port:22,username:"",password:""}]),[tt,Vt]=o.useState(null),[lt,Rt]=o.useState(!1),[St,ms]=o.useState([]),[Ts,ds]=o.useState(!1),[fs,Cs]=o.useState(!1),[gr,Rr]=o.useState(!1),[Ss]=H.useForm(),[Rn,fn]=o.useState(""),[Os,Ms]=o.useState(null),[Ht,Dt]=o.useState(!1),[zr,nn]=o.useState(!1),[zn,Ys]=o.useState(""),[En,Pn]=o.useState([]),[Mr,Lr]=o.useState(!1),Xn=async()=>{if(t){h(!0);try{const le=await aS({infra_id:t,hops:r});c(le.data.container)}catch(le){const me=le;at.error({message:"Nginx ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨",description:me.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{h(!1)}}},ea=async()=>{if(t){_(!0);try{const le=await iS({infra_id:t,hops:r});at.success({message:"Nginx ì»¨í…Œì´ë„ˆ ìƒì„± ì™„ë£Œ",description:le.message||"Nginx ì»¨í…Œì´ë„ˆê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",duration:5}),await Xn()}catch(le){const me=le;at.error({message:"Nginx ì»¨í…Œì´ë„ˆ ìƒì„± ì‹¤íŒ¨",description:me.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{_(!1)}}},or=async()=>{var le;if(t){E(!0);try{const me=await oS({infra_id:t,hops:r});L(((le=me.data)==null?void 0:le.configs)||[])}catch(me){const De=me;at.error({message:"Nginx ì„¤ì • íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",description:De.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{E(!1)}}},ss=async()=>{if(t){y(!0);try{await Hl({infra_id:t,hops:r}),f.success("Nginxê°€ ë¦¬ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤")}catch(le){const me=le;at.error({message:"Nginx ë¦¬ë¡œë“œ ì‹¤íŒ¨",description:me.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{y(!1)}}},rs=async()=>{if(t)try{const le=await v.validateFields(),me={domain:le.domain,backend_host:le.backend_host,backend_port:le.backend_port,ssl:le.ssl||!1,cert_path:le.cert_path,key_path:le.key_path};await lS({infra_id:t,hops:r,config:me}),at.success({message:"Nginx ì„¤ì • ìƒì„± ì™„ë£Œ",description:`${me.domain} ì„¤ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤`,duration:5}),I(!1),v.resetFields(),await or(),await Hl({infra_id:t,hops:r})}catch(le){const me=le;at.error({message:"Nginx ì„¤ì • ìƒì„± ì‹¤íŒ¨",description:me.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}},Hn=async le=>{if(t)try{await cS({infra_id:t,domain:le,hops:r}),at.success({message:"Nginx ì„¤ì • ì‚­ì œ ì™„ë£Œ",description:`${le} ì„¤ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`,duration:5}),await or(),await Hl({infra_id:t,hops:r})}catch(me){const De=me;at.error({message:"Nginx ì„¤ì • ì‚­ì œ ì‹¤íŒ¨",description:De.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}},yn=async le=>{var me,De,zt;if(t)try{const Ls=await Ip({infra_id:t,domain:le,hops:r});m({domain:le,content:((me=Ls.data)==null?void 0:me.content)||"",path:((De=Ls.data)==null?void 0:De.path)||""}),se(((zt=Ls.data)==null?void 0:zt.content)||""),W(!1),b(!0)}catch(Ls){const Br=Ls;at.error({message:"Nginx ì„¤ì • íŒŒì¼ ì¡°íšŒ ì‹¤íŒ¨",description:Br.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}},cn=async()=>{if(!(!t||!u))try{await Tp({infra_id:t,domain:u.domain,content:Z,hops:r}),at.success({message:"Nginx ì„¤ì • íŒŒì¼ ìˆ˜ì • ì™„ë£Œ",description:`${u.domain} ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`,duration:5}),m({...u,content:Z}),W(!1),await or(),await Hl({infra_id:t,hops:r}),f.success("Nginxê°€ ìë™ìœ¼ë¡œ ë¦¬ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤")}catch(le){const me=le;at.error({message:"Nginx ì„¤ì • íŒŒì¼ ìˆ˜ì • ì‹¤íŒ¨",description:me.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}},ys=async()=>{var le;if(t){K(!0);try{const me=await mS({infra_id:t,hops:r});D(((le=me.data)==null?void 0:le.certificates)||[])}catch(me){const De=me;at.error({message:"ì¸ì¦ì„œ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",description:De.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{K(!1)}}},Jt=async()=>{if(t)try{const le=await ne.validateFields();q(!0),await xS({infra_id:t,domain:le.domain,cert_content:le.cert_content,key_content:le.key_content,hops:r}),at.success({message:"ì¸ì¦ì„œ ì—…ë¡œë“œ ì™„ë£Œ",description:`${le.domain} ì¸ì¦ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤`,duration:5}),te(!1),ne.resetFields(),await ys()}catch(le){const me=le;at.error({message:"ì¸ì¦ì„œ ì—…ë¡œë“œ ì‹¤íŒ¨",description:me.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{q(!1)}},an=async le=>{if(t)try{await fS({infra_id:t,domain:le,hops:r}),at.success({message:"ì¸ì¦ì„œ ì‚­ì œ ì™„ë£Œ",description:`${le} ì¸ì¦ì„œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`,duration:5}),await ys()}catch(me){const De=me;at.error({message:"ì¸ì¦ì„œ ì‚­ì œ ì‹¤íŒ¨",description:De.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}},dn=async le=>{var me,De;if(t)try{const zt=await yS({infra_id:t,domain:le,hops:r});be(zt.data),(me=zt.data)!=null&&me.valid?at.success({message:"ì¸ì¦ì„œ ìœ íš¨",description:`${le} ì¸ì¦ì„œê°€ ìœ íš¨í•©ë‹ˆë‹¤. ë§Œë£Œì¼: ${((De=zt.data)==null?void 0:De.expiry_date)||"ì•Œ ìˆ˜ ì—†ìŒ"}`,duration:5}):at.warning({message:"ì¸ì¦ì„œ ë¬¸ì œ ë°œê²¬",description:"ì¸ì¦ì„œ ë˜ëŠ” í‚¤ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.",duration:5})}catch(zt){const Ls=zt;at.error({message:"ì¸ì¦ì„œ ê²€ì¦ ì‹¤íŒ¨",description:Ls.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}},un=async()=>{if(s!=null&&s.id){ge(!0);try{const le=await Gd(s.id);Ue(le)}catch(le){const me=le;at.error({message:"Ingress Controller ìƒíƒœ í™•ì¸ ì‹¤íŒ¨",description:me.message,duration:5})}finally{ge(!1)}}},nt=async()=>{if(s!=null&&s.id){je(!0),w(0);try{await Ty(s.id),at.info({message:"Nginx Ingress Controller ì„¤ì¹˜ ì‹œì‘",description:"ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì„¤ì¹˜ê°€ ì§„í–‰ë©ë‹ˆë‹¤. 5ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.",duration:5}),Gt()}catch(le){const me=le;at.error({message:"Ingress Controller ì„¤ì¹˜ ì‹¤íŒ¨",description:me.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5}),je(!1)}}},Gt=()=>{const le=setInterval(()=>{(async()=>{if(w(me=>me+5e3),!!(s!=null&&s.id))try{const me=await Gd(s.id);Ue(me),(me.status==="installed"||me.status==="error")&&(fe(),me.status==="installed"&&at.success({message:"Nginx Ingress Controller ì„¤ì¹˜ ì™„ë£Œ",description:"Ingress Controllerê°€ ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤.",duration:5}))}catch(me){}})()},5e3);U(le),setTimeout(()=>{fe(),je(!1),f.warning("ì„¤ì¹˜ í™•ì¸ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")},10*60*1e3)},fe=()=>{R&&(clearInterval(R),U(null)),je(!1)},Be=async le=>{if(s!=null&&s.id){Ne(!0);try{const me=[{host:le.host,paths:[{path:le.path,pathType:le.pathType,serviceName:le.serviceName,servicePort:le.servicePort}]}],De=le.enableTLS?[{hosts:[le.host],secretName:le.tlsSecretName||`${le.ingressName}-tls`}]:void 0;await Iy({service_id:s.id,namespace:l,ingress_name:le.ingressName,rules:me,tls:De}),at.success({message:"Ingress ìƒì„± ì™„ë£Œ",description:`Ingress "${le.ingressName}"ì´(ê°€) ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`,duration:5}),F(!1),X.resetFields(),dt()}catch(me){const De=me;at.error({message:"Ingress ìƒì„± ì‹¤íŒ¨",description:De.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{Ne(!1)}}},dt=async()=>{if(s!=null&&s.id){Ne(!0);try{const le=await ic(s.id);pe(le.ingresses||[])}catch(le){const me=le;at.error({message:"Ingress ì¡°íšŒ ì‹¤íŒ¨",description:me.message,duration:5})}finally{Ne(!1)}}},ns=async()=>{if(s!=null&&s.id){Le(!0);try{const le=await Xf({namespace:l,service_id:s.id});Nt(le.secrets||[])}catch(le){const me=le;at.error({message:"TLS Secret ì¡°íšŒ ì‹¤íŒ¨",description:me.message,duration:5})}finally{Le(!1)}}},Ds=async le=>{if(s!=null&&s.id){Me(!0);try{await Qf({secret_name:le.secretName,namespace:l,cert_content:le.certContent,key_content:le.keyContent,service_id:s.id}),at.success({message:"TLS Secret ìƒì„± ì™„ë£Œ",description:`TLS Secret "${le.secretName}"ì´(ê°€) ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`,duration:5}),Mt(!1),ot.resetFields(),ns()}catch(me){const De=me;at.error({message:"TLS Secret ìƒì„± ì‹¤íŒ¨",description:De.message,duration:5})}finally{Me(!1)}}},hn=async le=>{if(s!=null&&s.id)try{await ey({secret_name:le,namespace:l,service_id:s.id}),at.success({message:"TLS Secret ì‚­ì œ ì™„ë£Œ",description:`TLS Secret "${le}"ì´(ê°€) ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`,duration:5}),ns()}catch(me){const De=me;at.error({message:"TLS Secret ì‚­ì œ ì‹¤íŒ¨",description:De.message,duration:5})}},Ar=async()=>{if(!(i!=null&&i.id)){at.warning({message:"ì‚¬ìš©ì ì •ë³´ ì—†ìŒ",description:"ë¡œê·¸ì¸ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",duration:3});return}Ut(!0);try{const le=await Ra.getDevices(i.id);Ps(le.data||[])}catch(le){const me=le;at.error({message:"ì¥ë¹„ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",description:me.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}finally{Ut(!1)}},Nr=()=>{et([...Ge,{deviceId:null,host:"",port:22,username:"",password:""}])},Mn=le=>{if(Ge.length<=1){at.warning({message:"ìµœì†Œ 1ê°œì˜ í™‰ì´ í•„ìš”í•©ë‹ˆë‹¤",duration:3});return}const me=Ge.filter((De,zt)=>zt!==le);et(me)},jn=(le,me)=>{const De=[...Ge],zt=Bt.find(Ls=>Ls.id===me);zt?De[le]={deviceId:me,host:zt.ipAddress||"",port:zt.port||22,username:"",password:""}:De[le]={deviceId:null,host:"",port:22,username:"",password:""},et(De)},ba=(le,me,De)=>{const zt=[...Ge];zt[le][me]=De,et(zt)},Fa=async()=>{for(let le=0;le<Ge.length;le++){const me=Ge[le];if(!me.deviceId){at.warning({message:`Hop ${le+1}ì˜ ì„œë²„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”`,duration:3});return}if(!me.host||me.host.trim()===""){at.warning({message:`Hop ${le+1}ì˜ í˜¸ìŠ¤íŠ¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤`,duration:3});return}if(!me.username||me.username.trim()===""){at.warning({message:`Hop ${le+1}ì˜ ì‚¬ìš©ìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”`,duration:3});return}if(!me.password||me.password.trim()===""){at.warning({message:`Hop ${le+1}ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”`,duration:3});return}}Rt(!0);try{const le=Ge.filter(De=>De.host&&De.username&&De.password).map(De=>({host:De.host.trim(),port:De.port,username:De.username.trim(),password:De.password}));if(le.length===0){at.error({message:"ì—°ê²° ì •ë³´ ì˜¤ë¥˜",description:"ìœ íš¨í•œ SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ëª¨ë“  í•„ë“œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",duration:5}),Rt(!1);return}const me=await dS({hops:le});Vt(me.data),at.success({message:"ì™¸ë¶€ Nginx ì„œë²„ ì—°ê²° ì„±ê³µ",description:`ë²„ì „: ${me.data.nginx_version}, ìƒíƒœ: ${me.data.nginx_status} (${le.length}ê°œ í™‰ ê²½ìœ )`,duration:5}),await Ur()}catch(le){const me=le;Vt(null),at.error({message:"ì™¸ë¶€ Nginx ì„œë²„ ì—°ê²° ì‹¤íŒ¨",description:me.message||"ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤",duration:5})}finally{Rt(!1)}},Ur=async()=>{var me;if(Ge.length===0)return;const le=Ge.map(De=>({host:De.host,port:De.port,username:De.username,password:De.password}));ds(!0);try{const De=await uS({hops:le});ms(((me=De.data)==null?void 0:me.configs)||[])}catch(De){const zt=De;at.error({message:"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨",description:zt.message,duration:5})}finally{ds(!1)}},bn=async()=>{if(Ge.length===0)return;const le=Ge.map(me=>({host:me.host,port:me.port,username:me.username,password:me.password}));Rr(!0);try{await gS({hops:le}),f.success("ì™¸ë¶€ Nginxê°€ ë¦¬ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤")}catch(me){const De=me;at.error({message:"ì™¸ë¶€ Nginx ë¦¬ë¡œë“œ ì‹¤íŒ¨",description:De.message,duration:5})}finally{Rr(!1)}},Vn=async()=>{if(Ge.length===0)return;const le=Ge.map(me=>({host:me.host,port:me.port,username:me.username,password:me.password}));try{const me=await Ss.validateFields();await hS({hops:le,domain:me.domain,upstream_host:me.upstream_host,upstream_port:me.upstream_port,enable_ssl:me.enable_ssl||!1}),at.success({message:"ì™¸ë¶€ Nginx ì„¤ì • ìƒì„± ì™„ë£Œ",description:`${me.domain} ì„¤ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤`,duration:5}),Cs(!1),Ss.resetFields(),await Ur(),await bn()}catch(me){const De=me;at.error({message:"ì™¸ë¶€ Nginx ì„¤ì • ìƒì„± ì‹¤íŒ¨",description:De.message,duration:5})}},_a=async le=>{if(Ge.length===0)return;const me=Ge.map(De=>({host:De.host,port:De.port,username:De.username,password:De.password}));try{await pS({hops:me,domain:le}),at.success({message:"ì™¸ë¶€ Nginx ì„¤ì • ì‚­ì œ ì™„ë£Œ",description:`${le} ì„¤ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`,duration:5}),await Ur(),await bn()}catch(De){const zt=De;at.error({message:"ì™¸ë¶€ Nginx ì„¤ì • ì‚­ì œ ì‹¤íŒ¨",description:zt.message,duration:5})}},Ua=async le=>{var De,zt,Ls;if(Ge.length===0)return;const me=Ge.map(Br=>({host:Br.host,port:Br.port,username:Br.username,password:Br.password}));try{const Br=await Ip({infra_id:0,domain:le,hops:me});Ms({domain:le,content:((De=Br.data)==null?void 0:De.content)||"",path:((zt=Br.data)==null?void 0:zt.path)||""}),Ys(((Ls=Br.data)==null?void 0:Ls.content)||""),nn(!1),Dt(!0)}catch(Br){const Ln=Br;at.error({message:"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ì¡°íšŒ ì‹¤íŒ¨",description:Ln.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}},Ha=async()=>{if(Ge.length===0||!Os)return;const le=Ge.map(me=>({host:me.host,port:me.port,username:me.username,password:me.password}));try{await Tp({infra_id:0,domain:Os.domain,content:zn,hops:le}),at.success({message:"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ìˆ˜ì • ì™„ë£Œ",description:`${Os.domain} ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`,duration:5}),Ms({...Os,content:zn}),nn(!1),await Ur(),await bn(),f.success("ì™¸ë¶€ Nginxê°€ ìë™ìœ¼ë¡œ ë¦¬ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤")}catch(me){const De=me;at.error({message:"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ìˆ˜ì • ì‹¤íŒ¨",description:De.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:5})}},Va=async()=>{if(s!=null&&s.id){Lr(!0);try{const me=((await ic(s.id)).services||[]).map(De=>{var zt,Ls,Br,Ln;return{name:((zt=De.metadata)==null?void 0:zt.name)||"-",type:((Ls=De.spec)==null?void 0:Ls.type)||"ClusterIP",clusterIP:((Br=De.spec)==null?void 0:Br.clusterIP)||"-",ports:(((Ln=De.spec)==null?void 0:Ln.ports)||[]).map(Sa=>({name:Sa.name,port:Sa.port,targetPort:Sa.targetPort,nodePort:Sa.nodePort,protocol:Sa.protocol||"TCP"}))}});Pn(me)}catch(le){const me=le;at.error({message:"K8s ì„œë¹„ìŠ¤ ì¡°íšŒ ì‹¤íŒ¨",description:me.message,duration:5})}finally{Lr(!1)}}},wa=()=>e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(xe,{message:`${a?"Docker":"Podman"} Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ`,description:"Nginx ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ì—¬ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ë° ë„ë©”ì¸ ë¼ìš°íŒ…ì„ ì„¤ì •í•©ë‹ˆë‹¤.",type:"info",showIcon:!0}),e.jsx(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(Ze,{})," ì»¨í…Œì´ë„ˆ ìƒíƒœ"]}),children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsx(B,{type:"primary",size:"small",icon:e.jsx(Pt,{}),onClick:Xn,loading:p,children:"ìƒíƒœ í™•ì¸"}),d&&e.jsxs(Se,{bordered:!0,size:"small",column:2,style:{marginTop:12},children:[e.jsx(Se.Item,{label:"ì»¨í…Œì´ë„ˆ ì´ë¦„",children:e.jsx(T,{color:"blue",children:d.name})}),e.jsx(Se.Item,{label:"ìƒíƒœ",children:e.jsx(T,{color:d.running?"success":"error",children:d.running?"ì‹¤í–‰ ì¤‘":"ì¤‘ì§€ë¨"})}),d.ports&&e.jsx(Se.Item,{label:"í¬íŠ¸",span:2,children:d.ports})]}),(!d||!d.running)&&e.jsx(Kt,{title:"Nginx ì»¨í…Œì´ë„ˆ ìƒì„±",description:"Nginx ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:ea,okText:"ìƒì„±",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{type:"primary",size:"small",icon:e.jsx(rr,{}),loading:x,style:{marginTop:8},children:"ì»¨í…Œì´ë„ˆ ìƒì„±"})})]})}),(d==null?void 0:d.running)&&e.jsx(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(Fr,{})," ë„ë©”ì¸ ë¼ìš°íŒ… ì„¤ì •"]}),extra:e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:e.jsx(Pt,{}),onClick:or,loading:k,children:"ìƒˆë¡œê³ ì¹¨"}),e.jsx(B,{size:"small",icon:e.jsx(Pt,{spin:$}),onClick:ss,loading:$,children:"ë¦¬ë¡œë“œ"}),e.jsx(B,{size:"small",type:"primary",icon:e.jsx(rr,{}),onClick:()=>I(!0),children:"ì¶”ê°€"})]}),children:e.jsx(wt,{dataSource:S,loading:k,rowKey:"filename",columns:[{title:"íŒŒì¼ëª…",dataIndex:"filename",key:"filename",render:le=>e.jsx(_r,{strong:!0,children:le})},{title:"ê²½ë¡œ",dataIndex:"path",key:"path",render:le=>e.jsx(_r,{type:"secondary",children:le})},{title:"í¬ê¸°",dataIndex:"size",key:"size"},{title:"ìˆ˜ì •ì¼",dataIndex:"modified",key:"modified"},{title:"ì‘ì—…",key:"actions",render:(le,me)=>{const De=me.filename.replace(".conf","");return e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:e.jsx(xa,{}),onClick:()=>void yn(De),children:"ì¡°íšŒ"}),e.jsx(B,{size:"small",icon:e.jsx(ln,{}),onClick:()=>{yn(De)},children:"ìˆ˜ì •"}),e.jsx(Kt,{title:"ì„¤ì • ì‚­ì œ",description:`${me.filename} ì„¤ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,onConfirm:()=>Hn(De),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),children:"ì‚­ì œ"})})]})}}],pagination:!1,size:"small"})}),(d==null?void 0:d.running)&&e.jsxs(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(Bs,{style:{color:"#52c41a"}})," TLS/SSL ì¸ì¦ì„œ ê´€ë¦¬"]}),extra:e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:e.jsx(Pt,{}),onClick:ys,loading:M,children:"ìƒˆë¡œê³ ì¹¨"}),e.jsx(B,{size:"small",type:"primary",icon:e.jsx(Zu,{}),onClick:()=>te(!0),children:"ì¸ì¦ì„œ ì—…ë¡œë“œ"})]}),children:[e.jsx(xe,{message:"TLS/SSL ì¸ì¦ì„œ",description:e.jsxs("ul",{style:{margin:0,paddingLeft:16,marginTop:8},children:[e.jsx("li",{children:"HTTPS í™œì„±í™”ë¥¼ ìœ„í•´ ì¸ì¦ì„œë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”"}),e.jsx("li",{children:"ì¸ì¦ì„œ(.crt)ì™€ ê°œì¸í‚¤(.key)ê°€ ëª¨ë‘ í•„ìš”í•©ë‹ˆë‹¤"}),e.jsxs("li",{children:["ì—…ë¡œë“œëœ ì¸ì¦ì„œëŠ” ",e.jsx("code",{children:"/etc/k8scontrol/nginx/ssl/"}),"ì— ì €ì¥ë©ë‹ˆë‹¤"]}),e.jsx("li",{children:"ë„ë©”ì¸ ì„¤ì • ì‹œ SSLì„ í™œì„±í™”í•˜ë©´ ìë™ìœ¼ë¡œ ì—°ê²°ë©ë‹ˆë‹¤"})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),ce.length===0?e.jsx(Je,{description:"ë“±ë¡ëœ ì¸ì¦ì„œê°€ ì—†ìŠµë‹ˆë‹¤. ì¸ì¦ì„œ ì—…ë¡œë“œ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”."}):e.jsx(wt,{dataSource:ce.filter(le=>le.type==="cert"),loading:M,rowKey:"filename",columns:[{title:"ë„ë©”ì¸",dataIndex:"domain",key:"domain",render:le=>e.jsxs(g,{children:[e.jsx(Qn,{style:{color:"#52c41a"}}),e.jsx(_r,{strong:!0,children:le})]})},{title:"ì¸ì¦ì„œ íŒŒì¼",dataIndex:"filename",key:"filename",render:le=>e.jsx(T,{color:"green",children:le})},{title:"í¬ê¸°",dataIndex:"size",key:"size"},{title:"ìˆ˜ì •ì¼",dataIndex:"modified",key:"modified"},{title:"ì‘ì—…",key:"actions",render:(le,me)=>e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:e.jsx(Ze,{}),onClick:()=>dn(me.domain),children:"ê²€ì¦"}),e.jsx(Kt,{title:"ì¸ì¦ì„œ ì‚­ì œ",description:`${me.domain} ì¸ì¦ì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì¸ì¦ì„œì™€ ê°œì¸í‚¤ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤.`,onConfirm:()=>an(me.domain),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),children:"ì‚­ì œ"})})]})}],pagination:!1,size:"small"}),oe&&e.jsx(ie,{size:"small",style:{marginTop:16},title:e.jsxs(e.Fragment,{children:[e.jsx(Ze,{})," ì¸ì¦ì„œ ê²€ì¦ ê²°ê³¼"]}),children:e.jsxs(Se,{bordered:!0,size:"small",column:2,children:[e.jsx(Se.Item,{label:"ë„ë©”ì¸",children:oe.domain}),e.jsx(Se.Item,{label:"ìƒíƒœ",children:oe.valid?e.jsx(T,{color:"success",icon:e.jsx(Ze,{}),children:"ìœ íš¨"}):e.jsx(T,{color:"error",icon:e.jsx(Es,{}),children:"ë¬¸ì œ ë°œê²¬"})}),e.jsx(Se.Item,{label:"ì¸ì¦ì„œ",children:oe.cert_exists?e.jsx(T,{color:"success",children:"ì¡´ì¬"}):e.jsx(T,{color:"error",children:"ì—†ìŒ"})}),e.jsx(Se.Item,{label:"ê°œì¸í‚¤",children:oe.key_exists?e.jsx(T,{color:"success",children:"ì¡´ì¬"}):e.jsx(T,{color:"error",children:"ì—†ìŒ"})}),e.jsx(Se.Item,{label:"í‚¤ ë§¤ì¹­",children:oe.key_matches?e.jsx(T,{color:"success",children:"ì¼ì¹˜"}):e.jsx(T,{color:"error",children:"ë¶ˆì¼ì¹˜"})}),e.jsx(Se.Item,{label:"ë„ë©”ì¸ ì—°ê²°",children:oe.domain_status?e.jsx(T,{color:oe.ssl_enabled?"success":oe.config_exists?"processing":"default",children:oe.domain_status}):"-"}),e.jsx(Se.Item,{label:"ë§Œë£Œì¼",children:oe.expiry_date||"-"}),oe.issuer&&e.jsx(Se.Item,{label:"ë°œê¸‰ì",span:2,children:e.jsx(_r,{type:"secondary",children:oe.issuer})}),oe.subject&&e.jsx(Se.Item,{label:"ì£¼ì²´",span:2,children:e.jsx(_r,{type:"secondary",children:oe.subject})}),oe.connected_domains&&oe.connected_domains.length>0&&e.jsx(Se.Item,{label:"ì—°ê²°ëœ ë„ë©”ì¸",span:2,children:e.jsx(g,{wrap:!0,children:oe.connected_domains.map((le,me)=>e.jsx(T,{color:"blue",icon:e.jsx(ur,{}),children:le},me))})}),oe.config_files&&oe.config_files.length>0&&e.jsx(Se.Item,{label:"ì‚¬ìš© ì¤‘ì¸ ì„¤ì •",span:2,children:e.jsx(g,{wrap:!0,children:oe.config_files.map((le,me)=>e.jsxs(T,{color:"cyan",children:[le,".conf"]},me))})}),oe.connected_domains&&oe.connected_domains.length>0&&e.jsx(Se.Item,{label:"ì™¸ë¶€ ì ‘ê·¼ URL",span:2,children:e.jsxs(g,{direction:"vertical",size:"small",children:[oe.connected_domains.filter(le=>{const me=le.match(/(\d+)\.(\d+)\.(\d+)\.(\d+)/);if(!me)return!1;const[,De,zt]=me.map(Number);return!(De===10||De===192&&zt===168||De===172&&zt>=16&&zt<=31)}).map((le,me)=>{const zt=`https://${le}:8443`;return e.jsxs(g,{children:[e.jsx(T,{color:"green",icon:e.jsx(ur,{}),children:e.jsx("a",{href:zt,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit"},children:zt})}),e.jsx(B,{size:"small",type:"link",icon:e.jsx(xa,{}),onClick:()=>window.open(zt,"_blank"),children:"ì ‘ì†"})]},me)}),oe.connected_domains.every(le=>{const me=le.match(/(\d+)\.(\d+)\.(\d+)\.(\d+)/);if(!me)return!0;const[,De,zt]=me.map(Number);return De===10||De===192&&zt===168||De===172&&zt>=16&&zt<=31})&&e.jsx(_r,{type:"secondary",children:"ê³µì¸ IP ë„ë©”ì¸ì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤"})]})})]})})]})]}),Gr=()=>e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[N?e.jsx(ie,{children:e.jsx(gt,{tip:"Nginx Ingress Controller ìƒíƒœ í™•ì¸ ì¤‘..."})}):(ye==null?void 0:ye.status)==="installing"?e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(Pt,{spin:!0}),e.jsx("span",{children:"Nginx Ingress Controller ì„¤ì¹˜ ì§„í–‰ ì¤‘"}),Pe>0&&e.jsxs(T,{color:"blue",children:["ê²½ê³¼: ",Math.floor(Pe/1e3),"ì´ˆ"]})]}),description:e.jsxs("div",{children:[e.jsx("p",{children:"ì„¤ì¹˜ê°€ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì™„ë£Œë˜ë©´ ìë™ìœ¼ë¡œ ì•Œë¦¼ì´ í‘œì‹œë©ë‹ˆë‹¤."}),e.jsx(qt,{percent:66,status:"active",strokeColor:{from:"#108ee9",to:"#87d068"}}),e.jsxs(g,{style:{marginTop:12},children:[e.jsx(B,{size:"small",icon:e.jsx(Pt,{}),onClick:un,disabled:Ce,children:"ìˆ˜ë™ í™•ì¸"}),e.jsx(B,{size:"small",danger:!0,onClick:()=>{fe(),f.info("ëª¨ë‹ˆí„°ë§ì„ ì¤‘ì§€í–ˆìŠµë‹ˆë‹¤.")},disabled:!Ce,children:"ëª¨ë‹ˆí„°ë§ ì¤‘ì§€"})]})]}),type:"info",showIcon:!0}):(ye==null?void 0:ye.status)==="error"?e.jsx(xe,{message:"Nginx Ingress Controller ì˜¤ë¥˜",description:e.jsxs("div",{children:[e.jsx("p",{children:"Ingress Controllerì— ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}),e.jsxs(g,{style:{marginTop:12},children:[e.jsx(B,{type:"primary",danger:!0,icon:e.jsx(dr,{}),onClick:nt,loading:Ce,children:"ì¬ì„¤ì¹˜"}),e.jsx(B,{type:"link",icon:e.jsx(Pt,{}),onClick:un,disabled:Ce,children:"ìƒíƒœ ë‹¤ì‹œ í™•ì¸"})]})]}),type:"error",showIcon:!0}):ye&&!ye.installed?e.jsx(xe,{message:"Nginx Ingress Controller ë¯¸ì„¤ì¹˜",description:e.jsxs("div",{children:[e.jsx("p",{children:"Nginx Ingress Controllerê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. Controllerë¥¼ ë¨¼ì € ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤."}),e.jsxs(g,{style:{marginTop:12},children:[e.jsx(B,{type:"primary",icon:e.jsx(dr,{}),onClick:nt,loading:Ce,children:"ìë™ ì„¤ì¹˜"}),e.jsx(B,{type:"link",icon:e.jsx(Pt,{}),onClick:un,disabled:Ce,children:"ìƒíƒœ ë‹¤ì‹œ í™•ì¸"})]})]}),type:"warning",showIcon:!0}):ye!=null&&ye.installed?e.jsx(xe,{message:"Nginx Ingress Controller ì •ìƒ",description:e.jsxs("div",{children:[e.jsx(_r,{children:"Nginx Ingress Controllerê°€ ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤."}),e.jsxs(g,{style:{marginTop:12},children:[e.jsx(B,{type:"primary",danger:!0,icon:e.jsx(dr,{}),onClick:nt,loading:Ce,size:"small",children:"ì¬ì„¤ì¹˜"}),e.jsx(B,{type:"link",icon:e.jsx(Pt,{}),onClick:un,disabled:Ce,size:"small",children:"ìƒíƒœ ë‹¤ì‹œ í™•ì¸"})]})]}),type:"success",showIcon:!0}):e.jsx(B,{type:"primary",onClick:un,loading:N,children:"Ingress Controller ìƒíƒœ í™•ì¸"}),e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(ur,{style:{color:"#1890ff"}}),e.jsx(_r,{strong:!0,children:"Nginx Ingress ë„ë©”ì¸ ì—°ê²°"}),ye&&!ye.installed&&e.jsx(T,{color:"warning",icon:e.jsx(Yt,{}),children:"Controller ë¯¸ì„¤ì¹˜"})]}),extra:e.jsxs(g,{children:[!V&&e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:()=>F(!0),disabled:ye&&!ye.installed,children:"Ingress ìƒì„±"}),e.jsx(B,{icon:e.jsx(Pt,{}),onClick:dt,loading:de,children:"ì¡°íšŒ"})]}),children:[V&&e.jsx("div",{style:{marginBottom:16,padding:16,border:"1px solid #d9d9d9",borderRadius:4},children:e.jsxs(H,{form:X,layout:"vertical",onFinish:Be,initialValues:{path:"/",pathType:"Prefix",enableTLS:!1},children:[e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{label:"Ingress ì´ë¦„",name:"ingressName",rules:[{required:!0,message:"Ingress ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: my-app-ingress"})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{label:"ë„ë©”ì¸",name:"host",rules:[{required:!0,message:"ë„ë©”ì¸ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: app.example.com"})})})]}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:8,children:e.jsx(H.Item,{label:"Service ì´ë¦„",name:"serviceName",rules:[{required:!0,message:"Service ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: my-service"})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{label:"Service í¬íŠ¸",name:"servicePort",rules:[{required:!0,message:"Service í¬íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(xn,{min:1,max:65535,placeholder:"ì˜ˆ: 80",style:{width:"100%"}})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{label:"Path",name:"path",children:e.jsx(ue,{placeholder:"ì˜ˆ: /"})})})]}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{label:"Path Type",name:"pathType",children:e.jsxs(Ee,{children:[e.jsx(Ee.Option,{value:"Prefix",children:"Prefix"}),e.jsx(Ee.Option,{value:"Exact",children:"Exact"}),e.jsx(Ee.Option,{value:"ImplementationSpecific",children:"ImplementationSpecific"})]})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{label:"TLS í™œì„±í™”",name:"enableTLS",children:e.jsxs(Ee,{children:[e.jsx(Ee.Option,{value:!1,children:"ë¹„í™œì„±í™”"}),e.jsx(Ee.Option,{value:!0,children:"í™œì„±í™”"})]})})})]}),e.jsx(H.Item,{noStyle:!0,shouldUpdate:(le,me)=>le.enableTLS!==me.enableTLS,children:({getFieldValue:le})=>le("enableTLS")?e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{label:"TLS Secret ì´ë¦„",name:"tlsSecretName",tooltip:"ì‚¬ìš©í•  TLS Secret ì´ë¦„. ë¯¸ì…ë ¥ ì‹œ ìë™ ìƒì„±ë©ë‹ˆë‹¤.",children:e.jsx(Ee,{placeholder:"TLS Secret ì„ íƒ ë˜ëŠ” ì…ë ¥",allowClear:!0,showSearch:!0,optionFilterProp:"children",dropdownRender:De=>e.jsxs(e.Fragment,{children:[De,e.jsx("div",{style:{padding:"8px",borderTop:"1px solid #d9d9d9"},children:e.jsx(B,{type:"link",size:"small",icon:e.jsx(rr,{}),onClick:()=>Mt(!0),children:"ìƒˆ TLS Secret ìƒì„±"})})]}),children:Xe.map(De=>e.jsx(Ee.Option,{value:De.name,children:e.jsxs(g,{children:[e.jsx(Bs,{}),De.name]})},De.name))})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{label:" ",colon:!1,children:e.jsx(B,{icon:e.jsx(Pt,{}),onClick:ns,loading:Fe,children:"Secret ëª©ë¡ ì¡°íšŒ"})})})]}):null}),e.jsx(H.Item,{children:e.jsxs(g,{children:[e.jsx(B,{type:"primary",htmlType:"submit",loading:de,children:"ìƒì„±"}),e.jsx(B,{onClick:()=>{F(!1),X.resetFields()},children:"ì·¨ì†Œ"})]})})]})}),de?e.jsx(gt,{}):ae.length===0?e.jsx(Je,{description:"ë“±ë¡ëœ Ingressê°€ ì—†ìŠµë‹ˆë‹¤. ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”."}):e.jsx(wt,{dataSource:ae,rowKey:le=>{var me;return((me=le.metadata)==null?void 0:me.name)||le.name},pagination:{pageSize:10},size:"small",columns:[{title:"Ingress ì´ë¦„",dataIndex:["metadata","name"],key:"name",render:le=>e.jsx(_r,{strong:!0,children:le})},{title:"ë„ë©”ì¸",dataIndex:["spec","rules"],key:"host",render:le=>!le||le.length===0?"-":e.jsx(g,{wrap:!0,children:le.map((me,De)=>e.jsx(T,{color:"blue",icon:e.jsx(ur,{}),children:me.host||"-"},De))})},{title:"TLS",dataIndex:["spec","tls"],key:"tls",render:le=>!le||le.length===0?e.jsx(T,{color:"default",children:"ë¹„í™œì„±í™”"}):e.jsx(T,{color:"green",icon:e.jsx(Ze,{}),children:"í™œì„±í™”"})},{title:"ì‘ì—…",key:"actions",render:(le,me)=>e.jsx(B,{size:"small",icon:e.jsx(xa,{}),onClick:async()=>{var De;if(s!=null&&s.id)try{const zt=await Hg({service_id:s.id,resource_type:"ingress",resource_name:((De=me.metadata)==null?void 0:De.name)||me.name});rt.info({title:"YAML",width:800,content:e.jsx("pre",{style:{maxHeight:400,overflow:"auto"},children:zt})})}catch(zt){f.error("YAML ì¡°íšŒ ì‹¤íŒ¨")}},children:"YAML ë³´ê¸°"})}]})]}),(ye==null?void 0:ye.installed)&&e.jsxs(ie,{title:e.jsxs(g,{children:[e.jsx(Bs,{style:{color:"#52c41a"}}),e.jsx(_r,{strong:!0,children:"TLS/SSL ì¸ì¦ì„œ ê´€ë¦¬ (K8s Secret)"})]}),extra:e.jsxs(g,{children:[e.jsx(B,{icon:e.jsx(Zu,{}),onClick:()=>Mt(!0),children:"ì¸ì¦ì„œ ì—…ë¡œë“œ"}),e.jsx(B,{icon:e.jsx(Pt,{}),onClick:ns,loading:Fe,children:"ì¡°íšŒ"})]}),children:[e.jsx(xe,{message:"TLS Secret ê´€ë¦¬",description:"Ingressì—ì„œ HTTPSë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë¨¼ì € TLS Secretì„ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤. PEM í˜•ì‹ì˜ ì¸ì¦ì„œì™€ ê°œì¸í‚¤ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.",type:"info",showIcon:!0,style:{marginBottom:16}}),Fe?e.jsx(gt,{}):Xe.length===0?e.jsx(Je,{description:"ë“±ë¡ëœ TLS Secretì´ ì—†ìŠµë‹ˆë‹¤. ì¸ì¦ì„œ ì—…ë¡œë“œ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”."}):e.jsx(wt,{dataSource:Xe,rowKey:"name",pagination:!1,size:"small",columns:[{title:"Secret ì´ë¦„",dataIndex:"name",key:"name",render:le=>e.jsxs(g,{children:[e.jsx(Qn,{style:{color:"#52c41a"}}),e.jsx(_r,{strong:!0,children:le})]})},{title:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤",dataIndex:"namespace",key:"namespace",render:le=>e.jsx(T,{color:"blue",children:le})},{title:"ë§Œë£Œì¼",dataIndex:"cert_expiry",key:"cert_expiry",render:le=>le||"-"},{title:"ë°œê¸‰ì",dataIndex:"cert_issuer",key:"cert_issuer",render:le=>le||"-",ellipsis:!0},{title:"ìƒì„±ì¼",dataIndex:"created_at",key:"created_at",render:le=>le?new Date(le).toLocaleDateString():"-"},{title:"ì‘ì—…",key:"actions",render:(le,me)=>e.jsx(Kt,{title:"ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",description:"ì´ TLS Secretì„ ì‚¬ìš© ì¤‘ì¸ Ingressê°€ ìˆìœ¼ë©´ HTTPSê°€ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",onConfirm:()=>hn(me.name),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),children:"ì‚­ì œ"})})}]})]})]}),oa=()=>e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(xe,{message:"ì™¸ë¶€ Nginx ì„œë²„ ì—°ë™",description:"ì™¸ë¶€ Nginx ì„œë²„ì— SSH ì ‘ì†í•˜ì—¬ K8s ì„œë¹„ìŠ¤ì— ëŒ€í•œ ë„ë©”ì¸ ë¼ìš°íŒ…ì„ ì„¤ì •í•©ë‹ˆë‹¤. K8s NodePortë¥¼ í†µí•´ ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0}),e.jsx(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(ur,{})," K8s ì„œë¹„ìŠ¤ NodePort ì •ë³´"]}),extra:e.jsx(B,{size:"small",icon:e.jsx(Pt,{}),onClick:Va,loading:Mr,children:"ì¡°íšŒ"}),children:En.length===0?e.jsx(Je,{description:"ì„œë¹„ìŠ¤ ì¡°íšŒ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ K8s ì„œë¹„ìŠ¤ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì„¸ìš”"}):e.jsx(wt,{dataSource:En,rowKey:"name",size:"small",pagination:!1,columns:[{title:"ì„œë¹„ìŠ¤ ì´ë¦„",dataIndex:"name",key:"name",render:le=>e.jsx(_r,{strong:!0,children:le})},{title:"íƒ€ì…",dataIndex:"type",key:"type",render:le=>e.jsx(T,{color:le==="NodePort"?"blue":le==="LoadBalancer"?"green":"default",children:le})},{title:"Cluster IP",dataIndex:"clusterIP",key:"clusterIP"},{title:"í¬íŠ¸ ì •ë³´",key:"ports",render:(le,me)=>e.jsx(g,{direction:"vertical",size:4,children:me.ports.map((De,zt)=>e.jsxs(g,{size:4,children:[e.jsxs(T,{color:"cyan",children:[De.protocol," ",De.port,":",De.targetPort]}),De.nodePort&&e.jsxs(T,{color:"orange",style:{fontWeight:"bold"},children:["NodePort: ",De.nodePort]})]},zt))})}]})}),e.jsxs(ie,{size:"small",className:"domain-section-card",title:e.jsxs(g,{children:[e.jsx(ya,{style:{color:"#1890ff"}}),e.jsx(_r,{strong:!0,children:"Multi-hop SSH ì„œë²„ ì—°ê²°"}),e.jsxs(T,{color:"blue",children:[Ge.length,"ê°œ í™‰"]})]}),extra:e.jsxs(g,{children:[e.jsx(Ie,{title:"ì¥ë¹„ ê´€ë¦¬ì—ì„œ ë“±ë¡ëœ ì„œë²„ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤",children:e.jsx(B,{size:"small",icon:e.jsx(Pt,{}),onClick:Ar,loading:ir,children:"ì¥ë¹„ ëª©ë¡"})}),e.jsx(Ie,{title:"SSH ê²½ìœ  ì„œë²„(Jump Host)ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤",children:e.jsx(B,{size:"small",type:"primary",ghost:!0,icon:e.jsx(rr,{}),onClick:Nr,children:"Hop ì¶”ê°€"})})]}),children:[e.jsxs("div",{className:"domain-info-box",children:[e.jsx(ya,{className:"domain-info-box-icon"}),e.jsxs("div",{className:"domain-info-box-content",children:[e.jsx("div",{className:"domain-info-box-title",children:"Multi-hop SSH ì—°ê²°"}),e.jsxs("div",{className:"domain-info-box-description",children:["ì í”„ ì„œë²„(Gateway)ë¥¼ ê²½ìœ í•˜ì—¬ ìµœì¢… Nginx ì„œë²„ì— ì ‘ì†í•©ë‹ˆë‹¤.",e.jsx("br",{}),"ê° Hopì˜ ì„œë²„ë¥¼ ì„ íƒí•˜ê³  SSH ì¸ì¦ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”."," ",e.jsx("strong",{children:"ë§ˆì§€ë§‰ Hopì´ Nginx ì„œë²„"}),"ê°€ ë©ë‹ˆë‹¤."]})]})]}),e.jsxs("div",{className:"ssh-hop-container",children:[Ge.map((le,me)=>e.jsxs(Ct.Fragment,{children:[e.jsxs("div",{className:`ssh-hop-card ${me===Ge.length-1?"target":"gateway"}`,children:[e.jsxs("div",{className:"ssh-hop-header",children:[e.jsxs("div",{className:"ssh-hop-header-left",children:[e.jsx("span",{className:`ssh-hop-number ${me<Ge.length-1?"gateway":""}`,children:me+1}),e.jsxs("div",{className:"ssh-hop-title",children:[e.jsx("span",{className:"ssh-hop-title-main",children:me===Ge.length-1?e.jsxs(g,{children:[e.jsx(_t,{}),"Nginx ì„œë²„ (Target)"]}):e.jsxs(g,{children:[e.jsx(ya,{}),"Gateway ",me+1]})}),e.jsx("span",{className:"ssh-hop-title-sub",children:le.host?`${le.username||"user"}@${le.host}:${le.port}`:"ì„œë²„ë¥¼ ì„ íƒí•˜ì„¸ìš”"})]})]}),Ge.length>1&&e.jsx(Ie,{title:"ì´ Hop ì œê±°",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),onClick:()=>Mn(me)})})]}),e.jsxs("div",{className:"ssh-hop-fields",children:[e.jsx("div",{className:"ssh-hop-field-row server-select",children:e.jsxs("div",{className:"ssh-hop-field",children:[e.jsx("label",{htmlFor:`ssh-hop-server-${me}`,children:"ì„œë²„ ì„ íƒ"}),e.jsx(Ee,{id:`ssh-hop-server-${me}`,placeholder:"ì¥ë¹„ ê´€ë¦¬ì—ì„œ ë“±ë¡ëœ ì„œë²„ë¥¼ ì„ íƒí•˜ì„¸ìš”",value:le.deviceId,onChange:De=>jn(me,De),loading:ir,style:{width:"100%"},showSearch:!0,allowClear:!0,filterOption:(De,zt)=>(typeof(zt==null?void 0:zt.label)=="string"?zt.label:typeof(zt==null?void 0:zt.value)=="string"?zt.value:"").toLowerCase().includes(De.toLowerCase()),children:Bt.map(De=>e.jsx(Ee.Option,{value:De.id,children:e.jsxs(g,{children:[e.jsx(_t,{}),De.name," (",De.ipAddress,":",De.port,")"]})},De.id))})]})}),e.jsxs("div",{className:"ssh-hop-field-row",children:[e.jsxs("div",{className:"ssh-hop-field",children:[e.jsx("label",{htmlFor:`ssh-hop-host-${me}`,children:"í˜¸ìŠ¤íŠ¸"}),e.jsx(ue,{id:`ssh-hop-host-${me}`,value:le.host,disabled:!0,placeholder:"ì„œë²„ ì„ íƒ ì‹œ ìë™ ì…ë ¥",prefix:e.jsx(ur,{style:{color:"#bfbfbf"}})})]}),e.jsxs("div",{className:"ssh-hop-field port",children:[e.jsx("label",{htmlFor:`ssh-hop-port-${me}`,children:"í¬íŠ¸"}),e.jsx(xn,{id:`ssh-hop-port-${me}`,value:le.port,disabled:!0,style:{width:"100%"}})]})]}),e.jsxs("div",{className:"ssh-hop-field-row",children:[e.jsxs("div",{className:"ssh-hop-field",children:[e.jsx("label",{htmlFor:`ssh-hop-username-${me}`,children:"ì‚¬ìš©ìëª…"}),e.jsx(ue,{id:`ssh-hop-username-${me}`,value:le.username,onChange:De=>ba(me,"username",De.target.value),placeholder:"ì˜ˆ: root, admin",prefix:e.jsx("span",{style:{color:"#bfbfbf"},children:"@"})})]}),e.jsxs("div",{className:"ssh-hop-field",children:[e.jsx("label",{htmlFor:`ssh-hop-password-${me}`,children:"ë¹„ë°€ë²ˆí˜¸"}),e.jsx(ue.Password,{id:`ssh-hop-password-${me}`,value:le.password,onChange:De=>ba(me,"password",De.target.value),placeholder:"SSH ë¹„ë°€ë²ˆí˜¸"})]})]})]})]}),me<Ge.length-1&&e.jsx("div",{className:"ssh-hop-connector",children:e.jsx("div",{className:"ssh-hop-connector-icon",children:e.jsx(fc,{})})})]},me)),e.jsx(B,{className:"ssh-hop-add-btn",icon:e.jsx(rr,{}),onClick:Nr,children:"Gateway Hop ì¶”ê°€ (ê²½ìœ  ì„œë²„)"})]}),e.jsx("div",{className:"ssh-connect-btn",children:e.jsx(B,{type:"primary",icon:lt?e.jsx(Pt,{spin:!0}):e.jsx(Ze,{}),onClick:Fa,loading:lt,block:!0,size:"large",children:lt?"ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...":`ì—°ê²° í…ŒìŠ¤íŠ¸ (${Ge.length}ê°œ Hop ê²½ìœ )`})}),tt&&e.jsx("div",{className:`ssh-connection-status ${tt.connected?"":"error"}`,children:e.jsxs(Se,{bordered:!0,size:"small",column:{xs:1,sm:2,md:4},children:[e.jsx(Se.Item,{label:"ì—°ê²° ìƒíƒœ",children:e.jsx(T,{color:tt.connected?"success":"error",icon:tt.connected?e.jsx(Ze,{}):e.jsx(Es,{}),children:tt.connected?"ì—°ê²°ë¨":"ì—°ê²° ì‹¤íŒ¨"})}),e.jsx(Se.Item,{label:"Nginx ë²„ì „",children:e.jsx(_r,{children:tt.nginx_version||"-"})}),e.jsx(Se.Item,{label:"ì„œë¹„ìŠ¤ ìƒíƒœ",children:e.jsx(T,{color:tt.nginx_status==="running"?"success":"warning",children:tt.nginx_status||"-"})}),e.jsx(Se.Item,{label:"conf.d ë””ë ‰í† ë¦¬",children:e.jsx(T,{color:tt.conf_dir_exists?"success":"error",children:tt.conf_dir_exists?"ì¡´ì¬":"ì—†ìŒ"})})]})})]}),(tt==null?void 0:tt.connected)&&e.jsxs(ie,{size:"small",title:e.jsxs(e.Fragment,{children:[e.jsx(Fr,{})," ë„ë©”ì¸ ë¼ìš°íŒ… ì„¤ì •"]}),extra:e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:e.jsx(Pt,{}),onClick:Ur,loading:Ts,children:"ìƒˆë¡œê³ ì¹¨"}),e.jsx(B,{size:"small",icon:e.jsx(Pt,{spin:gr}),onClick:bn,loading:gr,children:"ë¦¬ë¡œë“œ"}),e.jsx(B,{size:"small",type:"primary",icon:e.jsx(rr,{}),onClick:()=>Cs(!0),children:"ì¶”ê°€"})]}),children:[e.jsx(ue.Search,{placeholder:"ì„¤ì • íŒŒì¼ëª… ê²€ìƒ‰...",allowClear:!0,value:Rn,onChange:le=>fn(le.target.value),style:{marginBottom:16}}),e.jsx(wt,{dataSource:St.filter(le=>le.filename.toLowerCase().includes(Rn.toLowerCase())),loading:Ts,rowKey:"filename",columns:[{title:"íŒŒì¼ëª…",dataIndex:"filename",key:"filename",render:le=>e.jsx(_r,{strong:!0,children:le})},{title:"ê²½ë¡œ",dataIndex:"path",key:"path",render:le=>e.jsx(_r,{type:"secondary",children:le})},{title:"í¬ê¸°",dataIndex:"size",key:"size"},{title:"ìˆ˜ì •ì¼",dataIndex:"modified",key:"modified"},{title:"ì‘ì—…",key:"actions",render:(le,me)=>{const De=me.filename.replace(".conf","");return e.jsxs(g,{children:[e.jsx(B,{size:"small",icon:e.jsx(xa,{}),onClick:()=>Ua(De),children:"ì¡°íšŒ"}),e.jsx(Kt,{title:"ì„¤ì • ì‚­ì œ",description:`${me.filename} ì„¤ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,onConfirm:()=>_a(De),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{}),children:"ì‚­ì œ"})})]})}}],pagination:!1,size:"small"})]})]});return e.jsxs("div",{style:{padding:"16px 0"},children:[e.jsx(xe,{message:"ë„ë©”ì¸ ì„¤ì •",description:n?`${a?"Docker":"Podman"} Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ë¼ìš°íŒ…ì„ ì„¤ì •í•©ë‹ˆë‹¤.`:"Kubernetes Nginx Ingress Controller ë˜ëŠ” ì™¸ë¶€ Nginx ì„œë²„ë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ë¼ìš°íŒ…ì„ ì„¤ì •í•©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(nr,{defaultActiveKey:n?["domain"]:["external-nginx"],style:{background:"#fff"},items:n?[{key:"domain",label:e.jsxs(g,{children:[e.jsx(rn,{style:{color:"#722ed1"}}),e.jsx(_r,{strong:!0,children:"ë„ë©”ì¸ ë¼ìš°íŒ…"}),e.jsx(T,{color:"purple",children:"Nginx Â· ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ"})]}),children:wa()}]:[{key:"external-nginx",label:e.jsxs(g,{children:[e.jsx(ur,{style:{color:"#1890ff"}}),e.jsx(_r,{strong:!0,children:"ì™¸ë¶€ Nginx ì„œë²„ ì—°ë™"}),e.jsx(T,{color:"blue",children:"SSH Â· K8s NodePort"}),(tt==null?void 0:tt.connected)&&e.jsx(T,{color:"success",children:"ì—°ê²°ë¨"})]}),children:oa()},{key:"ingress",label:e.jsxs(g,{children:[e.jsx(rn,{style:{color:"#722ed1"}}),e.jsx(_r,{strong:!0,children:"Ingress Controller"}),e.jsx(T,{color:"purple",children:"í´ëŸ¬ìŠ¤í„° ë‚´ë¶€"}),(ye==null?void 0:ye.installed)&&e.jsx(T,{color:"success",children:"ì„¤ì¹˜ë¨"})]}),children:Gr()}]}),e.jsxs(rt,{title:"Nginx ì„¤ì • ì¶”ê°€",open:P,onOk:rs,onCancel:()=>{I(!1),v.resetFields()},okText:"ìƒì„±",cancelText:"ì·¨ì†Œ",width:600,children:[e.jsx(xe,{message:"Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì •",description:e.jsxs("ul",{style:{margin:0,paddingLeft:16},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"ë„ë©”ì¸"}),": ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ë„ë©”ì¸ (ì˜ˆ: app.example.com)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"ë°±ì—”ë“œ í˜¸ìŠ¤íŠ¸"}),": localhost ì…ë ¥ ì‹œ í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ ìœ¼ë¡œ ì—°ê²°ë©ë‹ˆë‹¤"]})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(H,{form:v,layout:"vertical",initialValues:{ssl:!1},children:[e.jsx(H.Item,{label:"ë„ë©”ì¸",name:"domain",rules:[{required:!0,message:"ë„ë©”ì¸ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"app.example.com"})}),e.jsx(H.Item,{label:"ë°±ì—”ë“œ í˜¸ìŠ¤íŠ¸",name:"backend_host",rules:[{required:!0,message:"ë°±ì—”ë“œ í˜¸ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"localhost ë˜ëŠ” 192.168.0.32"})}),e.jsx(H.Item,{label:"ë°±ì—”ë“œ í¬íŠ¸",name:"backend_port",rules:[{required:!0,message:"ë°±ì—”ë“œ í¬íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(xn,{min:1,max:65535,style:{width:"100%"},placeholder:"8080"})}),e.jsx(H.Item,{label:"SSL ì‚¬ìš©",name:"ssl",valuePropName:"checked",children:e.jsx(Zr,{})}),e.jsx(H.Item,{noStyle:!0,shouldUpdate:(le,me)=>le.ssl!==me.ssl,children:({getFieldValue:le})=>le("ssl")&&e.jsxs(e.Fragment,{children:[e.jsx(H.Item,{label:"SSL ì¸ì¦ì„œ ê²½ë¡œ",name:"cert_path",children:e.jsx(ue,{placeholder:"/etc/k8scontrol/nginx/ssl/cert.pem"})}),e.jsx(H.Item,{label:"SSL í‚¤ ê²½ë¡œ",name:"key_path",children:e.jsx(ue,{placeholder:"/etc/k8scontrol/nginx/ssl/key.pem"})})]})})]})]}),e.jsxs(rt,{title:"ì™¸ë¶€ Nginx ë„ë©”ì¸ ì„¤ì • ì¶”ê°€",open:fs,onOk:Vn,onCancel:()=>{Cs(!1),Ss.resetFields()},okText:"ìƒì„±",cancelText:"ì·¨ì†Œ",width:600,children:[e.jsx(xe,{message:"K8s ì„œë¹„ìŠ¤ ë„ë©”ì¸ ì—°ê²°",description:e.jsxs("ul",{style:{margin:0,paddingLeft:16},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"ë„ë©”ì¸"}),": ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ë„ë©”ì¸ (ì˜ˆ: app.example.com)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Upstream Host"}),": K8s í´ëŸ¬ìŠ¤í„° ë…¸ë“œ IP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Upstream Port"}),": K8s ì„œë¹„ìŠ¤ì˜ NodePort (30000~32767)"]})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(H,{form:Ss,layout:"vertical",initialValues:{enable_ssl:!1,upstream_port:30080},children:[e.jsx(H.Item,{label:"ë„ë©”ì¸",name:"domain",rules:[{required:!0,message:"ë„ë©”ì¸ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"app.example.com"})}),e.jsx(H.Item,{label:"Upstream Host (K8s Node IP)",name:"upstream_host",rules:[{required:!0,message:"K8s ë…¸ë“œ IPë¥¼ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"192.168.0.100"})}),e.jsx(H.Item,{label:"Upstream Port (NodePort)",name:"upstream_port",rules:[{required:!0,message:"NodePortë¥¼ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(xn,{min:1,max:65535,style:{width:"100%"},placeholder:"30080"})}),e.jsx(H.Item,{label:"SSL ì‚¬ìš©",name:"enable_ssl",valuePropName:"checked",children:e.jsx(Zr,{})})]})]}),e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(Bs,{style:{color:"#52c41a"}}),"TLS/SSL ì¸ì¦ì„œ ì—…ë¡œë“œ"]}),open:J,onOk:Jt,onCancel:()=>{te(!1),ne.resetFields()},okText:"ì—…ë¡œë“œ",cancelText:"ì·¨ì†Œ",confirmLoading:G,width:700,children:[e.jsx(xe,{message:"ì¸ì¦ì„œ ì—…ë¡œë“œ ì•ˆë‚´",description:e.jsxs("ul",{style:{margin:0,paddingLeft:16,marginTop:8},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"ì¸ì¦ì„œ íŒŒì¼:"})," PEM í˜•ì‹ì˜ SSL ì¸ì¦ì„œ (.crt, .pem)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"ê°œì¸í‚¤ íŒŒì¼:"})," PEM í˜•ì‹ì˜ ê°œì¸í‚¤ (.key, .pem)"]}),e.jsx("li",{children:"ì¸ì¦ì„œëŠ” ë„ë©”ì¸ë³„ë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤"}),e.jsx("li",{children:"ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë„ë©”ì¸ì˜ ì¸ì¦ì„œëŠ” ë®ì–´ì”ë‹ˆë‹¤"})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(H,{form:ne,layout:"vertical",children:[e.jsx(H.Item,{name:"domain",label:"ë„ë©”ì¸",rules:[{required:!0,message:"ë„ë©”ì¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"},{pattern:/^[a-zA-Z0-9][a-zA-Z0-9.-]*[a-zA-Z0-9]$/,message:"ìœ íš¨í•œ ë„ë©”ì¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: example.com, api.example.com"})}),e.jsx(H.Item,{name:"cert_content",label:"ì¸ì¦ì„œ ë‚´ìš© (Certificate)",rules:[{required:!0,message:"ì¸ì¦ì„œ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"},{pattern:/-----BEGIN CERTIFICATE-----/,message:"PEM í˜•ì‹ì˜ ì¸ì¦ì„œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],extra:"-----BEGIN CERTIFICATE-----ë¡œ ì‹œì‘í•˜ëŠ” ì¸ì¦ì„œ ë‚´ìš©ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”",children:e.jsx(ue.TextArea,{rows:8,placeholder:`-----BEGIN CERTIFICATE-----
MIIDdTCCAl2gAwIBAgIJAKfRi...
-----END CERTIFICATE-----`,style:{fontFamily:"monospace",fontSize:"12px"}})}),e.jsx(H.Item,{name:"key_content",label:"ê°œì¸í‚¤ ë‚´ìš© (Private Key)",rules:[{required:!0,message:"ê°œì¸í‚¤ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"},{pattern:/-----BEGIN (RSA |EC )?PRIVATE KEY-----/,message:"PEM í˜•ì‹ì˜ ê°œì¸í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],extra:"-----BEGIN PRIVATE KEY-----ë¡œ ì‹œì‘í•˜ëŠ” ê°œì¸í‚¤ ë‚´ìš©ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”",children:e.jsx(ue.TextArea,{rows:8,placeholder:`-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAAS...
-----END PRIVATE KEY-----`,style:{fontFamily:"monospace",fontSize:"12px"}})})]})]}),e.jsx(rt,{title:e.jsxs(g,{children:[e.jsx(Fr,{}),A?"ì„¤ì • íŒŒì¼ ìˆ˜ì •":"ì„¤ì • íŒŒì¼ ì¡°íšŒ",u&&e.jsx(T,{color:"blue",children:u.domain})]}),open:j,onOk:A?cn:void 0,onCancel:()=>{b(!1),m(null),W(!1)},okText:A?"ì €ì¥":void 0,cancelText:"ë‹«ê¸°",width:900,footer:A?void 0:[e.jsx(B,{type:"primary",icon:e.jsx(ln,{}),onClick:()=>W(!0),children:"ìˆ˜ì •"},"edit"),e.jsx(B,{onClick:()=>{b(!1),m(null)},children:"ë‹«ê¸°"},"close")],children:u&&e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"middle",children:[e.jsx(xe,{message:"ì„¤ì • íŒŒì¼ ì •ë³´",description:e.jsxs(g,{direction:"vertical",children:[e.jsxs(_r,{children:[e.jsx("strong",{children:"ë„ë©”ì¸:"})," ",u.domain]}),e.jsxs(_r,{children:[e.jsx("strong",{children:"ê²½ë¡œ:"})," ",u.path]})]}),type:"info",showIcon:!0}),e.jsxs("div",{children:[e.jsx(_r,{strong:!0,children:"ì„¤ì • ë‚´ìš©:"}),e.jsx(ue.TextArea,{value:A?Z:u.content,onChange:le=>se(le.target.value),disabled:!A,rows:20,style:{marginTop:8,fontFamily:"monospace",fontSize:"13px"}})]})]})}),e.jsx(rt,{title:e.jsxs(g,{children:[e.jsx(Fr,{}),zr?"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ìˆ˜ì •":"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ì¡°íšŒ",Os&&e.jsx(T,{color:"blue",children:Os.domain})]}),open:Ht,onOk:zr?Ha:void 0,onCancel:()=>{Dt(!1),Ms(null),nn(!1)},okText:zr?"ì €ì¥":void 0,cancelText:"ë‹«ê¸°",width:900,footer:zr?void 0:[e.jsx(B,{type:"primary",icon:e.jsx(ln,{}),onClick:()=>nn(!0),children:"ìˆ˜ì •"},"edit"),e.jsx(B,{onClick:()=>{Dt(!1),Ms(null)},children:"ë‹«ê¸°"},"close")],children:Os&&e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"middle",children:[e.jsx(xe,{message:"ì™¸ë¶€ Nginx ì„¤ì • íŒŒì¼ ì •ë³´",description:e.jsxs(g,{direction:"vertical",children:[e.jsxs(_r,{children:[e.jsx("strong",{children:"ë„ë©”ì¸:"})," ",Os.domain]}),e.jsxs(_r,{children:[e.jsx("strong",{children:"ê²½ë¡œ:"})," ",Os.path]})]}),type:"info",showIcon:!0}),e.jsxs("div",{children:[e.jsx(_r,{strong:!0,children:"ì„¤ì • ë‚´ìš©:"}),e.jsx(ue.TextArea,{value:zr?zn:Os.content,onChange:le=>Ys(le.target.value),disabled:!zr,rows:20,style:{marginTop:8,fontFamily:"monospace",fontSize:"13px"}})]})]})}),e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(Bs,{}),"K8s TLS Secret ìƒì„±"]}),open:Oe,onCancel:()=>{Mt(!1),ot.resetFields()},footer:null,width:700,children:[e.jsx(xe,{message:"TLS Secret ìƒì„±",description:"Kubernetes TLS Secretì„ ìƒì„±í•©ë‹ˆë‹¤. PEM í˜•ì‹ì˜ ì¸ì¦ì„œ(.crt)ì™€ ê°œì¸í‚¤(.key) ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”. ìƒì„±ëœ Secretì€ Ingressì—ì„œ HTTPS ì„¤ì • ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(H,{form:ot,layout:"vertical",onFinish:Ds,children:[e.jsx(H.Item,{name:"secretName",label:"Secret ì´ë¦„",rules:[{required:!0,message:"Secret ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"},{pattern:/^[a-z0-9][a-z0-9-]*[a-z0-9]$/,message:"ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤"}],extra:`ë„¤ì„ìŠ¤í˜ì´ìŠ¤: ${l}`,children:e.jsx(ue,{placeholder:"ì˜ˆ: my-app-tls"})}),e.jsx(H.Item,{name:"certContent",label:"ì¸ì¦ì„œ ë‚´ìš© (Certificate)",rules:[{required:!0,message:"ì¸ì¦ì„œ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"},{pattern:/-----BEGIN CERTIFICATE-----/,message:"PEM í˜•ì‹ì˜ ì¸ì¦ì„œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],extra:"-----BEGIN CERTIFICATE-----ë¡œ ì‹œì‘í•˜ëŠ” ì¸ì¦ì„œ ë‚´ìš©ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”",children:e.jsx(ue.TextArea,{rows:8,placeholder:`-----BEGIN CERTIFICATE-----
MIIDdTCCAl2gAwIBAgIJAKfRi...
-----END CERTIFICATE-----`,style:{fontFamily:"monospace",fontSize:"12px"}})}),e.jsx(H.Item,{name:"keyContent",label:"ê°œì¸í‚¤ ë‚´ìš© (Private Key)",rules:[{required:!0,message:"ê°œì¸í‚¤ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"},{pattern:/-----BEGIN (RSA |EC )?PRIVATE KEY-----/,message:"PEM í˜•ì‹ì˜ ê°œì¸í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],extra:"-----BEGIN PRIVATE KEY-----ë¡œ ì‹œì‘í•˜ëŠ” ê°œì¸í‚¤ ë‚´ìš©ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”",children:e.jsx(ue.TextArea,{rows:8,placeholder:`-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0B...
-----END PRIVATE KEY-----`,style:{fontFamily:"monospace",fontSize:"12px"}})}),e.jsx(H.Item,{children:e.jsxs(g,{children:[e.jsx(B,{type:"primary",htmlType:"submit",loading:Ve,icon:e.jsx(Bs,{}),children:"TLS Secret ìƒì„±"}),e.jsx(B,{onClick:()=>{Mt(!1),ot.resetFields()},children:"ì·¨ì†Œ"})]})})]})]})]})},{Text:hk,Title:bS}=we,_S=({visible:s,onClose:t,service:r,currentStatus:n,serverHops:a,infraId:i,dastResult:l,dastState:d,repoId:c,repoName:p,repoUrl:h,onDastScanStateChange:x})=>{const{upsertServerByHostPort:_}=Gs();o.useEffect(()=>{s&&r&&O.debug("Service modal opened",{serviceName:r.name,infraType:r.infraType,displayInfraType:nl(r.infraType),isDockerInfra:su(r.infraType),isPodmanInfra:ru(r.infraType),isKubernetesInfra:vp(r.infraType)},"ImprovedOperateModal","mount")},[s,r]);const[S,L]=o.useState("overview"),[k,E]=o.useState(!1),[P,I]=o.useState([]),[$,y]=o.useState(""),[v,u]=o.useState(""),[m,j]=o.useState(!1),[b,A]=o.useState(""),[W,Z]=o.useState(""),[se,ce]=o.useState(!1),[D,M]=o.useState(""),[K,J]=o.useState(null),[te,G]=o.useState(!1),[q,oe]=o.useState(1),[be,ne]=o.useState(!1),[ye,Ue]=o.useState(null),[N,ge]=o.useState([]),[Ce,je]=o.useState(!1),[Pe,w]=o.useState(""),[R,U]=o.useState(!1),[V,F]=o.useState(!1),[X,de]=o.useState([]),[Ne,ae]=o.useState(!1),[pe,Xe]=o.useState(!1),[Nt]=H.useForm(),[Fe,Le]=o.useState(!1),[Oe,Mt]=o.useState(""),[Ve,Me]=o.useState(!1),[ot,Bt]=o.useState(""),[Ps,ir]=o.useState(null),[Ut,Ge]=o.useState(!1),[et,tt]=o.useState(!1),[Vt,lt]=o.useState(null),[Rt,St]=o.useState(null),[ms,Ts]=o.useState(!1),[ds,fs]=o.useState(!1),[Cs,gr]=o.useState(!1),Rr=o.useRef(null),Ss=o.useRef(null),[Rn,fn]=o.useState(0),[Os,Ms]=o.useState([]),[Ht,Dt]=o.useState(""),[zr,nn]=o.useState({}),[zn,Ys]=o.useState([]),[,En]=o.useState([]),[,Pn]=o.useState(!1),[Mr,Lr]=o.useState([]),[Xn,ea]=o.useState(!1),[or,ss]=o.useState(null),[rs,Hn]=o.useState([]),[yn,cn]=o.useState(""),[ys,Jt]=o.useState(!1),[an,dn]=o.useState([]),[un,nt]=o.useState(!1),[Gt,fe]=o.useState([]),[Be,dt]=o.useState(!1),[ns,Ds]=o.useState(!1),[hn,Ar]=o.useState(!1),[Nr,Mn]=o.useState("idle"),[jn,ba]=o.useState(void 0),[Fa,Ur]=o.useState(null),[bn,Vn]=o.useState([]),[_a,Ua]=o.useState(!1),[Ha,Va]=o.useState([]),[wa,Gr]=o.useState([]),[oa,le]=o.useState(!1),[me,De]=o.useState([]),[zt,Ls]=o.useState(!1),[Br,Ln]=o.useState(null),[Sa,Ma]=o.useState(!1),[jr,Wr]=o.useState(!1),[li,qa]=o.useState(null),[Ci,Xr]=o.useState(null),[ko,Ga]=o.useState(""),[Co,ci]=o.useState(null),va=()=>{if(!a)return[];try{const ve=typeof a=="string"?JSON.parse(a):a;return Array.isArray(ve)?ve:[]}catch(ve){return[]}},la=o.useCallback(()=>vp(r==null?void 0:r.infraType),[r==null?void 0:r.infraType]),xr=o.useCallback(()=>su(r==null?void 0:r.infraType),[r==null?void 0:r.infraType]),en=o.useCallback(()=>ru(r==null?void 0:r.infraType),[r==null?void 0:r.infraType]),_e=o.useCallback(()=>Xw(r==null?void 0:r.infraType),[r==null?void 0:r.infraType]);o.useEffect(()=>{},[Rt,Cs,Vt]),o.useEffect(()=>{if(s){L("overview"),I([]),y(""),u(""),A(""),Z(""),J(null),Xr(null),Ga("");let ve;if(la()&&i&&(r!=null&&r.id)){const{serverlist:He}=Gs.getState(),qe=He.filter(Qe=>Qe.infraId===i&&Qe.serviceId===r.id);if(qe.length>0){const Qe=qe.some(Ae=>Ae.hopOrder!==void 0);let mt;Qe?mt=[...qe].sort((Ae,yt)=>{var as,Xs;const Vs=(as=Ae.hopOrder)!=null?as:999,Qs=(Xs=yt.hopOrder)!=null?Xs:999;return Vs-Qs}):mt=[...qe].reverse(),ve=mt.map(Ae=>({host:Ae.host,port:Ae.port||22,username:Ae.userId,password:Ae.password})),fe(ve),O.info("K8s SSH credentials restored from creds-store",{hopsCount:ve.length,infraId:i,serviceId:r.id,hasHopOrder:Qe},"ImprovedOperateModal","mount")}}O.info("Modal opened",{serviceName:r.name,infraType:r.infraType,infraId:i,isDockerInfra:xr(),isPodmanInfra:en(),hasRestoredHops:ve!==void 0&&ve.length>0},"ImprovedOperateModal","mount"),An(ve),di()}},[s]),o.useEffect(()=>{s&&r&&i&&(An(),di())},[i,r==null?void 0:r.id,s]),o.useEffect(()=>{s&&S==="pods"&&(Ja(),Gt.length>0&&ut().then(ve=>{ve!=null&&ve.ready&&P.length>0&&us()}))},[s,S,Gt]),o.useEffect(()=>{s&&S==="deployment"&&Ro()},[s,S]),o.useEffect(()=>{const ve=async()=>{if(i){Pn(!0);try{const He=Gt.length>0?Gt.map(mt=>({host:mt.host,port:mt.port,username:mt.username||"",password:mt.password||""})):void 0,qe=await Vg({infra_id:i,hops:He}),Qe=qe.nodes?JSON.parse(qe.nodes):null;if(Qe&&Qe.items){const mt=Qe.items.map(Ae=>{var yt,Vs,Qs,as;return{name:Ae.metadata.name,status:((Vs=(yt=Ae.status.conditions)==null?void 0:yt.find(Xs=>Xs.type==="Ready"))==null?void 0:Vs.status)==="True"?"Ready":"NotReady",roles:(Qs=Ae.metadata.labels)!=null&&Qs["node-role.kubernetes.io/master"]?"master":(as=Ae.metadata.labels)!=null&&as["node-role.kubernetes.io/control-plane"]?"control-plane":"worker",age:Ae.metadata.creationTimestamp,version:Ae.status.nodeInfo.kubeletVersion}});En(mt)}}catch(He){}finally{Pn(!1)}}};S==="k8sops"&&i&&!_e()&&ve()},[S,i,_e]),o.useEffect(()=>{O.debug("Docker container load check",{visible:s,infraId:i,isDockerInfra:xr(),isPodmanInfra:en(),activeTab:S,shouldLoad:s&&i&&_e()&&(S==="containers"||S==="overview")},"ImprovedOperateModal","containerLoadCheck"),s&&i&&_e()&&(S==="containers"||S==="overview")&&(O.info("Loading Docker/Podman containers via useEffect",{infraId:i,activeTab:S},"ImprovedOperateModal","useEffect"),z())},[s,i,S]),o.useEffect(()=>{O.debug("Docker resources load check",{visible:s,infraId:i,isDockerInfra:xr(),isPodmanInfra:en(),activeTab:S,hasHops:rs.length>0,shouldLoad:s&&i&&_e()&&S==="dockerresources"&&rs.length>0},"ImprovedOperateModal","dockerResourcesLoadCheck"),s&&i&&_e()&&S==="dockerresources"&&rs.length>0&&(O.info("Loading Docker/Podman resources via useEffect",{infraId:i,activeTab:S},"ImprovedOperateModal","useEffect"),Q(),ke())},[s,i,S,rs]),o.useEffect(()=>{O.debug("Docker overview data load check",{visible:s,infraId:i,isDockerInfra:xr(),isPodmanInfra:en(),activeTab:S,hasHops:rs.length>0,shouldLoad:s&&i&&_e()&&S==="overview"&&rs.length>0},"ImprovedOperateModal","dockerOverviewLoadCheck"),s&&i&&_e()&&S==="overview"&&rs.length>0&&(O.info("Loading Docker/Podman overview data via useEffect",{infraId:i,activeTab:S},"ImprovedOperateModal","useEffect"),Ji(),Q(),ke())},[s,i,S,rs]);const An=async ve=>{var He,qe,Qe,mt,Ae,yt,Vs,Qs;if(!(!r||!i)){if(_e()){E(!1);return}E(!0);try{const as=ve&&ve.length>0?ve:Gt.length>0?Gt:va(),Xs=r.namespace||"default",da=await ze.kubernetes.request("getNamespaceAndPodStatus",{namespace:Xs,hops:as,infra_id:i,service_id:r.id});if((He=da.data)!=null&&He.data){const lr=da.data.data.pods||[];if(I(lr),lr.length>0&&!$){const mr=typeof lr[0].name=="string"?lr[0].name.trim():String(lr[0].name||"").trim();y(mr)}const Js=lr.filter(mr=>mr.image&&mr.image!=="<none>").map(mr=>mr.image),Rs=Array.from(new Set(Js));Rs.length>0&&Xr(mr=>({...mr,actual_deployed_images:Rs}))}if(r.id)try{const vs=ve&&ve.length>0?ve:Gt.length>0?Gt:void 0,lr=vs?vs.map(Rs=>({host:Rs.host,port:Rs.port,username:Rs.username||"",password:Rs.password||""})):void 0,Js=await ic(r.id,lr);if(Js.deployments&&Js.deployments.length>0){Ms(Js.deployments);const Rs=Js.deployments[0],mr=((qe=Rs.metadata)==null?void 0:qe.name)||"";Dt(mr);const Qa=Rs.status||{};nn({replicas:Qa.replicas||0,availableReplicas:Qa.availableReplicas||0,updatedReplicas:Qa.updatedReplicas||0}),Ya(vs)}if(Js.ingresses&&Js.ingresses.length>0){const Rs=[];Js.ingresses.forEach(mr=>{var Xa;(((Xa=mr.spec)==null?void 0:Xa.rules)||[]).forEach(Aa=>{Aa.host&&Rs.push(Aa.host)})}),Ys(Rs)}}catch(vs){const lr=vs.response||((Qe=vs.originalError)==null?void 0:Qe.response);if((vs.statusCode||(lr==null?void 0:lr.status))===401&&((Ae=(mt=lr==null?void 0:lr.data)==null?void 0:mt.data)!=null&&Ae.requires_ssh_credentials)){const Rs=lr.data.data.hops||[];O.info("K8s SSH credentials required",{hopsCount:Rs.length},"ImprovedOperateModal","loadOverviewData"),dn(Rs),dt(!0),Jt(!0)}else{const Rs=vs.message||vs.error||"";if((Rs.includes("SSH ì—°ê²°")||Rs.includes("SSH ì ‘ì†")||Rs.includes("ì—°ê²° ì‹œê°„ ì´ˆê³¼")||Rs.includes("ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤")||Rs.includes("connection timeout")||Rs.includes("connection refused")||Rs.includes("authentication failed"))&&(Gt.length>0||ve)){O.warn("SSH connection failed during K8s resources load",{error:Rs},"ImprovedOperateModal","loadOverviewData"),dn(Gt.length>0?Gt:ve||[]),dt(!0),nt(!0),Jt(!0);return}else throw O.error("Failed to load K8s resources",vs,{},"ImprovedOperateModal","loadOverviewData"),vs}}Wa(as)}catch(as){const Xs=as.response||((yt=as.originalError)==null?void 0:yt.response);if((as.statusCode||(Xs==null?void 0:Xs.status))===401&&((Qs=(Vs=Xs==null?void 0:Xs.data)==null?void 0:Vs.data)!=null&&Qs.requires_ssh_credentials)){const vs=Xs.data.data.hops||[];O.info("K8s SSH credentials required",{hopsCount:vs.length},"ImprovedOperateModal","loadOverviewData"),dn(vs),dt(!0),Jt(!0)}else{const vs=as.message||as.error||"";(vs.includes("SSH ì—°ê²°")||vs.includes("SSH ì ‘ì†")||vs.includes("ì—°ê²° ì‹œê°„ ì´ˆê³¼")||vs.includes("ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤")||vs.includes("connection timeout")||vs.includes("connection refused")||vs.includes("authentication failed"))&&(Gt.length>0||ve)?(O.warn("SSH connection failed, requesting credentials again",{error:vs},"ImprovedOperateModal","loadOverviewData"),at.error({key:"ssh-connection-error",message:"SSH ì—°ê²° ì‹¤íŒ¨",description:"SSH ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ‘ì† ì •ë³´ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.",duration:4}),dn(Gt.length>0?Gt:ve||[]),dt(!0),nt(!0),Jt(!0)):at.error({key:"data-load-error",message:"ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨",description:vs||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",duration:4})}}finally{E(!1)}}},Wa=async ve=>{var qe;if(!r)return;const He=ve&&ve.length>0?ve:Gt.length>0?Gt:va();if(He.length===0&&la()){O.warn("SSH credentials not found, showing credential modal",{serviceId:r.id},"ImprovedOperateModal","loadResourceInfo"),dt(!0),Jt(!0);return}G(!0);try{const Qe=await ze.kubernetes.request("calculateResources",{hops:He,service_id:r==null?void 0:r.id});if((qe=Qe.data)!=null&&qe.data){const mt=Qe.data.data;typeof mt=="object"&&mt!==null&&"cpu_model"in mt&&J(mt)}}catch(Qe){O.error("Failed to load resource info",Qe,{serviceId:r==null?void 0:r.id,hopsCount:He.length},"ImprovedOperateModal","loadResourceInfo")}finally{G(!1)}},di=async()=>{var ve,He;if(r!=null&&r.id)try{const{pipelineApi:qe}=await vn(async()=>{const{pipelineApi:yt}=await Promise.resolve().then(()=>S0);return{pipelineApi:yt}},void 0),Qe=await qe.getLastSuccessfulDeployment(r.id);if(Qe!=null&&Qe.details_data){const yt=Qe.details_data;if(ci(yt),yt.deployment_type==="docker-compose"){const Qs=yt.registry_url&&yt.project_name?`${yt.registry_url}/${yt.project_name}`:yt.registry_url||yt.project_name;Xr({deployed_image_tag:yt.image_tag,deployed_image:Qs,registry:yt.registry_url,deployed_at:Qe.created_at})}else Xr({deployed_image_tag:yt.deployed_image_tag,deployed_image:yt.deployed_image,primary_deployed_image:yt.primary_deployed_image,actual_deployed_images:yt.actual_deployed_images,registry:yt.registry,namespace:yt.namespace,deployed_at:Qe.created_at})}const{buildApi:mt}=await vn(async()=>{const{buildApi:yt}=await Promise.resolve().then(()=>ec);return{buildApi:yt}},void 0),Ae=await mt.getBuildStatistics(r.id);if((ve=Ae==null?void 0:Ae.latest_build)!=null&&ve.details_data)try{const yt=typeof Ae.latest_build.details_data=="string"?JSON.parse(Ae.latest_build.details_data):Ae.latest_build.details_data.Valid&&Ae.latest_build.details_data.String?JSON.parse(Ae.latest_build.details_data.String):Ae.latest_build.details_data;yt.image_tag&&Ga(yt.image_tag)}catch(yt){}}catch(qe){(qe==null?void 0:qe.statusCode)!==404&&!((He=qe==null?void 0:qe.message)!=null&&He.includes("ë°°í¬ ê¸°ë¡"))&&console.warn("[loadDeployedImageInfo] ë°°í¬ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:",qe)}},z=async()=>{var ve,He,qe;if(O.info("loadDockerContainerData called",{infraId:i,isDockerInfra:xr(),isPodmanInfra:en(),willReturn:!i||!_e()},"ImprovedOperateModal","loadDockerContainerData"),!i||!_e()){O.warn("Early return from loadDockerContainerData",{infraId:i,isDockerInfra:xr(),isPodmanInfra:en()},"ImprovedOperateModal","loadDockerContainerData");return}O.info("Loading Docker containers",{infraId:i},"ImprovedOperateModal","loadDockerContainerData");try{ea(!0);const Qe=await kg(i);if(O.debug("Docker server response received",{success:Qe.success,hasData:!!Qe.data,hasServer:!!((ve=Qe.data)!=null&&ve.server)},"ImprovedOperateModal","loadDockerContainerData"),!Qe.success||!((He=Qe.data)!=null&&He.server)){O.warn("No Docker server found",{infraId:i},"ImprovedOperateModal","loadDockerContainerData"),Lr([]);return}const mt=Qe.data.server,Ae=mt.id;ss(Ae),O.debug("Found Docker server",{serverId:Ae},"ImprovedOperateModal","loadDockerContainerData");let yt=[];if(mt.hops)try{const Xs=typeof mt.hops=="string"?mt.hops:JSON.stringify(mt.hops);yt=JSON.parse(Xs),O.debug("Parsed Docker server hops",{hopsCount:yt.length},"ImprovedOperateModal","loadDockerContainerData");const{serverlist:da}=Gs.getState(),vs=yt.map(Js=>{const Rs=da.find(mr=>mr.host===Js.host&&(!Js.port||mr.port===Js.port||mr.port===Number(Js.port))&&mr.userId===Js.username&&(i?mr.infraId===i:!0));return Rs&&Rs.password?(O.debug("Found credential for Docker hop",{host:Js.host},"ImprovedOperateModal","loadDockerContainerData"),{...Js,password:Rs.password,hasCredential:!0}):(O.warn("No credential found for Docker hop",{host:Js.host,port:Js.port},"ImprovedOperateModal","loadDockerContainerData"),{...Js,hasCredential:!1})}),lr=vs.filter(Js=>!Js.hasCredential);if(lr.length>0){O.info("Missing SSH credentials detected",{totalHops:yt.length,missingCount:lr.length},"ImprovedOperateModal","loadDockerContainerData"),dn(vs),Hn(vs),ss(Ae),nt(!1),Jt(!0),ea(!1);return}yt=vs,O.debug("Docker hops with credentials prepared",{hopsCount:yt.length},"ImprovedOperateModal","loadDockerContainerData")}catch(Xs){O.error("Failed to parse Docker hops",Xs,{infraId:i},"ImprovedOperateModal","loadDockerContainerData")}Hn(yt);let Vs;if(r!=null&&r.gitlab_url){const Xs=r.gitlab_url.replace(/\/$/,"").split("/");Vs=Xs[Xs.length-1].replace(".git",""),O.debug("Extracted compose project name",{gitlabUrl:r.gitlab_url,composeProject:Vs},"ImprovedOperateModal","loadDockerContainerData")}const Qs=xr()?"docker":"podman",as=await Hd(Ae,{hops:yt,compose_project:Vs},Qs);O.info(`${Qs} containers loaded`,{serverId:Ae,containerCount:((qe=as==null?void 0:as.containers)==null?void 0:qe.length)||0},"ImprovedOperateModal","loadDockerContainerData"),as&&as.containers?Lr(as.containers):Lr([])}catch(Qe){O.error("Failed to load Docker containers",Qe,{infraId:i},"ImprovedOperateModal","loadDockerContainerData"),Lr([]);const mt=Qe instanceof Error?Qe.message:String(Qe);(mt.includes("SSH")||mt.includes("ì¸ì¦")||mt.includes("authentication")||mt.includes("password"))&&rs.length>0?(at.error({key:"docker-ssh-error",message:"SSH ì ‘ì† ì‹¤íŒ¨",description:"SSH ì ‘ì†ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì¸ì¦ ì •ë³´ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.",duration:4}),dn(rs),nt(!0),Jt(!0)):at.error({key:"container-load-error",message:"ì»¨í…Œì´ë„ˆ ë¡œë“œ ì‹¤íŒ¨",description:"ì»¨í…Œì´ë„ˆ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",duration:4})}finally{ea(!1)}},Q=async()=>{if(!(!i||!_e()||rs.length===0))try{Ua(!0);let ve;if(r!=null&&r.gitlab_url){const Qe=r.gitlab_url.replace(/\/$/,"").split("/");ve=Qe[Qe.length-1].replace(".git","")}const He=xr()?"docker":"podman",qe=await Eg({hops:rs,compose_project:ve},He);Vn(qe),O.info(`${He} images loaded`,{imageCount:qe.length,composeProject:ve},"ImprovedOperateModal","loadDockerImages")}catch(ve){O.error("Failed to load Docker images",ve,{infraId:i},"ImprovedOperateModal","loadDockerImages"),Vn([])}finally{Ua(!1)}},ke=async()=>{if(!(!i||!_e()||rs.length===0))try{le(!0);let ve;if(r!=null&&r.gitlab_url){const mt=r.gitlab_url.replace(/\/$/,"").split("/");ve=mt[mt.length-1].replace(".git","")}const He=xr?"docker":"podman",[qe,Qe]=await Promise.all([Pg({hops:rs,compose_project:ve},He),Mg({hops:rs,compose_project:ve},He)]);Va(qe),Gr(Qe),O.info("Docker resources loaded",{volumeCount:qe.length,networkCount:Qe.length,composeProject:ve},"ImprovedOperateModal","loadDockerResources")}catch(ve){O.error("Failed to load Docker resources",ve,{infraId:i},"ImprovedOperateModal","loadDockerResources"),Va([]),Gr([])}finally{le(!1)}},Re=async ve=>{var He;if(Be){if(O.info("K8s SSH credentials provided, retrying K8s resources load",{serviceId:r==null?void 0:r.id,hopsCount:ve.length},"ImprovedOperateModal","handleSshCredentialComplete"),!(r!=null&&r.id)){O.error("Service ID is missing",void 0,{},"ImprovedOperateModal","handleSshCredentialComplete");return}try{fe(ve);const{serverlist:qe}=Gs.getState();qe.map((Ae,yt)=>({item:Ae,idx:yt})).filter(({item:Ae})=>Ae.infraId===i&&Ae.serviceId===r.id).map(({idx:Ae})=>Ae).sort((Ae,yt)=>yt-Ae).forEach(Ae=>{Gs.getState().removeServer(Ae)}),ve.forEach((Ae,yt)=>{_({host:Ae.host,port:Ae.port,userId:Ae.username,password:Ae.password,infraId:i,serviceId:r.id,hopOrder:yt})}),dt(!1),Jt(!1);const mt=ve.map(Ae=>({host:Ae.host,port:Ae.port,username:Ae.username||"",password:Ae.password||""}));await An(mt),O.info("K8s overview data loaded after credential input",{serviceId:r.id},"ImprovedOperateModal","handleSshCredentialComplete")}catch(qe){O.error("Failed to load K8s resources after credential input",qe,{},"ImprovedOperateModal","handleSshCredentialComplete"),nt(!0),Jt(!0)}return}if(!or){O.error("SSH credential completed but dockerServerId is null",void 0,{},"ImprovedOperateModal","handleSshCredentialComplete");return}O.info("SSH credentials provided, loading containers",{serverId:or,hopsCount:ve.length},"ImprovedOperateModal","handleSshCredentialComplete");try{ea(!0),Hn(ve);let qe;if(r!=null&&r.gitlab_url){const Ae=r.gitlab_url.replace(/\/$/,"").split("/");qe=Ae[Ae.length-1].replace(".git","")}const Qe=xr()?"docker":"podman",mt=await Hd(or,{hops:ve,compose_project:qe},Qe);O.info("Docker containers loaded after credential input",{serverId:or,containerCount:((He=mt==null?void 0:mt.containers)==null?void 0:He.length)||0},"ImprovedOperateModal","handleSshCredentialComplete"),mt&&mt.containers?Lr(mt.containers):Lr([])}catch(qe){O.error("Failed to load Docker containers after credential input",qe,{serverId:or},"ImprovedOperateModal","handleSshCredentialComplete"),Lr([]),nt(!0),Jt(!0)}finally{ea(!1)}},ut=async()=>{if(r!=null&&r.id&&!_e())try{Ts(!0);const ve=Gt.length>0?Gt.map(qe=>({host:qe.host,port:qe.port,username:qe.username||"",password:qe.password||""})):void 0,He=await fh(r.id,ve);if(lt(He),He.installed&&!He.ready){const qe=await zy(r.id,ve);St(qe.diagnostics||null),qe.diagnostics&&gr(!0)}else St(null),gr(!1);return He!=null&&He.ready&&P.length>0&&await us(),He}catch(ve){return null}finally{Ts(!1)}},$t=async()=>{if(!(r!=null&&r.id)){console.error("[Metrics Server] service.idê°€ ì—†ìŒ");return}try{fs(!0);const ve=Gt.length>0?Gt.map(Ae=>({host:Ae.host,port:Ae.port,username:Ae.username||"",password:Ae.password||""})):void 0,He=await Ry(r.id,ve);He.pod_status&&(He.pod_status.includes("ImagePullBackOff")||He.pod_status.includes("ErrImagePull"));let qe=0;const Qe=12,mt=async()=>{qe++;const Ae=await ut();Ae!=null&&Ae.ready||qe>=Qe?fs(!1):setTimeout(()=>{mt()},1e4)};setTimeout(()=>{mt()},15e3)}catch(ve){console.error("[Metrics Server] ì„¤ì¹˜ ì‹¤íŒ¨",ve),fs(!1)}},Hr=async()=>{if(r!=null&&r.id)try{await Ey(r.id),setTimeout(()=>{ut()},15e3)}catch(ve){}},us=async()=>{if(r!=null&&r.id&&!(Vt&&!Vt.ready))try{const ve=Gt.length>0?Gt.map(qe=>({host:qe.host,port:qe.port,username:qe.username||"",password:qe.password||""})):void 0,He=await Py(r.id,ve);I(qe=>qe.map(mt=>{const Ae=He.metrics.find(yt=>yt.pod_name===mt.name);return{...mt,cpuUsage:Ae==null?void 0:Ae.cpu_usage,memoryUsage:Ae==null?void 0:Ae.memory_usage}}))}catch(ve){if(!Vt){const He=Gt.length>0?Gt.map(Qe=>({host:Qe.host,port:Qe.port,username:Qe.username||"",password:Qe.password||""})):void 0,qe=await fh(r.id,He);lt(qe),qe!=null&&qe.installed&&qe!=null&&qe.ready}}},Nn=async ve=>{if(r!=null&&r.id)try{const He=await My({service_id:r.id,pod_name:ve});I(qe=>qe.map(Qe=>Qe.name===ve?{...Qe,events:He.events}:Qe))}catch(He){}},Ka=async()=>{var He,qe;if(!r||!$)return;const ve=Gt.length>0?Gt:va();if(ve.length===0&&la()){O.warn("SSH credentials not found for logs, showing credential modal",{serviceId:r.id,podName:$},"ImprovedOperateModal","handleGetLogs"),dt(!0),Jt(!0);return}j(!0),u(`ë¡œê·¸ ì¡°íšŒ ì¤‘...
`);try{const Qe=r.namespace||"default",mt=await ze.kubernetes.request("getPodLogs",{namespace:Qe,pod_name:$,hops:ve,lines:100});if((He=mt.data)!=null&&He.data){const Ae=mt.data.data;u(Ae.logs||"ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.")}else u(`ì˜¤ë¥˜: ${((qe=mt.data)==null?void 0:qe.error)||"ë¡œê·¸ ì¡°íšŒ ì‹¤íŒ¨"}`)}catch(Qe){u(`ì˜¤ë¥˜ ë°œìƒ: ${Qe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`),O.error("Failed to get pod logs",Qe,{serviceId:r.id,podName:$,hopsCount:ve.length},"ImprovedOperateModal","handleGetLogs")}finally{j(!1)}},Ii=async()=>{var He;if(!or||!yn)return;if(rs.length===0){O.warn("SSH credentials not found for Docker logs, showing credential modal",{dockerServerId:or,selectedContainer:yn},"ImprovedOperateModal","handleGetDockerLogs"),Jt(!0);return}j(!0),u(`ë¡œê·¸ ì¡°íšŒ ì¤‘...
`);const ve=xr()?"docker":"podman";try{const qe=await Tg(or,yn,{hops:rs},100,ve),Qe=qe.data;O.debug("Docker logs result",{hasData:!!qe.data,hasLogs:!!(Qe!=null&&Qe.logs),logsLength:(He=Qe==null?void 0:Qe.logs)==null?void 0:He.length,success:qe.success},"ImprovedOperateModal","handleGetDockerLogs"),Qe!=null&&Qe.logs?u(Qe.logs):qe.error?u(`ì˜¤ë¥˜: ${qe.error}`):u("ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.")}catch(qe){O.error("Failed to get Docker logs",qe,{dockerServerId:or,containerId:yn},"ImprovedOperateModal","handleGetDockerLogs"),u(`ì˜¤ë¥˜ ë°œìƒ: ${qe.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}finally{j(!1)}},ui=async()=>{var Qe,mt;if(!b.trim()||!r)return;ce(!0);const ve=b.trim(),He=new Date().toLocaleTimeString("ko-KR",{hour12:!1});let qe="";if(_e()){const Ae=D?((Qe=Mr.find(yt=>yt.id===D))==null?void 0:Qe.name)||D.substring(0,12):"í˜¸ìŠ¤íŠ¸";qe=`â”â”â” [${He}] ${Ae} â”â”â”
`}else qe=`â”â”â” [${He}] SSH ëª…ë ¹ ì‹¤í–‰ â”â”â”
`;Z(Ae=>{const yt=Ae.length>0?`
`:"";return Ae+yt+qe+`$ ${ve}
`});try{if(_e()){const Ae=rs.length>0?rs:va();if(Ae.length===0){O.warn("SSH credentials not found for Docker command execution, showing credential modal",{serviceId:r.id,command:ve},"ImprovedOperateModal","handleExecuteCommand"),Jt(!0),ce(!1);return}let yt;if(r!=null&&r.gitlab_url){const as=r.gitlab_url.replace(/\/$/,"").split("/");yt=as[as.length-1].replace(".git","")}const Qs=await Lg({hops:Ae,compose_project:yt||""},ve,D||void 0);Qs.success?Z(as=>as+(Qs.output||"")+`
`):Z(as=>as+`ì˜¤ë¥˜: ${Qs.error||"ëª…ë ¹ì–´ ì‹¤í–‰ ì‹¤íŒ¨"}
`)}else{const Ae=Gt.length>0?Gt:va();if(Ae.length===0){O.warn("SSH credentials not found for K8s command execution, showing credential modal",{serviceId:r.id,command:ve},"ImprovedOperateModal","handleExecuteCommand"),dt(!0),Jt(!0),ce(!1);return}const yt=await ze.kubernetes.request("executeCommand",{command:ve,hops:Ae,namespace:r.namespace||"default"});if((mt=yt.data)!=null&&mt.data){const Vs=yt.data.data;Z(Qs=>Qs+(Vs.output||"")+`
`)}else Z(Vs=>{var Qs;return Vs+`ì˜¤ë¥˜: ${((Qs=yt.data)==null?void 0:Qs.error)||"ëª…ë ¹ì–´ ì‹¤í–‰ ì‹¤íŒ¨"}
`})}}catch(Ae){Z(yt=>yt+`ì˜¤ë¥˜ ë°œìƒ: ${Ae.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}
`),f.error("ëª…ë ¹ì–´ ì‹¤í–‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),O.error("Failed to execute command",Ae,{serviceId:r.id,command:ve,infraType:r.infraType},"ImprovedOperateModal","handleExecuteCommand")}finally{ce(!1),A("")}},hi=async ve=>{Dt(ve),Ue(null);const He=Os.find(qe=>{var Qe;return((Qe=qe.metadata)==null?void 0:Qe.name)===ve});if(He){const qe=He.status||{};nn({replicas:qe.replicas||0,availableReplicas:qe.availableReplicas||0,updatedReplicas:qe.updatedReplicas||0})}};Ct.useEffect(()=>{Ht&&Ja()},[Ht,N]);const Ti=async()=>{if(!(r!=null&&r.id)){f.error("ì„œë¹„ìŠ¤ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}if(!Ht){f.error("Deploymentë¥¼ ì„ íƒí•˜ì„¸ìš”.");return}ne(!0);try{const ve=await xh({service_id:r.id,deployment_name:Ht,replicas:q});f.success(ve.message||"ìŠ¤ì¼€ì¼ë§ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."),An()}catch(ve){f.error("ìŠ¤ì¼€ì¼ë§ ì‹¤íŒ¨: "+(ve.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}finally{ne(!1)}},Ya=async ve=>{if(!(r!=null&&r.id)){ge([]);return}try{const He=ve&&ve.length>0?ve:Gt.length>0?Gt:void 0,qe=He?He.map(mt=>({host:mt.host,port:mt.port,username:mt.username||"",password:mt.password||""})):void 0,Qe=await wy(r.id,qe);if(Qe&&Qe.items&&Array.isArray(Qe.items)){const mt=Qe.items.map(Ae=>{var yt,Vs,Qs,as,Xs,da,vs,lr,Js,Rs,mr,Qa,Xa,Aa,dl,ul,Zi,ta;return{name:((yt=Ae.metadata)==null?void 0:yt.name)||"",namespace:((Vs=Ae.metadata)==null?void 0:Vs.namespace)||"default",targetRef:`${((as=(Qs=Ae.spec)==null?void 0:Qs.scaleTargetRef)==null?void 0:as.kind)||"Deployment"}/${((da=(Xs=Ae.spec)==null?void 0:Xs.scaleTargetRef)==null?void 0:da.name)||""}`,targetDeployment:((lr=(vs=Ae.spec)==null?void 0:vs.scaleTargetRef)==null?void 0:lr.name)||"",minReplicas:((Js=Ae.spec)==null?void 0:Js.minReplicas)||0,maxReplicas:((Rs=Ae.spec)==null?void 0:Rs.maxReplicas)||0,currentReplicas:((mr=Ae.status)==null?void 0:mr.currentReplicas)||0,targetCPU:((Qa=Ae.spec)==null?void 0:Qa.targetCPUUtilizationPercentage)||((Zi=(ul=(dl=(Aa=(Xa=Ae.spec)==null?void 0:Xa.metrics)==null?void 0:Aa[0])==null?void 0:dl.resource)==null?void 0:ul.target)==null?void 0:Zi.averageUtilization),currentCPU:(ta=Ae.status)==null?void 0:ta.currentCPUUtilizationPercentage}});ge(mt)}else ge([])}catch(He){ge([])}},Ja=async()=>{if(!(r!=null&&r.id)||!Ht){Ue(null);return}const ve=N.find(He=>He.targetDeployment===Ht);Ue(ve||null)},Za=async ve=>{if(!(r!=null&&r.id)){f.error("ì„œë¹„ìŠ¤ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}if(!Ht){f.error("Deploymentë¥¼ ì„ íƒí•˜ì„¸ìš”.");return}je(!0);try{const He=await Sy({service_id:r.id,deployment_name:Ht,min_replicas:ve.minReplicas,max_replicas:ve.maxReplicas,target_cpu_percent:ve.targetCPU});f.success(He.message||"HPAê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."),F(!1),Ja()}catch(He){f.error("HPA ìƒì„± ì‹¤íŒ¨: "+(He.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}finally{je(!1)}},Vi=async ve=>{if(!(r!=null&&r.id)){f.error("ì„œë¹„ìŠ¤ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}je(!0);try{const He=await vy({service_id:r.id,hpa_name:ve});f.success(He.message||"HPAê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),await Ja()}catch(He){const qe=He.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";He.code==="NOT_FOUND"||qe.includes("ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤")?f.warning(qe):f.error("HPA ì‚­ì œ ì‹¤íŒ¨: "+qe),await Ja()}finally{je(!1)}},Io=async ve=>{if(!(r!=null&&r.id)){f.error("ì„œë¹„ìŠ¤ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}try{const He=Gt.length>0?Gt.map(Qe=>({host:Qe.host,port:Qe.port||22,username:Qe.username||"",password:Qe.password||""})):void 0,qe=await mh({service_id:r.id,pod_name:ve,hops:He});f.success((qe.message||"Podê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")+" ì ì‹œ í›„ í™”ë©´ì„ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤..."),await new Promise(Qe=>setTimeout(Qe,2e3)),await An()}catch(He){f.error("Pod ì‚­ì œ ì‹¤íŒ¨: "+(He.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}},To=async()=>{if(!(r!=null&&r.id)){f.error("ì„œë¹„ìŠ¤ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const ve=P.filter(Ae=>Ae.status.toLowerCase()==="pending");if(ve.length===0){f.warning("ì‚­ì œí•  Pending ìƒíƒœì˜ Podê°€ ì—†ìŠµë‹ˆë‹¤.");return}const He=Gt.length>0?Gt.map(Ae=>({host:Ae.host,port:Ae.port||22,username:Ae.username||"",password:Ae.password||""})):void 0,qe=f.loading({content:`${ve.length}ê°œì˜ Pending Podë¥¼ ì‚­ì œí•˜ëŠ” ì¤‘...`,duration:0,key:"bulk-delete"});let Qe=0,mt=0;try{for(const Ae of ve)try{await mh({service_id:r.id,pod_name:Ae.name,hops:He}),Qe++}catch(yt){mt++}qe(),mt===0?f.success({content:`${Qe}ê°œì˜ Pending Podë¥¼ ëª¨ë‘ ì‚­ì œí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ í™”ë©´ì„ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤...`,key:"bulk-delete-result",duration:3}):f.warning({content:`${Qe}ê°œ ì„±ê³µ, ${mt}ê°œ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ í™”ë©´ì„ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤...`,key:"bulk-delete-result",duration:3}),await new Promise(Ae=>setTimeout(Ae,3e3)),await An()}catch(Ae){qe(),f.error({content:"Pending Pod ì¼ê´„ ì‚­ì œ ì‹¤íŒ¨: "+(Ae.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"),key:"bulk-delete-error"})}},La=async()=>{if(!(r!=null&&r.id)){f.error("ì„œë¹„ìŠ¤ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}if(!Ht){f.error("Deploymentë¥¼ ì„ íƒí•˜ì„¸ìš”.");return}ne(!0);try{const ve=await xh({service_id:r.id,deployment_name:Ht,replicas:0});f.success("ëª¨ë“  Pod ì œê±° ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ í™”ë©´ì„ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤..."),await new Promise(He=>setTimeout(He,3e3)),await An(),f.success("Pod ì œê±°ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(ve){f.error("ìŠ¤ì¼€ì¼ë§ ì‹¤íŒ¨: "+(ve.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"))}finally{ne(!1)}},Ro=async(ve=!1)=>{if(r!=null&&r.id){if(ve||Ge(!0),_e()){ve||Ge(!1);return}try{const He=await Gd(r.id);ir(He),!ve&&!He.installed&&f.warning("Nginx Ingress Controllerê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.")}catch(He){ir(null)}finally{ve||Ge(!1)}}},qi=()=>{Rr.current&&(clearInterval(Rr.current),Rr.current=null),Ss.current=null,fn(0)};o.useEffect(()=>()=>{qi()},[]);const Gi=ve=>{const He=ve.toLowerCase();return He==="running"?"success":He==="pending"?"warning":He==="failed"||He==="error"?"error":"default"},cl=ve=>{const He=ve.toLowerCase();return He==="running"?e.jsx(Ze,{style:{color:"#52c41a"}}):He==="pending"?e.jsx(Pt,{spin:!0,style:{color:"#faad14"}}):He==="failed"||He==="error"?e.jsx(Es,{style:{color:"#ff4d4f"}}):e.jsx(Yt,{style:{color:"#d9d9d9"}})},pi=()=>e.jsx(tS,{service:r,loading:k,onRefresh:An,isContainerInfra:_e(),isDockerInfra:xr(),isPodmanInfra:en(),containers:Mr,loadingContainers:Xn,dockerSystemInfo:Br,dockerImages:bn,dockerVolumes:Ha,dockerNetworks:wa,deployedImageInfo:Ci,pods:P,deploymentStatus:zr,deploymentDetails:Co,ingressDomains:zn,latestBuildImageTag:ko,resourceInfo:K,loadingResource:te}),Wi=()=>e.jsx(rS,{isContainerInfra:_e(),isDockerInfra:xr(),containers:Mr,selectedContainer:yn,onSelectedContainerChange:cn,loadingContainers:Xn,dockerServerId:or,pods:P,selectedPod:$,onSelectedPodChange:y,logs:v,loadingLogs:m,onGetLogs:_e()?Ii:Ka,onClearLogs:()=>u(""),getPodStatusIcon:cl,getPodStatusColor:Gi}),Ki=()=>e.jsx(nS,{isContainerInfra:_e(),isDockerInfra:xr(),containers:Mr,selectedContainerId:D,onSelectedContainerIdChange:M,commandInput:b,commandOutput:W,executingCommand:se,onCommandInputChange:A,onExecuteCommand:ui,onClearOutput:()=>Z("")}),Yi=async ve=>{if(!c){f.error("ì €ì¥ì†Œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}Ds(!1),Mn("idle");try{Ar(!0),Ur(new Date),ba(void 0),x==null||x("analyzing"),await Xt.dastScanWeb({repo_id:c,target_url:ve.target_url,scan_type:ve.scan_type,options:ve.options}),x==null||x("completed"),f.success("DAST ìŠ¤ìº”ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.")}catch(He){const qe=He instanceof Error?He.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";ba(qe),x==null||x("failed"),f.error(`DAST ìŠ¤ìº” ì‹¤íŒ¨: ${qe}`),O.error("DAST scan failed",He,{repoId:c,params:ve},"ImprovedOperateModal","handleDastScanConfirm")}finally{Ar(!1),Ur(null)}},zc=()=>hn?e.jsx(Ic,{scanType:"dast",visible:hn,onClose:()=>{Ar(!1)},startTime:Fa||void 0,serviceName:(r==null?void 0:r.name)||p}):e.jsx(sS,{repoId:c,repoName:p,service:r,isContainerInfra:_e(),isDockerInfra:xr(),onStartScan:()=>Ds(!0),onScanStateChange:ve=>{Ar(ve==="analyzing")}}),Ri=()=>_e()?e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(xe,{message:"Docker ë°°í¬ ê´€ë¦¬",description:"Docker í™˜ê²½ì—ì„œ ë°°í¬ëœ ì„œë¹„ìŠ¤ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.",type:"info",showIcon:!0,icon:e.jsx(dr,{}),style:{marginBottom:24}}),e.jsxs(ie,{title:"ë°°í¬ ì •ë³´",children:[e.jsxs(Se,{column:1,children:[e.jsx(Se.Item,{label:"ì„œë¹„ìŠ¤ ì´ë¦„",children:(r==null?void 0:r.name)||"-"}),e.jsx(Se.Item,{label:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤",children:(r==null?void 0:r.namespace)||"-"}),e.jsxs(Se.Item,{label:"ì»¨í…Œì´ë„ˆ ê°œìˆ˜",children:[Mr.length,"ê°œ"]})]}),e.jsx("div",{style:{marginTop:16},children:e.jsx("p",{children:"ë°°í¬ íˆìŠ¤í† ë¦¬ ë° ë¡¤ë°± ê¸°ëŠ¥ì€ ì»¨í…Œì´ë„ˆ ëª©ë¡ íƒ­ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."})})]})]}):e.jsx(Qw,{service:r,infraId:i,deployments:Os,selectedDeployment:Ht,onDeploymentChange:hi,deploymentStatus:zr,sshHops:Gt}),Ec=()=>_e()?e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(xe,{message:"Docker ë¦¬ì†ŒìŠ¤ ê´€ë¦¬",description:"Docker í™˜ê²½ì—ì„œëŠ” ì»¨í…Œì´ë„ˆ ë° ì´ë¯¸ì§€ ë¦¬ì†ŒìŠ¤ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.",type:"info",showIcon:!0,icon:e.jsx(rn,{}),style:{marginBottom:24}}),e.jsxs(ie,{title:"ë¦¬ì†ŒìŠ¤ ì •ë³´",children:[e.jsx("p",{children:"Docker ì»¨í…Œì´ë„ˆ ë° ì´ë¯¸ì§€ ë¦¬ì†ŒìŠ¤ëŠ” ì»¨í…Œì´ë„ˆ ëª©ë¡ íƒ­ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),e.jsx("div",{style:{marginTop:16},children:e.jsxs("p",{children:[e.jsx("strong",{children:"í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ:"})," ",Mr.length,"ê°œ"]})})]})]}):e.jsx(Yw,{service:r}),Pc=()=>_e()?e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(xe,{message:`${xr()?"Docker":"Podman"} ìš´ì˜ ê´€ë¦¬`,description:`${xr()?"Docker":"Podman"} í™˜ê²½ì—ì„œì˜ ìš´ì˜ ê´€ë¦¬ ê¸°ëŠ¥ì…ë‹ˆë‹¤.`,type:"info",showIcon:!0,icon:e.jsx(fa,{}),style:{marginBottom:24}}),e.jsxs(ie,{title:"ìš´ì˜ ì •ë³´",children:[e.jsx("p",{children:"Docker í™˜ê²½ì—ì„œëŠ” Kubernetes í´ëŸ¬ìŠ¤í„° ìš´ì˜ ê¸°ëŠ¥ì´ ì ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤."}),e.jsx("p",{children:"ì»¨í…Œì´ë„ˆ ê´€ë¦¬ ê¸°ëŠ¥ì€ ì»¨í…Œì´ë„ˆ ëª©ë¡ íƒ­ì—ì„œ ì´ìš©í•˜ì„¸ìš”."})]})]}):e.jsx(Jw,{service:r,infraId:i,hops:va(),onOverviewDataRefresh:An}),Mc=async()=>{if(rs.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}Ls(!0);try{const ve=en()?"podman":"docker",He=await Rg({hops:rs},ve);De(He),f.success("ì»¨í…Œì´ë„ˆ í†µê³„ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.")}catch(ve){O.error("Failed to load container stats",ve,{},"ImprovedOperateModal","loadAllContainerStats"),f.error("ì»¨í…Œì´ë„ˆ í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{Ls(!1)}},Ji=async()=>{if(rs.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}Ma(!0);try{const ve=en()?"podman":"docker",He=await zg({hops:rs},ve);Ln(He)}catch(ve){O.error("Failed to load Docker system info",ve,{},"ImprovedOperateModal","loadDockerSystemInfo"),f.error("Docker ì‹œìŠ¤í…œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{Ma(!1)}},Lc=async(ve,He)=>{if(rs.length===0||!or){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}qa(ve);try{const qe=en()?"podman":"docker";await Ig(or,ve,"restart",{hops:rs},qe),f.success(`ì»¨í…Œì´ë„ˆ "${He}"ì´(ê°€) ì¬ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.`)}catch(qe){O.error("Failed to restart container",qe,{containerId:ve},"ImprovedOperateModal","handleContainerRestart"),f.error(`ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${qe instanceof Error?qe.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}finally{qa(null)}},Ac=async ve=>{if(rs.length===0){f.warning("SSH ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}Wr(!0);try{const He=await Sc(ve,{hops:rs});f.success(He.message),at.info({message:"Docker ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì™„ë£Œ",description:He.output?He.output.substring(0,500):"ì •ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",duration:8}),Ji()}catch(He){O.error("Failed to prune Docker resources",He,{pruneType:ve},"ImprovedOperateModal","handlePruneDockerResources"),f.error(`Docker ë¦¬ì†ŒìŠ¤ ì •ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${He instanceof Error?He.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}finally{Wr(!1)}},ca=()=>{const ve=[{key:"overview",label:e.jsxs(g,{children:[e.jsx(ii,{}),e.jsx("span",{children:"ê°œìš”"})]}),children:pi()}],He=[{key:"pods",label:e.jsxs(g,{children:[e.jsx(_t,{}),e.jsx("span",{children:"íŒŒë“œ ëª©ë¡"}),P.length>0&&e.jsx(T,{color:"blue",children:P.length})]}),children:e.jsx(Gw,{pods:P,deployments:Os,selectedDeployment:Ht,deploymentStatus:zr,scalingReplicas:q,scalingLoading:be,hpaData:ye,hpaList:N,loadingHPA:Ce,showHPAForm:V,metricsServerStatus:Vt,metricsServerDiagnostics:Rt,loadingMetricsStatus:ms,installingMetrics:ds,showDiagnostics:Cs,deployedImageInfo:Ci,onDeploymentChange:hi,onScaleDeployment:Ti,onScaleToZero:La,onSetScalingReplicas:oe,onCreateHPA:Za,onDeleteHPA:Vi,onSetShowHPAForm:F,onLoadHPA:Ja,onDeletePod:Io,onBulkDeletePendingPods:To,onCheckMetricsServerStatus:ut,onInstallMetricsServer:$t,onCleanMetricsServerNode:Hr,onSetShowDiagnostics:gr,onLoadPodDetails:Nn})},{key:"deployment",label:e.jsxs(g,{children:[e.jsx(dr,{}),e.jsx("span",{children:"ë°°í¬ ê´€ë¦¬"})]}),children:Ri()},{key:"resources",label:e.jsxs(g,{children:[e.jsx(Cn,{}),e.jsx("span",{children:"ë¦¬ì†ŒìŠ¤ í˜„í™©"})]}),children:Ec()},{key:"k8sops",label:e.jsxs(g,{children:[e.jsx(fa,{}),e.jsx("span",{children:"ìš´ì˜ ê´€ë¦¬"})]}),children:Pc()}],qe=[{key:"containers",label:e.jsxs(g,{children:[e.jsx(_t,{}),e.jsx("span",{children:"ì»¨í…Œì´ë„ˆ ëª©ë¡"}),Mr.length>0&&e.jsx(T,{color:"blue",children:Mr.length})]}),children:e.jsx(Fw,{containers:Mr,loadingContainers:Xn,allContainerStats:me,loadingAllStats:zt,containerActionLoading:li,onLoadStats:Mc,onRefresh:z,onContainerRestart:Lc})},{key:"deployment",label:e.jsxs(g,{children:[e.jsx(dr,{}),e.jsx("span",{children:"ë°°í¬ ê´€ë¦¬"})]}),children:e.jsx(Hw,{service:r,containerCount:Mr.length,containers:Mr,dockerImages:bn,isDockerInfra:xr()})},{key:"dockerops",label:e.jsxs(g,{children:[e.jsx(fa,{}),e.jsx("span",{children:"ìš´ì˜ ê´€ë¦¬"})]}),children:e.jsx(Uw,{pruningResources:jr,onPruneResources:Ac,isDockerInfra:xr()})}],Qe=[{key:"logs",label:e.jsxs(g,{children:[e.jsx(Fr,{}),e.jsx("span",{children:"ë¡œê·¸ ì¡°íšŒ"})]}),children:Wi()},{key:"execute",label:e.jsxs(g,{children:[e.jsx(Jn,{}),e.jsx("span",{children:"ëª…ë ¹ ì‹¤í–‰"})]}),children:Ki()},{key:"domainsettings",label:e.jsxs(g,{children:[e.jsx(rn,{}),e.jsx("span",{children:"ë„ë©”ì¸ ì„¤ì •"})]}),children:e.jsx(jS,{service:r,infraId:_e()?or:void 0,serverHops:_e()?rs:[],isContainerInfra:_e(),isDockerInfra:xr()})},{key:"dast",label:e.jsxs(g,{children:[e.jsx(ur,{}),e.jsx("span",{children:"ë„ë©”ì¸ ê²€ì‚¬"}),d==="analyzing"&&e.jsx(T,{color:"processing",children:"ì§„í–‰ì¤‘"}),d==="completed"&&e.jsx(T,{color:"success",children:"ì™„ë£Œ"}),d==="failed"&&e.jsx(T,{color:"error",children:"ì‹¤íŒ¨"})]}),children:zc()}];return _e()?[...ve,...qe,...Qe]:[...ve,...He,...Qe]};return e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(ii,{style:{fontSize:24,color:"#1890ff"}}),e.jsx(bS,{level:4,style:{margin:0},children:"ì„œë¹„ìŠ¤ ìš´ì˜ ê´€ë¦¬"})]}),open:s,onCancel:t,width:1400,footer:[e.jsx(B,{onClick:t,children:"ë‹«ê¸°"},"close")],destroyOnClose:!0,style:{top:20},children:[Xn&&_e()&&e.jsx(xe,{message:"SSH ì—°ê²° ì¤‘",description:"ì„œë²„ì— SSHë¡œ ì—°ê²°í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...",type:"info",showIcon:!0,icon:e.jsx(gt,{size:"small"}),style:{marginBottom:16},closable:!1}),k&&la()&&e.jsx(xe,{message:"SSH ì—°ê²° ì¤‘",description:"ì„œë²„ì— SSHë¡œ ì—°ê²°í•˜ì—¬ Pod ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...",type:"info",showIcon:!0,icon:e.jsx(gt,{size:"small"}),style:{marginBottom:16},closable:!1}),e.jsx(xs,{activeKey:S,onChange:L,items:ca()}),e.jsx(Hi,{visible:ys,onClose:()=>Jt(!1),onComplete:Re,hops:an.map(ve=>({...ve,username:ve.username||""})),infraId:i,serviceId:r==null?void 0:r.id,serviceName:r==null?void 0:r.name,isRetry:un}),e.jsx(ku,{visible:ns,onClose:()=>{Ds(!1),Mn("idle"),ba(void 0)},onConfirm:Yi,loading:hn,serviceId:r==null?void 0:r.id,infraType:xr()?"docker":en()?"podman":"kubernetes",scanStatus:Nr,scanError:jn}),e.jsx(rt,{title:ot,open:Fe,onCancel:()=>Le(!1),onOk:()=>Le(!1),okText:"ë‹«ê¸°",cancelButtonProps:{style:{display:"none"}},width:800,children:Ve?e.jsx("div",{style:{textAlign:"center",padding:"40px"},children:e.jsx(gt,{tip:"YAMLì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{message:"YAML ì¡°íšŒ",description:"Kubernetes ë¦¬ì†ŒìŠ¤ YAML ë‚´ìš©ì…ë‹ˆë‹¤. (ì½ê¸° ì „ìš©)",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(ue.TextArea,{value:Oe,readOnly:!0,autoSize:{minRows:20,maxRows:30},style:{fontFamily:"monospace",fontSize:12}})]})})]})},{Text:Is}=we,{TabPane:Vl}=xs,wS=({repoId:s,repoName:t="ì €ì¥ì†Œ",repoUrl:r,serviceId:n,onScanStateChange:a,scaResult:i,loading:l,showTabs:d=!0})=>{const[c,p]=o.useState(!1),[h,x]=o.useState(null),[_,S]=o.useState([]),[L,k]=o.useState(null),[E,P]=o.useState(null),[I,$]=o.useState(!1),[y,v]=o.useState(!1),[u,m]=o.useState(null),[j,b]=o.useState([]),[A,W]=o.useState("checklist"),[Z,se]=o.useState(void 0),{updateSecurityState:ce,updateSecurityLastUpdate:D}=Gs(),M=l!==void 0?l:c,K=i!==void 0?i:h;o.useEffect(()=>{(async()=>{if(n)try{const U=await vo(n);if(U.registry_config){const V=JSON.parse(U.registry_config);se({registry_type:V.registry_type==="dockerhub"?"dockerhub":"harbor",registry_url:V.registry_url||"",username:V.username||"",password:V.password||"",project_name:V.project_name||""})}}catch(U){console.error("Registry config ì¡°íšŒ ì‹¤íŒ¨:",U)}})()},[n]);const J=R=>{const U=(R==null?void 0:R.toLowerCase())||"";return U==="critical"?"critical":U==="high"?"high":U==="medium"||U==="moderate"?"medium":"low"},te=o.useCallback(R=>{var V,F;const U=R.result;if(U&&U.tool==="trivy"&&((V=U.result)!=null&&V.scan_result)){const X=U.result.scan_result;let de=[];X.results&&Array.isArray(X.results)&&X.results.forEach(ae=>{ae.vulnerabilities&&Array.isArray(ae.vulnerabilities)&&(de=de.concat(ae.vulnerabilities.map(pe=>({name:pe.pkg_name,version:pe.installed_version,severity:J(pe.severity),description:pe.description,cve:pe.vulnerability_id,fix_available:!!pe.fixed_version,fixed_version:pe.fixed_version,references:pe.references}))))});const Ne={critical:de.filter(ae=>{var pe;return((pe=ae.severity)==null?void 0:pe.toLowerCase())==="critical"}).length,high:de.filter(ae=>{var pe;return((pe=ae.severity)==null?void 0:pe.toLowerCase())==="high"}).length,medium:de.filter(ae=>ae.severity==="medium").length,low:de.filter(ae=>ae.severity==="low").length};return{tool:U.tool,vulnerabilities:de,dependencies:[],summary:{total_vulnerabilities:de.length,total_dependencies:0,severity_breakdown:Ne,scan_time:((F=U.summary)==null?void 0:F.scan_time)||0},artifact_name:X.artifact_name,artifact_type:X.artifact_type,execution_log:R.execution_log||{log_messages:[],total_duration:0},scan_date:R.scan_date}}return null},[]),G=o.useCallback(async(R=null)=>{if(i===void 0&&s){p(!0),P(null);try{const U=await Xt.getScaResults(s,50),V=(U==null?void 0:U.data)||U;if(V.status==="not_found"||!V.results||V.results.length===0){S([]),x(null),k(null),P("ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),a==null||a("sca","idle"),r&&ce(r,"sca","idle");return}if(V.status==="completed"&&V.results&&V.results.length>0){const F=[];for(const ae of V.results){const pe=te(ae);pe&&F.push(pe)}if(F.length===0){S([]),x(null),k(null),P("ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}F.sort((ae,pe)=>{const Xe=new Date(ae.scan_date||0).getTime();return new Date(pe.scan_date||0).getTime()-Xe});const X=new Map;F.forEach(ae=>{const pe=ae.artifact_name||"unknown";X.has(pe)||X.set(pe,ae)});const de=Array.from(X.values()).sort((ae,pe)=>{const Xe=new Date(ae.scan_date||0).getTime();return new Date(pe.scan_date||0).getTime()-Xe});S(de);const Ne=de[0].artifact_name;if(!R||!X.has(R))k(Ne),x(de[0]);else{const ae=X.get(R);x(ae||de[0])}if(a==null||a("sca","completed"),r){ce(r,"sca","completed");const ae=de[0].scan_date;ae&&D(r,"sca",ae)}}else S([]),x(null),k(null),P("ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}catch(U){const V=U instanceof Error?U.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";P(`ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${V}`)}finally{p(!1)}}},[s,i,a,r,te,ce,D]),q=o.useRef(null),oe=o.useRef(null);o.useEffect(()=>{s&&i===void 0&&s!==q.current&&(q.current=s,G(null))},[s,i]),o.useEffect(()=>{(async()=>{if(s)try{const F=(await Su(s)).sort((X,de)=>{const Ne=new Date(X.build_date||0).getTime();return new Date(de.build_date||0).getTime()-Ne}).slice(0,100);b(F)}catch(U){b([])}})()},[s]);const be=o.useCallback(R=>{m(R||null),v(!0)},[]),ne=o.useCallback(async R=>{if(v(!1),!!s)try{if($(!0),a==null||a("sca","analyzing"),r&&ce(r,"sca","analyzing"),await Xt.trivyScanImage({repo_id:s,image_url:R.image_url,scan_type:R.scan_type||"vuln",registry_username:R.registry_username,registry_password:R.registry_password}),R.generate_sbom)try{await Xt.generateImageSbom({repo_id:s,image_url:R.image_url,license_analysis:R.license_analysis||!1,registry_username:R.registry_username,registry_password:R.registry_password}),f.success("SBOMì´ ìë™ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(U){const V=U instanceof Error?U.message:"SBOM ìƒì„± ì„œë¹„ìŠ¤ ì˜¤ë¥˜";console.error("[SBOM] Generation failed:",V),f.warning(`SBOM ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${V}`)}k(R.image_url),await new Promise(U=>setTimeout(U,1e3)),await G(R.image_url),a==null||a("sca","completed"),r&&(ce(r,"sca","completed"),D(r,"sca",new Date().toISOString())),f.success("ì´ë¯¸ì§€ ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(U){a==null||a("sca","failed"),r&&ce(r,"sca","failed"),f.error("ì´ë¯¸ì§€ ë¶„ì„ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{$(!1)}},[s,G,a,ce,D,r]),ye=o.useCallback((R,U=!1)=>{k(R);const V=_.find(F=>F.artifact_name===R);V?(x(V),U&&oe.current&&setTimeout(()=>{var F;(F=oe.current)==null||F.scrollIntoView({behavior:"smooth",block:"start"})},100)):console.warn("[DEBUG handleImageSelect]  ì„ íƒí•œ ì´ë¯¸ì§€ì˜ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ:",R)},[_]),Ue=o.useCallback(R=>{be(R)},[be]),N=o.useCallback(R=>_.some(V=>V.artifact_name===R),[_]),ge=o.useCallback(R=>_.find(U=>U.artifact_name===R),[_]),Ce=o.useCallback(()=>{var X;if(!(K!=null&&K.vulnerabilities))return{severity:{critical:0,high:0,medium:0,low:0},total:0,packageCount:{},hotSpots:[]};const R=((X=K.summary)==null?void 0:X.severity_breakdown)||{critical:0,high:0,medium:0,low:0},U=Object.values(R).reduce((de,Ne)=>de+Number(Ne),0),V={};K.vulnerabilities.forEach(de=>{const Ne=de.name||"unknown";V[Ne]=(V[Ne]||0)+1});const F=Object.entries(V).sort((de,Ne)=>Ne[1]-de[1]).slice(0,5).map(([de,Ne])=>({package:de,count:Ne}));return{severity:R,total:U,packageCount:V,hotSpots:F}},[K]),je=()=>{const{hotSpots:R}=Ce();return e.jsxs(e.Fragment,{children:[e.jsx(ie,{title:e.jsx(Is,{strong:!0,style:{fontSize:"15px"},children:"Hot Spots (ê°€ì¥ ì·¨ì•½í•œ íŒ¨í‚¤ì§€ TOP 5)"}),size:"small",style:{marginBottom:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",borderRadius:"8px"},children:R.length>0?e.jsx("div",{children:R.map(({package:U,count:V},F)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",background:F%2===0?"#fafafa":"#ffffff",borderRadius:"4px",marginBottom:"8px",border:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[e.jsxs(T,{color:F===0?"red":F===1?"orange":F===2?"gold":"default",style:{fontWeight:"bold",minWidth:"32px",textAlign:"center"},children:["#",F+1]}),e.jsx(Is,{style:{flex:1,fontSize:"13px"},ellipsis:{tooltip:U},children:U})]}),e.jsxs(T,{color:"red",style:{fontSize:"14px",fontWeight:"bold",padding:"4px 12px",borderRadius:"4px"},children:[V," ê±´"]})]},U))}):e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsx(Is,{type:"secondary",children:"Hot Spots ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"})})}),(K==null?void 0:K.artifact_name)&&e.jsx(ie,{title:e.jsx(Is,{strong:!0,style:{fontSize:"15px"},children:"ìŠ¤ìº” ëŒ€ìƒ ì´ë¯¸ì§€"}),size:"small",style:{marginBottom:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",borderRadius:"8px"},children:e.jsxs("div",{style:{padding:8},children:[e.jsx(Is,{strong:!0,children:"ì´ë¯¸ì§€: "}),e.jsx(Is,{copyable:!0,children:K.artifact_name}),e.jsx("br",{}),e.jsx(Is,{strong:!0,children:"íƒ€ì…: "}),e.jsx(Is,{children:K.artifact_type||"container_image"})]})})]})},Pe=()=>{if(!(K!=null&&K.vulnerabilities))return e.jsx(xe,{message:"ìƒì„¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.",type:"warning"});const R=K.vulnerabilities;return e.jsx("div",{children:R.length===0?e.jsx(xe,{message:"ë°œê²¬ëœ ì·¨ì•½ì  ì—†ìŒ",description:"ë¶„ì„ ê²°ê³¼ ë³´ì•ˆ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.",type:"success",showIcon:!0,icon:e.jsx(Ze,{}),style:{marginBottom:yr.lg,borderRadius:ma.lg,border:"2px solid #b7eb8f"}}):e.jsx("div",{style:{maxHeight:"600px",overflow:"auto",paddingRight:"8px"},children:R.map((U,V)=>{var Ne;const F=U,X=Iu(F.severity),de=ra[X];return e.jsx(ie,{size:"small",style:Si.vulnerabilityDetail(X),styles:{header:Si.vulnerabilityDetailHeader(X),body:{padding:yr.lg}},title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:yr.sm},children:[e.jsxs(g,{size:yr.sm,children:[e.jsx("div",{style:{width:24,height:24,borderRadius:"50%",background:de.primary,color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:"bold"},children:V+1}),e.jsx(T,{color:Tu(X),style:{margin:0},children:Rc[X]}),e.jsx(Is,{strong:!0,style:{fontSize:14},children:F.cve||F.name})]}),e.jsx(g,{size:4,children:(Ne=F.cwe_ids)==null?void 0:Ne.slice(0,1).map((ae,pe)=>e.jsx(T,{color:"volcano",style:{margin:0},children:ae},pe))})]}),children:e.jsxs(g,{direction:"vertical",size:yr.md,style:{width:"100%"},children:[F.description&&e.jsx(Is,{style:{fontSize:13,color:"#595959",display:"block",lineHeight:1.6},children:F.description}),e.jsxs(Se,{size:"small",column:2,children:[e.jsx(Se.Item,{label:e.jsxs(g,{children:[e.jsx(mn,{}),"íŒ¨í‚¤ì§€"]}),children:e.jsx(Is,{strong:!0,children:F.name})}),F.version&&e.jsx(Se.Item,{label:"ì„¤ì¹˜ ë²„ì „",children:e.jsx(Is,{code:!0,children:F.version})}),F.fix_available&&F.fixed_version&&e.jsx(Se.Item,{label:"ìˆ˜ì • ë²„ì „",children:e.jsx(Is,{code:!0,style:{color:"#52c41a"},children:F.fixed_version})})]}),F.references&&F.references.length>0&&e.jsx(nr,{ghost:!0,expandIcon:({isActive:ae})=>e.jsx(yc,{rotate:ae?90:0,style:{fontSize:10}}),items:[{key:"1",label:e.jsxs(g,{children:[e.jsx(Ea,{}),e.jsxs(Is,{style:{fontSize:13},children:["ì°¸ê³  ë§í¬ (",F.references.length,")"]})]}),children:e.jsxs("div",{children:[F.references.slice(0,3).map((ae,pe)=>e.jsx("a",{href:ae,target:"_blank",rel:"noopener noreferrer",style:{display:"block",fontSize:12,marginBottom:4},children:ae.length>60?`${ae.substring(0,60)}...`:ae},pe)),F.references.length>3&&e.jsxs(Is,{type:"secondary",style:{fontSize:11},children:["ì™¸ ",F.references.length-3,"ê°œ"]})]})}]})]})},V)})})})},w=()=>{var U,V;const R=K==null?void 0:K.execution_log;return e.jsx(ie,{title:"ì´ë¯¸ì§€ ë¶„ì„ ì‹¤í–‰ ë¡œê·¸",size:"small",children:e.jsx("div",{style:{maxHeight:400,overflowY:"auto",backgroundColor:"#1e1e1e",padding:"16px",borderRadius:"4px",fontFamily:'Monaco, Menlo, "Ubuntu Mono", Consolas, "source-code-pro", monospace',fontSize:"12px",lineHeight:1.5,color:"#d4d4d4"},children:(U=R==null?void 0:R.trivy_scan)!=null&&U.log_messages?e.jsxs("div",{children:[e.jsx(Is,{strong:!0,style:{color:"#fa8c16",display:"block",marginBottom:"8px"},children:"Trivy ìŠ¤ìº”:"}),R.trivy_scan.log_messages.map((F,X)=>e.jsx("pre",{style:{margin:0,marginBottom:4},children:F},X))]}):(V=R==null?void 0:R.full_execution_log)!=null&&V.log_messages?e.jsxs("div",{children:[e.jsx(Is,{strong:!0,style:{color:"#722ed1",display:"block",marginBottom:"8px"},children:"ì‹¤í–‰ ë¡œê·¸:"}),R.full_execution_log.log_messages.map((F,X)=>e.jsx("pre",{style:{margin:0,marginBottom:4},children:F},X))]}):e.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#888"},children:e.jsx(Is,{type:"secondary",style:{color:"#888"},children:"ì‹¤í–‰ ë¡œê·¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})})})})};return e.jsxs("div",{style:{padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[e.jsx(bi,{style:{color:"#1890ff",fontSize:"18px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:"ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼"})]}),j.length>0&&e.jsx(nr,{style:{marginBottom:16},items:[{key:"built-images",label:e.jsxs(g,{children:[e.jsx(Qr,{style:{color:"#1890ff"}}),e.jsx(Is,{strong:!0,children:"ë¹Œë“œëœ ì´ë¯¸ì§€ ëª©ë¡"}),e.jsxs(T,{color:"blue",children:[j.length,"ê°œ"]})]}),children:e.jsxs("div",{children:[e.jsx(xe,{message:"ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì—¬ ì·¨ì•½ì  ìŠ¤ìº”ì„ ì‹¤í–‰í•˜ì„¸ìš”",description:"ë¹Œë“œëœ ëª¨ë“  ì´ë¯¸ì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤. ìŠ¤ìº” ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì·¨ì•½ì  ë¶„ì„ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(ar,{size:"small",dataSource:j.slice(0,20),style:{maxHeight:400,overflow:"auto"},renderItem:R=>{var X;const U=N(R.image_url),V=U?ge(R.image_url):null,F=((X=V==null?void 0:V.vulnerabilities)==null?void 0:X.length)||0;return e.jsx(ar.Item,{style:{padding:"12px 16px",background:U?"#f6ffed":"#fafafa",marginBottom:8,borderRadius:6,border:U?"1px solid #b7eb8f":"1px solid #e8e8e8"},actions:[e.jsx(B,{type:U?"default":"primary",size:"small",icon:e.jsx($d,{}),onClick:()=>Ue(R.image_url),loading:I,disabled:I,children:U?"ì¬ìŠ¤ìº”":"ìŠ¤ìº”"},"scan"),U&&e.jsx(B,{type:"link",size:"small",onClick:()=>ye(R.image_url,!0),children:"ê²°ê³¼ ë³´ê¸°"},"view")].filter(Boolean),children:e.jsx(ar.Item.Meta,{avatar:e.jsx(Qr,{style:{fontSize:24,color:U?"#52c41a":"#1890ff"}}),title:e.jsxs(g,{size:"small",wrap:!0,children:[e.jsx(Ie,{title:R.image_url,children:e.jsx(Is,{style:{fontFamily:"monospace",fontSize:12,maxWidth:400},ellipsis:!0,copyable:{text:R.image_url},children:R.image_url})}),U&&e.jsx(T,{color:"green",icon:e.jsx(Ze,{}),children:"ìŠ¤ìº” ì™„ë£Œ"}),U&&F>0&&e.jsxs(T,{color:F>10?"red":F>5?"orange":"gold",children:["ì·¨ì•½ì  ",F,"ê°œ"]})]}),description:e.jsxs(g,{size:"middle",children:[e.jsxs(Is,{type:"secondary",style:{fontSize:11},children:[e.jsx(wr,{style:{marginRight:4}}),"ë¹Œë“œ:"," ",hr(R.build_date).format("YYYY-MM-DD HH:mm")]}),(V==null?void 0:V.scan_date)&&e.jsxs(Is,{type:"secondary",style:{fontSize:11},children:[e.jsx($d,{style:{marginRight:4}}),"ìŠ¤ìº”:"," ",hr(V.scan_date).format("YYYY-MM-DD HH:mm")]})]})})})},footer:j.length>20&&e.jsx("div",{style:{textAlign:"center",padding:"8px"},children:e.jsxs(Is,{type:"secondary",children:["+ ",j.length-20,"ê°œ ì´ë¯¸ì§€ ë” ìˆìŒ (ëª¨ë‹¬ì—ì„œ í™•ì¸ ê°€ëŠ¥)"]})})})]})}]}),e.jsx("div",{ref:oe,children:M?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px",fontSize:"16px",color:"#666"},children:"ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."})]}):I&&!K?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px",fontSize:"16px",color:"#1890ff"},children:"ì´ë¯¸ì§€ ë¶„ì„ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤..."}),e.jsx("p",{style:{marginTop:"8px",fontSize:"14px",color:"#666"},children:"ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”. ìŠ¤ìº”ì´ ì™„ë£Œë˜ë©´ ìë™ìœ¼ë¡œ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤."})]}):E?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#ff4d4f"},children:[e.jsx(bi,{style:{fontSize:"48px",marginBottom:"16px"}}),e.jsx("p",{style:{fontSize:"16px",margin:0},children:E})]}):K?e.jsxs("div",{children:[null,I&&K&&e.jsx(Ru,{scanType:"sca",targetName:L||void 0}),e.jsxs(zu,{isScanning:I,children:[L&&e.jsx(ie,{size:"small",style:{marginBottom:16,background:"linear-gradient(135deg, #f0f5ff 0%, #e6f7ff 100%)",border:"1px solid #91d5ff"},children:e.jsxs(g,{children:[e.jsx(Qr,{style:{fontSize:18,color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx(Is,{strong:!0,children:"ë¶„ì„ ëŒ€ìƒ ì´ë¯¸ì§€"}),e.jsx("br",{}),e.jsx(Is,{style:{fontFamily:"monospace",fontSize:12},copyable:{text:L},children:L}),(K==null?void 0:K.scan_date)&&e.jsxs(Is,{type:"secondary",style:{marginLeft:12,fontSize:11},children:[e.jsx(wr,{style:{marginRight:4}}),"ìŠ¤ìº”:"," ",hr(K.scan_date).format("YYYY-MM-DD HH:mm")]})]})]})}),d?e.jsxs(xs,{activeKey:A,onChange:R=>W(R),style:{marginBottom:16},children:[e.jsxs(Vl,{tab:e.jsxs("span",{children:[e.jsx(bc,{style:{marginRight:6}}),"ì·¨ì•½ì  ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜"]}),children:[e.jsx(xe,{type:"info",showIcon:!0,icon:e.jsx(Ks,{}),style:{marginBottom:16,borderRadius:8},message:e.jsx("span",{style:{fontWeight:600},children:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì·¨ì•½ì  ë¶„ì„ (SCA)"}),description:e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{marginBottom:12,color:"#666"},children:"CVE(Common Vulnerabilities and Exposures) ê¸°ë°˜ì˜ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë³´ì•ˆ ì·¨ì•½ì  ë¶„ë¥˜ì…ë‹ˆë‹¤. Trivy ìŠ¤ìºë„ˆë¥¼ í†µí•´ ë°œê²¬ëœ ì·¨ì•½ì ë“¤ì´ ì‹¬ê°ë„ì— ë”°ë¼ ë¶„ë¥˜ë©ë‹ˆë‹¤."}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{style:{color:"#262626"},children:"ì£¼ìš” ì·¨ì•½ì  ìœ í˜•:"}),e.jsx("span",{style:{color:"#666",marginLeft:8},children:"OS íŒ¨í‚¤ì§€, ì• í”Œë¦¬ì¼€ì´ì…˜ ì˜ì¡´ì„±, ë¼ì´ë¸ŒëŸ¬ë¦¬ ì·¨ì•½ì "})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#262626"},children:"ë¶„ì„ ë„êµ¬:"}),e.jsx("span",{style:{color:"#666",marginLeft:8},children:"Trivy (ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì·¨ì•½ì  ìŠ¤ìºë„ˆ)"})]})]})}),e.jsx(Tc,{repoId:s||n||0,analysisType:"sca",selectedImageName:L,onRefresh:G})]},"checklist"),e.jsx(Vl,{tab:e.jsxs("span",{children:[e.jsx(mn,{style:{marginRight:6}}),"ì·¨ì•½ì  ìƒì„¸"]}),children:Pe()},"details"),e.jsxs(Vl,{tab:e.jsxs("span",{children:[e.jsx(pr,{style:{marginRight:6}}),"ë¶„ì„ ì •ë³´"]}),children:[je(),w()]},"info"),e.jsx(Vl,{tab:e.jsxs("span",{children:[e.jsx(ai,{style:{marginRight:6}}),"SBOM / ë¼ì´ì„ ìŠ¤"]}),children:e.jsx(pc,{serviceId:n||s||0,selectedImageName:L,onRefresh:()=>G(),sbomType:"image"})},"sbom")]}):e.jsx("div",{children:je()})]})]}):e.jsx("div",{style:{padding:"40px 20px"},children:e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,imageStyle:{height:80},description:e.jsxs(g,{direction:"vertical",size:"large",style:{width:"100%",maxWidth:"600px",margin:"0 auto"},children:[e.jsxs("div",{children:[e.jsx(Is,{style:{fontSize:"18px",fontWeight:600,display:"block",marginBottom:"8px"},children:"ì´ë¯¸ì§€ ë¶„ì„ì´ ìˆ˜í–‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤"}),e.jsx(Is,{type:"secondary",style:{fontSize:"14px"},children:"ìœ„ì˜ ì´ë¯¸ì§€ ëª©ë¡ì—ì„œ ìŠ¤ìº”í•  ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”"})]}),e.jsx(ie,{size:"small",style:{textAlign:"left",background:"#f6f8fa",border:"1px solid #e8e8e8"},children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsxs(Is,{strong:!0,style:{fontSize:"14px",display:"block",marginBottom:"12px"},children:[e.jsx(bi,{style:{color:"#1890ff",marginRight:"8px"}}),"ì´ë¯¸ì§€ ë¶„ì„ì´ ì œê³µí•˜ëŠ” ì •ë³´:"]}),e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[e.jsx(Ze,{style:{color:"#52c41a",marginRight:"8px",marginTop:"4px"}}),e.jsxs(Is,{style:{fontSize:"13px"},children:[e.jsx(Is,{strong:!0,children:"íŒ¨í‚¤ì§€ ì·¨ì•½ì :"})," ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë‚´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° íŒ¨í‚¤ì§€ì˜ ì•Œë ¤ì§„ ì·¨ì•½ì  íƒì§€"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[e.jsx(Ze,{style:{color:"#52c41a",marginRight:"8px",marginTop:"4px"}}),e.jsxs(Is,{style:{fontSize:"13px"},children:[e.jsx(Is,{strong:!0,children:"ì‹¬ê°ë„ ë¶„ì„:"})," Critical, High, Medium, Low ë“±ê¸‰ë³„ ì·¨ì•½ì  ë¶„ë¥˜"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[e.jsx(Ze,{style:{color:"#52c41a",marginRight:"8px",marginTop:"4px"}}),e.jsxs(Is,{style:{fontSize:"13px"},children:[e.jsx(Is,{strong:!0,children:"ìˆ˜ì • ë°©ì•ˆ:"})," ê° ì·¨ì•½ì ë³„ ìˆ˜ì • ê°€ëŠ¥ ë²„ì „ ë° íŒ¨ì¹˜ ì •ë³´ ì œê³µ"]})]})]})]}),e.jsx(xe,{message:"ê¶Œì¥ì‚¬í•­",description:"ì •ê¸°ì ì¸ ì´ë¯¸ì§€ ë¶„ì„ì„ í†µí•´ ë°°í¬ ì „ ë³´ì•ˆ ì´ìŠˆë¥¼ ì‚¬ì „ì— ë°œê²¬í•˜ê³  í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ„ì˜ 'ë¹Œë“œëœ ì´ë¯¸ì§€ ëª©ë¡'ì—ì„œ ìŠ¤ìº”í•  ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”.",type:"info",showIcon:!0,icon:e.jsx(Yt,{}),style:{marginTop:"8px"}})]})})]})})})}),s&&e.jsx(Bx,{visible:y,onClose:()=>{v(!1),m(null)},onConfirm:ne,loading:I,builtImages:j,registryConfig:Z,defaultImageUrl:u||void 0})]})};function SS({analysisType:s,repoId:t,fetchFn:r,visible:n=!1,autoFetch:a=!0}){const[i,l]=o.useState(!1),[d,c]=o.useState(null),[p,h]=o.useState(null),[x,_]=o.useState(!1),[S,L]=o.useState("idle"),k=o.useCallback(async()=>{if(!t){h("Repository IDê°€ í•„ìš”í•©ë‹ˆë‹¤.");return}l(!0),h(null);try{const u=await r();c(u),L("completed")}catch(u){const m=u instanceof Error?u.message:`${s.toUpperCase()} ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`;h(m),L("failed")}finally{l(!1)}},[t,r,s]),E=o.useCallback(()=>{_(!0),L("analyzing"),h(null)},[]),P=o.useCallback(u=>{_(!1),L("completed"),u&&c(u)},[]),I=o.useCallback(u=>{_(!1),L("failed"),h(u||`${s.toUpperCase()} ìŠ¤ìº” ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`)},[s]),$=o.useCallback(()=>{h(null)},[]),y=o.useCallback(()=>{c(null),L("idle")},[]),v=o.useRef(n);return o.useEffect(()=>{const u=!v.current;v.current=n,n&&u&&a&&!i&&!x&&t&&k()},[n,a,t]),{loading:i,result:d,error:p,isScanning:x,scanState:S,fetchResult:k,startScan:E,completeScan:P,failScan:I,clearError:$,clearResult:y}}function Rp(s){const t={status:"pending",steps:[],errors:[],warnings:[],images:[]};if(!s||s.length===0)return t;const r=s[0],n=s[s.length-1];if(r.timestamp&&n.timestamp)try{const d=new Date(r.timestamp),c=new Date(n.timestamp);if(!isNaN(d.getTime())&&!isNaN(c.getTime())){const p=c.getTime()-d.getTime();p>=0&&(t.duration=Math.floor(p/1e3),t.deployTime=c.toLocaleString("ko-KR"))}}catch(d){console.warn("[deployMetrics] ë°°í¬ ì‹œê°„ ê³„ì‚° ì‹¤íŒ¨:",d)}const a=s.some(d=>d.exit_code===0||d.command.includes("cat docker-compose")||d.output.includes("Docker Compose file updated successfully")?!1:d.error&&d.error.toLowerCase().includes("timeout")||d.output&&d.output.toLowerCase().includes("timed out"));if(s.forEach(d=>{var _,S,L,k,E;const c=d.output+d.error,p=d.exit_code!==0;let h="";try{if(d.timestamp){const P=new Date(d.timestamp);isNaN(P.getTime())||(h=P.toLocaleTimeString())}}catch(P){console.warn("[deployMetrics] íƒ€ì„ìŠ¤íƒ¬í”„ íŒŒì‹± ì‹¤íŒ¨:",P)}if(d.exit_code!==0&&!d.command.includes("cat docker-compose")&&!d.output.includes("Docker Compose file updated successfully")&&(d.error&&d.error.toLowerCase().includes("timeout")||d.output&&d.output.toLowerCase().includes("timed out"))&&t.errors.push(`íƒ€ì„ì•„ì›ƒ ì—ëŸ¬: ${d.error||d.output}`),d.command.includes("which kubectl")&&t.steps.push({name:"kubectl ì„¤ì¹˜ í™•ì¸",status:p?"failed":"success",message:p?"kubectlì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤":"kubectl ì‚¬ìš© ê°€ëŠ¥",timestamp:h}),d.command.includes("git clone")){const P=d.command.match(/git clone (https?:\/\/[^\s]+)/);t.steps.push({name:"ë°°í¬ ì„¤ì • ë‹¤ìš´ë¡œë“œ",status:p?"failed":"success",message:P?`Git: ${(_=P[1].split("/").pop())==null?void 0:_.replace(".git","")}`:"ì†ŒìŠ¤ì½”ë“œ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ",timestamp:h})}if(d.command.includes("docker login")){const P=d.command.match(/docker login ([^\s]+)/),I=P?P[1]:"Registry";t.steps.push({name:"Registry ë¡œê·¸ì¸",status:p?"failed":"success",message:p?"Registry ì¸ì¦ ì‹¤íŒ¨":`${I} ì¸ì¦ ì™„ë£Œ`,timestamp:h})}if(d.command.includes("sed -i")&&d.command.includes("docker-compose.yml")||d.command.includes("update_compose.py")||d.output.includes("Docker Compose file updated successfully")){const P=d.command.match(/sed.*'s\|[^|]*\|image:\s*[^:]+:[^:]+:[^|]*:([^\s|']+)/);if(P&&!P[1].includes("\\")&&(t.imageTag=P[1]),!p&&d.output){const I=d.output.matchAll(/^\s*image:\s*([^\s]+)/gm);for(const $ of I){const y=$[1],v=y.lastIndexOf(":");if(v>0){const u=y.substring(0,v),m=y.substring(v+1);(S=t.images)!=null&&S.some(j=>j.fullPath===y)||(L=t.images)==null||L.push({name:u,tag:m,fullPath:y}),t.imageName||(t.imageName=u,t.imageTag=m)}}}t.steps.push({name:"ë°°í¬ ì„¤ì • ì—…ë°ì´íŠ¸",status:p?"failed":"success",message:p?"docker-compose.yml ìˆ˜ì • ì‹¤íŒ¨":"docker-compose.yml ì—…ë°ì´íŠ¸ ì™„ë£Œ",timestamp:h})}if((d.command.includes("docker-compose pull")||d.command.match(/docker[\s-]+compose.*pull/))&&t.steps.push({name:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ",status:p?"failed":"success",message:p?"ì´ë¯¸ì§€ Pull ì‹¤íŒ¨":"ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ",timestamp:h}),(d.command.includes("docker-compose down")||d.command.includes("docker-compose up"))&&!d.command.includes("ps")){const P=d.command.includes("down"),I=d.command.includes("up");t.steps.push({name:"ì»¨í…Œì´ë„ˆ ì¬ë°°í¬",status:p?"failed":"success",message:P&&I?"ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì¤‘ì§€ ë° ì¬ì‹œì‘ ì™„ë£Œ":I?"ì»¨í…Œì´ë„ˆ ì‹œì‘ ì™„ë£Œ":"ì»¨í…Œì´ë„ˆ ì¤‘ì§€ ì™„ë£Œ",timestamp:h})}if(d.command.includes("docker-compose ps")||d.command.match(/docker[\s-]+compose.*ps/)){const P=(d.output.match(/Up\s+/g)||[]).length;t.steps.push({name:"ë°°í¬ ìƒíƒœ í™•ì¸",status:p?"failed":"success",message:P>0?`${P}ê°œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì¤‘`:"ë°°í¬ ìƒíƒœ í™•ì¸ ì™„ë£Œ",timestamp:h})}if(d.command.includes("kubectl create namespace")){const P=d.command.match(/namespace\s+([^\s]+)/);P&&(t.namespace=P[1]);const I=d.error.includes("AlreadyExists");t.steps.push({name:"ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì„¤ì •",status:I||!p?"success":"failed",message:I?`ë„¤ì„ìŠ¤í˜ì´ìŠ¤ '${t.namespace}' í™•ì¸ ì™„ë£Œ`:`ë„¤ì„ìŠ¤í˜ì´ìŠ¤ '${t.namespace}' ìƒì„±`,timestamp:h})}if(d.command.includes("kubectl create secret")){const P=c.includes("created")||c.includes("deleted");t.steps.push({name:"Registry ì¸ì¦ ì„¤ì •",status:P&&!p?"success":"failed",message:P?"ì´ë¯¸ì§€ pull ì¸ì¦ ì™„ë£Œ":"ì¸ì¦ Secret ìƒì„±",timestamp:h});const I=d.command.match(/docker-server=([^\s]+)/);I&&(t.imageName=I[1])}if(d.command.includes("find /tmp/")&&d.command.includes("*.yaml")){const P=c.match(/(\w+)\.yaml/g);if(p){const I=d.error||d.output||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜",$=I.split(`
`)[0];t.steps.push({name:"Kubernetes ë¦¬ì†ŒìŠ¤ ë°°í¬",status:"failed",message:`ë°°í¬ ì‹¤íŒ¨: ${$}`,timestamp:h}),t.errors.push(I),t.status="failed"}else{const I=[];c.split(`
`).forEach(y=>{if(y.includes("configured")||y.includes("created")||y.includes("unchanged")){const v=y.match(/(\w+)\/([^\s]+)\s+(configured|created|unchanged)/);v&&I.push(`${v[1]}: ${v[2]}`)}}),t.steps.push({name:"Kubernetes ë¦¬ì†ŒìŠ¤ ë°°í¬",status:"success",message:I.length>0?I.join(", "):`${(P==null?void 0:P.length)||0}ê°œ ë¦¬ì†ŒìŠ¤ ì ìš© ì™„ë£Œ`,timestamp:h})}}if((d.command.includes("kubectl describe pod")||d.command.includes("kubectl describe"))&&!p&&d.output){const P=d.output.matchAll(/^\s*Image:\s*([^\s]+)$/gm);for(const I of P){const $=I[1];if($.includes("\\")||$.includes("[")||$.includes("("))continue;const y=$.lastIndexOf(":");if(y>0){const v=$.substring(0,y),u=$.substring(y+1);(k=t.images)!=null&&k.some(m=>m.fullPath===$)||(E=t.images)==null||E.push({name:v,tag:u,fullPath:$}),t.imageName||(t.imageName=v,t.imageTag=u)}}}if(d.command.includes("kubectl rollout restart")){const P=c.includes("restarted");t.steps.push({name:"ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘",status:P?"success":p?"failed":"in_progress",message:P?"ì¬ì‹œì‘ ì™„ë£Œ":"ì¬ì‹œì‘ ì§„í–‰ ì¤‘",timestamp:h})}d.command.startsWith("rm -rf")&&d.command.includes("_apply")&&t.steps.push({name:"ë°°í¬ ì •ë¦¬",status:"success",message:"ì„ì‹œ íŒŒì¼ ì‚­ì œ ì™„ë£Œ",timestamp:h}),c.toLowerCase().includes("warning")&&!p&&t.warnings.push(c)}),a){const d=s.find(c=>c.error&&c.error.toLowerCase().includes("timeout")||c.output&&c.output.toLowerCase().includes("timeout"));if(d){const c=d.error||d.output;let p="";try{if(d.timestamp){const h=new Date(d.timestamp);isNaN(h.getTime())||(p=h.toLocaleTimeString())}}catch(h){console.warn("[deployMetrics] íƒ€ì„ì•„ì›ƒ íƒ€ì„ìŠ¤íƒ¬í”„ íŒŒì‹± ì‹¤íŒ¨:",h)}t.steps.push({name:"ë°°í¬ ì‹¤í–‰",status:"failed",message:`íƒ€ì„ì•„ì›ƒ ë°œìƒ: ${c.split(`
`)[0]}`,timestamp:p})}}const i=t.steps.some(d=>d.status==="failed"),l=t.steps.every(d=>d.status==="success");return a||i||t.errors.length>0?t.status="failed":l&&t.steps.length>0?t.status="success":t.steps.length>0&&(t.status="in_progress"),t}function zp(s){const t=[],r={success:" ë°°í¬ ì„±ê³µ",failed:" ë°°í¬ ì‹¤íŒ¨",in_progress:"â³ ë°°í¬ ì§„í–‰ ì¤‘",pending:"â¸ï¸ ë°°í¬ ëŒ€ê¸°"}[s.status];if(t.push({label:"ë°°í¬ ìƒíƒœ",value:r,status:s.status==="success"?"success":s.status==="failed"?"error":"info"}),s.deployTime&&t.push({label:"ë°°í¬ ì™„ë£Œ ì‹œê°„",value:s.deployTime,status:"info"}),s.duration!==void 0){const l=Math.floor(s.duration/60),d=s.duration%60;t.push({label:"ë°°í¬ ì†Œìš” ì‹œê°„",value:l>0?`${l}ë¶„ ${d}ì´ˆ`:`${d}ì´ˆ`,status:"info"})}s.namespace&&t.push({label:"Kubernetes ë„¤ì„ìŠ¤í˜ì´ìŠ¤",value:s.namespace,status:"info"}),s.imageName&&t.push({label:"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€",value:`${s.imageName}${s.imageTag?":"+s.imageTag:""}`,status:"info"});const n=s.steps.filter(l=>l.status==="success").length,a=s.steps.length;return a>0&&t.push({label:"ì™„ë£Œëœ ë‹¨ê³„",value:`${n} / ${a}`,status:n===a?"success":"warning"}),s.errors.length>0&&t.push({label:"ì—ëŸ¬",value:`${s.errors.length}ê°œ`,status:"error"}),s.warnings.length>0&&t.push({label:"ê²½ê³ ",value:`${s.warnings.length}ê°œ`,status:"warning"}),{summary:`ë°°í¬ ${s.status==="success"?"ì„±ê³µ":s.status==="failed"?"ì‹¤íŒ¨":"ì§„í–‰ ì¤‘"} (${n}/${a} ë‹¨ê³„ ì™„ë£Œ)`,details:t}}const{Text:sr,Title:Ep,Paragraph:ql}=we,{Panel:Pp}=nr,vS=({logs:s,actualStatus:t,deploymentDetails:r,previousLogs:n})=>{var v;const[a,i]=o.useState("current"),l=o.useMemo(()=>{const u=Rp(s);if(t&&(u.status=t,t==="failed"&&!u.steps.some(b=>b.status==="failed"))){let b="";try{const Z=s[s.length-1];if(Z!=null&&Z.timestamp){const se=new Date(Z.timestamp);isNaN(se.getTime())||(b=se.toLocaleTimeString())}}catch(Z){}const A=(r==null?void 0:r.error_message)||"ë°°í¬ ì‹¤íŒ¨ (íƒ€ì„ì•„ì›ƒ ë˜ëŠ” ì—ëŸ¬ ë°œìƒ)",W=(r==null?void 0:r.error_stage)||"ë°°í¬ ì‹¤í–‰";if(u.steps.push({name:W,status:"failed",message:A,timestamp:b}),u.errors.length===0){const Z=r!=null&&r.error_message?`${r.error_stage?`[${r.error_stage}] `:""}${r.error_message}`:"ë°°í¬ ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";u.errors.push(Z)}}const m=u.steps.reduce((j,b)=>{const A=j.findIndex(W=>W.name===b.name&&W.status===b.status);return A===-1?j.push(b):!j[A].message&&b.message&&(j[A]=b),j},[]);return u.steps=m,u.errors=[...new Set(u.errors)],u.warnings=[...new Set(u.warnings)],u},[s,t,r==null?void 0:r.error_message,r==null?void 0:r.error_stage]),d=o.useMemo(()=>zp(l),[l]),c=o.useMemo(()=>{if(!n||n.length===0)return null;const u=Rp(n);u.status==="in_progress"&&(u.status="success");const m=u.steps.reduce((j,b)=>{const A=j.findIndex(W=>W.name===b.name&&W.status===b.status);return A===-1?j.push(b):!j[A].message&&b.message&&(j[A]=b),j},[]);return u.steps=m,u.errors=[...new Set(u.errors)],u.warnings=[...new Set(u.warnings)],u},[n]),p=o.useMemo(()=>c?zp(c):null,[c]),h=n&&n.length>0,x=u=>{switch(u){case"success":return{icon:e.jsx(Ze,{style:{fontSize:48,color:"#52c41a"}}),title:"ë°°í¬ ì„±ê³µ",gradient:"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)",color:"#52c41a",bgColor:"#f6ffed",borderColor:"#b7eb8f"};case"failed":return{icon:e.jsx(Es,{style:{fontSize:48,color:"#ff4d4f"}}),title:"ë°°í¬ ì‹¤íŒ¨",gradient:"linear-gradient(135deg, #ff4d4f 0%, #ff7875 100%)",color:"#ff4d4f",bgColor:"#fff2f0",borderColor:"#ffccc7"};case"in_progress":return{icon:e.jsx(Pt,{spin:!0,style:{fontSize:48,color:"#1890ff"}}),title:"ë°°í¬ ì§„í–‰ ì¤‘",gradient:"linear-gradient(135deg, #1890ff 0%, #40a9ff 100%)",color:"#1890ff",bgColor:"#e6f7ff",borderColor:"#91d5ff"};default:return{icon:e.jsx(wr,{style:{fontSize:48,color:"#d9d9d9"}}),title:"ë°°í¬ ëŒ€ê¸°",gradient:"linear-gradient(135deg, #d9d9d9 0%, #f0f0f0 100%)",color:"#8c8c8c",bgColor:"#fafafa",borderColor:"#d9d9d9"}}},_=x(l.status),S=l.steps.filter(u=>u.status==="success").length,L=l.steps.length,k=L>0?Math.round(S/L*100):0,P=(u=>{switch(u){case"ValidationFailed":return{title:"ë°°í¬ ê²€ì¦ ì‹¤íŒ¨",tips:["ìœ„ì˜ ê²€ì¦ ë‹¨ê³„ì—ì„œ ì‹¤íŒ¨í•œ í•­ëª©ì„ í™•ì¸í•˜ì„¸ìš”","ë¡œê·¸ì—ì„œ ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í™•ì¸í•˜ì„¸ìš”","ë¦¬ì†ŒìŠ¤ ë¶€ì¡±ì´ë‚˜ ì´ë¯¸ì§€ ë¬¸ì œì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤"]};case"RolloutTimeout":return{title:"Rollout íƒ€ì„ì•„ì›ƒ",tips:["Harbor Registryì— ì´ë¯¸ì§€ê°€ ì •ìƒì ìœ¼ë¡œ Pushë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”","ë…¸ë“œì˜ CPU/ë©”ëª¨ë¦¬ ë¦¬ì†ŒìŠ¤ê°€ ì¶©ë¶„í•œì§€ í™•ì¸í•˜ì„¸ìš”","í° ì´ë¯¸ì§€ëŠ” ë‹¤ìš´ë¡œë“œ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤"]};case"ImagePullBackOff":case"PodError":return{title:"ì´ë¯¸ì§€ Pull ì‹¤íŒ¨",tips:["Harbor í”„ë¡œì íŠ¸ ê²½ë¡œê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•˜ì„¸ìš”","imagePullSecrets ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”","ë…¸ë“œì—ì„œ Harbor Registry ì ‘ê·¼ì´ ê°€ëŠ¥í•œì§€ ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•˜ì„¸ìš”"]};case"NoRunningPods":return{title:"Pod ì‹¤í–‰ ì‹¤íŒ¨",tips:["kubectl describe podë¡œ ìƒì„¸ ì—ëŸ¬ë¥¼ í™•ì¸í•˜ì„¸ìš”","CPU/ë©”ëª¨ë¦¬ limits ì„¤ì •ì´ ì ì ˆí•œì§€ í™•ì¸í•˜ì„¸ìš”","readinessProbe, livenessProbe ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”"]};case"CrashLoopBackOff":return{title:"Pod í¬ë˜ì‹œ",tips:["kubectl logsë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”","í•„ìš”í•œ í™˜ê²½ ë³€ìˆ˜ê°€ ëª¨ë‘ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”","DB, Redis ë“± ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”"]};default:return null}})(r==null?void 0:r.error_type),I=l.status==="in_progress"&&h||l.status!=="in_progress"&&h,$=e.jsxs(g,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(ie,{style:{background:_.gradient,border:"none",borderRadius:12,overflow:"hidden"},bodyStyle:{padding:"32px 24px"},children:[e.jsxs(Ke,{gutter:[24,24],align:"middle",children:[e.jsx(Y,{xs:24,sm:6,style:{textAlign:"center"},children:_.icon}),e.jsxs(Y,{xs:24,sm:18,children:[e.jsx(Ep,{level:2,style:{color:"#fff",margin:"0 0 8px 0"},children:_.title}),e.jsx(ql,{style:{color:"rgba(255,255,255,0.9)",fontSize:16,margin:0},children:d.summary})]})]}),e.jsx(xt,{style:{background:"rgba(255,255,255,0.2)",margin:"24px 0"}}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)"},children:"ì™„ë£Œ ë‹¨ê³„"}),value:S,suffix:`/ ${L}`,valueStyle:{color:"#fff",fontSize:24}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)"},children:"ì„±ê³µë¥ "}),value:k,suffix:"%",valueStyle:{color:"#fff",fontSize:24}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)"},children:"ì†Œìš” ì‹œê°„"}),value:l.duration||0,suffix:"ì´ˆ",valueStyle:{color:"#fff",fontSize:24}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)"},children:"ì—ëŸ¬"}),value:l.errors.length,suffix:"ê°œ",valueStyle:{color:l.errors.length>0?"#fff":"rgba(255,255,255,0.65)",fontSize:24}})})]}),L>0&&e.jsx("div",{style:{marginTop:24},children:e.jsx(qt,{percent:k,strokeColor:"#fff",trailColor:"rgba(255,255,255,0.2)",showInfo:!1,strokeWidth:8})})]}),l.status==="failed"&&P&&e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(Yt,{}),e.jsx("strong",{children:P.title})]}),description:e.jsxs("div",{children:[(r==null?void 0:r.error_message)&&e.jsxs(ql,{style:{margin:"8px 0"},children:[e.jsx(sr,{strong:!0,children:"ì—ëŸ¬ ë©”ì‹œì§€:"})," ",r.error_message]}),e.jsxs(ql,{style:{margin:"8px 0 4px 0"},children:[e.jsx(Pa,{})," ",e.jsx(sr,{strong:!0,children:"í•´ê²° ë°©ë²•:"})]}),e.jsx("ul",{style:{margin:0,paddingLeft:20},children:P.tips.map((u,m)=>e.jsx("li",{children:u},m))})]}),type:"error",showIcon:!1,style:{borderRadius:8}}),e.jsx(Ke,{gutter:[16,16],children:e.jsx(Y,{xs:24,lg:24,children:e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(dr,{}),e.jsx("span",{children:"ë°°í¬ ì •ë³´"})]}),size:"small",style:{height:"100%",borderRadius:8},children:e.jsxs(g,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(sr,{type:"secondary",children:"ë°°í¬ ìƒíƒœ"}),e.jsx(ps,{status:l.status==="success"?"success":l.status==="failed"?"error":l.status==="in_progress"?"processing":"default",text:e.jsx(sr,{strong:!0,children:l.status==="success"?"ì„±ê³µ":l.status==="failed"?"ì‹¤íŒ¨":l.status==="in_progress"?"ì§„í–‰ ì¤‘":"ëŒ€ê¸°"})})]}),l.status==="failed"&&(r==null?void 0:r.error_stage)&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(sr,{type:"secondary",children:"ì‹¤íŒ¨ ë‹¨ê³„"}),e.jsx(sr,{strong:!0,type:"danger",children:r.error_stage})]}),((r==null?void 0:r.server_name)||(r==null?void 0:r.server_id))&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(sr,{type:"secondary",children:"ë°°í¬ ì„œë²„"}),e.jsx(sr,{strong:!0,children:(r==null?void 0:r.server_name)||`Server #${r.server_id}`})]}),l.namespace&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(sr,{type:"secondary",children:"Namespace"}),e.jsx(sr,{strong:!0,children:l.namespace})]}),l.images&&l.images.length>0?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsxs(sr,{type:"secondary",children:["ë°°í¬ ì´ë¯¸ì§€ (",l.images.length,"ê°œ)"]}),l.images.map((u,m)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingLeft:"8px"},children:[e.jsxs(sr,{type:"secondary",style:{fontSize:11},children:[m+1,"."]}),e.jsx(sr,{strong:!0,style:{fontSize:11,flex:1,marginLeft:"4px",wordBreak:"break-all"},children:u.fullPath})]},m))]}):l.imageName&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(sr,{type:"secondary",children:"ì´ë¯¸ì§€"}),e.jsxs(sr,{strong:!0,style:{fontSize:12},children:[l.imageName,l.imageTag&&`:${l.imageTag}`]})]}),l.deployTime&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(sr,{type:"secondary",children:"ë°°í¬ ì™„ë£Œ"}),e.jsx(sr,{children:l.deployTime})]}),!l.namespace&&!((v=l.images)!=null&&v.length)&&!l.imageName&&!l.deployTime&&!(r!=null&&r.server_id)&&e.jsx(sr,{type:"secondary",italic:!0,style:{fontSize:12},children:"ìƒì„¸ ë°°í¬ ì •ë³´ê°€ ê¸°ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."})]})})})}),l.steps.length>0&&e.jsx(nr,{defaultActiveKey:l.status==="failed"?["steps"]:[],ghost:!0,expandIconPosition:"end",children:e.jsx(Pp,{header:e.jsxs(g,{children:[e.jsx(_t,{}),e.jsx("strong",{children:"ë°°í¬ ë‹¨ê³„ ìƒì„¸"}),e.jsx(ps,{count:L,style:{backgroundColor:_.color}})]}),children:e.jsx(g,{direction:"vertical",size:"small",style:{width:"100%"},children:l.steps.map((u,m)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"8px 12px",background:u.status==="failed"?"#fff2f0":u.status==="success"?"#f6ffed":"#fafafa",borderRadius:6,border:`1px solid ${u.status==="failed"?"#ffccc7":u.status==="success"?"#b7eb8f":"#d9d9d9"}`},children:[e.jsx("div",{style:{marginRight:12,fontSize:18},children:u.status==="success"?e.jsx(Ze,{style:{color:"#52c41a"}}):u.status==="failed"?e.jsx(Es,{style:{color:"#ff4d4f"}}):u.status==="in_progress"?e.jsx(Pt,{spin:!0,style:{color:"#1890ff"}}):e.jsx(wr,{style:{color:"#d9d9d9"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{children:e.jsx(sr,{strong:!0,children:u.name})}),u.message&&e.jsx("div",{children:e.jsx(sr,{type:"secondary",style:{fontSize:12},children:u.message})})]}),u.timestamp&&e.jsx(sr,{type:"secondary",style:{fontSize:11},children:u.timestamp})]},m))})},"steps")}),(l.errors.length>0||l.warnings.length>0)&&e.jsx(nr,{defaultActiveKey:l.errors.length>0?["issues"]:[],ghost:!0,expandIconPosition:"end",children:e.jsx(Pp,{header:e.jsxs(g,{children:[e.jsx(Yt,{style:{color:l.errors.length>0?"#ff4d4f":"#faad14"}}),e.jsx("strong",{children:"ì—ëŸ¬ ë° ê²½ê³ "}),l.errors.length>0&&e.jsx(ps,{count:l.errors.length,style:{backgroundColor:"#ff4d4f"}}),l.warnings.length>0&&e.jsx(ps,{count:l.warnings.length,style:{backgroundColor:"#faad14"}})]}),children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[l.errors.length>0&&e.jsxs("div",{children:[e.jsxs(sr,{strong:!0,style:{color:"#ff4d4f"},children:["ì—ëŸ¬ (",l.errors.length,")"]}),e.jsx("div",{style:{marginTop:8},children:l.errors.map((u,m)=>e.jsx(xe,{message:u,type:"error",showIcon:!0,style:{marginBottom:8,fontSize:12}},m))})]}),l.warnings.length>0&&e.jsxs("div",{children:[e.jsxs(sr,{strong:!0,style:{color:"#faad14"},children:["âš ï¸ ê²½ê³  (",l.warnings.length,")"]}),e.jsx("div",{style:{marginTop:8},children:l.warnings.map((u,m)=>e.jsx(xe,{message:u.split(`
`)[0],type:"warning",showIcon:!0,style:{marginBottom:8,fontSize:12}},m))})]})]})},"issues")})]}),y=c&&p?e.jsxs(g,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(ie,{style:{background:x(c.status).gradient,border:"none",borderRadius:12,overflow:"hidden"},bodyStyle:{padding:"32px 24px"},children:[e.jsxs(Ke,{gutter:[24,24],align:"middle",children:[e.jsx(Y,{xs:24,sm:6,style:{textAlign:"center"},children:x(c.status).icon}),e.jsxs(Y,{xs:24,sm:18,children:[e.jsx(Ep,{level:2,style:{color:"#fff",margin:"0 0 8px 0"},children:x(c.status).title}),e.jsx(ql,{style:{color:"rgba(255,255,255,0.9)",fontSize:16,margin:0},children:p.summary})]})]}),e.jsx(xt,{style:{background:"rgba(255,255,255,0.2)",margin:"24px 0"}}),e.jsxs(Ke,{gutter:[16,16],children:[e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)"},children:"ì™„ë£Œ ë‹¨ê³„"}),value:c.steps.filter(u=>u.status==="success").length,suffix:`/ ${c.steps.length}`,valueStyle:{color:"#fff",fontSize:24}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)"},children:"ì†Œìš” ì‹œê°„"}),value:c.duration||0,suffix:"ì´ˆ",valueStyle:{color:"#fff",fontSize:24}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)"},children:"ì—ëŸ¬"}),value:c.errors.length,suffix:"ê°œ",valueStyle:{color:c.errors.length>0?"#fff":"rgba(255,255,255,0.65)",fontSize:24}})}),e.jsx(Y,{xs:12,sm:6,children:e.jsx($e,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.85)"},children:"ê²½ê³ "}),value:c.warnings.length,suffix:"ê°œ",valueStyle:{color:c.warnings.length>0?"#fff":"rgba(255,255,255,0.65)",fontSize:24}})})]})]}),c.steps.length>0&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(_t,{}),e.jsx("span",{children:"ë°°í¬ ë‹¨ê³„"})]}),size:"small",style:{borderRadius:8},children:e.jsx(g,{direction:"vertical",size:"small",style:{width:"100%"},children:c.steps.map((u,m)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"8px 12px",background:u.status==="failed"?"#fff2f0":u.status==="success"?"#f6ffed":"#fafafa",borderRadius:6,border:`1px solid ${u.status==="failed"?"#ffccc7":u.status==="success"?"#b7eb8f":"#d9d9d9"}`},children:[e.jsx("div",{style:{marginRight:12,fontSize:18},children:u.status==="success"?e.jsx(Ze,{style:{color:"#52c41a"}}):u.status==="failed"?e.jsx(Es,{style:{color:"#ff4d4f"}}):e.jsx(wr,{style:{color:"#d9d9d9"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{children:e.jsx(sr,{strong:!0,children:u.name})}),u.message&&e.jsx("div",{children:e.jsx(sr,{type:"secondary",style:{fontSize:12},children:u.message})})]}),u.timestamp&&e.jsx(sr,{type:"secondary",style:{fontSize:11},children:u.timestamp})]},m))})}),(c.errors.length>0||c.warnings.length>0)&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(Yt,{style:{color:c.errors.length>0?"#ff4d4f":"#faad14"}}),e.jsx("span",{children:"ì—ëŸ¬ ë° ê²½ê³ "})]}),size:"small",style:{borderRadius:8},children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[c.errors.length>0&&e.jsxs("div",{children:[e.jsxs(sr,{strong:!0,style:{color:"#ff4d4f"},children:["ì—ëŸ¬ (",c.errors.length,")"]}),e.jsx("div",{style:{marginTop:8},children:c.errors.map((u,m)=>e.jsx(xe,{message:u,type:"error",showIcon:!0,style:{marginBottom:8,fontSize:12}},m))})]}),c.warnings.length>0&&e.jsxs("div",{children:[e.jsxs(sr,{strong:!0,style:{color:"#faad14"},children:["âš ï¸ ê²½ê³  (",c.warnings.length,")"]}),e.jsx("div",{style:{marginTop:8},children:c.warnings.map((u,m)=>e.jsx(xe,{message:u.split(`
`)[0],type:"warning",showIcon:!0,style:{marginBottom:8,fontSize:12}},m))})]})]})})]}):null;return I?e.jsx(xs,{activeKey:a,onChange:i,type:"card",items:[{key:"current",label:e.jsxs(g,{children:[l.status==="in_progress"?e.jsx(Pt,{spin:!0,style:{color:"#1890ff"}}):l.status==="success"?e.jsx(Ze,{style:{color:"#52c41a"}}):e.jsx(Es,{style:{color:"#ff4d4f"}}),e.jsx("span",{children:l.status==="in_progress"?"ë°°í¬ ì§„í–‰ ì¤‘":"ìµœì‹  ë°°í¬"})]}),children:e.jsxs("div",{children:[l.status==="in_progress"&&e.jsx(xe,{message:"ë°°í¬ ì§„í–‰ ì¤‘",description:"ìƒˆë¡œìš´ ë°°í¬ê°€ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì´ì „ ë°°í¬ ì´ë ¥ì€ 'ì´ì „ ë°°í¬' íƒ­ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,icon:e.jsx(Pt,{spin:!0}),style:{marginBottom:16}}),s.length>0?$:e.jsx(xe,{message:"ë°°í¬ ì •ë³´ ë¡œë”© ì¤‘",description:"ë°°í¬ê°€ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.",type:"info",showIcon:!0})]})},{key:"previous",label:e.jsxs(g,{children:[e.jsx(wr,{}),e.jsx("span",{children:"ì´ì „ ë°°í¬"})]}),children:y||e.jsx(xe,{message:"ì´ì „ ë°°í¬ ì •ë³´ ì—†ìŒ",description:"ì´ì „ ë°°í¬ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.",type:"info",showIcon:!0})}]}):$},kS=({selectedStage:s,selectedDisplayKey:t,pipelineLogs:r,commits:n,commitsLoading:a,workflowStatuses:i,sastResultData:l,sastModalView:d,onShowSastDetailView:c})=>{let p=i.find(h=>h.stage===s);return(!p||!p.metrics||!p.execution)&&(p={stage:s,status:"inactive",progress:0,metrics:{throughput:0,quality:0,efficiency:0,reliability:0},execution:{executionLogs:[]}}),e.jsx(Ke,{gutter:[16,16],children:s!=="code"&&e.jsx(e.Fragment,{children:s==="deploy"?e.jsx(Y,{span:24,children:(()=>{const h=i.find(L=>L.stage==="deploy"),x=r&&r.length>0,_=h&&h.status!=="inactive";let S;if(h)try{if(h.details_data)if(typeof h.details_data=="object"&&"String"in h.details_data){const L=h.details_data;S=L.Valid&&L.String?JSON.parse(L.String):{}}else typeof h.details_data=="string"?S=JSON.parse(h.details_data):S=h.details_data;else S={};if(h!=null&&h.error_message)if(typeof h.error_message=="object"&&h.error_message&&"String"in h.error_message){const L=h.error_message;L.Valid&&L.String&&(S.error_message=L.String)}else typeof h.error_message=="string"&&(S.error_message=h.error_message)}catch(L){console.error("[DetailModalContent] deploymentDetails íŒŒì‹± ì‹¤íŒ¨:",L)}if(x||_){const L=(h==null?void 0:h.status)==="running",k=E=>{if(E){if(E==="running")return"in_progress";if(E==="success"||E==="failed"||E==="pending")return E}};return e.jsx(vS,{logs:L?[]:r||[],actualStatus:k(h==null?void 0:h.status),deploymentDetails:L?void 0:S,previousLogs:L?r||[]:void 0,previousDeploymentDetails:L?S:void 0})}else return e.jsx(xe,{message:"ë°°í¬ ì´ë ¥ ì—†ìŒ",description:"ì•„ì§ ë°°í¬ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤. 'ë°°í¬ ì‹¤í–‰' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë°°í¬ë¥¼ ì‹œì‘í•˜ì„¸ìš”.",type:"info",showIcon:!0})})()}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{span:12,children:e.jsx(ie,{title:"ì„±ëŠ¥ ë©”íŠ¸ë¦­",size:"small",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(we.Text,{children:"ì²˜ë¦¬ëŸ‰"}),e.jsx(qt,{percent:p.metrics.throughput,size:"small"})]}),e.jsxs("div",{children:[e.jsx(we.Text,{children:"í’ˆì§ˆ"}),e.jsx(qt,{percent:p.metrics.quality,size:"small",strokeColor:"#52c41a"})]}),e.jsxs("div",{children:[e.jsx(we.Text,{children:"íš¨ìœ¨ì„±"}),e.jsx(qt,{percent:p.metrics.efficiency,size:"small",strokeColor:"#1890ff"})]}),e.jsxs("div",{children:[e.jsx(we.Text,{children:"ì‹ ë¢°ì„±"}),e.jsx(qt,{percent:p.metrics.reliability,size:"small",strokeColor:"#722ed1"})]})]})})}),e.jsx(Y,{span:12,children:e.jsx(ie,{title:"ì‘ì—… í˜„í™©",size:"small",children:e.jsxs(Ke,{gutter:[8,8],children:[e.jsx(Y,{span:12,children:e.jsx($e,{title:"ì „ì²´ ì‘ì—…",value:p.totalTasks})}),e.jsx(Y,{span:12,children:e.jsx($e,{title:"ì™„ë£Œ",value:p.completedTasks,valueStyle:{color:"#52c41a"}})}),e.jsx(Y,{span:12,children:e.jsx($e,{title:"ì§„í–‰ ì¤‘",value:p.activeProjects,valueStyle:{color:"#1890ff"}})}),e.jsx(Y,{span:12,children:e.jsx($e,{title:"ë¸”ë¡ë¨",value:p.blockedTasks,valueStyle:{color:"#ff4d4f"}})})]})})})]})})})},Hx=async s=>{try{const t=await ee.pipeline("getBuildStatistics",{service_id:s});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ë¹Œë“œ í†µê³„ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error(`ë¹Œë“œ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨ (Service: ${s}):`,t),t}},Vx=async s=>{try{const t=await ee.pipeline("getServiceBuildVersions",{service_id:s});if(!t||!t.success)throw new Error((t==null?void 0:t.error)||"ì„œë¹„ìŠ¤ë³„ ë¹Œë“œ ë²„ì „ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return t.data}catch(t){throw O.error(`ì„œë¹„ìŠ¤ë³„ ë¹Œë“œ ë²„ì „ ì¡°íšŒ ì‹¤íŒ¨ (Service: ${s}):`,t),t}},Eu={getBuildStatistics:Hx,getServiceBuildVersions:Vx},ec=Object.freeze(Object.defineProperty({__proto__:null,buildApi:Eu,getBuildStatistics:Hx,getServiceBuildVersions:Vx},Symbol.toStringTag,{value:"Module"}));function CS(s){if(!s||s.length===0)return null;const t=s.find(l=>{var d;return((d=l.type)==null?void 0:d.includes("master"))&&l.join_command&&l.certificate_key}),r=s.find(l=>{var d;return(d=l.type)==null?void 0:d.includes("master")}),n=s.find(l=>{var d;return(d=l.type)==null?void 0:d.includes("docker")}),a=s.find(l=>{var d;return(d=l.type)==null?void 0:d.includes("podman")}),i=s.find(l=>{var d;return(d=l.type)==null?void 0:d.includes("external_kubernetes")});return t||r||n||a||i||s[0]}function IS(s){if(!s)return[];if(typeof s=="string")try{return JSON.parse(s)}catch(t){return[]}return Array.isArray(s)?s:[]}function TS(){const[s,t]=o.useState(null),[r,n]=o.useState(!1),[a,i]=o.useState(null),{imageRegistry:l}=Gs(),d=o.useCallback(async p=>{var h;n(!0),i(null);try{const x=await Eu.getBuildStatistics(p),S=(await gn.getService(p)).infra_id;if(!S){const u="ì„œë¹„ìŠ¤ì— ë°°í¬ ì¸í”„ë¼ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤";return console.error(`[useBuildServerInfo] ${u}`),i(u),n(!1),null}const L=await vc(S);if(!L||L.length===0){const u=`ì¸í”„ë¼ ID ${S}ì—ì„œ ì„œë²„ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤`;return console.error(`[useBuildServerInfo] ${u}`),i(u),n(!1),null}const k=CS(L);if(!k){const u="ë°°í¬ ì„œë²„ë¥¼ ì„ íƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤";return console.error(`[useBuildServerInfo] ${u}`),i(u),n(!1),null}const E=IS(k.hops),P=((h=x==null?void 0:x.build_environment)==null?void 0:h.docker_registry)||"";let I="",$="";if(P&&l){const u=l.find(m=>P.includes(m.registryUrl)||m.registryUrl.includes(P));u&&(I=u.userId||"",$=u.password||"")}const v={serverId:typeof k.id=="string"?parseInt(k.id,10):k.id,infraId:S,hops:E,registryUrl:P,registryUsername:I,registryPassword:$,buildStats:x};return t(v),n(!1),v}catch(x){const _=x instanceof Error?x.message:"ì„œë²„ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨";return console.error("[useBuildServerInfo] Error:",x),i(_),n(!1),null}},[l]),c=o.useCallback(()=>{t(null),n(!1),i(null)},[]);return{serverInfo:s,isLoading:r,error:a,loadServerInfo:d,reset:c}}function Pd(s){if(!s)return"inactive";const t=s.toLowerCase();return t==="success"||t==="succeeded"||t==="successed"||t==="completed"||t==="done"?"success":t==="running"||t==="in_progress"||t==="processing"||t==="progress"?"running":t==="failed"||t==="error"||t==="cancelled"||t==="canceled"?"failed":t==="pending"||t==="queued"||t==="waiting"?"pending":"inactive"}function RS(){const[s,t]=o.useState(null),[r,n]=o.useState(!1),[a,i]=o.useState(null),[l,d]=o.useState(null),[c,p]=o.useState(!1),h=o.useCallback(async(k,E,P)=>{n(!0),t(null);try{const I=P(E);if(!I.found||!I.token){n(!1);return}const $=await I0.getRepositoryStatistics(k,I.token);t($)}catch(I){}finally{n(!1)}},[]),x=o.useCallback(async k=>{p(!0),i(null),d(null);try{const E=await Eu.getBuildStatistics(k);i(E),d(E.build_environment||null)}catch(E){f.error("ë¹Œë“œ í†µê³„ë¥¼ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}finally{p(!1)}},[]),_=o.useCallback(()=>{t(null),n(!1)},[]),S=o.useCallback(()=>{i(null),d(null),p(!1)},[]),L=o.useCallback(()=>{_(),S()},[_,S]);return{repositoryStats:s,repositoryStatsLoading:r,setRepositoryStats:t,fetchRepositoryStatistics:h,clearRepositoryStats:_,buildStats:a,buildEnvironment:l,buildStatsLoading:c,setBuildStats:i,setBuildEnvironment:d,fetchBuildStatistics:x,clearBuildStats:S,clearAll:L}}function zS(s){return{inactive:"inactive",running:"running",success:"success",failed:"failed",pending:"pending",warning:"warning",completed:"success",error:"failed",cancelled:"failed",canceled:"failed"}[s==null?void 0:s.toLowerCase()]||"inactive"}const ES=[{stage:"code",name:"ì†ŒìŠ¤",status:"inactive",progress:0,lastUpdate:"",execution:{executionLogs:[]}},{stage:"security",name:"ë³´ì•ˆ",status:"inactive",progress:0,lastUpdate:"",execution:{executionLogs:[]}},{stage:"build",name:"ë¹Œë“œ",status:"inactive",progress:0,lastUpdate:"",execution:{executionLogs:[]}},{stage:"test",name:"QA ê²€ì¦",status:"inactive",progress:0,lastUpdate:"",execution:{executionLogs:[]}},{stage:"deploy",name:"ë°°í¬",status:"inactive",progress:0,lastUpdate:"",execution:{executionLogs:[]}},{stage:"operate",name:"ìš´ì˜",status:"inactive",progress:0,lastUpdate:"",execution:{executionLogs:[]}}],Mp={build:"build",deploy:"deploy"};function PS(s){const t=ES.map(a=>({...a,execution:{executionLogs:[]}})),r={};s.forEach(a=>{(!r[a.step_name]||r[a.step_name].id<a.id)&&(r[a.step_name]=a)});const n=new Map(Object.values(r).map(a=>[a.step_name,a]));return t.map(a=>{var d;const i=Object.keys(Mp).find(c=>Mp[c]===a.stage),l=i?n.get(i):void 0;if(l){let c=0;l.progress_percentage.Valid?c=l.progress_percentage.Float64:l.status==="success"&&(c=100);const p=l.completed_at.Valid?l.completed_at.String:l.started_at.Valid?l.started_at.String:"";return{...a,status:zS(l.status),progress:c,lastUpdate:p,error_message:(d=l.error_message)!=null&&d.Valid?l.error_message.String:void 0,details_data:l.details_data}}return a})}function Ai(s){try{const t=new URL(s);return`${t.protocol}//${t.host}`}catch(t){if(s.startsWith("git@")){const r=s.match(/git@([^:]+):/);if(r)return`https://${r[1]}`}return s.replace(/\/+$/,"")}}async function qx(s,t=0){const r=s.get("gitUrl")||"",n=s.get("accessToken")||"",a=2;try{const i=await Kn.post("/gits",{action:"executeSemgrepScan",parameters:{git_url:r,git_token:n,config:s.get("config")||"p/owasp-top-ten"}},{timeout:3e5});if(!i.success||!i.data){const l=i.error||"";throw/access denied|authentication failed|http basic/i.test(l)?new Error("INVALID_TOKEN"):new Error(i.error||"Semgrep ë¶„ì„ ì‹¤íŒ¨")}return i.data}catch(i){if(i instanceof Error&&(i.message.includes("Network Error")||i.message.includes("ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤")||i.message.includes("timeout"))&&t<a)return await new Promise(d=>setTimeout(d,2e3*(t+1))),qx(s,t+1);throw i instanceof Error?i.message==="INVALID_TOKEN"?i:new Error(`SEMGREP_ERROR: ${i.message}`):new Error("SEMGREP_ERROR: ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜")}}async function Gx(s,t=0){const r=s.get("gitUrl")||"",n=s.get("accessToken")||"",a=2;try{const i=await Kn.post("/gits",{action:"executeCodeqlScan",parameters:{git_url:r,git_token:n}},{timeout:3e5});if(!i.success||!i.data){const l=i.error||"";throw/access denied|authentication failed|http basic/i.test(l)?new Error("INVALID_TOKEN"):new Error(i.error||"CodeQL ë¶„ì„ ì‹¤íŒ¨")}return i.data}catch(i){if(i instanceof Error&&(i.message.includes("Network Error")||i.message.includes("ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤")||i.message.includes("timeout"))&&t<a)return await new Promise(d=>setTimeout(d,2e3*(t+1))),Gx(s,t+1);throw i instanceof Error?i.message==="INVALID_TOKEN"?i:new Error(`CODEQL_ERROR: ${i.message}`):new Error("CODEQL_ERROR: ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜")}}function MS(s){const t=s instanceof Error?s.message:String(s);return t==="INVALID_TOKEN"||/access denied|authentication failed|http basic/i.test(t)?"SAST ë¶„ì„ ì‹¤íŒ¨: GitLab ìê²©ì¦ëª…ì„ í™•ì¸í•˜ì„¸ìš”.":t.startsWith("SEMGREP_ERROR:")?`Semgrep ë¶„ì„ ì˜¤ë¥˜: ${t.replace("SEMGREP_ERROR:","").trim()}`:t.startsWith("CODEQL_ERROR:")?`CodeQL ë¶„ì„ ì˜¤ë¥˜: ${t.replace("CODEQL_ERROR:","").trim()}`:/network error|ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤|timeout/i.test(t)?"SAST ë¶„ì„ ì‹¤íŒ¨: ì„œë²„ ì—°ê²° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.":`SAST ë¶„ì„ ì‹¤íŒ¨: ${t}`}const LS=Fg()(s=>({isModalOpen:!1,isMemberModalOpen:!1,isEditModalOpen:!1,activeInfoModal:null,commitModalOpen:!1,commitModalActiveTab:"statistics",buildModalOpen:!1,buildModalActiveTab:"statistics",gitlabTokenModalOpen:!1,pendingRepoId:null,gitlabTokenInput:"",gitlabBaseUrlInput:"",tokenInputModalOpen:!1,tokenInputServiceId:null,tokenInputServiceName:"",tokenInputGitlabUrl:"",securityModalOpen:!1,securityModalRepoId:null,securityModalRepoName:"",securityModalRepoUrl:"",securityModalType:"sast",dastParamsModalOpen:!1,dastParamsRepoId:null,dastParamsRepoName:"",dastParamsRepoUrl:"",dastParamsServiceId:null,gitlabActionVisible:null,selectedInfraModal:!1,currentSelectedInfraName:void 0,pendingDeploymentModalOpen:{visible:!1,repo:null,displayKey:null},modalSastData:null,sastModalView:null,isSastScanInProgress:!1,operateModalOpen:!1,operateCurrentService:null,operateServerHops:"",operateInfraId:void 0,dastModalOpen:!1,dastResult:null,gitlabAuthLoading:!1,gitlabAuthStatus:"idle",registryTestLoading:!1,registryAuthStatus:"idle",setIsModalOpen:t=>s({isModalOpen:t}),setIsMemberModalOpen:t=>s({isMemberModalOpen:t}),setIsEditModalOpen:t=>s({isEditModalOpen:t}),setActiveInfoModal:t=>s({activeInfoModal:t}),setCommitModalOpen:t=>s({commitModalOpen:t}),setCommitModalActiveTab:t=>s({commitModalActiveTab:t}),setBuildModalOpen:t=>s({buildModalOpen:t}),setBuildModalActiveTab:t=>s({buildModalActiveTab:t}),setGitlabTokenModalOpen:t=>s({gitlabTokenModalOpen:t}),setPendingRepoId:t=>s({pendingRepoId:t}),setGitlabTokenInput:t=>s({gitlabTokenInput:t}),setGitlabBaseUrlInput:t=>s({gitlabBaseUrlInput:t}),setTokenInputModalOpen:t=>s({tokenInputModalOpen:t}),setTokenInputServiceId:t=>s({tokenInputServiceId:t}),setTokenInputServiceName:t=>s({tokenInputServiceName:t}),setTokenInputGitlabUrl:t=>s({tokenInputGitlabUrl:t}),openTokenInputModal:(t,r,n)=>s({tokenInputModalOpen:!0,tokenInputServiceId:t,tokenInputServiceName:r,tokenInputGitlabUrl:n}),closeTokenInputModal:()=>s({tokenInputModalOpen:!1,tokenInputServiceId:null,tokenInputServiceName:"",tokenInputGitlabUrl:""}),setSecurityModalOpen:t=>s({securityModalOpen:t}),setSecurityModalRepoId:t=>s({securityModalRepoId:t}),setSecurityModalRepoName:t=>s({securityModalRepoName:t}),setSecurityModalRepoUrl:t=>s({securityModalRepoUrl:t}),setSecurityModalType:t=>s({securityModalType:t}),openSecurityModal:(t,r,n,a)=>s({securityModalOpen:!0,securityModalRepoId:t,securityModalRepoName:r,securityModalRepoUrl:n,securityModalType:a}),closeSecurityModal:()=>s({securityModalOpen:!1,securityModalRepoId:null,securityModalRepoName:"",securityModalRepoUrl:""}),setDastParamsModalOpen:t=>s({dastParamsModalOpen:t}),setDastParamsRepoId:t=>s({dastParamsRepoId:t}),setDastParamsRepoName:t=>s({dastParamsRepoName:t}),setDastParamsRepoUrl:t=>s({dastParamsRepoUrl:t}),setDastParamsServiceId:t=>s({dastParamsServiceId:t}),openDastParamsModal:(t,r,n,a)=>s({dastParamsModalOpen:!0,dastParamsRepoId:t,dastParamsRepoName:r,dastParamsRepoUrl:n,dastParamsServiceId:a}),closeDastParamsModal:()=>s({dastParamsModalOpen:!1,dastParamsRepoId:null,dastParamsRepoName:"",dastParamsRepoUrl:"",dastParamsServiceId:null}),setGitlabActionVisible:t=>s({gitlabActionVisible:t}),setSelectedInfraModal:t=>s({selectedInfraModal:t}),setCurrentSelectedInfraName:t=>s({currentSelectedInfraName:t}),setPendingDeploymentModalOpen:t=>s({pendingDeploymentModalOpen:t}),setModalSastData:t=>s({modalSastData:t}),setSastModalView:t=>s({sastModalView:t}),setIsSastScanInProgress:t=>s({isSastScanInProgress:t}),setOperateModalOpen:t=>s({operateModalOpen:t}),setOperateCurrentService:t=>s({operateCurrentService:t}),setOperateServerHops:t=>s({operateServerHops:t}),setOperateInfraId:t=>s({operateInfraId:t}),openOperateModal:(t,r,n)=>s({operateModalOpen:!0,operateCurrentService:t,operateServerHops:r,operateInfraId:n}),closeOperateModal:()=>s({operateModalOpen:!1,operateCurrentService:null,operateServerHops:"",operateInfraId:void 0}),setDastModalOpen:t=>s({dastModalOpen:t}),setDastResult:t=>s({dastResult:t}),setGitlabAuthLoading:t=>s({gitlabAuthLoading:t}),setGitlabAuthStatus:t=>s({gitlabAuthStatus:t}),setRegistryTestLoading:t=>s({registryTestLoading:t}),setRegistryAuthStatus:t=>s({registryAuthStatus:t}),resetAuthStatus:()=>s({gitlabAuthLoading:!1,gitlabAuthStatus:"idle",registryTestLoading:!1,registryAuthStatus:"idle"}),resetAllModals:()=>s({isModalOpen:!1,isMemberModalOpen:!1,isEditModalOpen:!1,activeInfoModal:null,commitModalOpen:!1,commitModalActiveTab:"statistics",buildModalOpen:!1,buildModalActiveTab:"statistics",gitlabTokenModalOpen:!1,pendingRepoId:null,gitlabTokenInput:"",gitlabBaseUrlInput:"",tokenInputModalOpen:!1,tokenInputServiceId:null,tokenInputServiceName:"",tokenInputGitlabUrl:"",securityModalOpen:!1,securityModalRepoId:null,securityModalRepoName:"",securityModalRepoUrl:"",securityModalType:"sast",dastParamsModalOpen:!1,dastParamsRepoId:null,dastParamsRepoName:"",dastParamsRepoUrl:"",dastParamsServiceId:null,gitlabActionVisible:null,selectedInfraModal:!1,currentSelectedInfraName:void 0,pendingDeploymentModalOpen:{visible:!1,repo:null,displayKey:null},modalSastData:null,sastModalView:null,isSastScanInProgress:!1,operateModalOpen:!1,operateCurrentService:null,operateServerHops:"",operateInfraId:void 0,dastModalOpen:!1,dastResult:null,gitlabAuthLoading:!1,gitlabAuthStatus:"idle",registryTestLoading:!1,registryAuthStatus:"idle"})})),{Text:Lp,Title:AS}=we,NS=({visible:s,stage:t,category:r,warningType:n,vulnerabilitySummary:a,serviceName:i,onContinue:l,onCancel:d,loading:c=!1})=>{const p=t==="build"?"ë¹Œë“œ":"ë°°í¬",h=t==="build"?Yo:dr,x=r==="sast"?"ì½”ë“œ ë¶„ì„ (SAST)":"ì´ë¯¸ì§€ ë¶„ì„ (SCA)",_=r==="sast"?"ì†ŒìŠ¤ ì½”ë“œì— ëŒ€í•œ ì •ì  ë¶„ì„":"ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì˜ ì·¨ì•½ì  ë¶„ì„",L=n==="no_analysis"?{title:`${x}ì´ ìˆ˜í–‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤`,alertType:"warning",icon:e.jsx(Yt,{style:{color:"#faad14",fontSize:24}}),message:`"${i}" ì„œë¹„ìŠ¤ì— ëŒ€í•œ ${_}ì´ ì•„ì§ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`,description:`${p} ì „ì— ë³´ì•ˆ ë¶„ì„ì„ ìˆ˜í–‰í•˜ì—¬ ì ì¬ì  ì·¨ì•½ì ì„ í™•ì¸í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.`}:{title:"ì¹˜ëª…ì ì¸ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤",alertType:"error",icon:e.jsx(Tr,{style:{color:"#ff4d4f",fontSize:24}}),message:`"${i}" ì„œë¹„ìŠ¤ì˜ ${_} ê²°ê³¼ì—ì„œ Critical ë“±ê¸‰ì˜ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.`,description:`ë³´ì•ˆ ì·¨ì•½ì ì„ í•´ê²°í•œ í›„ ${p}í•˜ëŠ” ê²ƒì„ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤.`},k=(E,P,I)=>!P||P===0?null:e.jsxs(T,{color:I,style:{marginBottom:4},children:[E,": ",P,"ê±´"]});return e.jsx(rt,{open:s,title:e.jsxs(g,{children:[e.jsx(ni,{style:{color:"#1890ff"}}),e.jsx("span",{children:"ë³´ì•ˆ ê²€ì‚¬ ê²½ê³ "})]}),onCancel:d,footer:[e.jsx(B,{onClick:d,children:"ì·¨ì†Œ"},"cancel"),e.jsx(B,{type:"primary",danger:n==="critical_found",onClick:l,loading:c,icon:e.jsx(h,{}),children:p},"continue")],width:520,centered:!0,children:e.jsxs(g,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"16px 0"},children:[L.icon,e.jsx(AS,{level:5,style:{marginTop:12,marginBottom:0},children:L.title})]}),e.jsx(xe,{type:L.alertType,message:L.message,description:L.description,showIcon:!0,icon:L.alertType==="error"?e.jsx(mn,{}):e.jsx(Yt,{})}),n==="critical_found"&&a&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{style:{margin:"8px 0"},children:"ë°œê²¬ëœ ì·¨ì•½ì "}),e.jsxs("div",{style:{textAlign:"center"},children:[k("Critical",a.critical,"red"),k("High",a.high,"orange"),k("Medium",a.medium,"gold"),k("Low",a.low,"blue")]})]}),e.jsx("div",{style:{padding:"12px",backgroundColor:"#fafafa",borderRadius:"6px",marginTop:8},children:e.jsx(Lp,{type:"secondary",style:{fontSize:12},children:n==="no_analysis"?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"ê¶Œì¥ ì¡°ì¹˜:"})," ",r==="sast"?"Git ê´€ë¦¬ í˜ì´ì§€ì—ì„œ SAST ìŠ¤ìº”ì„ ë¨¼ì € ì‹¤í–‰í•´ ì£¼ì„¸ìš”.":"Git ê´€ë¦¬ í˜ì´ì§€ì—ì„œ SCA ìŠ¤ìº”ì„ ë¨¼ì € ì‹¤í–‰í•´ ì£¼ì„¸ìš”."]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"ê¶Œì¥ ì¡°ì¹˜:"})," Critical ë° High ë“±ê¸‰ì˜ ì·¨ì•½ì ì„ ë¨¼ì € í•´ê²°í•œ í›„ ",p,"ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤."]})})}),e.jsxs(Lp,{type:"secondary",style:{fontSize:12,display:"block",textAlign:"center"},children:["ìœ„ ê²½ê³ ì—ë„ ë¶ˆêµ¬í•˜ê³  ",p,"ë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"]})]})})},Ap=s=>{var t,r,n;if((t=s==null?void 0:s.summary)!=null&&t.severity_breakdown){const a=s.summary.severity_breakdown;return{critical:a.critical||0,high:a.high||0,medium:a.medium||0,low:a.low||0}}if((n=(r=s==null?void 0:s.result)==null?void 0:r.scan_result)!=null&&n.results){const a={critical:0,high:0,medium:0,low:0};for(const i of s.result.scan_result.results)if(i.vulnerabilities)for(const l of i.vulnerabilities){const d=(l.severity||"").toUpperCase();d==="CRITICAL"?a.critical++:d==="HIGH"?a.high++:d==="MEDIUM"?a.medium++:d==="LOW"&&a.low++}return a}return null},{Option:xi}=Ee,BS=()=>{var Du,Fu,Uu,Hu,Vu,qu;const{gitlabTokenModalOpen:s,setGitlabTokenModalOpen:t,pendingRepoId:r,setPendingRepoId:n,gitlabTokenInput:a,setGitlabTokenInput:i,gitlabBaseUrlInput:l,setGitlabBaseUrlInput:d,commitModalOpen:c,setCommitModalOpen:p,commitModalActiveTab:h,setCommitModalActiveTab:x,buildModalOpen:_,setBuildModalOpen:S,buildModalActiveTab:L,setBuildModalActiveTab:k,tokenInputModalOpen:E,setTokenInputModalOpen:P,tokenInputServiceId:I,setTokenInputServiceId:$,tokenInputServiceName:y,setTokenInputServiceName:v,tokenInputGitlabUrl:u,setTokenInputGitlabUrl:m,openTokenInputModal:j,closeTokenInputModal:b,securityModalOpen:A,setSecurityModalOpen:W,securityModalRepoId:Z,setSecurityModalRepoId:se,securityModalRepoName:ce,setSecurityModalRepoName:D,securityModalRepoUrl:M,setSecurityModalRepoUrl:K,securityModalType:J,setSecurityModalType:te,openSecurityModal:G,closeSecurityModal:q,dastParamsModalOpen:oe,setDastParamsModalOpen:be,dastParamsRepoId:ne,setDastParamsRepoId:ye,dastParamsRepoName:Ue,setDastParamsRepoName:N,dastParamsRepoUrl:ge,setDastParamsRepoUrl:Ce,dastParamsServiceId:je,setDastParamsServiceId:Pe,openDastParamsModal:w,closeDastParamsModal:R,isModalOpen:U,setIsModalOpen:V,isMemberModalOpen:F,setIsMemberModalOpen:X,isEditModalOpen:de,setIsEditModalOpen:Ne,activeInfoModal:ae,setActiveInfoModal:pe,selectedInfraModal:Xe,setSelectedInfraModal:Nt,currentSelectedInfraName:Fe,setCurrentSelectedInfraName:Le,modalSastData:Oe,setModalSastData:Mt,sastModalView:Ve,setSastModalView:Me,isSastScanInProgress:ot,setIsSastScanInProgress:Bt,operateModalOpen:Ps,setOperateModalOpen:ir,operateCurrentService:Ut,setOperateCurrentService:Ge,operateServerHops:et,setOperateServerHops:tt,operateInfraId:Vt,setOperateInfraId:lt,openOperateModal:Rt,closeOperateModal:St,dastModalOpen:ms,setDastModalOpen:Ts,dastResult:ds,setDastResult:fs,gitlabAuthLoading:Cs,setGitlabAuthLoading:gr,gitlabAuthStatus:Rr,setGitlabAuthStatus:Ss,registryTestLoading:Rn,setRegistryTestLoading:fn,registryAuthStatus:Os,setRegistryAuthStatus:Ms,resetAuthStatus:Ht}=LS(),[Dt,zr]=o.useState([]),[nn,zn]=o.useState(1),[Ys,En]=o.useState(10),[Pn,Mr]=o.useState(""),[Lr,Xn]=o.useState({}),[ea,or]=o.useState(!0),[ss,rs]=o.useState([]),[Hn,yn]=o.useState(null),{sourceRepository:cn,updateSecurityState:ys,updateSecurityLastUpdate:Jt}=Gs(),an=o.useCallback((C,re,he)=>{let Te=cn.find(st=>st.baseUrl===C&&(he!==void 0?st.serviceId===he:st.serviceId===void 0));if(!Te&&he!==void 0&&(Te=cn.find(st=>st.baseUrl===C&&st.serviceId===void 0)),!Te)return"null";const Ye=`${re}State`;return Te[Ye]||"null"},[cn]),dn=o.useCallback((C,re,he)=>{let Te=cn.find(st=>st.baseUrl===C&&(he!==void 0?st.serviceId===he:st.serviceId===void 0));if(!Te&&he!==void 0&&(Te=cn.find(st=>st.baseUrl===C&&st.serviceId===void 0)),!Te)return null;const Ye=`${re}LastUpdate`;return Te[Ye]||null},[cn]),{loadServerInfo:un}=TS(),[nt,Gt]=o.useState(null),{repositoryStats:fe,repositoryStatsLoading:Be,setRepositoryStats:dt,fetchRepositoryStatistics:ns,buildStats:Ds,buildEnvironment:hn,buildStatsLoading:Ar,setBuildStats:Nr,setBuildEnvironment:Mn,fetchBuildStatistics:jn}=RS(),[ba,Fa]=o.useState(null),{user:Ur}=Tn(),bn=o.useRef(null),Vn=o.useRef(null),_a=o.useRef(0),Ua=o.useRef(null),Ha=o.useRef(!1),Va=o.useCallback(()=>{Vn.current&&(clearInterval(Vn.current),Vn.current=null)},[]),[wa,Gr]=o.useState(null),[oa,le]=o.useState(null),[me,De]=o.useState(0),[zt,Ls]=o.useState(!1),[Br,Ln]=o.useState(!1),[Sa,Ma]=o.useState(!1),[jr,Wr]=o.useState(null),[li,qa]=o.useState({}),[Ci,Xr]=o.useState(!1),[ko,Ga]=o.useState(null),[Co,ci]=o.useState(null),[va,la]=o.useState([]),[xr,en]=o.useState(null),[_e,An]=o.useState(null),[Wa,di]=o.useState([]),[z,Q]=o.useState(!1),[ke,Re]=o.useState(!1),[ut,$t]=o.useState(null),[Hr,us]=o.useState(!1),[Nn,Ka]=o.useState([]),[Ii,ui]=o.useState(!1),hi=()=>V(!0),Ti=()=>{V(!1)},[Ya,Ja]=o.useState(null),[Za,Vi]=o.useState(""),[Io,To]=o.useState(""),[La,Ro]=o.useState(""),[qi,Gi]=o.useState("main"),[cl,pi]=o.useState([]),[Wi,Ki]=o.useState(!1),Yi=C=>{Ti(),Vi(""),To(""),Ro(""),Gi("main"),$c(null),hl(""),Oc([]),pl(null),Fc(""),Hc(""),Vc(""),qc(""),pi([]),Ki(!1),Wc(null),Ja(C)},zc=()=>{Ri(),setTimeout(()=>hi(),80)},Ri=()=>{Ja(null),Vi(""),To(""),Ro(""),Gi("main"),$c(null),hl(""),Oc([]),pl(null),Fc(""),Hc(""),Vc(""),qc(""),pi([]),Ki(!1),Wc(null)},Ec=async()=>{if(!qn||!Za||!La||!qi){f.warning("í”„ë¡œì íŠ¸ ì´ë¦„, Git URL, ë¸Œëœì¹˜ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}try{const C={id:0,name4kiwi:Za,name:Za,gitlabUrl:qn+"/"+La,gitlabBranch:qi,lastCommit:new Date().toLocaleString(),status:"active",creatorId:Ur?Ur.id:0,hasRepository:!0},re=await Xt.add(C),he=typeof re.data=="object"&&re.data!==null&&"id"in re.data?re.data.id:C.id,Te={...C,id:he};zr(Ye=>[...Ye,Te]),f.success("GitLab í”„ë¡œì íŠ¸ê°€ ìƒì„±ë˜ì–´ ìƒˆ ì„œë¹„ìŠ¤ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."),Ri(),Ti()}catch(C){f.error(`í”„ë¡œì íŠ¸ ìƒì„± ì‹¤íŒ¨: ${C instanceof Error?C.message:String(C)}`)}},Pc=async()=>{if(!Za||!Io){f.warning("ìƒˆ í”„ë¡œì íŠ¸ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(!qn){f.warning("Git URLì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}try{const C={id:0,name4kiwi:Za,name:Io,gitlabUrl:qn,gitlabBranch:"main",creatorId:Ur?Ur.id:0,hasRepository:!1,group:Mo,groupFullPath:tm},re=await Xt.add(C),he=typeof re.data=="object"&&re.data!==null?{...C,...re.data}:C;zr(Te=>[...Te,he]),f.success("GitLab í”„ë¡œì íŠ¸ê°€ ìƒì„±ë˜ì–´ ìƒˆ ì„œë¹„ìŠ¤ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."),Ri(),Ti()}catch(C){f.error(`í”„ë¡œì íŠ¸ ìƒì„± ì‹¤íŒ¨: ${C instanceof Error?C.message:String(C)}`)}},Mc=async()=>{if(!qn||!Mo){f.warning("ê·¸ë£¹ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}if(!Gc){f.warning("ë¶€ì—¬í•  ê¶Œí•œì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}if(!Dc||!Uc||!gl||!xl){f.warning("ìƒì„±í•  ê³„ì • ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(gl)){f.warning("ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");return}if(xl.length<8){f.warning("ë¹„ë°€ë²ˆí˜¸ëŠ” 8ê¸€ì ì´ìƒìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}try{const re={gitlabUrl:qn,groupID:Mo,userAuth:Gc,username:Dc,name:Uc,email:gl,password:xl};(await Xt.createUser(re)).success&&f.success("Gitlab ê³„ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."),Ri(),Ti()}catch(re){console.error(`Gitlab ê³„ì • ìƒì„± ì‹¤íŒ¨: ${re instanceof Error?re.message:String(re)}`)}},Ji=async C=>{let re;try{const pt=await gn.getServices();re=pt==null?void 0:pt.find(kt=>kt.id===C.id)}catch(pt){console.error("[GitManagement] ì„œë¹„ìŠ¤ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨, ìºì‹œëœ ì •ë³´ ì‚¬ìš©:",pt),re=ss.find(kt=>kt.id===C.id)}if(Wa.length===0){Q(!0);try{const pt=await Wd();di(pt),pt.length===0&&f.warning("ë“±ë¡ëœ ì¸í”„ë¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì¸í”„ë¼ë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”.")}catch(pt){console.error("[GitManagement] ì¸í”„ë¼ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",pt),f.error("ì¸í”„ë¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì½˜ì†”ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")}finally{Q(!1)}}let he="",Te=C.gitlabBranch,Ye="";if(re!=null&&re.gitlab_config)try{const pt=JSON.parse(re.gitlab_config);he=pt.token||pt.access_token||"",Te=pt.branch||Te,Ye=pt.username||""}catch(pt){console.warn("[GitManagement] GitLab config íŒŒì‹± ì‹¤íŒ¨:",pt)}!he&&(re!=null&&re.gitlab_access_token)&&(he=re.gitlab_access_token);let st="harbor",bt="",Zt="",Lt="",js="";if(re!=null&&re.registry_config)try{const pt=JSON.parse(re.registry_config);st=pt.registry_type==="dockerhub"?"dockerhub":"harbor",bt=pt.registry_url||"",Zt=pt.username||"",Lt=pt.password||"",js=pt.project_name||""}catch(pt){console.warn("[GitManagement] Registry config íŒŒì‹± ì‹¤íŒ¨:",pt)}if(An({id:C.id,serviceName:C.name,gitlabUrl:C.gitlabUrl,gitlabBranch:Te,gitlabAccessToken:he,gitlabUsername:Ye,infraId:re==null?void 0:re.infra_id,registryType:st,registryUrl:bt,registryUsername:Zt,registryPassword:Lt,registryProjectName:js}),Ss(he&&Ye?"success":"idle"),Ms(bt&&Zt&&Lt?"success":"idle"),he){ui(!0);try{const pt=await vu(C.id,he);Ka(pt.map(kt=>({name:kt.name,default:kt.default})))}catch(pt){console.error("[GitManagement] ë¸Œëœì¹˜ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",pt),Ka([])}finally{ui(!1)}}else Ka([]);Ne(!0)},Lc=async()=>{const C=Rr!=="success",re=Os!=="success";C&&re?f.warning("GitLab ì €ì¥ì†Œ ë° Container Registry ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ì¸ì¦ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”."):C?f.warning("GitLab ì €ì¥ì†Œ ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ì¸ì¦ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”."):re&&f.warning("Container Registry ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ì¸ì¦ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.");try{const he=await gn.updateServiceInfo(_e);if((_e!=null&&_e.gitlabBranch||_e!=null&&_e.gitlabAccessToken)&&await gn.updateServiceGitLabConfig(_e.id,{branch:_e.gitlabBranch,access_token:_e.gitlabAccessToken,username:_e.gitlabUsername}),_e!=null&&_e.registryUrl||_e!=null&&_e.registryUsername){const{updateServiceRegistryConfig:Ye}=await vn(async()=>{const{updateServiceRegistryConfig:st}=await Promise.resolve().then(()=>c0);return{updateServiceRegistryConfig:st}},void 0);await Ye(_e.id,_e.registryUrl||"",_e.registryType||"harbor",_e.registryProjectName,_e.registryUsername,_e.registryPassword)}zr(Ye=>Ye.map(st=>st.id===he.id?{...st,...he}:st));const Te=await gn.getServices();rs(Te||[]),C||re?f.success("ì„œë¹„ìŠ¤ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ì¸ì¦ì„ ì™„ë£Œí•˜ë©´ ëª¨ë“  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."):f.success("ì„œë¹„ìŠ¤ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤."),Ss("idle"),Ms("idle"),Ne(!1)}catch(he){f.error("ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),console.error("ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì • ì‹¤íŒ¨:",he)}},Ac=()=>{Ne(!1),Ss("idle"),Ms("idle")},ca=(C,re)=>{An(he=>he&&{...he,[C]:re})},ve=async()=>{if(!(_e!=null&&_e.gitlabUrl)||!(_e!=null&&_e.gitlabAccessToken)){f.warning("GitLab URLê³¼ Access Tokenì„ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.");return}try{ui(!0);const C=_e.gitlabUrl,re=new URL(C),he=`${re.protocol}//${re.host}`,Te=re.pathname.replace(/^\//,"").replace(/\.git$/,""),Ye=encodeURIComponent(Te),st=`${he}/api/v4/projects/${Ye}/repository/branches?per_page=100`,bt=await fetch(st,{headers:{"PRIVATE-TOKEN":_e.gitlabAccessToken}});if(!bt.ok)throw new Error(`GitLab API í˜¸ì¶œ ì‹¤íŒ¨ (Status: ${bt.status})`);const Zt=await bt.json();Ka(Zt.map(Lt=>({name:Lt.name,default:Lt.default||!1}))),f.success(`ë¸Œëœì¹˜ ${Zt.length}ê°œë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.`)}catch(C){console.error("[loadServiceBranches] ë¸Œëœì¹˜ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",C),f.error("ë¸Œëœì¹˜ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. GitLab URLê³¼ Access Tokenì„ í™•ì¸í•´ì£¼ì„¸ìš”."),Ka([])}finally{ui(!1)}},He=C=>{Fa(C),X(!0)},qe=()=>{X(!1),Fa(null)},[Qe,mt]=o.useState(!1),[Ae,yt]=o.useState(null),[Vs,Qs]=o.useState(null),[as,Xs]=o.useState(null),[da,vs]=o.useState(null),[lr,Js]=o.useState(null),[Rs,mr]=o.useState(!1),[Qa,Xa]=o.useState(null),Aa=o.useCallback(async C=>{try{const re=await Xt.getSastResult(C),he=re==null?void 0:re.data;if(!he)return null;if(typeof he.result=="string")try{return{...JSON.parse(he.result)||{},status:he.status}}catch(Te){return{status:he.status}}if(he.semgrep!==void 0||he.codeql!==void 0||he.status!==void 0){const Te=Dt.find(st=>st.id===C);if(Te&&(ys(Te.gitlabUrl,"sast",he.status||"idle",Te.id),he.last_update))try{const st=new Date(String(he.last_update)).toISOString();Jt(Te.gitlabUrl,"sast",st,Te.id)}catch(st){Jt(Te.gitlabUrl,"sast",String(he.last_update))}return{...he,executionLogs:{semgrep:he.semgrep_command_log||"",codeql:he.codeql_command_log||"",trivy:he.trivy_command_log||""}}}return he.result&&typeof he.result=="object"?{...he.result,status:he.status}:null}catch(re){return null}},[ys,Jt,Dt]),dl=o.useCallback(async()=>nt!=null&&nt.id?await Aa(nt.id):null,[nt==null?void 0:nt.id,Aa]),{fetchResult:ul}=SS({analysisType:"sast",repoId:(nt==null?void 0:nt.id)||0,fetchFn:dl,visible:!1,autoFetch:!1});o.useCallback(async C=>{try{const re=await Xt.getScaResult(C),he=re==null?void 0:re.data;if(!he||!he.result)return null;const Te=Dt.find(Ye=>Ye.id===C);if(Te&&he.status){const st={completed:"completed",failed:"failed",not_found:"idle"}[he.status]||"idle";ys(Te.gitlabUrl,"sca",st,Te.id),he.scan_date&&Jt(Te.gitlabUrl,"sca",he.scan_date,Te.id)}return he.result}catch(re){return null}},[ys,Jt,Dt]),o.useCallback(async C=>{try{const re=await Xt.getDastResult(C),he=re==null?void 0:re.data;if(!he||!he.result)return null;const Te=Dt.find(Ye=>Ye.id===C);if(Te&&he.status){const st={completed:"completed",failed:"failed",not_found:"idle"}[he.status]||"idle";ys(Te.gitlabUrl,"dast",st,Te.id),he.scan_date&&Jt(Te.gitlabUrl,"dast",he.scan_date,Te.id)}return he.result}catch(re){return null}},[ys,Jt,Dt]);const Zi=o.useCallback(()=>{try{const C=Gs.getState();return{hasGitlab:!!(C.sourceRepository&&C.sourceRepository.length>0),hasDocker:!!(C.imageRegistry&&C.imageRegistry.length>0),hasHops:!!(C.serverlist&&C.serverlist.length>0),sourceRepository:C.sourceRepository||[],dockerRegistry:C.imageRegistry||[],hops:C.serverlist||[]}}catch(C){return{hasGitlab:!1,hasDocker:!1,hasHops:!1,sourceRepository:[],dockerRegistry:[],hops:[]}}},[]),ta=o.useCallback(C=>{var re;try{const he=ss.find(Lt=>Lt.gitlab_url===C);let Te="";if(he!=null&&he.gitlab_config)try{const Lt=JSON.parse(he.gitlab_config);Te=Lt.access_token||Lt.token||""}catch(Lt){console.error("Failed to parse gitlab_config:",Lt)}if(!Te&&(he!=null&&he.gitlab_access_token)&&(Te=he.gitlab_access_token),Te)return{found:!0,token:Te,baseUrl:C,userId:"DB",source:"db"};const Ye=Gs.getState(),st=(re=Ye.sourceRepository)==null?void 0:re.find(Lt=>Lt.baseUrl===C),bt=st?null:(()=>{var pt;const Lt=Ai(C);return(pt=Ye.sourceRepository)==null?void 0:pt.find(kt=>kt.baseUrl===Lt)})(),Zt=st||bt;return Zt?{found:!0,token:Zt.token||"",baseUrl:Zt.baseUrl||Ai(C),userId:Zt.userId||"root",source:"localStorage"}:{found:!1,token:"",baseUrl:Ai(C),userId:"root",source:"none"}}catch(he){return{found:!1,token:"",baseUrl:Ai(C),userId:"root",source:"error"}}},[ss,Ai]),zo=o.useCallback((C,re,he=ss)=>{if(re==="source")return ta(C.gitlabUrl).found?{runnable:!0,disabled:!1}:{runnable:!1,disabled:!0,reason:"ì´ í”„ë¡œì íŠ¸ì˜ GitLab ìê²©ì¦ëª…ì´ ì—†ìŠµë‹ˆë‹¤. ì„¤ì •ì—ì„œ í† í°ì„ ë“±ë¡í•˜ì„¸ìš”."};const Te=C.id;if(!Te)return{runnable:!1,disabled:!0,reason:"ì´ ì €ì¥ì†Œì™€ ì—°ê²°ëœ ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤. ì €ì¥ì†Œë¥¼ ë‹¤ì‹œ ë“±ë¡í•˜ë©´ ìë™ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ìƒì„±ë©ë‹ˆë‹¤."};const Ye=Zi();if(["build","deploy","operate"].includes(re)){const st=he.find(js=>js.id===Te),bt=st==null?void 0:st.infra_id;if(!bt)return{runnable:!1,disabled:!0,reason:"ì¸í”„ë¼ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ ì„¤ì •ì—ì„œ ì¸í”„ë¼ë¥¼ ë¨¼ì € ë“±ë¡í•˜ì„¸ìš”."};if(!Ye.hops.some(js=>js.infraId===bt||!js.infraId)&&!Ye.hasHops&&console.warn(`[isStageRunnable] ì¸í”„ë¼ ${bt}ì˜ ì„œë²„ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ì‹¤í–‰ ì‹œ ì…ë ¥ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`),!ta(C.gitlabUrl).found)return{runnable:!1,disabled:!0,reason:"ì´ í”„ë¡œì íŠ¸ì˜ GitLab ìê²©ì¦ëª…ì´ ì—†ìŠµë‹ˆë‹¤. ì„¤ì •ì—ì„œ í† í°ì„ ë“±ë¡í•˜ì„¸ìš”."}}return{runnable:!0,disabled:!1}},[Zi,ta,ss]),Kx=o.useCallback(C=>{if(!C)return null;const re=Wa.find(Ye=>Ye.id===C);if(!re)return null;const he=nl(re.type),Te=eS(re.type);return{name:re.name,type:he,color:Te}},[Wa]),Yx=o.useCallback(async()=>{if(!a.trim()){f.warning("GitLab í† í°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(!l.trim()){f.warning("GitLab Base URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}try{const C=Gs.getState(),he={baseUrl:l.trim(),token:a.trim(),userId:"root"};if(C.upsertSourceRepository(he),f.success("GitLab í† í°ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."),t(!1),i(""),d(""),r){const Te=Dt.find(Ye=>Ye.id===r);Te&&ns(Te.id,Te.gitlabUrl,ta).catch(Ye=>{}),n(null)}}catch(C){f.error("GitLab í† í° ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},[a,l,r,ns,Dt,ta]),Jx=o.useCallback(async C=>{if(be(!1),!ne||!ge){f.error("ì €ì¥ì†Œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}try{ys(ge,"dast","analyzing",ne),await Xt.dastScanWeb({repo_id:ne,target_url:C.target_url,scan_type:C.scan_type||"baseline",options:C.options}),ys(ge,"dast","completed",ne),Jt(ge,"dast",new Date().toISOString(),ne),se(ne),D(Ue),K(ge),te("dast"),W(!0)}catch(re){ys(ge,"dast","failed",ne),f.error("DAST ìŠ¤ìº” ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},[ne,Ue,ge,ys,Jt]),Zx=async(C,re)=>{var Ye,st,bt,Zt,Lt,js,pt;let he=ss;if(he.length===0)try{he=await gn.getServices()||[],rs(he)}catch(kt){f.error("ì„œë¹„ìŠ¤ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");return}let Te=(Ye=he.find(kt=>kt.id===C.id))==null?void 0:Ye.id;if(Te||(Te=(st=he.find(kt=>kt.gitlab_url===C.gitlabUrl))==null?void 0:st.id),!Te){const kt=he.find(At=>At.name===C.name||At.gitlab_url===C.gitlabUrl||At.name&&C.name&&At.name.toLowerCase()===C.name.toLowerCase());Te=kt==null?void 0:kt.id}if(re==="build"){let kt=ss;if(kt.length===0)try{kt=await gn.getServices()||[],rs(kt)}catch(er){f.error("ì„œë¹„ìŠ¤ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");return}let At=(bt=kt.find(er=>er.id===C.id))==null?void 0:bt.id;if(At||(At=(Zt=kt.find(er=>er.gitlab_url===C.gitlabUrl))==null?void 0:Zt.id),!At){const er=kt.find(ks=>ks.name===C.name||ks.gitlab_url===C.gitlabUrl||ks.name&&C.name&&ks.name.toLowerCase()===C.name.toLowerCase());At=er==null?void 0:er.id}At?(Gt(C),S(!0),jn(At).catch(()=>{Nr({service_id:At,service_name:C.name,total_builds:0,successful_builds:0,failed_builds:0,success_rate:0,average_build_time:0,recent_builds:[],docker_images:[],build_environment:{gitlab_url:"",gitlab_branch:"",docker_compose_files:[],docker_registry:"",build_tool:"podman-compose"}})})):(Wr({repo:C,displayKey:"build"}),Ln(!0));return}if(re==="operate"&&Te){const kt=he.find(At=>At.id===Te);if(kt){Ge(kt);try{const{getServers:At}=await vn(async()=>{const{getServers:ks}=await Promise.resolve().then(()=>nd);return{getServers:ks}},void 0),er=kt.infra_id;if(er){const ks=await At(er);if(ks&&ks.length>0){const Qt=ks[0];Qt.hops&&tt(typeof Qt.hops=="string"?Qt.hops:JSON.stringify(Qt.hops)),lt(er)}}}catch(At){console.error("[GitManagement] ì¸í”„ë¼ SSH ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:",At)}try{const At=await Xt.getDastResult(C.id);fs(At.data)}catch(At){fs(null)}ir(!0);return}}if(re==="source"){if(Gt(C),ta(C.gitlabUrl).found)p(!0),ns(C.id,C.gitlabUrl,ta).catch(At=>{});else{const At=he.find(er=>er.gitlab_url===C.gitlabUrl);At?($(At.id),v(At.name),m(C.gitlabUrl),P(!0)):f.warning("GitLab í† í°ì´ ì—†ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ ë“±ë¡ ì‹œ GitLab Access Tokenì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")}return}try{if(["build","deploy"].includes(re)){let kt=ss;if(kt.length===0)try{kt=await gn.getServices()||[],rs(kt)}catch(Qt){f.error("ì„œë¹„ìŠ¤ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");return}let At=(Lt=kt.find(Qt=>Qt.id===C.id))==null?void 0:Lt.id;if(At||(At=(js=kt.find(Qt=>Qt.gitlab_url===C.gitlabUrl))==null?void 0:js.id),!At){const Qt=kt.find(Sr=>Sr.name===C.name||Sr.gitlab_url===C.gitlabUrl||Sr.name&&C.name&&Sr.name.toLowerCase()===C.name.toLowerCase());At=Qt==null?void 0:Qt.id}if(!At){f.error("ì—°ê²°ëœ ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ë¥¼ ë‹¤ì‹œ ë“±ë¡í•´ì£¼ì„¸ìš”.");return}const er=Zi();if(!er.hasHops||!er.hasGitlab){Wr({repo:C,displayKey:re}),Xr(!0);try{let Qt=[],Sr=null,Fs=null,_n="",As="",ls="";if(re==="deploy"){const It=await un(At);if(It)Qt=It.hops,Sr=It.serverId,Fs=It.infraId,ls=It.registryUrl||"",_n=It.registryUsername||"",As=It.registryPassword||"",Ga(Sr),ci(Fs);else{f.warning("ë°°í¬í•˜ê¸° ì „ì— ë¨¼ì € ë¹Œë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí•´ì£¼ì„¸ìš”."),Xr(!1);return}try{const{buildApi:ft}=await vn(async()=>{const{buildApi:We}=await Promise.resolve().then(()=>ec);return{buildApi:We}},void 0),ht=await ft.getServiceBuildVersions(At);ht&&Object.keys(ht).length>0&&en(ht)}catch(ft){console.error("[GitManagement]  ì„œë¹„ìŠ¤ë³„ ë¹Œë“œ ë²„ì „ ì¡°íšŒ ì‹¤íŒ¨, ê¸°ì¡´ ë²ˆë“¤ ë°©ì‹ ì‚¬ìš©:",ft)}try{const ft=It.buildStats;if(ft!=null&&ft.recent_builds&&ft.recent_builds.length>0){const ht=ft.recent_builds.filter(We=>We.status==="success").map(We=>{var Ws;let Ot="",vt="",qs=We.image_tag||"",hs="",Yr=We.registry||"",tn="",Or=We.built_images||[];if(We.details_data)try{const ts=typeof We.details_data=="string"?JSON.parse(We.details_data):We.details_data.Valid&&We.details_data.String?JSON.parse(We.details_data.String):We.details_data;qs=qs||ts.image_tag||"",Ot=ts.docker_username||"",vt=ts.docker_password||"",hs=ts.registry_type||"",Yr=Yr||ts.registry_url||"",tn=ts.registry_project||"",Or.length===0&&(Or=ts.built_images||[])}catch(ts){}return{id:We.id,pipeline_id:We.pipeline_id,image_tag:qs,started_at:We.started_at,infra_name:((Ws=We.build_infra_name)==null?void 0:Ws.String)||We.build_infra_name||"N/A",docker_username:Ot,docker_password:vt,registry_type:hs,registry_url:Yr,registry_project:tn,built_images:Or}}).filter(We=>We.image_tag||We.built_images&&We.built_images.length>0).sort((We,Ot)=>new Date(Ot.started_at).getTime()-new Date(We.started_at).getTime());ht.length>0&&la(ht)}}catch(ft){}}else{const It=await gn.getServiceServers(At);Qt=JSON.parse(It.hops||"[]")}const{useCredsStore:es}=await vn(async()=>{const{useCredsStore:It}=await Promise.resolve().then(()=>Vo);return{useCredsStore:It}},void 0),bs=es.getState(),{sourceRepository:tr,serverlist:$r}=bs,Kr=tr.find(It=>C.gitlabUrl.includes(It.baseUrl)||It.baseUrl.includes(C.gitlabUrl)),br=Qt.map(It=>{const ft=$r.find(ht=>{var We,Ot;return((We=ht.host)==null?void 0:We.toLowerCase())===((Ot=It.host)==null?void 0:Ot.toLowerCase())&&(ht.port||22)===(It.port||22)});return{...It,username:(ft==null?void 0:ft.userId)||It.username||"",password:""}}),Er={serviceId:At,infraType:C.infraType,gitUrl:C.gitlabUrl,dockerRegistry:re==="deploy"?ls||C.dockerRegistry||"":C.dockerRegistry||"",hops:br,deployServerId:re==="deploy"?Sr:void 0,deployInfraId:re==="deploy"?Fs:void 0,credentials:re==="deploy"?{username_repo:(Kr==null?void 0:Kr.userId)||"",password_repo:(Kr==null?void 0:Kr.token)||"",docker_username:_n,docker_password:As}:void 0};qa(Er),Ls(!0)}catch(Qt){f.info("ì´ í”„ë¡œì íŠ¸ì— ì—°ê²°ëœ ì¸í”„ë¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë°°í¬í•  ì¸í”„ë¼ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");try{const Sr=kt.find(Fs=>Fs.id===At);if(Sr&&Sr.infra_id){const Fs=await yu.getById(Sr.infra_id);Fs.success&&Fs.data&&Le(Fs.data.name)}else Le(void 0)}catch(Sr){Le(void 0)}yn({repo:C,displayKey:re}),vs(C),Nt(!0),f.error("ì„œë²„ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{Xr(!1)}return}if(re==="deploy"){const Qt=kt.find(Fs=>Fs.id===At);if(!((pt=Lr[At])==null?void 0:pt.some(Fs=>Fs.step_name==="deploy"))&&!(Qt!=null&&Qt.is_deployed)){Wr({repo:C,displayKey:re}),Xr(!0);try{const Fs=await un(At);if(!Fs){f.warning("ë°°í¬í•˜ê¸° ì „ì— ë¨¼ì € ë¹Œë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí•´ì£¼ì„¸ìš”."),Xr(!1);return}const _n=Fs.hops,As=Fs.registryUrl||"",ls=Fs.registryUsername||"",es=Fs.registryPassword||"";Ga(Fs.serverId),ci(Fs.infraId);try{const{buildApi:ft}=await vn(async()=>{const{buildApi:We}=await Promise.resolve().then(()=>ec);return{buildApi:We}},void 0),ht=await ft.getServiceBuildVersions(At);ht&&Object.keys(ht).length>0&&en(ht)}catch(ft){console.error("[GitManagement]  ì„œë¹„ìŠ¤ë³„ ë¹Œë“œ ë²„ì „ ì¡°íšŒ ì‹¤íŒ¨ (ì²« ë°°í¬), ê¸°ì¡´ ë²ˆë“¤ ë°©ì‹ ì‚¬ìš©:",ft)}try{const ft=Fs.buildStats;if(ft!=null&&ft.recent_builds&&ft.recent_builds.length>0){const ht=ft.recent_builds.filter(We=>We.status==="success").map(We=>{var Ws;let Ot="",vt="",qs=We.image_tag||"",hs="",Yr=We.registry||"",tn="",Or=We.built_images||[];if(We.details_data)try{const ts=typeof We.details_data=="string"?JSON.parse(We.details_data):We.details_data.Valid&&We.details_data.String?JSON.parse(We.details_data.String):We.details_data;qs=qs||ts.image_tag||"",Ot=ts.docker_username||"",vt=ts.docker_password||"",hs=ts.registry_type||"",Yr=Yr||ts.registry_url||"",tn=ts.registry_project||"",Or.length===0&&(Or=ts.built_images||[])}catch(ts){}return{id:We.id,pipeline_id:We.pipeline_id,image_tag:qs,started_at:We.started_at,infra_name:((Ws=We.build_infra_name)==null?void 0:Ws.String)||We.build_infra_name||"N/A",docker_username:Ot,docker_password:vt,registry_type:hs,registry_url:Yr,registry_project:tn,built_images:Or}}).filter(We=>We.image_tag||We.built_images&&We.built_images.length>0);ht.length>0&&la(ht)}}catch(ft){}const{useCredsStore:bs}=await vn(async()=>{const{useCredsStore:ft}=await Promise.resolve().then(()=>Vo);return{useCredsStore:ft}},void 0),tr=bs.getState(),{sourceRepository:$r,serverlist:Kr}=tr,br=$r.find(ft=>C.gitlabUrl.includes(ft.baseUrl)||ft.baseUrl.includes(C.gitlabUrl)),Er=_n.map(ft=>{const ht=Kr.find(We=>{var Ot,vt;return((Ot=We.host)==null?void 0:Ot.toLowerCase())===((vt=ft.host)==null?void 0:vt.toLowerCase())&&(We.port||22)===(ft.port||22)});return{...ft,username:(ht==null?void 0:ht.userId)||ft.username||"",password:""}}),It={serviceId:At,infraType:C.infraType,gitUrl:C.gitlabUrl,dockerRegistry:As||C.dockerRegistry||"",hops:Er,deployServerId:Fs.serverId,deployInfraId:Fs.infraId,credentials:{username_repo:(br==null?void 0:br.userId)||"",password_repo:(br==null?void 0:br.token)||"",docker_username:ls,docker_password:es}};qa(It),Ls(!0)}catch(Fs){f.error("ì„œë²„ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{Xr(!1)}return}}mr(!0);const ks=await Bi.getLatestStepDetails(At,re);Xa(ks),mt(!0),Qs(C),Xs(re),Me("summary"),Mt(null),mr(!1);return}}catch(kt){f.error("ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),mt(!1)}finally{mr(!1)}},Nc=()=>{mt(!1),yt(null),Qs(null),Xs(null),Mt(null),Xa(null),Ua.current=null},zi=o.useCallback(()=>{bn.current&&(clearInterval(bn.current),bn.current=null,Gr(null))},[]),Eo=o.useCallback(async(C=!1)=>{if(Dt.length===0){or(!1);return}C&&or(!0);try{const re=Dt.map(bt=>bt.id).filter(bt=>bt!=null);if(re.length===0){or(!1);return}const he=await Bi.getBatchPipelineStatus(re);let Te=!1,Ye=!1,st=!1;Xn(bt=>{const Zt={...bt};return Dt.forEach(Lt=>{const js=he[Lt.id];if(js&&js.length>0){const pt=bt[Lt.id];if(pt&&pt.length>0&&js.forEach(kt=>{const At=pt.find(er=>er.step_name===kt.step_name);At&&(At.status,kt.status)}),Zt[Lt.id]=js,js.some(kt=>Pd(kt.status)==="running")&&(Te=!0),oa&&Lt.id===oa.serviceId){const kt=js.find(At=>At.step_name===oa.stepName);kt&&kt.status!=="running"&&(Ye=!0,st=kt.status==="success")}}}),Zt}),Ye&&oa&&(le(null),Gr(null),Wr(null),oa.stepName==="build"&&De(bt=>bt+1)),Te?_a.current=0:bn.current&&(_a.current+=1,_a.current>=6&&(zi(),_a.current=0))}catch(re){zi()}finally{C&&or(!1)}},[Dt,zi,oa]),Ei=o.useCallback(()=>{zi(),_a.current=0,Eo(),bn.current=setInterval(()=>{Eo()},5e3)},[Eo,zi]);o.useEffect(()=>()=>{zi()},[zi]),o.useEffect(()=>{const C=()=>{Vn.current&&(clearInterval(Vn.current),Vn.current=null)};return C(),()=>{C()}},[Qe,as,Oe==null?void 0:Oe.status,Vs,ss]),o.useEffect(()=>{if(!lr)return;const{repo:C,displayKey:re}=lr,he=Lr[C.id];if(!he||he.length===0)return;he.find(Ye=>Ye.step_name==="deploy")&&(Xa(null),Qs(C),Xs(re),mt(!0),Js(null))},[lr,Lr]);const Pu=o.useCallback(async(C,re)=>{var Ye,st,bt,Zt,Lt,js;Nc();let he=ss;if(he.length===0)try{he=await gn.getServices()||[],rs(he)}catch(pt){f.error("ì„œë¹„ìŠ¤ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");return}let Te=(Ye=he.find(pt=>pt.id===C.id))==null?void 0:Ye.id;if(Te||(Te=(st=he.find(pt=>pt.gitlab_url===C.gitlabUrl))==null?void 0:st.id),!Te){const pt=he.find(kt=>kt.name===C.name||kt.gitlab_url===C.gitlabUrl||kt.name&&C.name&&kt.name.toLowerCase()===C.name.toLowerCase());Te=pt==null?void 0:pt.id}if(!Te){f.error("ì—°ê²°ëœ ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ë¥¼ ë‹¤ì‹œ ë“±ë¡í•˜ë©´ ìë™ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ìƒì„±ë©ë‹ˆë‹¤.");return}Wr({repo:C,displayKey:re}),Xr(!0);try{let pt=[],kt=null,At=null,er="",ks="",Qt="";if(re==="deploy"){const ht=await un(Te);if(ht)pt=ht.hops,kt=ht.serverId,At=ht.infraId,Qt=ht.registryUrl||"",er=ht.registryUsername||"",ks=ht.registryPassword||"",Ga(kt),ci(At);else{f.warning("ë°°í¬í•˜ê¸° ì „ì— ë¨¼ì € ë¹Œë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí•´ì£¼ì„¸ìš”."),Xr(!1);return}try{const{buildApi:We}=await vn(async()=>{const{buildApi:vt}=await Promise.resolve().then(()=>ec);return{buildApi:vt}},void 0),Ot=await We.getServiceBuildVersions(Te);Ot&&Object.keys(Ot).length>0&&en(Ot)}catch(We){console.error("[GitManagement]  ì„œë¹„ìŠ¤ë³„ ë¹Œë“œ ë²„ì „ ì¡°íšŒ ì‹¤íŒ¨ (handleExecuteStage), ê¸°ì¡´ ë²ˆë“¤ ë°©ì‹ ì‚¬ìš©:",We)}try{const We=ht.buildStats;if(We!=null&&We.recent_builds&&We.recent_builds.length>0){const Ot=We.recent_builds.filter(vt=>vt.status==="success").map(vt=>{var ua;let qs="",hs="",Yr=vt.image_tag||"",tn="",Or=vt.registry||"",Ws="",ts=vt.built_images||[];if(vt.details_data)try{const sn=typeof vt.details_data=="string"?JSON.parse(vt.details_data):vt.details_data.Valid&&vt.details_data.String?JSON.parse(vt.details_data.String):vt.details_data;Yr=Yr||sn.image_tag||"",qs=sn.docker_username||"",hs=sn.docker_password||"",tn=sn.registry_type||"",Or=Or||sn.registry_url||"",Ws=sn.registry_project||"",ts.length===0&&(ts=sn.built_images||[])}catch(sn){}return{id:vt.id,pipeline_id:vt.pipeline_id,image_tag:Yr,started_at:vt.started_at,infra_name:((ua=vt.build_infra_name)==null?void 0:ua.String)||vt.build_infra_name||"N/A",docker_username:qs,docker_password:hs,registry_type:tn,registry_url:Or,registry_project:Ws,built_images:ts}}).filter(vt=>vt.image_tag||vt.built_images&&vt.built_images.length>0).sort((vt,qs)=>new Date(qs.started_at).getTime()-new Date(vt.started_at).getTime());Ot.length>0&&la(Ot)}}catch(We){}}else{const ht=await gn.getServiceServers(Te);pt=JSON.parse(ht.hops||"[]")}const{useCredsStore:Sr}=await vn(async()=>{const{useCredsStore:ht}=await Promise.resolve().then(()=>Vo);return{useCredsStore:ht}},void 0),Fs=Sr.getState(),{imageRegistry:_n,sourceRepository:As,serverlist:ls}=Fs,es=pt.map(ht=>{const We=ls.find(Ot=>{var vt,qs;return((vt=Ot.host)==null?void 0:vt.toLowerCase())===((qs=ht.host)==null?void 0:qs.toLowerCase())&&(Ot.port||22)===(ht.port||22)});return{...ht,username:(We==null?void 0:We.userId)||ht.username||"",password:""}}),bs=C.gitlabUrl,tr=As.find(ht=>bs.includes(ht.baseUrl)||ht.baseUrl.includes(bs)),$r={serviceId:Te,infraType:C.infraType,gitUrl:C.gitlabUrl,dockerRegistry:re==="deploy"?Qt||C.dockerRegistry||"":C.dockerRegistry||"",hops:es,deployServerId:re==="deploy"?kt:void 0,deployInfraId:re==="deploy"?At:void 0,credentials:re==="deploy"?{username_repo:(tr==null?void 0:tr.userId)||"",password_repo:(tr==null?void 0:tr.token)||"",docker_username:er,docker_password:ks}:void 0};qa($r);const Kr=es.every(ht=>{const We=ls.find(Ot=>{var vt,qs;return((vt=Ot.host)==null?void 0:vt.toLowerCase())===((qs=ht.host)==null?void 0:qs.toLowerCase())&&(Ot.port||22)===(ht.port||22)});return!!(We&&We.password)}),br=!bs||As.some(ht=>bs.includes(ht.baseUrl)||ht.baseUrl.includes(bs)),Er=$r.dockerRegistry,It=!Er||_n.some(ht=>Er.includes(ht.registryUrl)||ht.registryUrl.includes(Er));if(re!=="deploy"&&Kr&&br&&It){Gr(re);try{const ht=es.map(We=>{const Ot=ls.find(vt=>{var qs,hs;return((qs=vt.host)==null?void 0:qs.toLowerCase())===((hs=We.host)==null?void 0:hs.toLowerCase())&&(vt.port||22)===(We.port||22)});return{host:We.host||"",username:(Ot==null?void 0:Ot.userId)||We.username||"",port:We.port||22,password:(Ot==null?void 0:Ot.password)||""}});if(re==="build"){const We=async()=>{try{await Bi.buildImage(Te,ht),le({serviceId:Te,serviceName:C.name,stepName:re,displayKey:re}),f.success(`${re.toUpperCase()} ë‹¨ê³„ ì‹¤í–‰ ì‹œì‘ - ë°±ê·¸ë¼ìš´ë“œì—ì„œ íŒŒì´í”„ë¼ì¸ ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.`),Ei()}catch(Ot){console.error("ë¹Œë“œ ì‹¤í–‰ ì‹¤íŒ¨:",Ot),Ls(!0)}};try{us(!0);const Ot=await Xt.getSastResult(C.id),vt=Ot==null?void 0:Ot.data,qs=(vt==null?void 0:vt.semgrep)||(vt==null?void 0:vt.codeql),hs=sn=>{var ml,fl,yl;const eo={critical:0,high:0,medium:0,low:0};if(!sn)return eo;try{const to=JSON.parse(sn),Jc=(to==null?void 0:to.runs)||[];if(Jc.length===0)return eo;const pm=((ml=Jc[0])==null?void 0:ml.results)||[],gm=ha=>{const on=(ha||"").toLowerCase();return on==="error"||on==="critical"?"critical":on==="warning"||on==="high"?"high":on==="note"||on==="medium"||on==="moderate"?"medium":"low"};for(const ha of pm){let on=((fl=ha.rule)==null?void 0:fl.level)||ha.level||"";if(!on&&ha.properties&&(on=ha.properties.securitySeverity||ha.properties["security-severity"]||ha.properties.severity||""),!on&&ha.rank&&(on=ha.rank),!on&&((yl=ha.properties)!=null&&yl.tags))for(const xm of ha.properties.tags){const jl=(xm||"").toLowerCase();if(jl.includes("critical")){on="critical";break}if(jl.includes("high")){on="high";break}if(jl.includes("medium")){on="medium";break}if(jl.includes("low")){on="low";break}}eo[gm(on)]++}}catch(to){console.warn("SARIF íŒŒì‹± ì˜¤ë¥˜:",to)}return eo},Yr=(Zt=(bt=vt==null?void 0:vt.semgrep)==null?void 0:bt.results)==null?void 0:Zt.sarif_json,tn=(js=(Lt=vt==null?void 0:vt.codeql)==null?void 0:Lt.results)==null?void 0:js.sarif_json,Or=hs(Yr),Ws=hs(tn),ts={critical:Or.critical+Ws.critical,high:Or.high+Ws.high,medium:Or.medium+Ws.medium,low:Or.low+Ws.low};if(!qs||(vt==null?void 0:vt.status)==="not_found"){$t({stage:"build",category:"sast",warningType:"no_analysis",serviceName:C.name,onContinue:()=>{Re(!1),$t(null),We()}}),Re(!0),us(!1),Xr(!1);return}const ua=ts;if(ua.critical>0){$t({stage:"build",category:"sast",warningType:"critical_found",vulnerabilitySummary:ua,serviceName:C.name,onContinue:()=>{Re(!1),$t(null),We()}}),Re(!0),us(!1),Xr(!1);return}us(!1),await We()}catch(Ot){console.warn("SAST ê²°ê³¼ ì¡°íšŒ ì‹¤íŒ¨, ë¹Œë“œ ê³„ì† ì§„í–‰:",Ot),us(!1),await We()}return}le({serviceId:Te,serviceName:C.name,stepName:re,displayKey:re}),f.success(`${re.toUpperCase()} ë‹¨ê³„ ì‹¤í–‰ ì‹œì‘ - ë°±ê·¸ë¼ìš´ë“œì—ì„œ íŒŒì´í”„ë¼ì¸ ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.`),Ei()}catch(ht){Ls(!0)}finally{}}else Ls(!0)}catch(pt){f.error("ì„œë²„ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),Ls(!0)}finally{Xr(!1)}},[Ei,ss]),Qx=o.useCallback(C=>{(async()=>{var st,bt,Zt,Lt,js,pt,kt,At,er;if(!jr)return;if(wa!==null){f.warning(`ì´ë¯¸ ${wa.toUpperCase()} ì‘ì—…ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì™„ë£Œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`);return}const{repo:re,displayKey:he}=jr;let Te=ss;if(Te.length===0)try{Te=await gn.getServices()||[],rs(Te)}catch(ks){}let Ye=(st=Te.find(ks=>ks.id===re.id))==null?void 0:st.id;if(Ye||(Ye=(bt=Te.find(ks=>ks.gitlab_url===re.gitlabUrl))==null?void 0:bt.id),!Ye){const ks=Te.find(Qt=>Qt.name===re.name||Qt.gitlab_url===re.gitlabUrl||Qt.name&&re.name&&Qt.name.toLowerCase()===re.name.toLowerCase());Ye=ks==null?void 0:ks.id}if(!Ye){f.error(`ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. "${re.name}" ì„œë¹„ìŠ¤ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ ëª©ë¡ì„ ìƒˆë¡œê³ ì¹¨í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`),console.error("[GitManagement] ì„œë¹„ìŠ¤ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ:",{repoId:re.id,repoName:re.name,repoGitlabUrl:re.gitlabUrl,availableServices:Te.map(ks=>({id:ks.id,name:ks.name,gitlab_url:ks.gitlab_url}))});return}Gr(he),Ls(!1);try{const ks=li.hops||[],Qt=(Zt=C.hops)!=null?Zt:[],Sr=Gs.getState(),Fs=ks.map((As,ls)=>{var tr;const es=Qt[ls]||{},bs=(tr=Sr.serverlist)==null?void 0:tr.find($r=>{var Kr,br;return((Kr=$r.host)==null?void 0:Kr.toLowerCase())===((br=As.host)==null?void 0:br.toLowerCase())&&($r.port||22)===(As.port||22)});return{...As,port:As.port||22,username:es.username||(bs==null?void 0:bs.userId)||As.username||"",password:es.password||(bs==null?void 0:bs.password)||""}}),_n=(Lt=C.credentials)!=null?Lt:{username_repo:"",password_repo:"",docker_username:"",docker_password:""};if(he==="deploy"&&!_n.username_repo){const As=ss.find(ls=>ls.id===Ye);if(As){const ls=Gs.getState().sourceRepository.find(es=>As.gitlab_url.includes(es.baseUrl)||es.baseUrl.includes(As.gitlab_url));ls&&(_n.username_repo=ls.userId||"",_n.password_repo=ls.token||"")}}if(he==="deploy"&&!_n.docker_username){const As=ss.find(ls=>ls.id===Ye);if(As&&As.registry_config)try{const ls=JSON.parse(As.registry_config),es=(ls==null?void 0:ls.registryUrl)||"";if(es){const bs=Gs.getState().imageRegistry.find(tr=>es.includes(tr.registryUrl)||tr.registryUrl.includes(es));bs&&(_n.docker_username=bs.userId||"",_n.docker_password=bs.password||"")}}catch(ls){}}if(he==="build"){const As=async()=>{try{await Bi.buildImage(Ye,Fs),le({serviceId:Ye,serviceName:re.name,stepName:he,displayKey:he}),f.success(`${he.toUpperCase()} ë‹¨ê³„ ì‹¤í–‰ ì‹œì‘ - ë°±ê·¸ë¼ìš´ë“œì—ì„œ íŒŒì´í”„ë¼ì¸ ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.`),Ei()}catch(ls){console.error("ë¹Œë“œ ì‹¤í–‰ ì‹¤íŒ¨:",ls);const es=ls instanceof Error?ls.message:String(ls);f.error(`ë¹Œë“œ ì‹¤í–‰ ì‹¤íŒ¨ - ${es||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}`),Gr(null)}};try{us(!0);const ls=await Xt.getSastResult(re.id),es=ls==null?void 0:ls.data,bs=(es==null?void 0:es.semgrep)||(es==null?void 0:es.codeql),tr=ht=>{var Ot,vt,qs;const We={critical:0,high:0,medium:0,low:0};if(!ht)return We;try{const hs=JSON.parse(ht),Yr=(hs==null?void 0:hs.runs)||[];if(Yr.length===0)return We;const tn=((Ot=Yr[0])==null?void 0:Ot.results)||[],Or=Ws=>{const ts=(Ws||"").toLowerCase();return ts==="error"||ts==="critical"?"critical":ts==="warning"||ts==="high"?"high":ts==="note"||ts==="medium"||ts==="moderate"?"medium":"low"};for(const Ws of tn){let ts=((vt=Ws.rule)==null?void 0:vt.level)||Ws.level||"";if(!ts&&Ws.properties&&(ts=Ws.properties.securitySeverity||Ws.properties["security-severity"]||Ws.properties.severity||""),!ts&&Ws.rank&&(ts=Ws.rank),!ts&&((qs=Ws.properties)!=null&&qs.tags))for(const ua of Ws.properties.tags){const sn=(ua||"").toLowerCase();if(sn.includes("critical")){ts="critical";break}if(sn.includes("high")){ts="high";break}if(sn.includes("medium")){ts="medium";break}if(sn.includes("low")){ts="low";break}}We[Or(ts)]++}}catch(hs){console.warn("SARIF íŒŒì‹± ì˜¤ë¥˜:",hs)}return We},$r=(pt=(js=es==null?void 0:es.semgrep)==null?void 0:js.results)==null?void 0:pt.sarif_json,Kr=(At=(kt=es==null?void 0:es.codeql)==null?void 0:kt.results)==null?void 0:At.sarif_json,br=tr($r),Er=tr(Kr),It={critical:br.critical+Er.critical,high:br.high+Er.high,medium:br.medium+Er.medium,low:br.low+Er.low};if(!bs||(es==null?void 0:es.status)==="not_found"){$t({stage:"build",category:"sast",warningType:"no_analysis",serviceName:re.name,onContinue:()=>{Re(!1),$t(null),As()}}),Re(!0),us(!1);return}const ft=It;if(ft.critical>0){$t({stage:"build",category:"sast",warningType:"critical_found",vulnerabilitySummary:ft,serviceName:re.name,onContinue:()=>{Re(!1),$t(null),As()}}),Re(!0),us(!1);return}us(!1),await As()}catch(ls){console.warn("SAST ê²°ê³¼ ì¡°íšŒ ì‹¤íŒ¨, ë¹Œë“œ ê³„ì† ì§„í–‰:",ls),us(!1),await As()}}else if(he==="deploy"){const As=C.selected_image_tag,ls=C.selected_service_images,es=async()=>{try{await Bi.applyKubernetes(Ye,Fs,As,ls),le({serviceId:Ye,serviceName:re.name,stepName:he,displayKey:he}),Js({repo:re,displayKey:he}),f.success(`${he.toUpperCase()} ë‹¨ê³„ ì‹¤í–‰ ì‹œì‘ - ë°±ê·¸ë¼ìš´ë“œì—ì„œ íŒŒì´í”„ë¼ì¸ ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.`),Ei()}catch(bs){console.error("ë°°í¬ ì‹¤í–‰ ì‹¤íŒ¨:",bs);const tr=bs instanceof Error?bs.message:String(bs);f.error(`ë°°í¬ ì‹¤í–‰ ì‹¤íŒ¨ - ${tr||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}`),Gr(null)}};try{us(!0);const bs=[];As&&bs.push(As),ls&&Object.values(ls).forEach(It=>{It&&bs.push(It)});const tr=await Xt.getScaResults(re.id,50),$r=((er=tr==null?void 0:tr.data)==null?void 0:er.results)||[],Kr=It=>{var We,Ot;const ft=It.split(":").pop()||It,ht=((We=It.split("/").pop())==null?void 0:We.split(":")[0])||It;for(let vt=0;vt<$r.length;vt++){const qs=$r[vt];if(!qs.result)continue;let hs;if(typeof qs.result=="string")try{hs=JSON.parse(qs.result)}catch(Jc){continue}else hs=qs.result;const Yr=hs==null?void 0:hs.summary,tn=hs==null?void 0:hs.result,Or=tn==null?void 0:tn.scan_result,Ws=hs==null?void 0:hs.metadata,ts=(Yr==null?void 0:Yr.image_name)||(hs==null?void 0:hs.image_name)||(hs==null?void 0:hs.target_image)||(Or==null?void 0:Or.artifact_name)||(tn==null?void 0:tn.artifact_name)||(Ws==null?void 0:Ws.image_name)||"";if(!ts)continue;const ua=ts.toLowerCase(),sn=It.toLowerCase(),eo=ft.toLowerCase(),ml=ht.toLowerCase(),fl=((Ot=ua.split("/").pop())==null?void 0:Ot.split(":")[0])||"",yl=ua.split(":").pop()||"";if(ua===sn||fl===ml&&yl===eo||sn===ua)return hs}return null},br=[],Er=[];for(const It of bs){const ft=Kr(It);if(!ft)br.push(It);else{const ht=Ap(ft);ht&&ht.critical>0&&Er.push({imageUrl:It,vulnerabilities:ht})}}if(bs.length>0&&br.length>0){const It=br.map(We=>We.split(":").pop()||We).join(", ");let ft=`${re.name} - ${br.length}ê°œ ì´ë¯¸ì§€ ë¯¸ë¶„ì„ (${It})`;if(Er.length>0){const We=Er.map(Ot=>Ot.imageUrl.split(":").pop()||Ot.imageUrl).join(", ");ft+=` | ${Er.length}ê°œ ì´ë¯¸ì§€ ì·¨ì•½ì  ë°œê²¬ (${We})`}const ht=Er.reduce((We,Ot)=>({critical:We.critical+Ot.vulnerabilities.critical,high:We.high+Ot.vulnerabilities.high,medium:We.medium+Ot.vulnerabilities.medium,low:We.low+Ot.vulnerabilities.low}),{critical:0,high:0,medium:0,low:0});$t({stage:"deploy",category:"sca",warningType:"no_analysis",serviceName:ft,vulnerabilitySummary:ht.critical>0?ht:void 0,onContinue:()=>{Re(!1),$t(null),es()}}),Re(!0),us(!1);return}if(bs.length===0){if($r.length===0){$t({stage:"deploy",category:"sca",warningType:"no_analysis",serviceName:re.name,onContinue:()=>{Re(!1),$t(null),es()}}),Re(!0),us(!1);return}const It=$r[0];if(It!=null&&It.result)try{const ft=typeof It.result=="string"?JSON.parse(It.result):It.result,ht=Ap(ft);if(ht&&ht.critical>0){$t({stage:"deploy",category:"sca",warningType:"critical_found",vulnerabilitySummary:ht,serviceName:re.name,onContinue:()=>{Re(!1),$t(null),es()}}),Re(!0),us(!1);return}}catch(ft){}}if(Er.length>0){const It=Er.reduce((ht,We)=>({critical:ht.critical+We.vulnerabilities.critical,high:ht.high+We.vulnerabilities.high,medium:ht.medium+We.vulnerabilities.medium,low:ht.low+We.vulnerabilities.low}),{critical:0,high:0,medium:0,low:0}),ft=Er.map(ht=>ht.imageUrl.split(":").pop()||ht.imageUrl).join(", ");$t({stage:"deploy",category:"sca",warningType:"critical_found",vulnerabilitySummary:It,serviceName:`${re.name} (${ft})`,onContinue:()=>{Re(!1),$t(null),es()}}),Re(!0),us(!1);return}us(!1),await es()}catch(bs){console.warn("SCA ê²°ê³¼ ì¡°íšŒ ì‹¤íŒ¨, ë°°í¬ ê³„ì† ì§„í–‰:",bs),us(!1),await es()}}else throw new Error(`'${he}' ë‹¨ê³„ì— ëŒ€í•œ ì‹¤í–‰ ë¡œì§ì´ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`)}catch(ks){const Qt=ks instanceof Error?ks.message:JSON.stringify(ks);Qt.includes("SSH")||Qt.includes("hops")||Qt.includes("ì¸ì¦")||Qt.includes("credentials")||Qt.includes("password")||Qt.includes("token")?(Ls(!0),Gr(null),f.warning("ìê²©ì¦ëª… í™•ì¸ í•„ìš” - SSH ì—°ê²° ì •ë³´ë‚˜ ì¸ì¦ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")):(f.error(`${he.toUpperCase()} ë‹¨ê³„ ì‹¤í–‰ ì‹¤íŒ¨ - ${Qt||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."}`),Gr(null),Wr(null))}})()},[jr,li,Ei,ss,wa]),Xx=()=>{f.success("ì„œë¹„ìŠ¤ ì •ë³´ë¥¼ ìƒˆë¡œê³ ì¹¨í–ˆìŠµë‹ˆë‹¤.")},em=C=>{rt.confirm({title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"8px 0"},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"linear-gradient(135deg, #ff4d4f 0%, #cf1322 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(255, 77, 79, 0.3)"},children:e.jsx(gs,{style:{color:"#fff",fontSize:18}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#262626",lineHeight:1.2},children:"ì„œë¹„ìŠ¤ ì‚­ì œ"}),e.jsx("div",{style:{fontSize:12,color:"#8c8c8c",marginTop:2},children:"ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"})]})]}),content:e.jsxs("div",{style:{padding:"20px 0",fontSize:14,lineHeight:1.6},children:[e.jsxs("div",{style:{padding:16,background:"#fff2f0",borderRadius:8,border:"1px solid #ffccc7",marginBottom:16},children:[e.jsxs("div",{style:{color:"#cf1322",fontWeight:600,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx(Yt,{}),"ì£¼ì˜: ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"]}),e.jsxs("div",{style:{color:"#595959"},children:[e.jsx("strong",{children:C.name})," ì„œë¹„ìŠ¤ë¥¼ ì‚­ì œí•˜ë©´ ë‹¤ìŒ ë°ì´í„°ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤:"]}),e.jsxs("ul",{style:{margin:"12px 0 0 0",paddingLeft:20,color:"#595959"},children:[e.jsx("li",{children:"ì„œë¹„ìŠ¤ ì„¤ì • ë° êµ¬ì„± ì •ë³´"}),e.jsx("li",{children:"íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ ì´ë ¥"}),e.jsx("li",{children:"ë¹Œë“œ ë° ë°°í¬ ê¸°ë¡"}),e.jsx("li",{children:"ê¶Œí•œì ì •ë³´"})]})]}),e.jsx("div",{style:{padding:12,background:"#fafafa",borderRadius:8,border:"1px solid #e8e8e8"},children:e.jsx("div",{style:{color:"#8c8c8c",fontSize:12},children:'ì‚­ì œë¥¼ ê³„ì†í•˜ë ¤ë©´ ì•„ë˜ "ì‚­ì œ" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.'})})]}),okText:"ì‚­ì œ",okType:"danger",cancelText:"ì·¨ì†Œ",width:520,okButtonProps:{size:"large",style:{height:44,fontSize:15,fontWeight:600,borderRadius:8,boxShadow:"0 2px 8px rgba(255, 77, 79, 0.3)"}},cancelButtonProps:{size:"large",style:{height:44,fontSize:15,fontWeight:600,borderRadius:8}},onOk:async()=>{try{await Xt.delete(C.id),zr(Dt.filter(re=>re.id!==C.id)),f.success("ì„œë¹„ìŠ¤ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(re){f.error(`ì‚­ì œ ì‹¤íŒ¨: ${re instanceof Error?re.message:String(re)}`)}}})},Mu=async(C,re,he)=>{if(ot){f.warning("SAST ìŠ¤ìº”ì´ ì´ë¯¸ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.");return}Bt(!0);let Te=he||"";if(!Te)try{const{useCredsStore:Ye}=await vn(async()=>{const{useCredsStore:Lt}=await Promise.resolve().then(()=>Vo);return{useCredsStore:Lt}},void 0),{sourceRepository:st}=Ye.getState(),bt=Ai(re.gitlabUrl),Zt=st.find(Lt=>bt.includes(Lt.baseUrl)||Lt.baseUrl.includes(bt));Te=(Zt==null?void 0:Zt.token)||""}catch(Ye){}if(!Te){f.error("ì„œë¹„ìŠ¤ì— GitLab Access Tokenì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."),Bt(!1);return}(!Oe||(Oe==null?void 0:Oe.status)==="not_found"||!(Oe!=null&&Oe.semgrep)&&!(Oe!=null&&Oe.codeql))&&await Xt.newSastResult(C),Mt({...Oe!=null?Oe:{},semgrep:void 0,codeql:void 0,status:"analyzing"}),ys(re.gitlabUrl,"sast","analyzing",re.id);try{await Xt.saveSastResult(C,JSON.stringify({semgrep:null,codeql:null}),"analyzing","","",void 0)}catch(Ye){}try{const Ye=new Map([["gitUrl",re.gitlabUrl],["authType","token"],["accessToken",Te],["config","p/owasp-top-ten"]]),st=await qx(Ye),bt=await Gx(Ye),Zt={semgrep:st,codeql:bt};await Xt.saveSastResult(C,JSON.stringify(Zt),"error"in st&&st.error||"error"in bt&&bt.error?"failed":"completed",st.command_log||"",bt.command_log||"",void 0);const Lt=await Aa(C);if(Mt(Lt),Lt!=null&&Lt.status&&Lt.status!=="analyzing"){ys(re.gitlabUrl,"sast",Lt.status==="completed"?"completed":"failed",re.id);const js=new Date().toISOString();Jt(re.gitlabUrl,"sast",js,re.id),yt(pt=>pt&&{...pt,lastUpdateTime:new Date(js).toLocaleString()})}}catch(Ye){try{await Xt.saveSastResult(C,null,"failed","","",void 0)}catch(bt){}try{const bt=await Aa(C);Mt(bt)}catch(bt){}ys(re.gitlabUrl,"sast","failed",re.id);const st=new Date().toISOString();Jt(re.gitlabUrl,"sast",st,re.id),yt(bt=>bt&&{...bt,lastUpdateTime:new Date(st).toLocaleString()}),f.error(MS(Ye)),Va()}finally{Bt(!1)}},Qi=o.useCallback(async()=>{try{const C=await Xt.list();C.data!==null&&Array.isArray(C.data)&&zr(C.data)}catch(C){f.error(`ì„œë¹„ìŠ¤ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ${C instanceof Error?C.message:String(C)}`)}},[]);o.useEffect(()=>{me>0&&Qi()},[me,Qi]);const[Xi,Bc]=o.useState([]),[Po,hl]=o.useState(""),[qn,$c]=o.useState(null),[Lu,Oc]=o.useState([]),[Mo,pl]=o.useState(null),[tm,sm]=o.useState(""),[rm,nm]=o.useState(""),[Dc,Fc]=o.useState(""),[Uc,Hc]=o.useState(""),[gl,Vc]=o.useState(""),[xl,qc]=o.useState(""),[Gc,Wc]=o.useState(null),Au=o.useCallback(async()=>{if(!qn||!La){f.warning("Git URLê³¼ í”„ë¡œì íŠ¸ ê²½ë¡œë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”."),pi([]);return}const C=`${qn}/${La}`.replace(/\.git$/,""),re=ta(C);if(!re.found||!re.token){f.warning("GitLab í† í°ì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. Git ê´€ë¦¬ í˜ì´ì§€ì—ì„œ í† í°ì„ ë¨¼ì € ë“±ë¡í•´ì£¼ì„¸ìš”."),pi([]);return}try{Ki(!0);const he=new URL(qn),Te=`${he.protocol}//${he.host}`,Ye=encodeURIComponent(La.replace(/\.git$/,"")),st=`${Te}/api/v4/projects/${Ye}/repository/branches?per_page=100`,bt=await fetch(st,{headers:{"PRIVATE-TOKEN":re.token}});if(!bt.ok)throw new Error(`GitLab API í˜¸ì¶œ ì‹¤íŒ¨ (Status: ${bt.status})`);const Zt=await bt.json();pi(Zt.map(Lt=>({name:Lt.name,default:Lt.default||!1}))),f.success(`ë¸Œëœì¹˜ ${Zt.length}ê°œë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.`)}catch(he){console.error("[loadRegisterBranches] ë¸Œëœì¹˜ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",he),f.error("ë¸Œëœì¹˜ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),pi([])}finally{Ki(!1)}},[qn,La,ta]);o.useEffect(()=>{(async()=>{(await ol.checkGitLabStatus()).data})()},[]),o.useEffect(()=>{Qi(),(async()=>{Q(!0);try{const re=await Wd();di(re),re.length===0&&f.warning("ë“±ë¡ëœ ì¸í”„ë¼ê°€ ì—†ìŠµë‹ˆë‹¤. ì¸í”„ë¼ë¥¼ ë¨¼ì € ë“±ë¡í•´ì£¼ì„¸ìš”.")}catch(re){console.error("ì¸í”„ë¼ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",re),f.error("ì¸í”„ë¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{Q(!1)}})()},[Qi]);const Nu=o.useRef(null);o.useEffect(()=>{nt!=null&&nt.id&&nt.id!==Nu.current&&(Nu.current=nt.id,ul())},[nt==null?void 0:nt.id]),o.useEffect(()=>{Dt.length>0&&!Ha.current&&(Ha.current=!0,(async()=>{try{const C=await gn.getServices();rs(C||[])}catch(C){console.error("[GitManagement] ì´ˆê¸° services ë¡œë“œ ì‹¤íŒ¨:",C)}})(),Eo(!0),(async()=>{try{const C=await Xt.listSastLastUpdates();((C==null?void 0:C.data)||[]).forEach(he=>{if(he!=null&&he.service_id&&he.last_update){const Te=typeof he.service_id=="string"?parseInt(he.service_id,10):he.service_id,Ye=Dt.find(st=>st.id===Te);if(Ye){try{const st=new Date(String(he.last_update)).toISOString();Jt(Ye.gitlabUrl,"sast",st,Ye.id)}catch(st){Jt(Ye.gitlabUrl,"sast",String(he.last_update))}he.status&&ys(Ye.gitlabUrl,"sast",he.status,Ye.id)}}})}catch(C){}})(),(async()=>{try{const C=await Xt.listScaLastUpdates();((C==null?void 0:C.data)||[]).forEach(he=>{if(he!=null&&he.service_id&&he.last_update){const Te=typeof he.service_id=="string"?parseInt(he.service_id,10):he.service_id,Ye=Dt.find(st=>st.id===Te);if(Ye){try{const st=new Date(String(he.last_update)).toISOString();Jt(Ye.gitlabUrl,"sca",st,Ye.id)}catch(st){Jt(Ye.gitlabUrl,"sca",String(he.last_update))}he.status&&ys(Ye.gitlabUrl,"sca",he.status,Ye.id)}}})}catch(C){}})(),(async()=>{try{const C=await Xt.listDastLastUpdates();((C==null?void 0:C.data)||[]).forEach(he=>{if(he!=null&&he.service_id&&he.last_update){const Te=typeof he.service_id=="string"?parseInt(he.service_id,10):he.service_id,Ye=Dt.find(st=>st.id===Te);if(Ye){try{const st=new Date(String(he.last_update)).toISOString();Jt(Ye.gitlabUrl,"dast",st,Ye.id)}catch(st){Jt(Ye.gitlabUrl,"dast",String(he.last_update))}he.status&&ys(Ye.gitlabUrl,"dast",he.status,Ye.id)}}})}catch(C){console.error("[DAST] Error loading DAST data:",C)}})())},[Dt,Eo,Jt,ys]);const Bu=o.useCallback(async()=>{const C=await Fn.getGitUrls(Ur.organization_id);Bc(C.data)},[Ur.organization_id]);o.useEffect(()=>{Bu()},[Bu]);const am=async()=>{if(!Po){f.warning("Gitlab URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(!/^https?:\/\/[A-Za-z0-9.-]+(?::\d+)?(\/)?$/.test(Po)){f.warning("URL í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");return}if(Xi.find(he=>he.gitlab_url==Po)){f.warning("ì´ë¯¸ ì¶”ê°€ëœ URLì…ë‹ˆë‹¤.");return}const re=await Fn.addGitUrl(Ur.organization_id,Po);Bc([...Xi,re.data]),hl("")},im=async C=>{try{await Fn.removeGitlabUrl(C,Ur.organization_id),Bc(re=>re.filter(he=>he.id!==C)),f.success("URLì´ ì„±ê³µì ìœ¼ë¡œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(re){f.error(`ì‚­ì œ ì‹¤íŒ¨: ${re instanceof Error?re.message:String(re)}`)}},Kc=async C=>{pl(null),$c(C);const re=await Xt.getGroups(C);Oc(re.data);const he=await Xt.getUsername(C);nm(he.user.username)},$u=C=>{pl(C);let re="";for(const he of Yc){const Te=he.options.find(Ye=>Ye.value===C);if(Te){re=Te.label;break}}sm(re)},om=C=>{Wc(C)},Ou=Lu.length?Lu.map(C=>({label:C.fullPath,value:C.id,disabled:!1})):[],lm={label:rm,value:0,disabled:!1},Yc=Ou.length?[{label:"ì‚¬ìš©ì ê·¸ë£¹",options:Ou},{label:"ì‚¬ìš©ì ê³„ì •",options:[lm]}]:[],cm=ss.filter(C=>C.is_deployed).length,dm=ss.filter(C=>{var re;return(re=C.infraType)==null?void 0:re.toLowerCase().includes("kubernetes")}).length,um=ss.filter(C=>{var re,he;return((re=C.infraType)==null?void 0:re.toLowerCase().includes("docker"))&&!((he=C.infraType)!=null&&he.toLowerCase().includes("podman"))}).length,hm=ss.filter(C=>{var re;return(re=C.infraType)==null?void 0:re.toLowerCase().includes("podman")}).length;return e.jsxs("div",{className:"service-management management-page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"page-header-title",children:[e.jsx(_t,{style:{fontSize:28,color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx("h1",{children:"ì„œë¹„ìŠ¤ ê´€ë¦¬"}),e.jsx("p",{className:"page-header-description",children:"ì„œë¹„ìŠ¤ ë“±ë¡, ë¹Œë“œ, ë°°í¬ ë° ëª¨ë‹ˆí„°ë§ì„ ê´€ë¦¬í•©ë‹ˆë‹¤"})]})]}),e.jsxs(g,{children:[e.jsx(B,{icon:e.jsx(zs,{}),onClick:async()=>{await Qi();const C=await gn.getServices();rs(C||[])},children:"ìƒˆë¡œê³ ì¹¨"}),e.jsx(B,{type:"primary",icon:e.jsx(Ui,{}),onClick:hi,children:"ì„œë¹„ìŠ¤ ë“±ë¡/ìƒì„±"})]})]}),e.jsxs(Ke,{gutter:16,className:"stats-row",children:[e.jsx(Y,{xs:24,sm:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon blue",children:e.jsx(_t,{})}),e.jsx($e,{title:"ì „ì²´ ì„œë¹„ìŠ¤",value:Dt.length,suffix:"ê°œ"})]})})}),e.jsx(Y,{xs:24,sm:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon green",children:e.jsx(dr,{})}),e.jsx($e,{title:"ìš´ì˜ì¤‘ ìƒíƒœì¸ ì„œë¹„ìŠ¤",value:cm,suffix:`/ ${ss.length}`})]})})}),e.jsx(Y,{xs:24,sm:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon purple",children:e.jsx(Cn,{})}),e.jsx($e,{title:"Kubernetes ì„œë¹„ìŠ¤",value:dm,suffix:"ê°œ"})]})})}),e.jsx(Y,{xs:24,sm:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon cyan",children:e.jsx(Qr,{})}),e.jsx($e,{title:"Docker/Podman ì„œë¹„ìŠ¤",value:um+hm,suffix:"ê°œ"})]})})})]}),e.jsx(Ke,{justify:"space-between",align:"middle",style:{marginBottom:"16px",display:"none"},children:e.jsx(Y,{children:e.jsxs(g,{children:[e.jsxs(rt,{title:e.jsx("div",{style:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px",marginLeft:-24,marginRight:-24,marginTop:-20,fontSize:"18px",fontWeight:600,color:"#1890ff"},children:"ì„œë¹„ìŠ¤ ë“±ë¡/ìƒì„±"}),open:U,onCancel:Ti,footer:null,width:600,centered:!0,styles:{body:{padding:"24px"}},children:[e.jsx("div",{style:{marginBottom:"24px",textAlign:"center",color:"#666"},children:e.jsx("p",{children:"GitLab í”„ë¡œì íŠ¸ë¥¼ ë“±ë¡í•˜ê±°ë‚˜ ìƒˆë¡œ ìƒì„±í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”."})}),e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:24,width:"100%",justifyContent:"center",padding:"20px 0"},children:[Ur.role!="Member"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{type:"primary","aria-label":"gitlab-register-button",size:"large",style:{height:80,minWidth:240,fontSize:16,borderRadius:8,fontWeight:500,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:6,transition:"all 0.2s"},onClick:()=>Yi("urlSetting"),icon:e.jsx(Ea,{style:{fontSize:"26px"}}),className:"hover-scale",children:e.jsx("span",{style:{fontSize:16,fontWeight:600},children:"Gitlab ì„¤ì •"})}),e.jsx(B,{type:"primary","aria-label":"gitlab-register-button",size:"large",style:{height:80,minWidth:240,fontSize:16,borderRadius:8,fontWeight:500,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:6,transition:"all 0.2s"},onClick:()=>Yi("createUser"),icon:e.jsx(Ld,{style:{fontSize:"26px"}}),className:"hover-scale",children:e.jsx("span",{style:{fontSize:16,fontWeight:600},children:"Gitlab ê³„ì • ìƒì„±"})})]}),e.jsx(B,{type:"primary","aria-label":"gitlab-register-button",size:"large",style:{height:80,minWidth:240,fontSize:16,borderRadius:8,fontWeight:500,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:6,transition:"all 0.2s"},onClick:()=>Yi("register"),icon:e.jsx(si,{style:{fontSize:"26px"}}),className:"hover-scale",children:e.jsx("span",{style:{fontSize:16,fontWeight:600},children:"ê¸°ì¡´ í”„ë¡œì íŠ¸ ë“±ë¡"})}),e.jsx(B,{"aria-label":"gitlab-create-button",type:"primary",size:"large",style:{height:80,minWidth:240,fontSize:16,borderRadius:8,fontWeight:500,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:6,transition:"all 0.2s"},onClick:()=>Yi("create"),icon:e.jsx(Xc,{style:{fontSize:"26px"}}),className:"hover-scale",children:e.jsx("span",{style:{fontSize:16,fontWeight:600},children:"ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±"})})]})]}),e.jsxs(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",borderBottom:"1px solid #f0f0f0",padding:"8px 12px",marginLeft:-12,marginRight:-12},children:[e.jsx("div",{style:{marginRight:12},children:e.jsx(B,{type:"text",icon:e.jsx(Qu,{}),onClick:zc})}),e.jsx("div",{style:{flex:1,textAlign:"center",fontSize:"16px",fontWeight:600,color:"#1890ff"},children:{urlSetting:"Gitlab ì„¤ì •",createUser:"Gitlab ìœ ì € ìƒì„±",register:"ê¸°ì¡´ í”„ë¡œì íŠ¸ ë“±ë¡",create:"ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±"}[Ya]||""}),e.jsx("div",{style:{width:36}})]}),open:Ya!==null,footer:null,width:700,centered:!0,styles:{body:{padding:"20px"}},onCancel:Ri,children:[e.jsx("div",{style:{marginBottom:12,color:"#666",fontSize:13,lineHeight:1.6},children:{urlSetting:e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Gitlab URLì„ ì„¤ì •í•©ë‹ˆë‹¤."}),e.jsx("div",{children:"í”„ë¡œì íŠ¸ë¥¼ ë“±ë¡í•˜ê±°ë‚˜ ìƒˆë¡œ ìƒì„±í•˜ê¸° ì „ì—, GitLab URLì„ ì…ë ¥í•˜ì„¸ìš”."})]}),createUser:e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Gitlab ìœ ì €ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. Gitlabì˜ ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤."}),e.jsx("div",{children:"ìœ ì €ë¥¼ ìƒì„±í•  ê·¸ë£¹ê³¼ ìœ ì € ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”."})]}),register:e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"ì´ë¯¸ ì¡´ì¬í•˜ëŠ” GitLab í”„ë¡œì íŠ¸ë¥¼ ì„œë¹„ìŠ¤ì— ì—°ê²°í•©ë‹ˆë‹¤."}),e.jsx("div",{children:"í”„ë¡œì íŠ¸ ì´ë¦„, Git URL, Git Branchë¥¼ ì…ë ¥í•˜ì„¸ìš”."})]}),create:e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"ìƒˆë¡œìš´ GitLab í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤."}),e.jsx("div",{children:"í”„ë¡œì íŠ¸ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”. GitLab URLì€ ì‚¬ìš©ì GitLab URLë¡œ ì„¤ì •ë©ë‹ˆë‹¤."})]})}[Ya]||""}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[{urlSetting:e.jsxs(e.Fragment,{children:[e.jsx(ue,{value:Po,placeholder:"git URL (ì˜ˆ: https://gitlab.mipllab.com)",onChange:C=>hl(C.target.value),suffix:e.jsx(B,{type:"text",icon:"ì¶”ê°€",onClick:am,style:{height:"auto",lineHeight:1}})}),e.jsx(ar,{size:"small",bordered:!0,style:{marginTop:12},dataSource:Xi,locale:{emptyText:"ë“±ë¡ëœ Git URLì´ ì—†ìŠµë‹ˆë‹¤."},renderItem:(C,re)=>e.jsxs(e.Fragment,{children:[re===0&&e.jsx(ar.Item,{style:{background:"#fafafa",fontWeight:"bold",cursor:"default"},children:e.jsx(we.Text,{children:"URL ëª©ë¡"})}),e.jsx(ar.Item,{actions:[e.jsx(Kt,{title:"ì´ ì„œë²„ë¥¼ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>im(C.id),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",children:e.jsx(Ie,{title:"ì‚­ì œ",children:e.jsx(B,{type:"text",danger:!0,icon:e.jsx(gs,{})})})},C.id)],children:e.jsx(we.Text,{children:C.gitlab_url})})]})})]}),createUser:e.jsxs(e.Fragment,{children:[e.jsxs(ue.Group,{compact:!0,children:[e.jsx(Ee,{placeholder:"Git URL",onChange:Kc,value:qn,style:{width:"50%"},children:Xi.map(C=>e.jsx(xi,{value:C.gitlab_url,children:C.gitlab_url},C.id))}),e.jsx(Ee,{placeholder:"group",value:Mo,onChange:$u,style:{width:"30%"},popupMatchSelectWidth:!1,showSearch:!0,optionFilterProp:"name",filterOption:(C,re)=>{var he;return((he=re==null?void 0:re.label)!=null?he:"").toLowerCase().includes(C.toLowerCase())},options:Yc}),e.jsxs(Ee,{placeholder:"ê¶Œí•œ",value:Gc,onChange:om,style:{width:"20%"},children:[e.jsx(xi,{value:10,children:"Guest"},"guest"),e.jsx(xi,{value:20,children:"Reporter"},"reporter"),e.jsx(xi,{value:30,children:"developer"},"developer"),e.jsx(xi,{value:40,children:"Maintainer"},"maintainer"),e.jsx(xi,{value:50,children:"Owner"},"owner")]})]}),e.jsxs(ue.Group,{compact:!0,children:[e.jsx(ue,{disabled:!0,value:"ê³„ì •ëª…",style:{width:"20%",backgroundColor:"#f5f5f5",color:"#464646ff",cursor:"default"}}),e.jsx(ue,{placeholder:"username",value:Dc,onChange:C=>Fc(C.target.value),style:{width:"80%"}})]}),e.jsxs(ue.Group,{compact:!0,children:[e.jsx(ue,{disabled:!0,value:"í”„ë¡œí•„ëª…",style:{width:"20%",backgroundColor:"#f5f5f5",color:"#464646ff",cursor:"default"}}),e.jsx(ue,{placeholder:"name",value:Uc,onChange:C=>Hc(C.target.value),style:{width:"80%"}})]}),e.jsxs(ue.Group,{compact:!0,children:[e.jsx(ue,{disabled:!0,value:"ì´ë©”ì¼",style:{width:"20%",backgroundColor:"#f5f5f5",color:"#464646ff",cursor:"default"}}),e.jsx(ue,{placeholder:"email",value:gl,onChange:C=>Vc(C.target.value),style:{width:"80%"}})]}),e.jsxs(ue.Group,{compact:!0,children:[e.jsx(ue,{disabled:!0,value:"ë¹„ë°€ë²ˆí˜¸",style:{width:"20%",backgroundColor:"#f5f5f5",color:"#464646ff",cursor:"default"}}),e.jsx(ue.Password,{placeholder:"password (Minimum length is 8 characters.)",value:xl,onChange:C=>qc(C.target.value),style:{width:"80%"}})]})]}),register:e.jsxs(e.Fragment,{children:[e.jsxs(ue.Group,{compact:!0,children:[e.jsx(ue,{disabled:!0,value:"ì„œë¹„ìŠ¤ ëª…",style:{width:"20%",backgroundColor:"#f5f5f5",color:"#464646ff",cursor:"default"}}),e.jsx(ue,{placeholder:"kiwi ìƒì—ì„œ ê´€ë¦¬ë  ì„œë¹„ìŠ¤ì˜ ì´ë¦„ (ì˜ˆ: my-project)",value:Za,onChange:C=>Vi(C.target.value),style:{width:"80%"}})]}),e.jsxs(ue.Group,{compact:!0,children:[e.jsx(Ee,{placeholder:"Git URL",onChange:Kc,value:qn,style:{width:"44%"},children:Xi.map(C=>e.jsx(xi,{value:C.gitlab_url,children:C.gitlab_url},C.id))}),e.jsx(ue,{style:{width:"6%",textAlign:"center"},disabled:!0,value:"/"}),e.jsx(ue,{style:{width:"50%"},placeholder:"í”„ë¡œì íŠ¸ ê²½ë¡œ (ì˜ˆ: user/repo.git)",value:La,onChange:C=>Ro(C.target.value)})]}),cl.length>0?e.jsxs(ue.Group,{compact:!0,style:{display:"flex"},children:[e.jsx(ue,{disabled:!0,value:"ë¸Œëœì¹˜",style:{width:"20%",backgroundColor:"#f5f5f5",color:"#464646ff",cursor:"default"}}),e.jsx(Ee,{placeholder:"ë¸Œëœì¹˜ ì„ íƒ",value:qi,onChange:C=>Gi(C),loading:Wi,showSearch:!0,optionFilterProp:"children",notFoundContent:Wi?e.jsx(gt,{size:"small"}):"ë¸Œëœì¹˜ ì—†ìŒ",suffixIcon:e.jsx(B,{type:"link",size:"small",loading:Wi,onClick:C=>{C.stopPropagation(),Au()},icon:e.jsx(zs,{})}),style:{flex:1},children:cl.map(C=>e.jsxs(Ee.Option,{value:C.name,children:[C.name," ",C.default&&"(ê¸°ë³¸)"]},C.name))})]}):e.jsxs(ue.Group,{compact:!0,style:{display:"flex"},children:[e.jsx(ue,{disabled:!0,value:"ë¸Œëœì¹˜",style:{width:"20%",backgroundColor:"#f5f5f5",color:"#464646ff",cursor:"default"}}),e.jsx(ue,{placeholder:"Git ë¸Œëœì¹˜ (ì˜ˆ: main, develop)",value:qi,onChange:C=>Gi(C.target.value),style:{flex:1}}),e.jsx(B,{type:"default",loading:Wi,onClick:Au,disabled:!qn||!La,children:"ë¸Œëœì¹˜ ë¶ˆëŸ¬ì˜¤ê¸°"})]})]}),create:e.jsxs(e.Fragment,{children:[e.jsxs(ue.Group,{compact:!0,children:[e.jsx(ue,{disabled:!0,value:"ì„œë¹„ìŠ¤ ëª…",style:{width:"20%",backgroundColor:"#f5f5f5",color:"#464646ff",cursor:"default"}}),e.jsx(ue,{placeholder:"kiwi ìƒì—ì„œ ê´€ë¦¬ë  ì„œë¹„ìŠ¤ì˜ ì´ë¦„ (ì˜ˆ: my-project)",value:Za,onChange:C=>Vi(C.target.value),style:{width:"80%"}})]}),e.jsxs(ue.Group,{compact:!0,children:[e.jsx(Ee,{placeholder:"Git URL",onChange:Kc,value:qn,style:{width:"40%"},children:Xi.map(C=>e.jsx(xi,{value:C.gitlab_url,children:C.gitlab_url},C.id))}),e.jsx(Ee,{placeholder:"group",value:Mo,onChange:$u,style:{width:"20%"},popupMatchSelectWidth:!1,showSearch:!0,optionFilterProp:"name",filterOption:(C,re)=>{var he;return((he=re==null?void 0:re.label)!=null?he:"").toLowerCase().includes(C.toLowerCase())},options:Yc}),e.jsx(ue,{placeholder:"í”„ë¡œì íŠ¸ ì´ë¦„ (ì˜ˆ: my-project)",value:Io,onChange:C=>To(C.target.value),style:{width:"40%"}})]})]})}[Ya]||"",e.jsx("div",{style:{display:"flex",flexDirection:"row",gap:12,justifyContent:"flex-end",marginTop:12},children:Ya!="urlSetting"&&e.jsx(B,{type:"primary",size:"middle",style:{minWidth:180,height:44,display:"flex",alignItems:"center",justifyContent:"center",gap:12},onClick:{createUser:Mc,create:Pc,register:Ec}[Ya],children:{createUser:e.jsxs(e.Fragment,{children:[e.jsx(Ld,{style:{fontSize:16}}),e.jsx("span",{style:{fontSize:14,fontWeight:600,marginLeft:2},children:"Gitlab ê³„ì • ìƒì„±"})]}),create:e.jsxs(e.Fragment,{children:[e.jsx(Xc,{style:{fontSize:16}}),e.jsx("span",{style:{fontSize:14,fontWeight:600,marginLeft:2},children:"í”„ë¡œì íŠ¸ ìƒì„±"})]}),register:e.jsxs(e.Fragment,{children:[e.jsx(si,{style:{fontSize:16}}),e.jsx("span",{style:{fontSize:14,fontWeight:600,marginLeft:2},children:"í”„ë¡œì íŠ¸ ë“±ë¡"})]})}[Ya]})})]})]})]})})}),e.jsxs(ie,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(_t,{style:{fontSize:20,color:"#1890ff"}}),e.jsx("span",{style:{fontSize:18,fontWeight:600},children:"ì„œë¹„ìŠ¤ ëª©ë¡"}),e.jsx(ps,{count:Dt.length,style:{backgroundColor:"#1890ff",marginLeft:8}})]}),extra:e.jsx(B,{icon:e.jsx(zs,{}),onClick:Xx,type:"primary",ghost:!0,children:"ìƒˆë¡œê³ ì¹¨"}),className:"service-list-card",children:[e.jsx("form",{autoComplete:"off",onSubmit:C=>C.preventDefault(),style:{marginBottom:16},children:e.jsx(ue.Search,{placeholder:"ì„œë¹„ìŠ¤ ì´ë¦„ ê²€ìƒ‰...",allowClear:!0,autoComplete:"off",value:Pn,onChange:C=>{Mr(C.target.value),zn(1)}})}),Dt.length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsxs(g,{direction:"vertical",size:8,children:[e.jsx("span",{style:{fontSize:16,color:"#595959"},children:"ë“±ë¡ëœ ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("span",{style:{fontSize:14,color:"#8c8c8c"},children:"ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ë¥¼ ì¶”ê°€í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”"})]}),style:{padding:"60px 20px"},children:e.jsx(B,{type:"primary",icon:e.jsx(Xc,{}),size:"large",style:{borderRadius:8,height:44,fontSize:15,fontWeight:500},children:"ì„œë¹„ìŠ¤ ì¶”ê°€í•˜ê¸°"})}):e.jsxs(g,{direction:"vertical",style:{width:"100%",gap:12},children:[Dt.filter(C=>C.name.toLowerCase().includes(Pn.toLowerCase())).slice((nn-1)*Ys,nn*Ys).map(C=>{const re=ss.find(Te=>Te.id===C.id);Kx(re==null?void 0:re.infra_id);const he=(()=>{const Te=Lr[C.id];if(!Te||Te.length===0)return null;const Ye=Te.find(Lt=>Lt.step_name==="build"),st=Te.find(Lt=>Lt.step_name==="deploy"),bt=Pd(Ye==null?void 0:Ye.status),Zt=Pd(st==null?void 0:st.status);return C.name,bt==="failed"?{status:"failed",stage:"build",label:"ë¹Œë“œì‹¤íŒ¨",icon:e.jsx(Yt,{}),tooltip:"ë¹Œë“œ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”."}:bt==="running"?{status:"running",stage:"build",label:"ë¹Œë“œì¤‘",icon:e.jsx(rn,{spin:!0}),tooltip:"ì´ë¯¸ì§€ ë¹Œë“œê°€ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤"}:bt==="success"&&Zt==="failed"?{status:"failed",stage:"deploy",label:"ë°°í¬ì‹¤íŒ¨",icon:e.jsx(Yt,{}),tooltip:"ë°°í¬ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”."}:bt==="success"&&Zt==="running"?{status:"running",stage:"deploy",label:"ë°°í¬ì¤‘",icon:e.jsx(dr,{}),tooltip:"ì„œë¹„ìŠ¤ ë°°í¬ê°€ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤"}:bt==="success"&&Zt==="success"?{status:"success",stage:"operate",label:"ìš´ì˜ì¤‘",icon:e.jsx(qm,{}),tooltip:"ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ìš´ì˜ ì¤‘ì…ë‹ˆë‹¤"}:bt==="pending"||bt==="inactive"||!Ye?{status:"default",stage:"pending",label:"ë¹Œë“œëŒ€ê¸°",icon:e.jsx(Pa,{}),tooltip:"ë¹Œë“œ ì‹œì‘ì„ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤"}:{status:"default",stage:"pending",label:"ì¤€ë¹„ì¤‘",icon:e.jsx(Pa,{}),tooltip:"ì„œë¹„ìŠ¤ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤"}})();return e.jsx(ie,{size:"small",className:"service-card",hoverable:!0,children:e.jsxs("div",{className:"repo-card-content",children:[e.jsxs("div",{className:"repo-info",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[e.jsxs("h3",{style:{margin:0,fontSize:16,fontWeight:600,color:"#262626",flex:1,display:"flex",alignItems:"center",gap:8},children:[e.jsx(si,{style:{color:"#8c8c8c",fontSize:14}}),C.name]}),he&&e.jsx(Ie,{title:he.tooltip,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(ps,{status:he.status==="success"?"success":he.status==="running"?"processing":he.status==="failed"?"error":"default"}),e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,fontSize:12,fontWeight:600,color:he.status==="success"?"#52c41a":he.status==="running"?"#1890ff":he.status==="failed"?"#ff4d4f":"#8c8c8c"},children:[he.icon,he.label]})]})})]}),e.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginTop:12,padding:"10px 0",borderTop:"1px solid #f0f0f0"},children:[e.jsx(Ie,{title:"ì„œë¹„ìŠ¤ ê¸°ë³¸ ì •ë³´ ë° ì„¤ì •",children:e.jsx(B,{type:"default",icon:e.jsx(rn,{style:{fontSize:12}}),onClick:Te=>{Te.stopPropagation(),Ji(C),pe("service")},style:{fontSize:12,fontWeight:500,borderRadius:6,padding:"4px 12px",height:30,color:"#1890ff",background:"#e6f7ff",border:"1px solid #91d5ff"},children:"ì„œë¹„ìŠ¤"})}),e.jsx(Ie,{title:"GitLab ì €ì¥ì†Œ ì •ë³´",children:e.jsx(B,{type:"default",icon:e.jsx(si,{style:{fontSize:12}}),onClick:Te=>{Te.stopPropagation(),Ji(C),pe("gitlab")},style:{fontSize:12,fontWeight:500,borderRadius:6,padding:"4px 12px",height:30,color:"#722ed1",background:"#f9f0ff",border:"1px solid #d3adf7"},children:"GitLab"})}),e.jsx(Ie,{title:"ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì •ë³´",children:e.jsx(B,{type:"default",icon:e.jsx(_t,{style:{fontSize:12}}),onClick:Te=>{Te.stopPropagation(),Ji(C),pe("registry")},style:{fontSize:12,fontWeight:500,borderRadius:6,padding:"4px 12px",height:30,color:"#52c41a",background:"#f6ffed",border:"1px solid #b7eb8f"},children:"Registry"})})]})]}),e.jsx("div",{className:"pipeline-view-container",children:e.jsx(w0,{pipelineStatus:Lr[C.id]||[],isLoading:ea&&!Lr[C.id],serviceId:C.id,onStageClick:Te=>Zx(C,Te),sourceTime:(re==null?void 0:re.created_at)||void 0,sastState:an(C.gitlabUrl,"sast",C.id),sastLastUpdate:dn(C.gitlabUrl,"sast",C.id),scaState:an(C.gitlabUrl,"sca",C.id),scaLastUpdate:dn(C.gitlabUrl,"sca",C.id),dastState:an(C.gitlabUrl,"dast",C.id),dastLastUpdate:dn(C.gitlabUrl,"dast",C.id),disabledStages:{source:zo(C,"source",ss),build:zo(C,"build",ss),deploy:zo(C,"deploy",ss),operate:zo(C,"operate",ss)}})}),e.jsxs("div",{className:"repo-actions",children:[(()=>{const Te=zo(C,"build",ss),Ye=ss.find(Lt=>Lt.id===C.id),st=!!(Ye!=null&&Ye.infra_id),bt=Te.disabled||!st,Zt=st?Te.reason||"":"ì¸í”„ë¼ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ ì„¤ì •ì—ì„œ ì¸í”„ë¼ë¥¼ ë¨¼ì € ë“±ë¡í•˜ì„¸ìš”.";return e.jsx(Ie,{title:bt?Zt:"ë¹Œë“œ í›„ ìë™ìœ¼ë¡œ ë°°í¬ê¹Œì§€ ì§„í–‰í•©ë‹ˆë‹¤",children:e.jsx(B,{type:"primary",icon:e.jsx(dr,{}),onClick:()=>{Wr({repo:C,displayKey:"build"}),Ma(!0),Ln(!0)},disabled:bt,className:"action-button action-button-build-deploy",style:{backgroundColor:bt?void 0:"#52c41a",borderColor:bt?void 0:"#52c41a"},children:"ë¹Œë“œ + ë°°í¬"})})})(),e.jsx(B,{type:"default",icon:e.jsx(du,{}),onClick:()=>He(C),className:"action-button action-button-member",children:"ê¶Œí•œ ê´€ë¦¬"}),e.jsx(B,{type:"default",danger:!0,icon:e.jsx(gs,{}),onClick:()=>em(C),className:"action-button action-button-delete",children:"ì‚­ì œ"})]})]})},C.id)}),Dt.length>0&&e.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:24},children:e.jsx(Gm,{current:nn,pageSize:Ys,total:Dt.filter(C=>C.name.toLowerCase().includes(Pn.toLowerCase())).length,onChange:(C,re)=>{zn(C),re&&En(re)},showSizeChanger:!0,showTotal:(C,re)=>`${re[0]}-${re[1]} / ${C}ê°œ`,pageSizeOptions:["10","20","50","100"]})})]})]}),e.jsx(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"8px 0"},children:[e.jsxs("div",{style:{width:40,height:40,borderRadius:10,background:ae==="service"?"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)":ae==="gitlab"?"linear-gradient(135deg, #722ed1 0%, #531dab 100%)":ae==="registry"?"linear-gradient(135deg, #13c2c2 0%, #08979c 100%)":"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:ae==="service"?"0 4px 12px rgba(24, 144, 255, 0.3)":ae==="gitlab"?"0 4px 12px rgba(114, 46, 209, 0.3)":ae==="registry"?"0 4px 12px rgba(19, 194, 194, 0.3)":"0 4px 12px rgba(24, 144, 255, 0.3)"},children:[ae==="service"&&e.jsx(rn,{style:{color:"#fff",fontSize:18}}),ae==="gitlab"&&e.jsx(si,{style:{color:"#fff",fontSize:18}}),ae==="registry"&&e.jsx(_t,{style:{color:"#fff",fontSize:18}}),!ae&&e.jsx(ln,{style:{color:"#fff",fontSize:18}})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#262626",lineHeight:1.2},children:ae==="service"?"ì„œë¹„ìŠ¤ ì •ë³´":ae==="gitlab"?"GitLab ì €ì¥ì†Œ ì •ë³´":ae==="registry"?"Registry ì •ë³´":"ì„œë¹„ìŠ¤ ì •ë³´ ìˆ˜ì •"}),e.jsx("div",{style:{fontSize:12,color:"#8c8c8c",marginTop:2},children:(_e==null?void 0:_e.serviceName)||"ì„œë¹„ìŠ¤ ì„¤ì •ì„ ë³€ê²½í•©ë‹ˆë‹¤"})]})]}),open:de,onOk:Lc,onCancel:()=>{Ac(),pe(null)},okText:"ì €ì¥",cancelText:"ì·¨ì†Œ",width:600,okButtonProps:{size:"large",style:{height:44,fontSize:15,fontWeight:600,borderRadius:8,boxShadow:"0 2px 8px rgba(24, 144, 255, 0.3)"}},cancelButtonProps:{size:"large",style:{height:44,fontSize:15,fontWeight:600,borderRadius:8}},style:{top:40},bodyStyle:{padding:"24px"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[(ae==="service"||!ae)&&e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:16,fontWeight:600,color:"#262626",fontSize:14,borderBottom:"1px solid #f0f0f0",paddingBottom:8},children:"ê¸°ë³¸ ì •ë³´"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"ì €ì¥ì†Œëª…"}),e.jsx(ue,{style:{flex:1},value:(_e==null?void 0:_e.serviceName)||"",onChange:C=>ca("serviceName",C.target.value),placeholder:"ì €ì¥ì†Œ ì´ë¦„"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"Git URL"}),e.jsx(ue,{style:{flex:1},value:(_e==null?void 0:_e.gitlabUrl)||"",placeholder:"Git ì €ì¥ì†Œ URL",disabled:!0})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"ë¹Œë“œ/ë°°í¬ ì¸í”„ë¼"}),e.jsx(Ee,{style:{flex:1},value:_e==null?void 0:_e.infraId,onChange:C=>ca("infraId",C),placeholder:"ì¸í”„ë¼ ì„ íƒ",loading:z,allowClear:!0,notFoundContent:z?"ë¡œë”© ì¤‘...":"ì¸í”„ë¼ê°€ ì—†ìŠµë‹ˆë‹¤",children:Wa.map(C=>e.jsxs(Ee.Option,{value:C.id,children:[C.name," (",nl(C.type),")"]},C.id))})]})]}),(ae==="gitlab"||!ae)&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16,paddingBottom:8,borderBottom:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(si,{style:{fontSize:16,color:Rr==="success"?"#52c41a":Rr==="failed"?"#ff4d4f":"#8c8c8c"}}),e.jsx("span",{style:{fontWeight:600,color:"#262626",fontSize:14},children:"GitLab ì €ì¥ì†Œ ì¸ì¦"}),Rr==="success"&&e.jsx(T,{color:"success",style:{marginLeft:8},children:"ì¸ì¦ë¨"}),Rr==="failed"&&e.jsx(T,{color:"error",style:{marginLeft:8},children:"ì¸ì¦ ì‹¤íŒ¨"})]}),e.jsx(B,{type:Rr==="success"?"default":"primary",size:"small",loading:Cs,disabled:!(_e!=null&&_e.gitlabUrl)||!(_e!=null&&_e.gitlabAccessToken)||!(_e!=null&&_e.gitlabUsername),onClick:async()=>{if(_e!=null&&_e.gitlabAccessToken&&(_e!=null&&_e.gitlabUrl)&&(_e!=null&&_e.gitlabUsername)){gr(!0);try{const{testGitLabAuthentication:C}=await vn(async()=>{const{testGitLabAuthentication:he}=await Promise.resolve().then(()=>nd);return{testGitLabAuthentication:he}},void 0),re=await C({gitlab_url:_e.gitlabUrl,access_token:_e.gitlabAccessToken});re.username.toLowerCase()!==_e.gitlabUsername.toLowerCase()?(Ss("failed"),f.error(`ì‚¬ìš©ìëª…ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì…ë ¥: ${_e.gitlabUsername}, GitLab: ${re.username}`)):(Ss("success"),f.success("GitLab ì¸ì¦ ì„±ê³µ!"))}catch(C){Ss("failed"),f.error(`GitLab ì¸ì¦ ì‹¤íŒ¨: ${C.message}`)}finally{gr(!1)}}},children:"ì¸ì¦"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"Access Token"}),e.jsx(ue.Password,{style:{flex:1},value:(_e==null?void 0:_e.gitlabAccessToken)||"",onChange:C=>{ca("gitlabAccessToken",C.target.value),Ss("idle")},placeholder:"GitLab Access Token"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"ì‚¬ìš©ìëª…"}),e.jsx(ue,{style:{flex:1},value:(_e==null?void 0:_e.gitlabUsername)||"",onChange:C=>{ca("gitlabUsername",C.target.value),Ss("idle")},placeholder:"GitLab ì‚¬ìš©ìëª…"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"ë¸Œëœì¹˜"}),e.jsxs("div",{style:{flex:1,display:"flex",gap:8},children:[e.jsx(Ee,{style:{flex:1},value:(_e==null?void 0:_e.gitlabBranch)||"",onChange:C=>ca("gitlabBranch",C),placeholder:"ë¸Œëœì¹˜ ì„ íƒ",loading:Ii,showSearch:!0,optionFilterProp:"children",notFoundContent:Ii?e.jsx(gt,{size:"small"}):Nn.length===0?"ë¸Œëœì¹˜ë¥¼ ë¶ˆëŸ¬ì˜¤ë ¤ë©´ ì˜¤ë¥¸ìª½ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”":"ë¸Œëœì¹˜ ì—†ìŒ",disabled:!(_e!=null&&_e.gitlabAccessToken)||Nn.length===0,children:Nn.map(C=>e.jsxs(Ee.Option,{value:C.name,children:[C.name," ",C.default&&"(ê¸°ë³¸)"]},C.name))}),e.jsx(B,{type:"default",loading:Ii,onClick:ve,disabled:!(_e!=null&&_e.gitlabUrl)||!(_e!=null&&_e.gitlabAccessToken),icon:e.jsx(zs,{}),children:"ë¶ˆëŸ¬ì˜¤ê¸°"})]})]})]}),(ae==="registry"||!ae)&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16,paddingBottom:8,borderBottom:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(_t,{style:{fontSize:16,color:Os==="success"?"#1890ff":Os==="failed"?"#ff4d4f":"#8c8c8c"}}),e.jsx("span",{style:{fontWeight:600,color:"#262626",fontSize:14},children:"Container Registry ì¸ì¦"}),Os==="success"&&e.jsx(T,{color:"success",style:{marginLeft:8},children:"ì¸ì¦ë¨"}),Os==="failed"&&e.jsx(T,{color:"error",style:{marginLeft:8},children:"ì¸ì¦ ì‹¤íŒ¨"})]}),e.jsx(B,{type:Os==="success"?"default":"primary",size:"small",loading:Rn,disabled:!(_e!=null&&_e.registryUrl)||!(_e!=null&&_e.registryUsername)||!(_e!=null&&_e.registryPassword),onClick:async()=>{if(!(_e!=null&&_e.registryUrl)||!(_e!=null&&_e.registryUsername)||!(_e!=null&&_e.registryPassword)){f.warning("Registry URL, ì‚¬ìš©ìëª…, ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}fn(!0);try{const{testRegistryAuthentication:C}=await vn(async()=>{const{testRegistryAuthentication:re}=await Promise.resolve().then(()=>nd);return{testRegistryAuthentication:re}},void 0);await C({registry_url:_e.registryUrl,username:_e.registryUsername,password:_e.registryPassword,infra_id:_e.infraId||0,registry_type:_e.registryType||"harbor",project_name:_e.registryProjectName}),Ms("success"),f.success("Container Registry ì¸ì¦ ì„±ê³µ!")}catch(C){Ms("failed"),f.error(`Container Registry ì¸ì¦ ì‹¤íŒ¨: ${C.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}finally{fn(!1)}},children:"ì¸ì¦"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"Registry íƒ€ì…"}),e.jsxs(Ee,{style:{flex:1},value:(_e==null?void 0:_e.registryType)||"harbor",onChange:C=>{ca("registryType",C),Ms("idle")},children:[e.jsx(Ee.Option,{value:"harbor",children:"Harbor"}),e.jsx(Ee.Option,{value:"dockerhub",children:"Docker Hub"})]})]}),(_e==null?void 0:_e.registryType)!=="dockerhub"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"Registry URL"}),e.jsx(ue,{style:{flex:1},value:(_e==null?void 0:_e.registryUrl)||"",onChange:C=>{ca("registryUrl",C.target.value),Ms("idle")},placeholder:"ì˜ˆ: harbor.mipilab.com"})]}),(_e==null?void 0:_e.registryType)==="harbor"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"í”„ë¡œì íŠ¸ëª…"}),e.jsx(ue,{style:{flex:1},value:(_e==null?void 0:_e.registryProjectName)||"",onChange:C=>ca("registryProjectName",C.target.value),placeholder:"ì˜ˆ: myproject"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"ì‚¬ìš©ìëª…"}),e.jsx(ue,{style:{flex:1},value:(_e==null?void 0:_e.registryUsername)||"",onChange:C=>{ca("registryUsername",C.target.value),Ms("idle")},placeholder:"Registry ì‚¬ìš©ìëª…"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{width:120,fontWeight:500,color:"#595959"},children:"ë¹„ë°€ë²ˆí˜¸"}),e.jsx(ue.Password,{style:{flex:1},value:(_e==null?void 0:_e.registryPassword)||"",onChange:C=>{ca("registryPassword",C.target.value),Ms("idle")},placeholder:"Registry ë¹„ë°€ë²ˆí˜¸"})]})]})]})}),e.jsx(E0,{open:F,repo:ba,onClose:qe}),e.jsx(rt,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",paddingRight:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[e.jsx(dr,{style:{fontSize:20,color:"#1890ff"}}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"bold"},children:Ae?`${Ae.repoName} - ${Ae.displayName}`:"ìƒì„¸ ì •ë³´"}),(Ae==null?void 0:Ae.lastUpdateTime)&&e.jsxs(we.Text,{type:"secondary",style:{fontSize:"12px",marginLeft:"8px"},children:["(ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ",Ae.lastUpdateTime,")"]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexShrink:0},children:[as==="sast"&&Ve==="summary"&&e.jsx(B,{type:"primary",icon:e.jsx(pr,{}),disabled:ot,loading:ot,onClick:async()=>{var he;if(!Vs)return;const C=ss.find(Te=>Te.gitlab_url===Vs.gitlabUrl);let re="";if(C!=null&&C.gitlab_config)try{const Te=JSON.parse(C.gitlab_config);re=Te.token||Te.access_token||""}catch(Te){console.warn("[GitManagement] ì¬ë¶„ì„ - GitLab config íŒŒì‹± ì‹¤íŒ¨:",Te)}if(!re&&(C!=null&&C.gitlab_access_token)&&(re=C.gitlab_access_token),!re){const Te=Ai(Vs.gitlabUrl);try{const Ye=localStorage.getItem("creds-store")||"";if(Ye){const st=JSON.parse(Ye),Zt=(((he=st==null?void 0:st.state)==null?void 0:he.sourceRepository)||[]).find(Lt=>{var js;return Te.includes(Lt.baseUrl)||((js=Lt.baseUrl)==null?void 0:js.includes(Te))});re=String((Zt==null?void 0:Zt.token)||"")}}catch(Ye){}}if(!re){f.error("ì„œë¹„ìŠ¤ì— GitLab Access Tokenì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");return}Mu(Vs.id,Vs,re)},children:ot?"ë¶„ì„ ì¤‘...":"ì¬ë¶„ì„"}),as&&["build","sca","deploy","dast"].includes(as)&&e.jsx(B,{type:"primary",icon:e.jsx(dr,{}),onClick:()=>{Vs&&as&&Pu(Vs,as)},children:as?`${ap[as]} ì‹¤í–‰`:"ì‹¤í–‰"})]})]}),open:Qe,onCancel:Nc,closeIcon:!1,footer:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{display:"flex",gap:"8px"},children:as==="sast"&&Ve!=="summary"&&e.jsx(B,{icon:e.jsx(Qu,{}),onClick:()=>Me("summary"),children:"ë’¤ë¡œ"})}),e.jsx(B,{onClick:Nc,children:"ë‹«ê¸°"})]}),width:Ve==="summary"?800:1e3,destroyOnClose:!0,children:Rs?e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(gt,{})}):e.jsx(kS,{selectedStage:as?np[as]:"code",selectedDisplayKey:as,pipelineLogs:Qa,workflowStatuses:Vs?PS(Lr[Vs.id]||[]):[],sastResultData:Oe,sastModalView:Ve,onShowSastDetailView:Me,commits:[],commitsLoading:!1})}),e.jsx(m0,{open:zt,loading:Ci||wa!==null,stageInfo:jr?{stage:np[jr.displayKey],displayKey:jr.displayKey}:null,initialValues:li,availableBuilds:va,serviceBuildVersions:xr,onCancel:()=>{Ls(!1),la([]),en(null),Gr(null),Wr(null)},onSubmit:Qx}),e.jsx(x0,{open:Br,serviceId:jr?(Du=ss.find(C=>C.id===jr.repo.id))==null?void 0:Du.id:void 0,gitUrl:jr==null?void 0:jr.repo.gitlabUrl,gitBranch:jr==null?void 0:jr.repo.gitlabBranch,registryUrl:jr?(Fu=ss.find(C=>C.id===jr.repo.id))==null?void 0:Fu.registry_config:void 0,defaultAutoDeploy:Sa,onCancel:()=>{Ln(!1),Wr(null),Ma(!1)},onSubmit:async C=>{var st,bt,Zt,Lt;if(!jr)return;const re=jr.repo.id,he=jr.repo.name,Te=jr.repo.id;if(!re){f.error("ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì„œë¹„ìŠ¤ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.");return}const Ye=async()=>{try{Ln(!1),Gr("build"),await Bi.buildImage(re,C.hops,C.infra_id,C.selected_services,C.auto_deploy),le({serviceId:re,serviceName:he,stepName:"build",displayKey:"build"}),Ei(),Wr(null),Ma(!1)}catch(js){f.error("ë¹Œë“œ ì‹œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),console.error("ë¹Œë“œ ì‹¤í–‰ ì‹¤íŒ¨:",js),Gr(null),le(null),Wr(null),Ma(!1)}};try{us(!0);const js=await Xt.getSastResult(Te),pt=js==null?void 0:js.data,kt=(pt==null?void 0:pt.semgrep)||(pt==null?void 0:pt.codeql),At=As=>{var es,bs,tr;const ls={critical:0,high:0,medium:0,low:0};if(!As)return ls;try{const $r=JSON.parse(As),Kr=($r==null?void 0:$r.runs)||[];if(Kr.length===0)return ls;const br=((es=Kr[0])==null?void 0:es.results)||[],Er=It=>{const ft=(It||"").toLowerCase();return ft==="error"||ft==="critical"?"critical":ft==="warning"||ft==="high"?"high":ft==="note"||ft==="medium"||ft==="moderate"?"medium":"low"};for(const It of br){let ft=((bs=It.rule)==null?void 0:bs.level)||It.level||"";if(!ft&&It.properties&&(ft=It.properties.securitySeverity||It.properties["security-severity"]||It.properties.severity||""),!ft&&It.rank&&(ft=It.rank),!ft&&((tr=It.properties)!=null&&tr.tags))for(const ht of It.properties.tags){const We=(ht||"").toLowerCase();if(We.includes("critical")){ft="critical";break}if(We.includes("high")){ft="high";break}if(We.includes("medium")){ft="medium";break}if(We.includes("low")){ft="low";break}}ls[Er(ft)]++}}catch($r){console.warn("SARIF íŒŒì‹± ì˜¤ë¥˜:",$r)}return ls},er=(bt=(st=pt==null?void 0:pt.semgrep)==null?void 0:st.results)==null?void 0:bt.sarif_json,ks=(Lt=(Zt=pt==null?void 0:pt.codeql)==null?void 0:Zt.results)==null?void 0:Lt.sarif_json,Qt=At(er),Sr=At(ks),Fs={critical:Qt.critical+Sr.critical,high:Qt.high+Sr.high,medium:Qt.medium+Sr.medium,low:Qt.low+Sr.low};if(!kt||(pt==null?void 0:pt.status)==="not_found"){$t({stage:"build",category:"sast",warningType:"no_analysis",serviceName:he,onContinue:()=>{Re(!1),$t(null),Ye()}}),Re(!0),us(!1);return}const _n=Fs;if(_n.critical>0){$t({stage:"build",category:"sast",warningType:"critical_found",vulnerabilitySummary:_n,serviceName:he,onContinue:()=>{Re(!1),$t(null),Ye()}}),Re(!0),us(!1);return}us(!1),await Ye()}catch(js){console.warn("SAST ê²°ê³¼ ì¡°íšŒ ì‹¤íŒ¨, ë¹Œë“œ ê³„ì† ì§„í–‰:",js),us(!1),await Ye()}}}),e.jsx(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(Jo,{style:{color:"#1890ff",fontSize:"20px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:nt?`${nt.name} - ì €ì¥ì†Œ í†µê³„`:"ì €ì¥ì†Œ í†µê³„"})]}),open:c,onCancel:()=>{p(!1),Gt(null),dt(null)},footer:[e.jsx(B,{type:"primary",onClick:()=>{p(!1),Gt(null),dt(null)},children:"ë‹«ê¸°"},"close")],width:1200,styles:{body:{maxHeight:"80vh",overflow:"auto",padding:"24px"}},destroyOnClose:!0,children:e.jsx(xs,{activeKey:h,onChange:x,items:[{key:"statistics",label:e.jsxs(g,{children:[e.jsx(Jo,{}),e.jsx("span",{children:"ì €ì¥ì†Œ í†µê³„"})]}),children:Be?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px",fontSize:"16px",color:"#666"},children:"ì €ì¥ì†Œ í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]}):fe?e.jsx(Lw,{statistics:fe,loading:Be}):e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#999"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"ğŸ“Š"}),e.jsx("p",{style:{fontSize:"16px",margin:0},children:"ì €ì¥ì†Œ í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{style:{fontSize:"14px",margin:"8px 0 0 0",color:"#ccc"},children:"ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."})]})},{key:"sast",label:e.jsxs(g,{children:[e.jsx(ni,{}),e.jsx("span",{children:"ì •ì  ì½”ë“œ ë¶„ì„"}),nt&&(()=>{const C=an(nt.gitlabUrl,"sast",nt.id);return C&&C!=="null"&&C!=="idle"?e.jsx(T,{color:C==="analyzing"?"processing":C==="completed"?"success":C==="failed"?"error":"default",style:{marginLeft:4},children:C==="analyzing"?"ì§„í–‰ì¤‘":C==="completed"?"ì™„ë£Œ":"ì‹¤íŒ¨"}):null})()]}),children:nt?e.jsx(Fx,{repoId:nt.id,serviceId:(Uu=ss.find(C=>C.gitlab_url===nt.gitlabUrl))==null?void 0:Uu.id,repoName:nt.name,onStartScan:async()=>{try{const C=ss.find(he=>he.gitlab_url===nt.gitlabUrl);let re="";if(C!=null&&C.gitlab_config)try{const he=JSON.parse(C.gitlab_config);re=he.token||he.access_token||""}catch(he){console.warn("[GitManagement] SAST Scan - GitLab config íŒŒì‹± ì‹¤íŒ¨:",he)}!re&&(C!=null&&C.gitlab_access_token)&&(re=C.gitlab_access_token),re&&re.length>=10?(ys(nt.gitlabUrl,"sast","analyzing",nt.id),await Mu(nt.id,nt,re)):f.error("ì„œë¹„ìŠ¤ì— GitLab Access Tokenì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")}catch(C){f.error("SAST ìŠ¤ìº” ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},onScanStateChange:C=>{nt&&ys(nt.gitlabUrl,"sast",C,nt.id)}}):e.jsx(vw,{icon:e.jsx(pr,{style:{fontSize:64,color:"#1890ff"}}),title:"SAST ì •ì  ì½”ë“œ ë¶„ì„ ê²°ê³¼",description:"ì €ì¥ì†Œë¥¼ ì„ íƒí•˜ì„¸ìš”"})}]})}),e.jsx(rt,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(dr,{style:{color:"#52c41a",fontSize:"20px"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold"},children:nt?`${nt.name} - ë¹Œë“œ í†µê³„`:"ë¹Œë“œ í†µê³„"})]}),e.jsx(B,{type:"primary",icon:e.jsx(dr,{}),onClick:()=>{nt&&(S(!1),Wr({repo:nt,displayKey:"build"}),Ln(!0))},disabled:!nt,children:"ë¹Œë“œ ì‹¤í–‰"})]}),open:_,closable:!1,onCancel:()=>{S(!1),Gt(null),Nr(null),Mn(null)},footer:[e.jsx(B,{onClick:()=>{S(!1),Gt(null),Nr(null),Mn(null)},children:"ë‹«ê¸°"},"close")],width:1200,styles:{body:{maxHeight:"80vh",overflow:"auto",padding:"24px"}},destroyOnClose:!0,children:e.jsx(xs,{activeKey:L,onChange:k,items:[{key:"statistics",label:e.jsxs(g,{children:[e.jsx(Jo,{}),e.jsx("span",{children:"ë¹Œë“œ í†µê³„"})]}),children:Ar?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:"16px",fontSize:"16px",color:"#666"},children:"ë¹Œë“œ í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]}):Ds?e.jsx($w,{statistics:Ds,buildEnvironment:hn,loading:Ar,serviceId:nt==null?void 0:nt.id,onBuildClick:()=>{nt&&(S(!1),Wr({repo:nt,displayKey:"build"}),Ls(!0))}}):e.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#999"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"ğŸ—ï¸"}),e.jsx("p",{style:{fontSize:"16px",margin:0},children:"ë¹Œë“œ í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{style:{fontSize:"14px",margin:"8px 0 0 0",color:"#ccc"},children:"ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."})]})},{key:"wizard",label:e.jsxs(g,{children:[e.jsx(dr,{}),e.jsx("span",{children:"ë¹Œë“œ í™˜ê²½ ìƒì„±"})]}),children:nt?e.jsx(D_,{gitUrl:nt.gitlabUrl,branch:nt.gitlabBranch,serviceName:nt.name,onSuccess:()=>{f.success("ë¹Œë“œ í™˜ê²½ íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!"),Qi()}}):e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(dr,{style:{fontSize:64,color:"#52c41a",marginBottom:"24px"}}),e.jsx("p",{style:{fontSize:"18px",marginBottom:"16px",color:"#333"},children:"ë¹Œë“œ í™˜ê²½ ìƒì„± ë§ˆë²•ì‚¬"}),e.jsx("p",{style:{fontSize:"14px",marginBottom:"24px",color:"#666"},children:"ì €ì¥ì†Œë¥¼ ì„ íƒí•˜ì„¸ìš”"})]})},{key:"sca",label:e.jsxs(g,{children:[e.jsx(bi,{}),e.jsx("span",{children:"ì´ë¯¸ì§€ ë¶„ì„"}),nt&&(()=>{const C=an(nt.gitlabUrl,"sca",nt.id);return C&&C!=="null"&&C!=="idle"?e.jsx(T,{color:C==="analyzing"?"processing":C==="completed"?"success":C==="failed"?"error":"default",style:{marginLeft:4},children:C==="analyzing"?"ì§„í–‰ì¤‘":C==="completed"?"ì™„ë£Œ":"ì‹¤íŒ¨"}):null})()]}),children:nt?e.jsx(wS,{repoId:nt.id,repoName:nt.name,repoUrl:nt.gitlabUrl,serviceId:(Hu=ss.find(C=>C.id===nt.id||C.gitlab_url===nt.gitlabUrl))==null?void 0:Hu.id,onScanStateChange:(C,re)=>{nt&&ys(nt.gitlabUrl,C,re,nt.id)}}):e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},children:[e.jsx(bi,{style:{fontSize:64,color:"#52c41a",marginBottom:"24px"}}),e.jsx("p",{style:{fontSize:"18px",marginBottom:"16px",color:"#333"},children:"ì´ë¯¸ì§€ ë¶„ì„ ê²°ê³¼"}),e.jsx("p",{style:{fontSize:"14px",marginBottom:"24px",color:"#666"},children:"ì €ì¥ì†Œë¥¼ ì„ íƒí•˜ì„¸ìš”"})]})}]})}),e.jsx(rt,{title:"GitLab í† í° ì…ë ¥",open:s,onCancel:()=>{t(!1),n(null),i(""),d("")},onOk:()=>{Yx()},okText:"ì €ì¥",cancelText:"ì·¨ì†Œ",destroyOnClose:!0,forceRender:!0,children:e.jsxs("div",{style:{padding:"20px 0"},children:[e.jsx("p",{style:{marginBottom:"16px",color:"#666"},children:"GitLab APIì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ê°œì¸ ì•¡ì„¸ìŠ¤ í† í°ì´ í•„ìš”í•©ë‹ˆë‹¤."}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{htmlFor:"gitlab-base-url",style:{display:"block",marginBottom:"8px",fontWeight:"bold"},children:"GitLab Base URL:"}),e.jsx(ue,{id:"gitlab-base-url",placeholder:"https://gitlab.mipllab.com",value:l,onChange:C=>d(C.target.value),style:{marginBottom:"16px"}})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{htmlFor:"gitlab-token",style:{display:"block",marginBottom:"8px",fontWeight:"bold"},children:"Personal Access Token:"}),e.jsx(ue.Password,{id:"gitlab-token",placeholder:"GitLab Personal Access Tokenì„ ì…ë ¥í•˜ì„¸ìš”",value:a,onChange:C=>i(C.target.value)})]}),e.jsxs("div",{style:{fontSize:"12px",color:"#999"},children:[e.jsx("p",{children:"í† í° ìƒì„± ë°©ë²•:"}),e.jsxs("ol",{style:{margin:"8px 0",paddingLeft:"20px"},children:[e.jsx("li",{children:"GitLab â†’ Settings â†’ Access Tokens"}),e.jsx("li",{children:'Token name: "k8scontrol"'}),e.jsx("li",{children:'Scopes: "read_api", "read_repository" ì„ íƒ'}),e.jsx("li",{children:"ìƒì„±ëœ í† í°ì„ ë³µì‚¬í•˜ì—¬ ì…ë ¥"})]})]})]})}),e.jsx(_S,{visible:Ps,onClose:()=>{ir(!1),Ge(null),tt(""),lt(void 0)},service:Ut,currentStatus:Ut==null?void 0:Ut.currentStatus,serverHops:et,infraId:Vt,dastState:Ut!=null&&Ut.gitlab_url?an(Ut.gitlab_url,"dast",Ut.id):void 0,dastResult:ds,repoId:Ut!=null&&Ut.gitlab_url?(Vu=Dt.find(C=>C.gitlabUrl===Ut.gitlab_url))==null?void 0:Vu.id:void 0,repoName:Ut!=null&&Ut.gitlab_url?(qu=Dt.find(C=>C.gitlabUrl===Ut.gitlab_url))==null?void 0:qu.name:void 0,repoUrl:(Ut==null?void 0:Ut.gitlab_url)||void 0,onDastScanStateChange:C=>{Ut!=null&&Ut.gitlab_url&&(ys(Ut.gitlab_url,"dast",C,Ut.id),(C==="completed"||C==="failed")&&Jt(Ut.gitlab_url,"dast",new Date().toISOString(),Ut.id))}}),e.jsx(z0,{visible:Xe,onClose:()=>{Nt(!1),vs(null),Le(void 0)},currentInfraName:Fe,onSelect:async(C,re)=>{if(!da){f.error("ì„ íƒëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.");return}try{let he=ss.find(Te=>Te.id===da.id);if(he||(he=ss.find(Te=>Te.gitlab_url===da.gitlabUrl)),!he){f.error("ì—°ê²°ëœ ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}await gn.updateServiceInfra(he.id,C),f.success(`ì¸í”„ë¼ê°€ "${re}"ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`),Nt(!1),vs(null),Hn&&(f.info(`ì´ì œ ì›ë˜ ìš”ì²­í–ˆë˜ "${ap[Hn.displayKey]}" ë‹¨ê³„ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.`),await Pu(Hn.repo,Hn.displayKey),yn(null))}catch(he){f.error("ì‘ì—…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",he),yn(null)}}}),J!=="sca"&&e.jsx(Mw,{visible:A,onClose:()=>{W(!1),se(null),D(""),K("")},repoId:Z||0,repoName:ce,repoUrl:M,analysisType:J,onScanStateChange:(C,re)=>{if(M&&(ys(M,C,re,Z),re==="completed"||re==="failed")){const he=new Date().toISOString();Jt(M,C,he,Z)}}}),ut&&e.jsx(NS,{visible:ke,stage:ut.stage,category:ut.category,warningType:ut.warningType,vulnerabilitySummary:ut.vulnerabilitySummary,serviceName:ut.serviceName,onContinue:ut.onContinue,onCancel:()=>{Re(!1),$t(null),Gr(null),Wr(null)},loading:Hr}),e.jsx(ku,{visible:oe,onClose:()=>{be(!1),ye(null),N(""),Ce(""),Pe(null)},onConfirm:Jx,loading:!1,serviceId:je||void 0}),nt&&e.jsx(U_,{visible:ms,onClose:()=>Ts(!1),repoId:nt.id,repoName:nt.name,onScanStateChange:C=>{nt.gitlabUrl&&(ys(nt.gitlabUrl,"dast",C,nt.id),(C==="completed"||C==="failed")&&Jt(nt.gitlabUrl,"dast",new Date().toISOString(),nt.id))}}),I&&e.jsx(Dw,{visible:E,onCancel:()=>{P(!1),$(null),v(""),m("")},onSuccess:()=>{P(!1),gn.getServices().then(C=>{rs(C||[]),nt&&(p(!0),ns(nt.id,nt.gitlabUrl,ta).catch(()=>{}))}).catch(()=>{f.error("ì„œë¹„ìŠ¤ ëª©ë¡ ê°±ì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}),$(null),v(""),m("")},serviceId:I,serviceName:y,gitlabUrl:u})]})},$S="/database";async function qr(s,t={}){try{const r=await ee.post($S,{action:s,parameters:t});if(!r.success)throw new Error(r.error||"ìš”ì²­ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return r.data}catch(r){throw O.error(`[Database API] ${s} ì‹¤íŒ¨:`,r),r}}async function OS(){return qr("getDBConnections")}async function DS(){return qr("getServicesWithSSHInfo")}async function FS(s){return qr("createDBConnection",s)}async function US(s,t){await qr("updateDBConnection",{id:s,...t})}async function HS(s){await qr("deleteDBConnection",{id:s})}async function VS(s){return typeof s=="number"?qr("testDBConnection",{id:s}):qr("testDBConnection",s)}async function qS(s,t,r="full"){return qr("compareDBs",{source_connection_id:s,target_connection_id:t,compare_type:r})}async function GS(){return qr("getSyncJobs")}async function WS(s){return qr("createSyncJob",s)}async function KS(s,t){await qr("updateSyncJob",{id:s,...t})}async function YS(s){await qr("deleteSyncJob",{id:s})}async function JS(s,t=!1){return qr("executeSyncJob",{id:s,dry_run:t})}async function ZS(s){const t={};return s&&(t.job_id=s),qr("getSyncHistory",t)}async function QS(s){return qr("getSyncHistoryDetail",{id:s})}async function XS(s){return qr("listBackups",{connection_id:s})}async function ev(s,t){return qr("restoreBackup",{connection_id:s,backup_file:t})}async function tv(s,t){return qr("restoreBackupAsync",{connection_id:s,backup_file:t})}async function sv(s,t){const r={};return s&&(r.connection_id=s),t&&(r.restore_id=t),qr("getRestoreHistory",r)}async function rv(s){return qr("createDBBackup",s)}async function nv(s){return qr("deleteDBBackup",{backup_id:s})}function Wx(s){switch(s){case"mysql":case"mariadb":return 3306;case"postgresql":return 5432;default:return 3306}}function tc(s){switch(s){case"success":return"green";case"partial":return"orange";case"running":return"blue";case"failed":return"red";case"cancelled":return"gold";case"pending":default:return"default"}}function sc(s){switch(s){case"success":return"ì„±ê³µ";case"partial":return"ì¼ë¶€ ì‹¤íŒ¨";case"running":return"ì‹¤í–‰ ì¤‘";case"failed":return"ì‹¤íŒ¨";case"cancelled":return"ì·¨ì†Œë¨";case"pending":return"ëŒ€ê¸° ì¤‘";default:return s}}const Cr={getDBConnections:OS,getServicesWithSSHInfo:DS,createDBConnection:FS,updateDBConnection:US,deleteDBConnection:HS,testDBConnection:VS,compareDBs:qS,getSyncJobs:GS,createSyncJob:WS,updateSyncJob:KS,deleteSyncJob:YS,executeSyncJob:JS,getSyncHistory:ZS,getSyncHistoryDetail:QS,listBackups:XS,restoreBackup:ev,restoreBackupAsync:tv,getRestoreHistory:sv,createDBBackup:rv,deleteDBBackup:nv,getDefaultPort:Wx,getSyncStatusColor:tc,getSyncStatusText:sc},{Title:av,Text:ct,Paragraph:Np}=we,{TabPane:Fo}=xs,{Option:mi}=Ee,{Panel:iv}=nr,ov=()=>{var dn,un,nt,Gt,fe,Be,dt,ns,Ds,hn,Ar,Nr,Mn,jn,ba,Fa,Ur,bn,Vn,_a,Ua,Ha,Va,wa,Gr,oa,le,me,De,zt,Ls,Br,Ln,Sa,Ma,jr,Wr,li,qa,Ci,Xr,ko,Ga,Co,ci,va,la,xr,en,_e,An,Wa,di;const[s,t]=o.useState("connections"),[r,n]=o.useState(!1),[a,i]=o.useState([]),[l,d]=o.useState([]),[c,p]=o.useState([]),[h,x]=o.useState(new Set),[_,S]=o.useState(!1),[L,k]=o.useState(!1),[E,P]=o.useState(null),[I,$]=o.useState(null),[y,v]=o.useState([]),[u,m]=o.useState(null),[j,b]=o.useState(!1),[A,W]=o.useState(!1),[Z,se]=o.useState(null),[ce,D]=o.useState(!1),[M]=H.useForm(),[K]=H.useForm(),[J]=H.useForm(),[te,G]=o.useState(!1),[q,oe]=o.useState(!1),[be,ne]=o.useState({validated:!1,isCompatible:!1}),[ye,Ue]=o.useState(!1),[N,ge]=o.useState(!0),[Ce,je]=o.useState(!1),[Pe,w]=o.useState(!1),[R,U]=o.useState(null),[V,F]=o.useState(!1),[X,de]=o.useState(0),[Ne,ae]=o.useState(0),[pe,Xe]=o.useState(new Map),[Nt,Fe]=o.useState(new Set),[Le,Oe]=o.useState([]),[Mt,Ve]=o.useState(!1),[Me,ot]=o.useState(null),[Bt,Ps]=o.useState([]),[ir,Ut]=o.useState(!1),[Ge,et]=o.useState(null),[tt,Vt]=o.useState(null),[lt,Rt]=o.useState(null),[St,ms]=o.useState(null),Ts=a.filter(z=>z.connectionStatus==="connected"),ds=o.useCallback(async()=>{try{n(!0);const z=await Cr.getDBConnections();i((z||[]).map(Q=>({...Q,connectionStatus:Q.last_test_status||"unknown",lastTestMessage:Q.last_test_message})))}catch(z){O.error("DB ì—°ê²° ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",z),f.error("DB ì—°ê²° ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}finally{n(!1)}},[]),fs=o.useCallback(async()=>{try{const z=await Cr.getSyncJobs();d(z||[])}catch(z){O.error("ë™ê¸°í™” ì‘ì—… ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",z)}},[]),Cs=o.useCallback(async()=>{try{const z=await Cr.getSyncHistory();p(z||[])}catch(z){O.error("ë™ê¸°í™” ì´ë ¥ ë¡œë“œ ì‹¤íŒ¨:",z)}},[]),gr=o.useCallback(async()=>{b(!0);try{const z=await Cr.getServicesWithSSHInfo();v(z||[]),W(!0),(!z||z.length===0)&&O.info("SSH ì •ë³´ê°€ ìˆëŠ” ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.")}catch(z){O.error("ì„œë¹„ìŠ¤ SSH ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:",z),f.error("ì„œë¹„ìŠ¤ ì •ë³´ ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),W(!0)}finally{b(!1)}},[]),Rr=z=>{if(m(z),!z)return;const Q=y.find(Re=>Re.service_id===z);if(!Q||Q.ssh_hops.length===0){f.warning("ì„ íƒí•œ ì„œë¹„ìŠ¤ì— SSH ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const ke=Q.ssh_hops;ke.length>=1&&(ke.length>=2?(M.setFieldsValue({ssh_enabled:!0,ssh_jump_enabled:!0,ssh_jump_host:ke[0].host,ssh_jump_port:ke[0].port||22,ssh_jump_username:ke[0].username,ssh_host:ke[ke.length-1].host,ssh_port:ke[ke.length-1].port||22,ssh_username:ke[ke.length-1].username}),G(!0),oe(!0)):(M.setFieldsValue({ssh_enabled:!0,ssh_jump_enabled:!1,ssh_host:ke[0].host,ssh_port:ke[0].port||22,ssh_username:ke[0].username}),G(!0),oe(!1)),f.success(`"${Q.service_name}" ì„œë¹„ìŠ¤ì˜ SSH ì •ë³´ê°€ ìë™ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ë§Œ ì…ë ¥í•˜ì„¸ìš”.`))};o.useEffect(()=>{ds(),fs(),Cs()},[ds,fs,Cs]);const Ss=o.useRef(null);o.useEffect(()=>(c.some(Q=>Q.status==="running")?Ss.current||(Ss.current=setInterval(()=>{Cs()},3e3)):Ss.current&&(clearInterval(Ss.current),Ss.current=null),()=>{Ss.current&&(clearInterval(Ss.current),Ss.current=null)}),[c,Cs]),o.useEffect(()=>{let z=null;return ce&&(de(0),z=setInterval(()=>{de(Q=>Q+1)},1e3)),()=>{z&&clearInterval(z)}},[ce]),o.useEffect(()=>{let z=null;return V&&(ae(0),z=setInterval(()=>{ae(Q=>Q+1)},1e3)),()=>{z&&clearInterval(z)}},[V]);const Rn=async z=>{try{n(!0);const Q={...z,service_id:u||void 0};E?(await Cr.updateDBConnection(E.id,Q),f.success("DB ì—°ê²° ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")):(await Cr.createDBConnection(Q),f.success("ìƒˆ DB ì—°ê²°ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.")),S(!1),M.resetFields(),P(null),G(!1),oe(!1),m(null),ds()}catch(Q){O.error("DB ì—°ê²° ì €ì¥ ì‹¤íŒ¨:",Q),f.error("DB ì—°ê²° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{n(!1)}},fn=async z=>{try{await Cr.deleteDBConnection(z),f.success("DB ì—°ê²°ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),ds()}catch(Q){O.error("DB ì—°ê²° ì‚­ì œ ì‹¤íŒ¨:",Q),f.error("DB ì—°ê²° ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},Os=async z=>{const Q=a.find(ke=>ke.id===z);try{x(Re=>new Set(Re).add(z)),i(Re=>Re.map(ut=>ut.id===z?{...ut,connectionStatus:"testing"}:ut));const ke=await Cr.testDBConnection(z);i(Re=>Re.map(ut=>ut.id===z?{...ut,connectionStatus:ke.connected?"connected":"failed",lastTestMessage:ke.connected?"ì—°ê²° ì„±ê³µ":ke.error||"ì—°ê²° ì‹¤íŒ¨"}:ut)),ke.connected?f.success({content:e.jsxs("span",{children:[e.jsx("strong",{children:(Q==null?void 0:Q.name)||"DB"})," ì—°ê²° ì„±ê³µ",e.jsx("br",{}),e.jsxs("span",{style:{fontSize:12,color:"#666"},children:[Q==null?void 0:Q.host,":",Q==null?void 0:Q.port,"/",Q==null?void 0:Q.database_name]})]}),duration:3}):f.error(`${(Q==null?void 0:Q.name)||"DB"} ì—°ê²° ì‹¤íŒ¨: ${ke.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}catch(ke){O.error("DB ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:",ke),i(Re=>Re.map(ut=>ut.id===z?{...ut,connectionStatus:"failed",lastTestMessage:"í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨"}:ut)),f.error(`${(Q==null?void 0:Q.name)||"DB"} ì—°ê²° í…ŒìŠ¤íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.`)}finally{x(ke=>{const Re=new Set(ke);return Re.delete(z),Re})}},Ms=async()=>{for(const z of a)await Os(z.id)},Ht=async z=>{try{n(!0),I?(await Cr.updateSyncJob(I.id,z),f.success("ë™ê¸°í™” ì‘ì—…ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")):(await Cr.createSyncJob(z),f.success("ë™ê¸°í™” ì‘ì—…ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")),k(!1),K.resetFields(),$(null),fs()}catch(Q){O.error("ë™ê¸°í™” ì‘ì—… ì €ì¥ ì‹¤íŒ¨:",Q),f.error("ë™ê¸°í™” ì‘ì—… ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{n(!1)}},Dt=async z=>{try{await Cr.deleteSyncJob(z),f.success("ë™ê¸°í™” ì‘ì—…ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),fs()}catch(Q){O.error("ë™ê¸°í™” ì‘ì—… ì‚­ì œ ì‹¤íŒ¨:",Q),f.error("ë™ê¸°í™” ì‘ì—… ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},zr=async z=>{var Q;try{F(!0),w(!0),U({job:z,compareResult:null});const ke=await Cr.compareDBs(z.source_connection_id,z.target_connection_id,"full");(Q=ke.data_diff)!=null&&Q.tables&&ke.data_diff.tables.forEach(Re=>{}),U({job:z,compareResult:ke})}catch(ke){O.error("ë™ê¸°í™” ë¯¸ë¦¬ë³´ê¸° ì‹¤íŒ¨:",ke),f.error("ë™ê¸°í™” ë¯¸ë¦¬ë³´ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."),w(!1)}finally{F(!1)}},nn=async(z,Q=!1)=>{try{const ke=await Cr.executeSyncJob(z,Q);f.success(Q?`í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. (ID: ${ke.history_id})`:`ë™ê¸°í™” ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. (ID: ${ke.history_id})`),fs(),Cs(),w(!1),U(null)}catch(ke){O.error("ë™ê¸°í™” ì‘ì—… ì‹¤í–‰ ì‹¤íŒ¨:",ke),f.error("ë™ê¸°í™” ì‘ì—… ì‹¤í–‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},zn=async z=>{try{D(!0),se(null);const Q=await Cr.compareDBs(z.source_id,z.target_id,"schema");se(Q),f.success("ìŠ¤í‚¤ë§ˆ ë¹„êµê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(Q){O.error("ìŠ¤í‚¤ë§ˆ ë¹„êµ ì‹¤íŒ¨:",Q),f.error("ìŠ¤í‚¤ë§ˆ ë¹„êµì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")}finally{D(!1)}},Ys=async z=>{if(!pe.has(z))try{Fe(ke=>new Set(ke).add(z));const Q=await Cr.getSyncHistoryDetail(z);Xe(ke=>new Map(ke).set(z,Q))}catch(Q){O.error(`ì´ë ¥ ìƒì„¸ ë¡œë“œ ì‹¤íŒ¨ (ID: ${z}):`,Q),f.error("ì´ë ¥ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}finally{Fe(Q=>{const ke=new Set(Q);return ke.delete(z),ke})}},En=z=>{Oe(Q=>Q.includes(z)?Q.filter(Re=>Re!==z):(Ys(z),[...Q,z]))},Pn=async z=>{try{Ut(!0),ot(z),Ve(!0);const Q=await Cr.listBackups(z.id);Ps(Q||[])}catch(Q){O.error("ë°±ì—… ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:",Q),f.error("ë°±ì—… ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}finally{Ut(!1)}},Mr=o.useCallback(async z=>{try{const Q=await Cr.getRestoreHistory(void 0,z);if(Q&&Q.length>0){const ke=Q[0];Vt(ke),ke.status==="completed"?(f.success("ë°±ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤."),et(null),Vt(null),Rt(null)):ke.status==="failed"&&(f.error(`ë°±ì—… ë³µì› ì‹¤íŒ¨: ${ke.error_message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`),et(null),Vt(null),Rt(null))}}catch(Q){O.error("ë³µì› ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨:",Q)}},[]);o.useEffect(()=>{if(lt!==null){const z=setInterval(()=>{Mr(lt)},2e3);return()=>clearInterval(z)}},[lt,Mr]);const Lr=async z=>{Me&&rt.confirm({title:"ë°±ì—… ë³µì› í™•ì¸",icon:e.jsx(Tr,{}),content:e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ì£¼ì˜:"})," ë°±ì—… ë³µì›ì€ í˜„ì¬ ë°ì´í„°ë¥¼ ë®ì–´ì”ë‹ˆë‹¤!"]}),e.jsxs("p",{children:["ë³µì›í•  ë°±ì—…: ",e.jsx(ct,{code:!0,children:z})]}),e.jsxs("p",{children:["ëŒ€ìƒ DB: ",e.jsx(ct,{strong:!0,children:Me.name})]}),e.jsx(xe,{type:"warning",message:"ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ë°ì´í„°ê°€ ìˆë‹¤ë©´ ë¨¼ì € ë°±ì—…í•˜ì„¸ìš”.",style:{marginTop:12}})]}),okText:"ë³µì› ì‹¤í–‰",okType:"danger",cancelText:"ì·¨ì†Œ",onOk:async()=>{try{et(z),Vt({id:0,connection_id:Me.id,backup_file:z,status:"running",progress_percent:50,started_at:new Date().toISOString(),completed_at:"",duration_seconds:0,error_message:"",connection_name:Me.name,database_name:Me.database_name});try{const Q=await Cr.restoreBackupAsync(Me.id,z);f.info("ë³µì› ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì§„í–‰ë¥ ì„ í™•ì¸í•˜ì„¸ìš”."),Rt(Q.restore_id),Vt(ke=>ke?{...ke,id:Q.restore_id,status:"running",progress_percent:10}:null)}catch(Q){O.warn("ë¹„ë™ê¸° ë³µì› ì‹¤íŒ¨, ë™ê¸° ë³µì›ìœ¼ë¡œ ì§„í–‰:",Q),await Cr.restoreBackup(Me.id,z),Vt(ke=>ke?{...ke,status:"completed",progress_percent:100,completed_at:new Date().toISOString()}:null),f.success("ë°±ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤."),setTimeout(()=>{Vt(null),et(null)},2e3)}}catch(Q){O.error("ë°±ì—… ë³µì› ì‹¤íŒ¨:",Q),Vt(ke=>ke?{...ke,status:"failed",progress_percent:100,error_message:Q instanceof Error?Q.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}:null),f.error("ë°±ì—… ë³µì›ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),setTimeout(()=>{Vt(null),et(null)},3e3)}}})},Xn=async(z,Q,ke,Re,ut)=>{try{ms(ut);const $t=Q.split("/").pop()||Q;Vt({id:0,connection_id:z,backup_file:Q,status:"running",progress_percent:10,started_at:new Date().toISOString(),completed_at:"",duration_seconds:0,error_message:"",connection_name:ke,database_name:Re});try{const Hr=await Cr.restoreBackupAsync(z,Q);Rt(Hr.restore_id),Vt(us=>us?{...us,id:Hr.restore_id,status:"running",progress_percent:30}:null)}catch(Hr){O.warn("ë¹„ë™ê¸° ë³µì› ì‹¤íŒ¨, ë™ê¸° ë³µì›ìœ¼ë¡œ ì§„í–‰:",Hr),Vt(us=>us?{...us,progress_percent:50}:null),await Cr.restoreBackup(z,Q),Vt(us=>us?{...us,status:"completed",progress_percent:100,completed_at:new Date().toISOString()}:null),rt.success({title:"ë°±ì—… ë³µì› ì™„ë£Œ",content:e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ë³µì› íŒŒì¼:"})," ",$t]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ëŒ€ìƒ DB:"})," ",ke]}),e.jsx(xe,{type:"info",message:"ë³µì›ëœ ë°ì´í„°ë¥¼ í™•ì¸í•˜ë ¤ë©´ 'DB ë¹„êµ' ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì„¸ìš”.",style:{marginTop:12}})]}),okText:"í™•ì¸"}),setTimeout(()=>{Vt(null),ms(null)},2e3),Cs()}}catch($t){O.error("ë°±ì—… ë³µì› ì‹¤íŒ¨:",$t),Vt(Hr=>Hr?{...Hr,status:"failed",progress_percent:100,error_message:$t instanceof Error?$t.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}:null),rt.error({title:"ë³µì› ì‹¤íŒ¨",content:e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"íŒŒì¼:"})," ",Q.split("/").pop()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ì˜¤ë¥˜:"})," ",$t instanceof Error?$t.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"]})]}),okText:"í™•ì¸"}),setTimeout(()=>{Vt(null),ms(null)},3e3)}},ea=z=>{if(z===0)return"0 B";const Q=1024,ke=["B","KB","MB","GB"],Re=Math.floor(Math.log(z)/Math.log(Q));return parseFloat((z/Math.pow(Q,Re)).toFixed(2))+" "+ke[Re]},or=async()=>{const z=J.getFieldValue("source_id"),Q=J.getFieldValue("target_id"),ke=a.find(ut=>ut.id===z),Re=a.find(ut=>ut.id===Q);if(!z||!Q){f.error("ì†ŒìŠ¤ì™€ íƒ€ê²Ÿ DBë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}try{je(!0);const ut=new Date().toISOString().slice(0,19).replace("T","_").replace(/:/g,"-"),$t=await Cr.createSyncJob({name:`Migration_${(ke==null?void 0:ke.name)||"src"}_to_${(Re==null?void 0:Re.name)||"tgt"}_${ut}`,description:`ìŠ¤í‚¤ë§ˆ ë§ˆì´ê·¸ë ˆì´ì…˜: ${(ke==null?void 0:ke.database_name)||""} â†’ ${(Re==null?void 0:Re.database_name)||""}`,source_connection_id:z,target_connection_id:Q,sync_type:"schema",backup_before_sync:N});await Cr.executeSyncJob($t.id,!1),f.success({content:"ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹¤í–‰ ì´ë ¥ì—ì„œ ì§„í–‰ ìƒí™©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",duration:3}),se(null),fs(),Cs(),t("history")}catch(ut){O.error("ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ ì‹¤íŒ¨:",ut),f.error("ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{je(!1)}},ss=async(z,Q)=>{var ke,Re,ut,$t,Hr,us;if(!z||!Q||z===Q){ne({validated:!1,isCompatible:!1});return}try{Ue(!0);const Nn=await Cr.compareDBs(z,Q,"schema"),Ka=(((Re=(ke=Nn.schema_diff)==null?void 0:ke.only_in_source)==null?void 0:Re.length)||0)>0,Ii=((($t=(ut=Nn.schema_diff)==null?void 0:ut.only_in_target)==null?void 0:$t.length)||0)>0,ui=(((us=(Hr=Nn.schema_diff)==null?void 0:Hr.column_differences)==null?void 0:us.length)||0)>0,hi=!Ka&&!Ii&&!ui;ne({validated:!0,isCompatible:hi,message:hi?"ìŠ¤í‚¤ë§ˆê°€ ë™ì¼í•©ë‹ˆë‹¤. ë°ì´í„° ë™ê¸°í™”ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.":"ìŠ¤í‚¤ë§ˆê°€ ë‹¤ë¦…ë‹ˆë‹¤. ë¨¼ì € ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìˆ˜í–‰í•´ì£¼ì„¸ìš”.",differences:Nn.schema_diff})}catch(Nn){O.error("ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹¤íŒ¨:",Nn),ne({validated:!0,isCompatible:!1,message:"ìŠ¤í‚¤ë§ˆ ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."})}finally{Ue(!1)}},rs=z=>{if(h.has(z.id))return e.jsx(ps,{status:"processing",text:"í…ŒìŠ¤íŠ¸ ì¤‘..."});switch(z.connectionStatus){case"connected":return e.jsx(Ie,{title:z.lastTestMessage,children:e.jsx(ps,{status:"success",text:"ì—°ê²°ë¨"})});case"failed":return e.jsx(Ie,{title:z.lastTestMessage,children:e.jsx(ps,{status:"error",text:"ì—°ê²° ì‹¤íŒ¨"})});default:return e.jsx(ps,{status:"default",text:"ë¯¸í™•ì¸"})}},Hn=[{title:"ì—°ê²° ì´ë¦„",dataIndex:"name",key:"name",render:(z,Q)=>e.jsxs(g,{children:[e.jsx(_s,{style:{color:Q.connectionStatus==="connected"?"#52c41a":"#999"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:z}),Q.description&&e.jsx(ct,{type:"secondary",style:{fontSize:12},children:Q.description})]})]})},{title:"ì—°ê²° ìƒíƒœ",key:"status",width:120,render:(z,Q)=>rs(Q)},{title:"DB ì •ë³´",key:"dbInfo",render:(z,Q)=>e.jsxs(g,{direction:"vertical",size:0,children:[e.jsxs(g,{children:[e.jsx(T,{color:Q.db_type==="postgresql"?"blue":"green",children:Q.db_type.toUpperCase()}),e.jsx(ct,{code:!0,children:Q.database_name})]}),e.jsxs(ct,{type:"secondary",style:{fontSize:12},children:[Q.host,":",Q.port]})]})},{title:"ì—°ê²° ë°©ì‹",key:"connectionType",width:140,render:(z,Q)=>e.jsxs(g,{children:[Q.ssh_enabled?e.jsx(Ie,{title:"SSH í„°ë„ì„ í†µí•œ ì—°ê²°",children:e.jsx(T,{color:"blue",icon:e.jsx(ya,{}),children:"SSH í„°ë„"})}):e.jsx(T,{icon:e.jsx(Ea,{}),children:"ì§ì ‘ ì—°ê²°"}),Q.ssh_jump_enabled&&e.jsx(Ie,{title:"ì í”„ í˜¸ìŠ¤íŠ¸ ì‚¬ìš©",children:e.jsx(T,{color:"purple",children:"Jump"})})]})},{title:"ì‘ì—…",key:"actions",width:220,render:(z,Q)=>e.jsxs(g,{children:[e.jsx(Ie,{title:"ì—°ê²° í…ŒìŠ¤íŠ¸",children:e.jsx(B,{type:"primary",ghost:!0,size:"small",icon:e.jsx(Pa,{}),loading:h.has(Q.id),onClick:()=>Os(Q.id),children:"í…ŒìŠ¤íŠ¸"})}),e.jsx(Ie,{title:"ë°±ì—… ê´€ë¦¬",children:e.jsx(B,{size:"small",icon:e.jsx(Bs,{}),onClick:()=>Pn(Q),disabled:!Q.ssh_enabled})}),e.jsx(Ie,{title:"ìˆ˜ì •",children:e.jsx(B,{size:"small",icon:e.jsx(ln,{}),onClick:()=>{P(Q),M.setFieldsValue(Q),G(Q.ssh_enabled),oe(Q.ssh_jump_enabled),S(!0)}})}),e.jsx(Kt,{title:"DB ì—°ê²° ì‚­ì œ",description:"ì´ ì—°ê²°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ê´€ë ¨ ë™ê¸°í™” ì‘ì—…ë„ ì˜í–¥ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",onConfirm:()=>fn(Q.id),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(Ie,{title:"ì‚­ì œ",children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{})})})})]})}],yn=[{title:"ì‘ì—…ëª…",dataIndex:"name",key:"name",render:(z,Q)=>e.jsxs(g,{children:[e.jsx(Pt,{}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:z}),Q.description&&e.jsx(ct,{type:"secondary",style:{fontSize:12},children:Q.description})]})]})},{title:"ë°ì´í„° íë¦„",key:"direction",render:(z,Q)=>{const ke=a.find(ut=>ut.id===Q.source_connection_id),Re=a.find(ut=>ut.id===Q.target_connection_id);return e.jsxs(g,{children:[e.jsx(T,{color:(ke==null?void 0:ke.connectionStatus)==="connected"?"green":"default",children:(ke==null?void 0:ke.name)||`ID:${Q.source_connection_id}`}),e.jsx(Gn,{}),e.jsx(T,{color:(Re==null?void 0:Re.connectionStatus)==="connected"?"green":"default",children:(Re==null?void 0:Re.name)||`ID:${Q.target_connection_id}`})]})}},{title:"ë°±ì—… ì„¤ì •",key:"backup",width:100,render:(z,Q)=>Q.backup_before_sync?e.jsx(T,{color:"green",icon:e.jsx(Bs,{}),children:"ë°±ì—…"}):e.jsx(T,{color:"default",children:"ë¯¸ì ìš©"})},{title:"ë§ˆì§€ë§‰ ì‹¤í–‰",key:"last_run",width:200,render:(z,Q)=>Q.last_run_status?e.jsxs(g,{direction:"vertical",size:0,children:[e.jsx(T,{color:tc(Q.last_run_status),children:sc(Q.last_run_status)}),Q.last_run_at&&e.jsx(ct,{type:"secondary",style:{fontSize:12},children:new Date(Q.last_run_at).toLocaleString("ko-KR")})]}):e.jsx(ct,{type:"secondary",children:"ì‹¤í–‰ ê¸°ë¡ ì—†ìŒ"})},{title:"ì‘ì—…",key:"actions",width:120,render:(z,Q)=>{const ke=a.find($t=>$t.id===Q.source_connection_id),Re=a.find($t=>$t.id===Q.target_connection_id),ut=(ke==null?void 0:ke.connectionStatus)==="connected"&&(Re==null?void 0:Re.connectionStatus)==="connected";return e.jsxs(g,{children:[e.jsx(Ie,{title:ut?"ë™ê¸°í™” ë¯¸ë¦¬ë³´ê¸° ë° ì‹¤í–‰":"ì†ŒìŠ¤ì™€ íƒ€ê²Ÿ DBê°€ ëª¨ë‘ ì—°ê²°ë˜ì–´ì•¼ í•©ë‹ˆë‹¤",children:e.jsx(B,{type:"primary",size:"small",icon:e.jsx(xa,{}),disabled:!ut,onClick:()=>zr(Q),children:"ë¯¸ë¦¬ë³´ê¸°"})}),e.jsx(Kt,{title:"ë™ê¸°í™” ì‘ì—… ì‚­ì œ",description:"ì´ ë™ê¸°í™” ì‘ì—…ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",onConfirm:()=>Dt(Q.id),okText:"ì‚­ì œ",cancelText:"ì·¨ì†Œ",okButtonProps:{danger:!0},children:e.jsx(B,{size:"small",danger:!0,icon:e.jsx(gs,{})})})]})}}],cn=[{title:"ì‘ì—…",dataIndex:"job_name",key:"job_name",render:z=>z||"-"},{title:"í–‰ìœ„ ìœ í˜•",dataIndex:"sync_type",key:"sync_type",width:110,render:z=>z==="data"?e.jsx(T,{color:"blue",icon:e.jsx(Pt,{}),children:"ë™ê¸°í™”"}):z==="schema"||z==="full"?e.jsx(T,{color:"purple",icon:e.jsx(Gn,{}),children:"ë§ˆì´ê·¸ë ˆì´ì…˜"}):e.jsx(T,{children:"-"})},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:100,render:z=>e.jsx(T,{color:tc(z),icon:z==="success"?e.jsx(Ze,{}):z==="failed"?e.jsx(Es,{}):z==="running"?e.jsx(Pt,{spin:!0}):z==="partial"?e.jsx(Tr,{}):void 0,children:sc(z)})},{title:"ë°±ì—…",dataIndex:"backup_created",key:"backup_created",width:70,render:z=>z?e.jsx(T,{color:"green",icon:e.jsx(Bs,{}),children:"ì™„ë£Œ"}):e.jsx(ct,{type:"secondary",children:"-"})},{title:"ì‹œì‘ ì‹œê°„",dataIndex:"started_at",key:"started_at",width:160,render:z=>z?new Date(z).toLocaleString("ko-KR"):"-"},{title:"ì†Œìš” ì‹œê°„",dataIndex:"duration_seconds",key:"duration_seconds",width:90,render:z=>{if(!z)return"-";if(z<60)return`${z}ì´ˆ`;const Q=Math.floor(z/60),ke=z%60;return`${Q}ë¶„ ${ke}ì´ˆ`}},{title:"ì²˜ë¦¬ ê²°ê³¼",key:"result",width:200,render:(z,Q)=>{if(Q.sync_type==="schema"||Q.sync_type==="full"){const ke=Q.tables_synced||0,Re=Q.rows_deleted||0,ut=Q.rows_updated||0;return e.jsxs(g,{direction:"vertical",size:0,children:[e.jsx(Ie,{title:"ìƒì„±ëœ í…Œì´ë¸”",children:e.jsxs(ct,{type:"success",style:{fontSize:12},children:["í…Œì´ë¸” ",ke,"ê°œ"]})}),Re>0&&e.jsx(Ie,{title:"ì œê±°ëœ í…Œì´ë¸”",children:e.jsxs(ct,{type:"danger",style:{fontSize:12},children:["ì‚­ì œ ",Re]})}),ut>0&&e.jsx(Ie,{title:"ì¶”ê°€ëœ ì»¬ëŸ¼",children:e.jsxs(ct,{style:{color:"#faad14",fontSize:12},children:["ì»¬ëŸ¼ +",ut,"ê°œ"]})}),e.jsx(ct,{type:"secondary",style:{fontSize:11,cursor:"pointer",color:"#1890ff"},onClick:$t=>{$t.stopPropagation(),En(Q.id)},onKeyDown:$t=>{($t.key==="Enter"||$t.key===" ")&&($t.preventDefault(),$t.stopPropagation(),En(Q.id))},role:"button",tabIndex:0,children:Le.includes(Q.id)?"ì ‘ê¸° â†‘":"ìƒì„¸ ë³´ê¸° â†’"})]})}return e.jsxs(g,{split:e.jsx(xt,{type:"vertical"}),children:[e.jsx(Ie,{title:"ì¶”ê°€ëœ í–‰",children:e.jsxs(ct,{type:"success",children:["+",Q.rows_inserted||0]})}),e.jsx(Ie,{title:"ìˆ˜ì •ëœ í–‰",children:e.jsxs(ct,{style:{color:"#faad14"},children:["~",Q.rows_updated||0]})}),e.jsx(Ie,{title:"ì‚­ì œëœ í–‰",children:e.jsxs(ct,{type:"danger",children:["-",Q.rows_deleted||0]})})]})}},{title:"ì˜¤ë¥˜",dataIndex:"error_message",key:"error_message",ellipsis:!0,render:z=>z?e.jsx(Ie,{title:z,children:e.jsx(ct,{type:"danger",children:z})}):"-"}],ys=c.filter(z=>z.sync_type==="schema"||z.sync_type==="full"),Jt=c.filter(z=>z.backup_created),an=c.filter(z=>z.status==="running");return e.jsxs("div",{className:"database-management management-page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"page-header-title",children:[e.jsx(_s,{style:{fontSize:28,color:"#1890ff"}}),e.jsxs("div",{children:[e.jsx("h1",{children:"ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬"}),e.jsx("p",{className:"page-header-description",children:"DB ì—°ê²°, ë™ê¸°í™”, ë§ˆì´ê·¸ë ˆì´ì…˜ ë° ë°±ì—…ì„ ê´€ë¦¬í•©ë‹ˆë‹¤"})]})]}),e.jsx(B,{icon:e.jsx(zs,{}),onClick:()=>{ds(),fs(),Cs()},children:"ìƒˆë¡œê³ ì¹¨"})]}),e.jsxs(Ke,{gutter:16,className:"stats-row",children:[e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon blue",children:e.jsx(_s,{})}),e.jsx($e,{title:"DB ì—°ê²°",value:a.filter(z=>z.connectionStatus==="connected").length,suffix:`/ ${a.length}`})]})})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsxs("div",{className:"stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon purple",children:e.jsx(Gn,{})}),e.jsx($e,{title:"ë§ˆì´ê·¸ë ˆì´ì…˜",value:ys.length,suffix:"íšŒ"})]}),an.length>0&&e.jsxs(T,{color:"processing",icon:e.jsx(Pt,{spin:!0}),style:{marginTop:8},children:[an.length,"ê°œ ì‹¤í–‰ ì¤‘"]})]})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon green",children:e.jsx(Bs,{})}),e.jsx($e,{title:"ë°±ì—…",value:Jt.length,suffix:"ê°œ"})]})})}),e.jsx(Y,{xs:24,sm:12,md:6,children:e.jsx("div",{className:"stat-card",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"stat-card-icon orange",children:e.jsx(Pt,{})}),e.jsx($e,{title:"ë™ê¸°í™” ì‘ì—…",value:l.filter(z=>z.sync_type==="data").length,suffix:"ê°œ"})]})})})]}),e.jsx("div",{className:"main-card",children:e.jsxs(xs,{activeKey:s,onChange:t,children:[e.jsxs(Fo,{tab:e.jsxs("span",{children:[e.jsx(_s,{}),"DB ì—°ê²°",e.jsx(ps,{count:a.filter(z=>z.connectionStatus==="connected").length,style:{marginLeft:8,backgroundColor:"#52c41a"},showZero:!0})]}),children:[a.some(z=>z.connectionStatus!=="connected")&&e.jsxs("div",{className:"info-box",children:[e.jsx(Tr,{className:"info-box-icon"}),e.jsxs("div",{className:"info-box-content",children:[e.jsx("div",{className:"info-box-title",children:"ì—°ê²° í™•ì¸ í•„ìš”"}),e.jsx("div",{className:"info-box-description",children:"ì¼ë¶€ DB ì—°ê²°ì´ í™•ì¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì „ì²´ ì—°ê²° í™•ì¸ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."})]})]}),e.jsxs("div",{className:"tab-toolbar",children:[e.jsx("div",{className:"tab-toolbar-left",children:e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:()=>{P(null),M.resetFields(),M.setFieldsValue({db_type:"mariadb",port:3306}),G(!1),oe(!1),m(null),W(!1),v([]),S(!0),gr()},children:"ìƒˆ DB ì—°ê²° ì¶”ê°€"})}),e.jsx("div",{className:"tab-toolbar-right",children:a.length>0&&e.jsx(B,{icon:e.jsx(Pa,{}),onClick:Ms,loading:h.size>0,children:"ì „ì²´ ì—°ê²° í™•ì¸"})})]}),a.length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsxs("span",{children:["ë“±ë¡ëœ DB ì—°ê²°ì´ ì—†ìŠµë‹ˆë‹¤.",e.jsx("br",{}),e.jsx(ct,{type:"secondary",children:"ìƒˆ DB ì—°ê²°ì„ ì¶”ê°€í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”."})]}),className:"empty-action",children:e.jsx(B,{type:"primary",onClick:()=>S(!0),children:"DB ì—°ê²° ì¶”ê°€"})}):e.jsx(wt,{columns:Hn,dataSource:a,rowKey:"id",loading:r,pagination:{pageSize:10,showSizeChanger:!0}})]},"connections"),e.jsxs(Fo,{tab:e.jsxs("span",{children:[e.jsx(Pt,{}),"ë™ê¸°í™” ì‘ì—…",e.jsx(ps,{count:l.filter(z=>z.sync_type==="data").length,style:{marginLeft:8},showZero:!0})]}),children:[e.jsxs("div",{className:"info-box",children:[e.jsx(Pt,{className:"info-box-icon"}),e.jsxs("div",{className:"info-box-content",children:[e.jsx("div",{className:"info-box-title",children:"ë°ì´í„° ë™ê¸°í™” ì‘ì—…"}),e.jsx("div",{className:"info-box-description",children:"ìŠ¤í‚¤ë§ˆê°€ ë™ì¼í•œ ë‘ DB ê°„ì˜ ë°ì´í„°ë¥¼ ë™ê¸°í™”í•©ë‹ˆë‹¤. ìŠ¤í‚¤ë§ˆ ë§ˆì´ê·¸ë ˆì´ì…˜ì€ 'ë§ˆì´ê·¸ë ˆì´ì…˜' íƒ­ì—ì„œ ìˆ˜í–‰í•©ë‹ˆë‹¤."})]})]}),Ts.length<2&&e.jsx(xe,{message:e.jsxs("span",{children:["ë™ê¸°í™” ì‘ì—…ì„ ìƒì„±í•˜ë ¤ë©´ ",e.jsx("strong",{children:"ìµœì†Œ 2ê°œ"}),"ì˜ ì—°ê²°ëœ DBê°€ í•„ìš”í•©ë‹ˆë‹¤. í˜„ì¬ ",Ts.length,"ê°œ ì—°ê²°ë¨."]}),type:"warning",showIcon:!0,icon:e.jsx(Tr,{}),style:{marginBottom:16}}),e.jsxs("div",{className:"tab-toolbar",children:[e.jsx("div",{className:"tab-toolbar-left",children:e.jsx(B,{type:"primary",icon:e.jsx(rr,{}),onClick:()=>{if(Ts.length<2){f.warning("ë™ê¸°í™” ì‘ì—…ì„ ìƒì„±í•˜ë ¤ë©´ ìµœì†Œ 2ê°œì˜ ì—°ê²°ëœ DBê°€ í•„ìš”í•©ë‹ˆë‹¤.");return}$(null),K.resetFields(),K.setFieldsValue({sync_type:"data",backup_before_sync:!0}),k(!0)},disabled:Ts.length<2,children:"ìƒˆ ë™ê¸°í™” ì‘ì—… ì¶”ê°€"})}),e.jsx("div",{className:"tab-toolbar-right",children:e.jsxs(ct,{type:"secondary",children:["ì´ ",l.filter(z=>z.sync_type==="data").length,"ê°œ ì‘ì—…"]})})]}),l.filter(z=>z.sync_type==="data").length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsxs("span",{children:["ë“±ë¡ëœ ë™ê¸°í™” ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤.",e.jsx("br",{}),e.jsx(ct,{type:"secondary",children:Ts.length<2?"ë¨¼ì € DB ì—°ê²°ì„ ì¶”ê°€í•˜ê³  ì—°ê²° í…ŒìŠ¤íŠ¸ë¥¼ ì™„ë£Œí•˜ì„¸ìš”.":"ìƒˆ ë™ê¸°í™” ì‘ì—…ì„ ì¶”ê°€í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”."})]}),children:Ts.length>=2&&e.jsx(B,{type:"primary",onClick:()=>k(!0),children:"ë™ê¸°í™” ì‘ì—… ì¶”ê°€"})}):e.jsx(wt,{columns:yn,dataSource:l.filter(z=>z.sync_type==="data"),rowKey:"id",loading:r,pagination:{pageSize:10,showSizeChanger:!0}})]},"sync-jobs"),e.jsxs(Fo,{tab:e.jsxs("span",{children:[e.jsx(Gn,{}),"ë§ˆì´ê·¸ë ˆì´ì…˜",ys.length>0&&e.jsx(ps,{count:ys.length,style:{marginLeft:8,backgroundColor:"#722ed1"}})]}),children:[e.jsxs("div",{className:"info-box",children:[e.jsx(Gn,{className:"info-box-icon",style:{color:"#722ed1"}}),e.jsxs("div",{className:"info-box-content",children:[e.jsx("div",{className:"info-box-title",children:"ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜"}),e.jsx("div",{className:"info-box-description",children:"ë‘ ë°ì´í„°ë² ì´ìŠ¤ì˜ ìŠ¤í‚¤ë§ˆì™€ ë°ì´í„°ë¥¼ ë¹„êµí•˜ê³ , ì†ŒìŠ¤ DBì˜ êµ¬ì¡°ë¥¼ íƒ€ê²Ÿ DBë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•©ë‹ˆë‹¤."})]})]}),Ts.length<2?e.jsx(xe,{message:"ì—°ê²°ëœ DBê°€ ë¶€ì¡±í•©ë‹ˆë‹¤",description:e.jsxs("span",{children:["ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìˆ˜í–‰í•˜ë ¤ë©´ ",e.jsx("strong",{children:"ìµœì†Œ 2ê°œ"}),"ì˜ ì—°ê²°ëœ DBê°€ í•„ìš”í•©ë‹ˆë‹¤. í˜„ì¬ ",Ts.length,"ê°œê°€ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.",e.jsx("br",{}),e.jsx(B,{type:"link",style:{padding:0,marginTop:8},onClick:()=>t("connections"),children:"DB ì—°ê²° íƒ­ìœ¼ë¡œ ì´ë™ â†’"})]}),type:"warning",showIcon:!0,icon:e.jsx(Tr,{})}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"section-card",style:{marginBottom:20},children:e.jsxs(H,{form:J,layout:"vertical",onFinish:zn,children:[e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:11,children:e.jsx(H.Item,{name:"source_id",label:"ì†ŒìŠ¤ DB (ì›ë³¸)",rules:[{required:!0,message:"ì†ŒìŠ¤ DBë¥¼ ì„ íƒí•˜ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ë¹„êµ ê¸°ì¤€ DB",children:Ts.map(z=>e.jsx(mi,{value:z.id,children:e.jsxs(g,{children:[e.jsx(Ze,{style:{color:"#52c41a"}}),z.name," (",z.database_name,")"]})},z.id))})})}),e.jsx(Y,{span:2,style:{textAlign:"center",paddingTop:38},children:e.jsx(Gn,{style:{fontSize:18}})}),e.jsx(Y,{span:11,children:e.jsx(H.Item,{name:"target_id",label:"íƒ€ê²Ÿ DB (ëŒ€ìƒ)",rules:[{required:!0,message:"íƒ€ê²Ÿ DBë¥¼ ì„ íƒí•˜ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ë¹„êµ ëŒ€ìƒ DB",children:Ts.map(z=>e.jsx(mi,{value:z.id,children:e.jsxs(g,{children:[e.jsx(Ze,{style:{color:"#52c41a"}}),z.name," (",z.database_name,")"]})},z.id))})})})]}),e.jsx(Ke,{gutter:16,align:"middle",style:{marginBottom:16},children:e.jsx(Y,{children:e.jsx(H.Item,{label:"ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ ë°±ì—…",style:{marginBottom:0},tooltip:"íƒ€ê²Ÿ DBë¥¼ ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ì— ë°±ì—…í•©ë‹ˆë‹¤",children:e.jsx(Zr,{checked:N,onChange:ge,checkedChildren:"ë°±ì—…í•¨",unCheckedChildren:"ë°±ì—… ì•ˆí•¨"})})})}),e.jsx(B,{type:"primary",htmlType:"submit",loading:ce,icon:e.jsx(Gn,{}),size:"large",children:"ìŠ¤í‚¤ë§ˆ ë¹„êµ"})]})}),ce&&e.jsxs("div",{style:{textAlign:"center",padding:"60px"},children:[e.jsx(gt,{size:"large"}),e.jsx(Np,{style:{marginTop:16,marginBottom:8},children:e.jsx(ct,{strong:!0,children:"ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë¹„êµ ì¤‘..."})}),e.jsx(qt,{type:"line",percent:Math.min(X*3,95),status:"active",strokeColor:{from:"#108ee9",to:"#87d068"},style:{maxWidth:300,margin:"0 auto"}}),e.jsxs(Np,{type:"secondary",style:{marginTop:12},children:["ê²½ê³¼ ì‹œê°„: ",X,"ì´ˆ",X>10&&" (í…Œì´ë¸” ìˆ˜ì— ë”°ë¼ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤)"]})]}),Z&&e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx(xt,{children:"ë¹„êµ ê²°ê³¼"}),Z.schema_diff&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(rn,{})," ìŠ¤í‚¤ë§ˆ ë¹„êµ ê²°ê³¼"]}),size:"small",style:{marginBottom:"16px"},children:(((dn=Z.schema_diff.only_in_source)==null?void 0:dn.length)||0)===0&&(((un=Z.schema_diff.only_in_target)==null?void 0:un.length)||0)===0&&(((nt=Z.schema_diff.column_differences)==null?void 0:nt.length)||0)===0?e.jsx(xe,{type:"success",message:"ìŠ¤í‚¤ë§ˆê°€ ë™ì¼í•©ë‹ˆë‹¤.",showIcon:!0}):e.jsx(g,{direction:"vertical",style:{width:"100%"},size:"large",children:e.jsxs("div",{children:[e.jsxs(av,{level:5,style:{marginBottom:12},children:[e.jsx(Xu,{})," í…Œì´ë¸” ì°¨ì´ ë¶„ì„"]}),e.jsx(wt,{size:"small",pagination:!1,dataSource:[...(Z.schema_diff.only_in_source||[]).map(z=>({key:`source-${z}`,table_name:z,status:"source_only",description:"ì†ŒìŠ¤ì—ë§Œ ì¡´ì¬"})),...(Z.schema_diff.only_in_target||[]).map(z=>({key:`target-${z}`,table_name:z,status:"target_only",description:"íƒ€ê²Ÿì—ë§Œ ì¡´ì¬"})),...(Z.schema_diff.column_differences||[]).map((z,Q)=>{var Hr,us,Nn;const ke=((Hr=z.columns_only_source)==null?void 0:Hr.length)||0,Re=((us=z.columns_only_target)==null?void 0:us.length)||0,ut=((Nn=z.type_differences)==null?void 0:Nn.length)||0,$t=ke+Re+ut;return{key:`column-diff-${Q}`,table_name:z.table,status:"column_diff",description:`ì†ŒìŠ¤ë§Œ: ${ke}ê°œ, íƒ€ê²Ÿë§Œ: ${Re}ê°œ, íƒ€ì…ì°¨ì´: ${ut}ê°œ`,column_diff_data:z,total_diffs:$t}})],columns:[{title:"í…Œì´ë¸”ëª…",dataIndex:"table_name",key:"table_name",render:z=>e.jsx(ct,{strong:!0,children:z})},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:150,render:z=>z==="source_only"?e.jsx(T,{color:"blue",icon:e.jsx(_s,{}),children:"ì†ŒìŠ¤ì—ë§Œ ì¡´ì¬"}):z==="target_only"?e.jsx(T,{color:"orange",icon:e.jsx(_s,{}),children:"íƒ€ê²Ÿì—ë§Œ ì¡´ì¬"}):e.jsx(T,{color:"purple",icon:e.jsx(Xu,{}),children:"ì»¬ëŸ¼ ì°¨ì´"})},{title:"ì„¤ëª…",dataIndex:"description",key:"description"}],expandable:{expandedRowRender:z=>{if(z.status!=="column_diff"||!z.column_diff_data)return null;const Q=z.column_diff_data,ke=[];return(Q.columns_only_source||[]).forEach((Re,ut)=>{ke.push({key:`src-${ut}`,column:Re,source_type:"ì¡´ì¬í•¨",target_type:"ì—†ìŒ",diff_type:"source_only"})}),(Q.columns_only_target||[]).forEach((Re,ut)=>{ke.push({key:`tgt-${ut}`,column:Re,source_type:"ì—†ìŒ",target_type:"ì¡´ì¬í•¨",diff_type:"target_only"})}),(Q.type_differences||[]).forEach((Re,ut)=>{ke.push({key:`type-${ut}`,column:Re.column,source_type:Re.source_type,target_type:Re.target_type,diff_type:"type_diff"})}),e.jsxs("div",{style:{padding:"8px 16px",background:"#fafafa"},children:[e.jsx(ct,{strong:!0,style:{display:"block",marginBottom:8},children:"ì»¬ëŸ¼ ìƒì„¸ ì°¨ì´:"}),e.jsx(wt,{size:"small",pagination:!1,dataSource:ke,columns:[{title:"ì»¬ëŸ¼ëª…",dataIndex:"column",key:"column",render:Re=>e.jsx(ct,{strong:!0,children:Re})},{title:"ì†ŒìŠ¤",dataIndex:"source_type",key:"source_type",render:(Re,ut)=>e.jsx(T,{color:ut.diff_type==="source_only"?"blue":ut.diff_type==="target_only"?"default":"blue",children:Re})},{title:"íƒ€ê²Ÿ",dataIndex:"target_type",key:"target_type",render:(Re,ut)=>e.jsx(T,{color:ut.diff_type==="target_only"?"orange":ut.diff_type==="source_only"?"default":"orange",children:Re})},{title:"ì°¨ì´ ìœ í˜•",dataIndex:"diff_type",key:"diff_type",render:Re=>Re==="source_only"?e.jsx(T,{color:"blue",children:"ì†ŒìŠ¤ì—ë§Œ ì¡´ì¬"}):Re==="target_only"?e.jsx(T,{color:"orange",children:"íƒ€ê²Ÿì—ë§Œ ì¡´ì¬"}):e.jsx(T,{color:"purple",children:"íƒ€ì… ë¶ˆì¼ì¹˜"})}]})]})},rowExpandable:z=>z.status==="column_diff"&&z.total_diffs>0}})]})})}),Z.schema_diff&&((((Gt=Z.schema_diff.source_tables)==null?void 0:Gt.length)||0)>0||(((fe=Z.schema_diff.target_tables)==null?void 0:fe.length)||0)>0)&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(_s,{}),e.jsx("span",{children:"DB í…Œì´ë¸” êµ¬ì¡°"}),e.jsx(T,{color:"blue",children:((Be=Z.schema_diff.source_tables)==null?void 0:Be.length)||0}),e.jsx("span",{children:"vs"}),e.jsx(T,{color:"green",children:((dt=Z.schema_diff.target_tables)==null?void 0:dt.length)||0})]}),size:"small",style:{marginTop:16},extra:e.jsx(g,{size:"small",children:e.jsxs(T,{color:"purple",children:["FK ìˆëŠ” í…Œì´ë¸”:"," ",((ns=Z.schema_diff.source_tables)==null?void 0:ns.filter(z=>z.fk_relations&&z.fk_relations.length>0).length)||0,"ê°œ"]})}),children:e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(ie,{type:"inner",size:"small",title:e.jsxs(g,{children:[e.jsx("span",{style:{color:"#1890ff",fontWeight:600},children:"ì†ŒìŠ¤ DB"}),e.jsxs(T,{children:[((Ds=Z.schema_diff.source_tables)==null?void 0:Ds.length)||0,"ê°œ"]})]}),bodyStyle:{padding:0},children:e.jsx("div",{style:{maxHeight:280,overflow:"auto"},children:(hn=Z.schema_diff.source_tables)==null?void 0:hn.map((z,Q)=>e.jsxs("div",{style:{padding:"6px 12px",borderBottom:"1px solid #f5f5f5",background:z.in_target?"#fff":"#e6f7ff"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(g,{size:4,children:[e.jsx(ct,{style:{fontSize:13,fontWeight:500},children:z.name}),!z.in_target&&e.jsx(T,{color:"blue",style:{fontSize:10,margin:0,lineHeight:"14px"},children:"NEW"})]}),z.fk_relations&&z.fk_relations.length>0&&e.jsxs(T,{color:"purple",style:{fontSize:10,margin:0},children:["FK:",z.fk_relations.length]})]}),z.fk_relations&&z.fk_relations.length>0&&e.jsx("div",{style:{marginTop:2,fontSize:11,color:"#8c8c8c",paddingLeft:8},children:z.fk_relations.map((ke,Re)=>e.jsxs("div",{children:[e.jsx("code",{style:{fontSize:10,background:"#f0f0f0",padding:"0 4px",borderRadius:2},children:ke.column}),e.jsx("span",{style:{margin:"0 4px"},children:"â†’"}),e.jsx("span",{style:{color:"#722ed1"},children:ke.referenced_table})]},Re))})]},Q))})})}),e.jsx(Y,{span:12,children:e.jsx(ie,{type:"inner",size:"small",title:e.jsxs(g,{children:[e.jsx("span",{style:{color:"#52c41a",fontWeight:600},children:"íƒ€ê²Ÿ DB"}),e.jsxs(T,{children:[((Ar=Z.schema_diff.target_tables)==null?void 0:Ar.length)||0,"ê°œ"]})]}),bodyStyle:{padding:0},children:e.jsx("div",{style:{maxHeight:280,overflow:"auto"},children:(Nr=Z.schema_diff.target_tables)==null?void 0:Nr.map((z,Q)=>e.jsxs("div",{style:{padding:"6px 12px",borderBottom:"1px solid #f5f5f5",background:z.in_source?"#fff":"#fff7e6"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(g,{size:4,children:[e.jsx(ct,{style:{fontSize:13,fontWeight:500},children:z.name}),!z.in_source&&e.jsx(T,{color:"orange",style:{fontSize:10,margin:0,lineHeight:"14px"},children:"ONLY"})]}),z.fk_relations&&z.fk_relations.length>0&&e.jsxs(T,{color:"purple",style:{fontSize:10,margin:0},children:["FK:",z.fk_relations.length]})]}),z.fk_relations&&z.fk_relations.length>0&&e.jsx("div",{style:{marginTop:2,fontSize:11,color:"#8c8c8c",paddingLeft:8},children:z.fk_relations.map((ke,Re)=>e.jsxs("div",{children:[e.jsx("code",{style:{fontSize:10,background:"#f0f0f0",padding:"0 4px",borderRadius:2},children:ke.column}),e.jsx("span",{style:{margin:"0 4px"},children:"â†’"}),e.jsx("span",{style:{color:"#722ed1"},children:ke.referenced_table})]},Re))})]},Q))})})})]})}),Z.schema_diff&&((((Mn=Z.schema_diff.only_in_source)==null?void 0:Mn.length)||0)>0||(((jn=Z.schema_diff.only_in_target)==null?void 0:jn.length)||0)>0||(((ba=Z.schema_diff.column_differences)==null?void 0:ba.length)||0)>0)&&e.jsx(ie,{style:{marginTop:16,border:"1px solid #722ed1",background:"#faf5ff"},title:e.jsxs(g,{children:[e.jsx(Gn,{style:{color:"#722ed1"}}),e.jsx(ct,{strong:!0,style:{color:"#722ed1"},children:"ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰"})]}),children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsx(xe,{message:"ìŠ¤í‚¤ë§ˆ ì°¨ì´ ë°œê²¬",description:e.jsxs("div",{children:[e.jsx("p",{style:{margin:"4px 0"},children:"ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹¤í–‰í•˜ë©´ ì†ŒìŠ¤ DBì˜ ìŠ¤í‚¤ë§ˆë¥¼ íƒ€ê²Ÿ DBì— ì ìš©í•©ë‹ˆë‹¤."}),e.jsxs("ul",{style:{margin:"8px 0",paddingLeft:20},children:[(((Fa=Z.schema_diff.only_in_source)==null?void 0:Fa.length)||0)>0&&e.jsxs("li",{children:["ì†ŒìŠ¤ì—ë§Œ ìˆëŠ” í…Œì´ë¸”"," ",(Ur=Z.schema_diff.only_in_source)==null?void 0:Ur.length,"ê°œê°€ íƒ€ê²Ÿì— ìƒì„±ë©ë‹ˆë‹¤."]}),(((bn=Z.schema_diff.column_differences)==null?void 0:bn.length)||0)>0&&e.jsxs("li",{children:["ì»¬ëŸ¼ ì°¨ì´ê°€ ìˆëŠ” í…Œì´ë¸”"," ",(Vn=Z.schema_diff.column_differences)==null?void 0:Vn.length,"ê°œê°€ ìˆ˜ì •ë©ë‹ˆë‹¤."]})]})]}),type:"warning",showIcon:!0}),e.jsxs(Ke,{gutter:16,align:"middle",style:{marginTop:16},children:[e.jsx(Y,{flex:"auto",children:e.jsxs(g,{children:[e.jsx(Bs,{style:{color:N?"#52c41a":"#8c8c8c"}}),e.jsxs(ct,{type:N?void 0:"secondary",children:["ë°±ì—…:"," ",N?"í™œì„±í™”ë¨ (ì‹¤í–‰ ì „ ìë™ ë°±ì—…)":"ë¹„í™œì„±í™”ë¨"]})]})}),e.jsx(Y,{children:e.jsx(B,{type:"primary",size:"large",icon:e.jsx(Gn,{}),loading:Ce,onClick:or,style:{background:"#722ed1",borderColor:"#722ed1"},children:Ce?"ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ ì¤‘...":"ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰"})})]})]})})]})]})]},"migration"),e.jsxs(Fo,{tab:e.jsxs("span",{children:[e.jsx(Bs,{}),"ë°±ì—… ê´€ë¦¬",c.filter(z=>z.backup_created).length>0&&e.jsx(ps,{count:c.filter(z=>z.backup_created).length,style:{marginLeft:8,backgroundColor:"#52c41a"}})]}),children:[e.jsxs("div",{className:"info-box",children:[e.jsx(Bs,{className:"info-box-icon",style:{color:"#52c41a"}}),e.jsxs("div",{className:"info-box-content",children:[e.jsx("div",{className:"info-box-title",children:"ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ê´€ë¦¬"}),e.jsx("div",{className:"info-box-description",children:"ë™ê¸°í™” ë° ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ ì‹œ ìƒì„±ëœ ë°±ì—…ì„ í™•ì¸í•˜ê³  ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°±ì—…ì€ ë™ê¸°í™”/ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì—…ì˜ 'ë°±ì—…' ì˜µì…˜ì„ í™œì„±í™”í•˜ë©´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤."})]})]}),tt&&St&&e.jsxs("div",{className:"sync-progress",style:{marginBottom:16},children:[e.jsxs("div",{className:"sync-progress-title",children:[e.jsx(zs,{spin:tt.status==="running"||tt.status==="pending"}),"ë°±ì—… ë³µì›"," ",tt.status==="running"?"ì§„í–‰ ì¤‘":tt.status==="completed"?"ì™„ë£Œ":"ì‹¤íŒ¨"]}),e.jsxs("div",{style:{padding:"12px 16px",background:"#fff",borderRadius:6},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs(g,{children:[e.jsx(T,{color:tt.status==="failed"?"error":tt.status==="completed"?"success":"processing",icon:e.jsx(zs,{spin:tt.status==="running"}),children:"ë³µì›"}),e.jsx(ct,{strong:!0,children:tt.connection_name})]}),e.jsxs(ct,{type:"secondary",children:["ì‹œì‘:"," ",tt.started_at?new Date(tt.started_at).toLocaleString("ko-KR"):"-"]})]}),e.jsx(qt,{percent:tt.progress_percent,status:tt.status==="failed"?"exception":tt.status==="completed"?"success":"active",strokeColor:tt.status==="running"?{from:"#108ee9",to:"#87d068"}:tt.status==="completed"?"#52c41a":void 0,format:z=>`${z}%`}),e.jsxs(ct,{type:"secondary",style:{fontSize:12},children:[tt.status==="running"&&e.jsxs(e.Fragment,{children:["ë³µì› íŒŒì¼:"," ",e.jsx(ct,{code:!0,children:tt.backup_file.split("/").pop()})]}),tt.status==="completed"&&e.jsx(ct,{type:"success",children:"ë³µì›ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),tt.status==="failed"&&e.jsxs(ct,{type:"danger",children:["ì˜¤ë¥˜: ",tt.error_message]})]})]})]}),e.jsxs("div",{className:"tab-toolbar",children:[e.jsx("div",{className:"tab-toolbar-left",children:e.jsxs(ct,{type:"secondary",children:["ì´ ",c.filter(z=>z.backup_created).length,"ê°œ ë°±ì—…"]})}),e.jsx("div",{className:"tab-toolbar-right",children:e.jsx(B,{icon:e.jsx(zs,{}),onClick:Cs,children:"ìƒˆë¡œê³ ì¹¨"})})]}),e.jsx(ie,{className:"section-card",children:c.filter(z=>z.backup_created).length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:e.jsxs("span",{children:["ìƒì„±ëœ ë°±ì—…ì´ ì—†ìŠµë‹ˆë‹¤.",e.jsx("br",{}),e.jsx(ct,{type:"secondary",children:"ë™ê¸°í™” ë˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì—… ì‹œ 'ë°±ì—…' ì˜µì…˜ì„ í™œì„±í™”í•˜ë©´ ë°±ì—…ì´ ìƒì„±ë©ë‹ˆë‹¤."})]})}):e.jsx(wt,{dataSource:c.filter(z=>z.backup_created),rowKey:"id",pagination:{pageSize:10},columns:[{title:"ì‘ì—…ëª…",dataIndex:"job_name",key:"job_name",render:z=>e.jsx(ct,{strong:!0,children:z||"-"})},{title:"ìœ í˜•",dataIndex:"sync_type",key:"sync_type",width:110,render:z=>z==="data"?e.jsx(T,{color:"blue",icon:e.jsx(Pt,{}),children:"ë™ê¸°í™”"}):z==="schema"||z==="full"?e.jsx(T,{color:"purple",icon:e.jsx(Gn,{}),children:"ë§ˆì´ê·¸ë ˆì´ì…˜"}):e.jsx(T,{children:"-"})},{title:"ìƒíƒœ",dataIndex:"status",key:"status",width:100,render:z=>e.jsx(T,{color:tc(z),children:sc(z)})},{title:"ë°±ì—… ìƒì„± ì‹œê°„",dataIndex:"started_at",key:"started_at",width:180,render:z=>z?new Date(z).toLocaleString("ko-KR"):"-"},{title:"ì‘ì—…",key:"actions",width:120,render:(z,Q)=>{const ke=l.find(ut=>ut.id===Q.sync_job_id),Re=Q.backup_path&&(ke==null?void 0:ke.target_connection_id);return e.jsx(g,{children:e.jsx(Ie,{title:Re?"ë°±ì—…ì—ì„œ ë°ì´í„° ë³µì›":"ë°±ì—… íŒŒì¼ ì—†ìŒ",children:e.jsx(Kt,{title:"ë°±ì—… ë³µì›",description:e.jsxs("div",{style:{maxWidth:300},children:[e.jsx("p",{children:"ì´ ë°±ì—…ì„ ì‚¬ìš©í•˜ì—¬ íƒ€ê²Ÿ DBë¥¼ ë³µì›í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"}),e.jsx("p",{style:{color:"#ff4d4f",fontSize:12},children:"âš ï¸ í˜„ì¬ íƒ€ê²Ÿ DBì˜ ë°ì´í„°ê°€ ë°±ì—… ì‹œì ìœ¼ë¡œ ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤."})]}),onConfirm:async()=>{if(!(ke!=null&&ke.target_connection_id)||!Q.backup_path){f.error("ë³µì›ì— í•„ìš”í•œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const ut=a.find($t=>$t.id===ke.target_connection_id);await Xn(ke.target_connection_id,Q.backup_path,ke.target_name||(ut==null?void 0:ut.name)||`Connection #${ke.target_connection_id}`,(ut==null?void 0:ut.database_name)||"",Q.id)},okText:"ë³µì›",cancelText:"ì·¨ì†Œ",disabled:!Re||St===Q.id,children:e.jsx(B,{size:"small",disabled:!Re,loading:St===Q.id,icon:e.jsx(zs,{}),children:"ë³µì›"})})})})}}]})}),e.jsxs(Ke,{gutter:16,style:{marginTop:16},children:[e.jsx(Y,{xs:24,sm:8,children:e.jsx("div",{className:"stat-card backup-stat-card",children:e.jsx($e,{title:"ì´ ë°±ì—… ìˆ˜",value:c.filter(z=>z.backup_created).length,prefix:e.jsx(Bs,{style:{color:"#52c41a"}}),suffix:"ê°œ"})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx("div",{className:"stat-card backup-stat-card",children:e.jsx($e,{title:"ë™ê¸°í™” ë°±ì—…",value:c.filter(z=>z.backup_created&&z.sync_type==="data").length,prefix:e.jsx(Pt,{style:{color:"#1890ff"}}),suffix:"ê°œ"})})}),e.jsx(Y,{xs:24,sm:8,children:e.jsx("div",{className:"stat-card backup-stat-card",children:e.jsx($e,{title:"ë§ˆì´ê·¸ë ˆì´ì…˜ ë°±ì—…",value:c.filter(z=>z.backup_created&&(z.sync_type==="schema"||z.sync_type==="full")).length,prefix:e.jsx(Gn,{style:{color:"#722ed1"}}),suffix:"ê°œ"})})})]})]},"backup"),e.jsxs(Fo,{tab:e.jsxs("span",{children:[e.jsx(mo,{}),"ì‹¤í–‰ ì´ë ¥",e.jsx(ps,{count:c.filter(z=>z.status==="running").length,style:{marginLeft:8}})]}),children:[e.jsxs("div",{className:"info-box",children:[e.jsx(mo,{className:"info-box-icon"}),e.jsxs("div",{className:"info-box-content",children:[e.jsx("div",{className:"info-box-title",children:"ì‹¤í–‰ ì´ë ¥"}),e.jsx("div",{className:"info-box-description",children:"ë™ê¸°í™” ë° ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì—…ì˜ ì‹¤í–‰ ì´ë ¥ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê° í•­ëª©ì„ í¼ì¹˜ë©´ ìƒì„¸ ë¡œê·¸ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤."})]})]}),an.length>0&&e.jsxs("div",{className:"sync-progress",children:[e.jsxs("div",{className:"sync-progress-title",children:[e.jsx(Pt,{spin:!0}),an.length,"ê°œ ì‘ì—… ì‹¤í–‰ ì¤‘"]}),e.jsx(g,{direction:"vertical",style:{width:"100%"},size:"small",children:an.map(z=>e.jsxs("div",{style:{padding:"12px 16px",background:"#fff",borderRadius:6},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs(g,{children:[e.jsx(T,{color:"processing",icon:e.jsx(Pt,{spin:!0}),children:z.sync_type==="data"?"ë™ê¸°í™”":z.sync_type==="schema"?"ë§ˆì´ê·¸ë ˆì´ì…˜":"ì „ì²´ ë™ê¸°í™”"}),e.jsx(ct,{strong:!0,children:z.job_name||`ì‘ì—… #${z.sync_job_id}`})]}),e.jsxs(ct,{type:"secondary",children:["ì‹œì‘:"," ",z.started_at?new Date(z.started_at).toLocaleString("ko-KR"):"-"]})]}),e.jsx(qt,{percent:z.progress_percent||0,status:"active",strokeColor:{from:"#108ee9",to:"#87d068"},format:Q=>`${Q}%`}),z.current_table&&e.jsxs(ct,{type:"secondary",style:{fontSize:12},children:["ì²˜ë¦¬ ì¤‘: ",e.jsx(ct,{code:!0,children:z.current_table})]})]},z.id))})]}),e.jsx(xs,{defaultActiveKey:"all",size:"small",style:{marginBottom:16},items:[{key:"all",label:e.jsxs("span",{children:["ì „ì²´ (",c.length,")"]}),children:c.length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ì‹¤í–‰ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤."}):e.jsx(wt,{columns:cn,dataSource:c,rowKey:"id",loading:r,pagination:{pageSize:15,showSizeChanger:!0},size:"small",expandable:{expandedRowRender:z=>{const Q=pe.get(z.id),ke=Nt.has(z.id);return e.jsx("div",{style:{padding:"12px 24px",background:"#fafafa"},children:ke?e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx(gt,{size:"small"}),e.jsx(ct,{type:"secondary",style:{marginLeft:8},children:"ìƒì„¸ ì •ë³´ ë¡œë”© ì¤‘..."})]}):e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"middle",children:[Q!=null&&Q.execution_log&&Q.execution_log.length>0?e.jsx(xe,{type:"info",message:e.jsxs("span",{children:["ì‹¤í–‰ ë¡œê·¸ (",Q.execution_log.length,"ê°œ í•­ëª©)",z.sync_type==="schema"||z.sync_type==="full"?" - DDL ì¿¼ë¦¬ í¬í•¨":""]}),description:e.jsx("div",{style:{maxHeight:350,overflow:"auto"},children:Q.execution_log.map((Re,ut)=>e.jsxs("div",{style:{padding:"6px 10px",marginBottom:6,background:Re.level==="error"?"#fff1f0":Re.level==="warn"?"#fffbe6":"#f0f5ff",borderLeft:`3px solid ${Re.level==="error"?"#ff4d4f":Re.level==="warn"?"#faad14":"#1890ff"}`,borderRadius:"0 4px 4px 0"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:Re.sql?4:0},children:[e.jsxs(ct,{type:"secondary",style:{fontSize:11},children:["[",new Date(Re.timestamp).toLocaleString("ko-KR"),"]"]}),Re.sql&&e.jsx(T,{color:"blue",style:{fontSize:10,margin:0},children:"SQL"})]}),e.jsx(ct,{type:Re.level==="error"?"danger":Re.level==="warn"?"warning":void 0,style:{fontFamily:"monospace",fontSize:12},children:Re.message}),Re.sql&&e.jsx("div",{style:{marginTop:6,padding:"8px 10px",background:"#1e1e1e",borderRadius:4,overflow:"auto",maxHeight:120},children:e.jsx("pre",{style:{margin:0,color:"#d4d4d4",fontSize:11,whiteSpace:"pre-wrap",wordBreak:"break-all",fontFamily:"'Fira Code', 'Consolas', monospace"},children:Re.sql})})]},ut))})}):e.jsx(xe,{type:"warning",message:"ì‹¤í–‰ ë¡œê·¸ ì—†ìŒ",description:Q?"ì´ ì‘ì—…ì˜ ì‹¤í–‰ ë¡œê·¸ê°€ ê¸°ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.":"ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆê±°ë‚˜, ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."}),(Q==null?void 0:Q.backup_created)&&Q.backup_path&&e.jsx(xe,{type:"success",message:"ë°±ì—… ì •ë³´",description:e.jsxs("div",{children:[e.jsx(ct,{strong:!0,children:"ë°±ì—… ê²½ë¡œ:"})," ",e.jsx(ct,{code:!0,style:{fontSize:11},children:Q.backup_path})]}),icon:e.jsx(Bs,{})}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(ie,{size:"small",title:"ì‹¤í–‰ ì •ë³´",children:e.jsxs(g,{direction:"vertical",size:4,children:[e.jsxs(ct,{type:"secondary",children:["ì‘ì—… ID: ",z.sync_job_id]}),e.jsxs(ct,{type:"secondary",children:["ì‹¤í–‰ì ID: ",z.executed_by]}),e.jsxs(ct,{type:"secondary",children:["í…Œì´ë¸”:"," ",z.tables_synced||0,"ê°œ"]}),z.error_message&&e.jsx(xe,{type:"error",message:z.error_message,style:{padding:"4px 12px",marginTop:8}})]})})}),e.jsx(Y,{span:12,children:e.jsx(ie,{size:"small",title:z.sync_type==="schema"||z.sync_type==="full"?"ìŠ¤í‚¤ë§ˆ ë³€ê²½ í†µê³„":"ë°ì´í„° ì²˜ë¦¬ í†µê³„",children:z.sync_type==="schema"||z.sync_type==="full"?e.jsxs(Ke,{gutter:8,children:[e.jsx(Y,{span:12,children:e.jsx($e,{title:"í…Œì´ë¸” ìƒì„±",value:(Q==null?void 0:Q.tables_synced)||z.tables_synced||0,valueStyle:{fontSize:16,color:"#52c41a"},suffix:"ê°œ"})}),e.jsx(Y,{span:12,children:e.jsx($e,{title:"ì»¬ëŸ¼ ì¶”ê°€",value:(Q==null?void 0:Q.rows_updated)||z.rows_updated||0,valueStyle:{fontSize:16,color:"#1890ff"},suffix:"ê°œ"})})]}):e.jsxs(Ke,{gutter:8,children:[e.jsx(Y,{span:8,children:e.jsx($e,{title:"ì‚½ì…",value:(Q==null?void 0:Q.rows_inserted)||z.rows_inserted||0,valueStyle:{fontSize:16,color:"#52c41a"}})}),e.jsx(Y,{span:8,children:e.jsx($e,{title:"ìˆ˜ì •",value:(Q==null?void 0:Q.rows_updated)||z.rows_updated||0,valueStyle:{fontSize:16,color:"#faad14"}})}),e.jsx(Y,{span:8,children:e.jsx($e,{title:"ì‚­ì œ",value:(Q==null?void 0:Q.rows_deleted)||z.rows_deleted||0,valueStyle:{fontSize:16,color:"#ff4d4f"}})})]})})})]})]})})},expandedRowKeys:Le,onExpand:(z,Q)=>{z?(Ys(Q.id),Oe(ke=>[...ke,Q.id])):Oe(ke=>ke.filter(Re=>Re!==Q.id))},rowExpandable:()=>!0}})},{key:"sync",label:e.jsxs("span",{children:[e.jsx(Pt,{})," ë™ê¸°í™” (",c.filter(z=>z.sync_type==="data").length,")"]}),children:c.filter(z=>z.sync_type==="data").length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ë™ê¸°í™” ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤."}):e.jsx(wt,{columns:cn,dataSource:c.filter(z=>z.sync_type==="data"),rowKey:"id",loading:r,pagination:{pageSize:15},size:"small",expandable:{expandedRowKeys:Le,onExpand:(z,Q)=>{z?(Ys(Q.id),Oe(ke=>[...ke,Q.id])):Oe(ke=>ke.filter(Re=>Re!==Q.id))},rowExpandable:()=>!0}})},{key:"migration",label:e.jsxs("span",{children:[e.jsx(Gn,{})," ë§ˆì´ê·¸ë ˆì´ì…˜ (",ys.length,")"]}),children:ys.length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ë§ˆì´ê·¸ë ˆì´ì…˜ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤."}):e.jsx(wt,{columns:cn,dataSource:ys,rowKey:"id",loading:r,pagination:{pageSize:15},size:"small",expandable:{expandedRowRender:z=>{const Q=pe.get(z.id),ke=Nt.has(z.id);return e.jsxs("div",{style:{padding:"12px 24px",background:"#f9f0ff"},children:[e.jsx(ct,{strong:!0,style:{color:"#722ed1"},children:"ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„¸"}),ke?e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx(gt,{size:"small"}),e.jsx(ct,{type:"secondary",style:{marginLeft:8},children:"ë¡œê·¸ ë¡œë”© ì¤‘..."})]}):Q?e.jsxs(g,{direction:"vertical",style:{width:"100%",marginTop:8},size:"middle",children:[Q.execution_log&&Q.execution_log.length>0?e.jsx(xe,{type:"info",message:"SQL ì‹¤í–‰ ë¡œê·¸",description:e.jsx("div",{style:{maxHeight:300,overflow:"auto"},children:Q.execution_log.map((Re,ut)=>e.jsxs("div",{style:{padding:"4px 8px",marginBottom:4,background:Re.level==="error"?"#fff1f0":"#f0f5ff",borderLeft:`3px solid ${Re.level==="error"?"#ff4d4f":Re.level==="warn"?"#faad14":"#1890ff"}`,fontFamily:"monospace",fontSize:12},children:[e.jsxs(ct,{type:"secondary",style:{fontSize:11},children:["[",new Date(Re.timestamp).toLocaleString("ko-KR"),"]"]})," ",e.jsx(ct,{type:Re.level==="error"?"danger":Re.level==="warn"?"warning":void 0,style:{fontFamily:"monospace"},children:Re.message})]},ut))})}):e.jsx(xe,{type:"info",message:"ì‹¤í–‰ ì •ë³´",description:z.error_message?e.jsx(ct,{type:"danger",children:z.error_message}):e.jsx("div",{children:e.jsxs(ct,{type:"secondary",children:["ìŠ¤í‚¤ë§ˆ ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ",e.jsx("br",{}),"- í…Œì´ë¸” ë™ê¸°í™”:"," ",z.tables_synced||0,"ê°œ",e.jsx("br",{}),"- í–‰ ì‚½ì…:"," ",z.rows_inserted||0,"ê°œ",e.jsx("br",{}),"- í–‰ ìˆ˜ì •:"," ",z.rows_updated||0,"ê°œ",e.jsx("br",{}),"- í–‰ ì‚­ì œ:"," ",z.rows_deleted||0,"ê°œ"]})})}),Q.backup_created&&Q.backup_path&&e.jsx(xe,{type:"success",message:"ë°±ì—… ì •ë³´",description:e.jsxs("div",{children:[e.jsx(ct,{strong:!0,children:"ë°±ì—… ê²½ë¡œ:"})," ",e.jsx(ct,{code:!0,style:{fontSize:11},children:Q.backup_path})]}),icon:e.jsx(Bs,{})}),e.jsx(ie,{size:"small",style:{background:"#fff"},children:e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:6,children:e.jsx($e,{title:"í…Œì´ë¸”",value:Q.tables_synced||0,suffix:"ê°œ",valueStyle:{fontSize:16}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"ì‚½ì…",value:Q.rows_inserted||0,suffix:"í–‰",valueStyle:{fontSize:16,color:"#52c41a"}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"ìˆ˜ì •",value:Q.rows_updated||0,suffix:"í–‰",valueStyle:{fontSize:16,color:"#faad14"}})}),e.jsx(Y,{span:6,children:e.jsx($e,{title:"ì‚­ì œ",value:Q.rows_deleted||0,suffix:"í–‰",valueStyle:{fontSize:16,color:"#ff4d4f"}})})]})})]}):e.jsx(xe,{type:"info",message:"ê¸°ë³¸ ì •ë³´",description:z.error_message?e.jsx(ct,{type:"danger",children:z.error_message}):e.jsxs(ct,{type:"secondary",children:["ìŠ¤í‚¤ë§ˆ ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ",e.jsx("br",{}),"- í…Œì´ë¸” ë™ê¸°í™”:"," ",z.tables_synced||0,"ê°œ"]}),style:{marginTop:8}})]})},expandedRowKeys:Le,onExpand:(z,Q)=>{z?(Ys(Q.id),Oe(ke=>[...ke,Q.id])):Oe(ke=>ke.filter(Re=>Re!==Q.id))},rowExpandable:()=>!0}})},{key:"backup",label:e.jsxs("span",{children:[e.jsx(Bs,{})," ë°±ì—… ìƒì„± (",Jt.length,")"]}),children:Jt.length===0?e.jsx(Je,{image:Je.PRESENTED_IMAGE_SIMPLE,description:"ë°±ì—… ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤."}):e.jsx(wt,{columns:cn,dataSource:Jt,rowKey:"id",loading:r,pagination:{pageSize:15},size:"small"})}]})]},"history")]})}),e.jsx(rt,{title:e.jsxs(g,{children:[e.jsx(_s,{}),E?"DB ì—°ê²° ìˆ˜ì •":"ìƒˆ DB ì—°ê²° ì¶”ê°€"]}),open:_,onCancel:()=>{S(!1),P(null),G(!1),oe(!1)},footer:null,width:700,children:e.jsxs(H,{form:M,layout:"vertical",onFinish:Rn,children:[!E&&e.jsxs(H.Item,{label:"ì„œë¹„ìŠ¤ì—ì„œ SSH ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ì„ íƒì‚¬í•­)",children:[e.jsx(Ee,{placeholder:"ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•˜ë©´ SSH ì •ë³´ê°€ ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤",allowClear:!0,value:u,onChange:Rr,style:{width:"100%"},loading:j,notFoundContent:j?"ì„œë¹„ìŠ¤ ì •ë³´ë¥¼ ë¡œë“œ ì¤‘...":A&&y.length===0?"ì„œë¹„ìŠ¤ê°€ ì—†ê±°ë‚˜ SSH ì •ë³´ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤":null,disabled:j,children:y.map(z=>e.jsx(mi,{value:z.service_id,children:e.jsxs(g,{children:[e.jsx("span",{children:z.service_name}),z.infra_name&&e.jsx(T,{color:"blue",style:{fontSize:"11px"},children:z.infra_name}),z.ssh_hops&&z.ssh_hops.length>0&&e.jsxs(T,{color:"green",style:{fontSize:"11px"},children:["SSH ",z.ssh_hops.length,"í™‰"]})]})},z.service_id))}),u&&((_a=y.find(z=>z.service_id===u))==null?void 0:_a.ssh_hops)&&e.jsx(xe,{type:"info",message:"SSH ì •ë³´ê°€ ìë™ìœ¼ë¡œ ì±„ì›Œì¡ŒìŠµë‹ˆë‹¤",description:e.jsx("div",{style:{fontSize:"12px"},children:(Ha=(Ua=y.find(z=>z.service_id===u))==null?void 0:Ua.ssh_hops)==null?void 0:Ha.map((z,Q)=>e.jsxs("div",{children:["í™‰ ",Q+1,": ",z.username,"@",z.host,":",z.port]},Q))}),style:{marginTop:8},showIcon:!0})]}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:16,children:e.jsx(H.Item,{name:"name",label:"ì—°ê²° ì´ë¦„",rules:[{required:!0,message:"ì—°ê²° ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: Production Database",prefix:e.jsx(_s,{})})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{name:"db_type",label:"DB íƒ€ì…",rules:[{required:!0}],children:e.jsxs(Ee,{onChange:z=>{M.setFieldsValue({port:Wx(z)})},children:[e.jsx(mi,{value:"mariadb",children:"MariaDB"}),e.jsx(mi,{value:"mysql",children:"MySQL"}),e.jsx(mi,{value:"postgresql",children:"PostgreSQL"})]})})})]}),e.jsx(H.Item,{name:"description",label:"ì„¤ëª… (ì„ íƒì‚¬í•­)",children:e.jsx(ue.TextArea,{rows:2,placeholder:"ì´ ì—°ê²°ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"})}),e.jsx(xt,{orientation:"left",children:"ì—°ê²° ì •ë³´"}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:16,children:e.jsx(H.Item,{name:"host",label:"í˜¸ìŠ¤íŠ¸ ì£¼ì†Œ",rules:[{required:!0,message:"í˜¸ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: localhost, 192.168.1.100, db.example.com"})})}),e.jsx(Y,{span:8,children:e.jsx(H.Item,{name:"port",label:"í¬íŠ¸",rules:[{required:!0}],children:e.jsx(xn,{style:{width:"100%"},min:1,max:65535})})})]}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"database_name",label:"ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„",rules:[{required:!0,message:"ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: mydb"})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"username",label:"ì‚¬ìš©ìëª…",rules:[{required:!0}],children:e.jsx(ue,{placeholder:"DB ì‚¬ìš©ìëª…"})})})]}),e.jsx(H.Item,{name:"password",label:"ë¹„ë°€ë²ˆí˜¸",rules:[{required:!E,message:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue.Password,{placeholder:E?"ë³€ê²½í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ë¹„ì›Œë‘ì„¸ìš”":"DB ë¹„ë°€ë²ˆí˜¸"})}),e.jsx(nr,{ghost:!0,activeKey:te?["ssh"]:[],onChange:z=>G(z.includes("ssh")),children:e.jsxs(iv,{header:e.jsxs(g,{children:[e.jsx(ya,{}),"SSH í„°ë„ ì„¤ì •",e.jsx(H.Item,{name:"ssh_enabled",valuePropName:"checked",noStyle:!0,children:e.jsx(Zr,{size:"small",onChange:z=>G(z)})})]}),children:[e.jsx(xe,{message:"SSH í„°ë„ì„ í†µí•´ ë³´ì•ˆ ë„¤íŠ¸ì›Œí¬ ë‚´ì˜ DBì— ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:16}}),u&&((wa=(Va=y.find(z=>z.service_id===u))==null?void 0:Va.ssh_hops)==null?void 0:wa.length)>0?e.jsxs("div",{children:[(oa=(Gr=y.find(z=>z.service_id===u))==null?void 0:Gr.ssh_hops)==null?void 0:oa.map((z,Q,ke)=>{const Re=ke.length>1&&Q===0,ut=ke.length===1||Q===ke.length-1;return e.jsxs("div",{style:{marginBottom:Q<ke.length-1?16:0},children:[Q>0&&e.jsx(xt,{style:{margin:"16px 0"}}),e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs("div",{style:{fontSize:"14px",fontWeight:500,color:"#1890ff"},children:[e.jsx(ur,{})," SSH Hop ",Q+1," ",Re?"(Jump Host)":ut?"(Target)":""]}),e.jsxs("div",{style:{fontSize:"12px",color:"#666",marginLeft:24,padding:"8px 12px",backgroundColor:"#f5f5f5",borderRadius:4},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Host:"})," ",z.host]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Port:"})," ",z.port]})]}),Re?e.jsxs(e.Fragment,{children:[e.jsx(H.Item,{name:"ssh_jump_host",hidden:!0,children:e.jsx(ue,{})}),e.jsx(H.Item,{name:"ssh_jump_port",hidden:!0,children:e.jsx(xn,{})}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"ssh_jump_username",label:"Username",rules:[{required:!0,message:"Usernameì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{prefix:e.jsx(Un,{}),placeholder:"SSH ì‚¬ìš©ìëª…",autoComplete:"off"})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"ssh_jump_password",label:"Password",rules:[{required:!0,message:"Passwordë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue.Password,{prefix:e.jsx(Qn,{}),placeholder:"SSH ë¹„ë°€ë²ˆí˜¸",autoComplete:"new-password"})})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(H.Item,{name:"ssh_host",hidden:!0,children:e.jsx(ue,{})}),e.jsx(H.Item,{name:"ssh_port",hidden:!0,children:e.jsx(xn,{})}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"ssh_username",label:"Username",rules:[{required:!0,message:"Usernameì„ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue,{prefix:e.jsx(Un,{}),placeholder:"SSH ì‚¬ìš©ìëª…",autoComplete:"off"})})}),e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"ssh_password",label:"Password",rules:[{required:!0,message:"Passwordë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}],children:e.jsx(ue.Password,{prefix:e.jsx(Qn,{}),placeholder:"SSH ë¹„ë°€ë²ˆí˜¸",autoComplete:"new-password"})})})]})]})]})]},`hop-${Q}`)}),e.jsx(H.Item,{name:"ssh_jump_enabled",hidden:!0,children:e.jsx(Zr,{})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"ssh_host",label:"SSH í˜¸ìŠ¤íŠ¸",children:e.jsx(ue,{placeholder:"SSH ì„œë²„ ì£¼ì†Œ"})})}),e.jsx(Y,{span:6,children:e.jsx(H.Item,{name:"ssh_port",label:"SSH í¬íŠ¸",initialValue:22,children:e.jsx(xn,{style:{width:"100%"}})})}),e.jsx(Y,{span:6,children:e.jsx(H.Item,{name:"ssh_username",label:"SSH ì‚¬ìš©ì",children:e.jsx(ue,{placeholder:"ì‚¬ìš©ìëª…"})})})]}),e.jsx(H.Item,{name:"ssh_password",label:"SSH ë¹„ë°€ë²ˆí˜¸",children:e.jsx(ue.Password,{placeholder:"SSH ë¹„ë°€ë²ˆí˜¸"})}),e.jsx(H.Item,{name:"ssh_jump_enabled",valuePropName:"checked",children:e.jsx(Zr,{checkedChildren:"Jump Host ì‚¬ìš©",unCheckedChildren:"Jump Host ë¯¸ì‚¬ìš©",onChange:z=>oe(z)})}),q&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{orientation:"left",plain:!0,children:"Jump Host (Bastion) ì„¤ì •"}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:12,children:e.jsx(H.Item,{name:"ssh_jump_host",label:"Jump Host",children:e.jsx(ue,{placeholder:"Jump ì„œë²„ ì£¼ì†Œ"})})}),e.jsx(Y,{span:6,children:e.jsx(H.Item,{name:"ssh_jump_port",label:"í¬íŠ¸",initialValue:22,children:e.jsx(xn,{style:{width:"100%"}})})}),e.jsx(Y,{span:6,children:e.jsx(H.Item,{name:"ssh_jump_username",label:"ì‚¬ìš©ì",children:e.jsx(ue,{placeholder:"ì‚¬ìš©ìëª…"})})})]}),e.jsx(H.Item,{name:"ssh_jump_password",label:"Jump Host ë¹„ë°€ë²ˆí˜¸",children:e.jsx(ue.Password,{placeholder:"Jump Host ë¹„ë°€ë²ˆí˜¸"})})]})]})]},"ssh")}),e.jsx(xt,{}),e.jsx(H.Item,{style:{marginBottom:0},children:e.jsxs(g,{style:{width:"100%",justifyContent:"flex-end"},children:[e.jsx(B,{onClick:()=>S(!1),children:"ì·¨ì†Œ"}),e.jsx(B,{type:"primary",htmlType:"submit",loading:r,children:E?"ìˆ˜ì •":"ì¶”ê°€"})]})})]})}),e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(Pt,{}),I?"ë™ê¸°í™” ì‘ì—… ìˆ˜ì •":"ìƒˆ ë™ê¸°í™” ì‘ì—… ì¶”ê°€"]}),open:L,onCancel:()=>{k(!1),$(null),ne({validated:!1,isCompatible:!1})},footer:null,width:700,children:[e.jsx(xe,{message:"ë™ê¸°í™” ì‘ì—… ì•ˆë‚´",description:"ì†ŒìŠ¤ DBì˜ ë°ì´í„°ë¥¼ íƒ€ê²Ÿ DBë¡œ ë³µì œí•©ë‹ˆë‹¤. ë°ì´í„° ë™ê¸°í™”ë¥¼ ìœ„í•´ì„œëŠ” ë‘ DBì˜ ìŠ¤í‚¤ë§ˆê°€ ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs(H,{form:K,layout:"vertical",onFinish:Ht,onValuesChange:z=>{var Q,ke;if(z.source_connection_id||z.target_connection_id){const Re=(Q=z.source_connection_id)!=null?Q:K.getFieldValue("source_connection_id"),ut=(ke=z.target_connection_id)!=null?ke:K.getFieldValue("target_connection_id");Re&&ut&&ss(Re,ut)}},children:[e.jsx(H.Item,{name:"name",label:"ì‘ì—… ì´ë¦„",rules:[{required:!0,message:"ì‘ì—… ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"}],children:e.jsx(ue,{placeholder:"ì˜ˆ: Daily Production Sync",prefix:e.jsx(Pt,{})})}),e.jsx(H.Item,{name:"description",label:"ì„¤ëª… (ì„ íƒì‚¬í•­)",children:e.jsx(ue.TextArea,{rows:2,placeholder:"ì´ ë™ê¸°í™” ì‘ì—…ì— ëŒ€í•œ ì„¤ëª…"})}),e.jsxs(Ke,{gutter:16,children:[e.jsx(Y,{span:11,children:e.jsx(H.Item,{name:"source_connection_id",label:e.jsxs("span",{children:[e.jsx("span",{style:{color:"#52c41a"},children:"â—"})," ì†ŒìŠ¤ DB (ì›ë³¸)"]}),rules:[{required:!0,message:"ì†ŒìŠ¤ DBë¥¼ ì„ íƒí•˜ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ DB",children:Ts.map(z=>e.jsx(mi,{value:z.id,children:e.jsxs(g,{children:[e.jsx(Ze,{style:{color:"#52c41a"}}),z.name]})},z.id))})})}),e.jsx(Y,{span:2,style:{textAlign:"center",paddingTop:38},children:e.jsx(Gn,{style:{fontSize:20,color:"#1890ff"}})}),e.jsx(Y,{span:11,children:e.jsx(H.Item,{name:"target_connection_id",label:e.jsxs("span",{children:[e.jsx("span",{style:{color:"#1890ff"},children:"â—"})," íƒ€ê²Ÿ DB (ëŒ€ìƒ)"]}),rules:[{required:!0,message:"íƒ€ê²Ÿ DBë¥¼ ì„ íƒí•˜ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ë°ì´í„°ë¥¼ ë„£ì„ DB",children:Ts.map(z=>e.jsx(mi,{value:z.id,children:e.jsxs(g,{children:[e.jsx(Ze,{style:{color:"#52c41a"}}),z.name]})},z.id))})})})]}),ye&&e.jsx(xe,{message:e.jsxs(g,{children:[e.jsx(gt,{size:"small"})," ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± ê²€ì¦ ì¤‘..."]}),type:"info",style:{marginBottom:16}}),!ye&&be.validated&&e.jsx(xe,{message:be.isCompatible?"ìŠ¤í‚¤ë§ˆ í˜¸í™˜":"ìŠ¤í‚¤ë§ˆ ë¶ˆì¼ì¹˜",description:e.jsxs("div",{children:[e.jsx("div",{children:be.message}),!be.isCompatible&&be.differences&&e.jsxs("div",{style:{marginTop:8},children:[(((le=be.differences.only_in_source)==null?void 0:le.length)||0)>0&&e.jsxs("div",{children:[e.jsx(ct,{type:"secondary",children:"ì†ŒìŠ¤ì—ë§Œ ìˆëŠ” í…Œì´ë¸”: "}),(me=be.differences.only_in_source)==null?void 0:me.slice(0,5).map(z=>e.jsx(T,{color:"blue",style:{marginRight:4},children:z},z)),(((De=be.differences.only_in_source)==null?void 0:De.length)||0)>5&&e.jsxs(ct,{type:"secondary",children:["ì™¸"," ",(((zt=be.differences.only_in_source)==null?void 0:zt.length)||0)-5,"ê°œ"]})]}),(((Ls=be.differences.only_in_target)==null?void 0:Ls.length)||0)>0&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx(ct,{type:"secondary",children:"íƒ€ê²Ÿì—ë§Œ ìˆëŠ” í…Œì´ë¸”: "}),(Br=be.differences.only_in_target)==null?void 0:Br.slice(0,5).map(z=>e.jsx(T,{color:"orange",style:{marginRight:4},children:z},z)),(((Ln=be.differences.only_in_target)==null?void 0:Ln.length)||0)>5&&e.jsxs(ct,{type:"secondary",children:["ì™¸"," ",(((Sa=be.differences.only_in_target)==null?void 0:Sa.length)||0)-5,"ê°œ"]})]}),e.jsx(B,{type:"link",size:"small",style:{padding:0,marginTop:8},onClick:()=>{k(!1),t("migration")},children:"ë§ˆì´ê·¸ë ˆì´ì…˜ íƒ­ìœ¼ë¡œ ì´ë™ â†’"})]})]}),type:be.isCompatible?"success":"warning",showIcon:!0,icon:be.isCompatible?e.jsx(Ze,{}):e.jsx(Tr,{}),style:{marginBottom:16}}),e.jsx(H.Item,{name:"sync_type",initialValue:"data",hidden:!0,children:e.jsx(ue,{})}),e.jsx(H.Item,{name:"backup_before_sync",label:"ë™ê¸°í™” ì „ ë°±ì—…",valuePropName:"checked",tooltip:"íƒ€ê²Ÿ DBë¥¼ ë™ê¸°í™” ì „ì— ë°±ì—…í•©ë‹ˆë‹¤",children:e.jsx(Zr,{checkedChildren:"ë°±ì—…í•¨",unCheckedChildren:"ë°±ì—… ì•ˆí•¨"})}),e.jsx(xt,{}),e.jsx(H.Item,{style:{marginBottom:0},children:e.jsxs(g,{style:{width:"100%",justifyContent:"flex-end"},children:[e.jsx(B,{onClick:()=>k(!1),children:"ì·¨ì†Œ"}),e.jsx(B,{type:"primary",htmlType:"submit",loading:r,disabled:!I&&be.validated&&!be.isCompatible,children:I?"ìˆ˜ì •":"ì¶”ê°€"})]})})]})]}),e.jsx(rt,{title:e.jsxs(g,{children:[e.jsx(xa,{style:{color:"#1890ff"}}),e.jsx("span",{children:"ë™ê¸°í™” ì‹¤í–‰ ë¯¸ë¦¬ë³´ê¸°"})]}),open:Pe,onCancel:()=>{w(!1),U(null)},width:800,footer:e.jsxs(g,{style:{width:"100%",justifyContent:"flex-end"},children:[e.jsx(B,{onClick:()=>{w(!1),U(null)},children:"ì·¨ì†Œ"}),(R==null?void 0:R.compareResult)&&e.jsx(B,{type:"primary",icon:e.jsx(In,{}),onClick:()=>{R!=null&&R.job&&nn(R.job.id)},disabled:(((jr=(Ma=R.compareResult.schema_diff)==null?void 0:Ma.only_in_source)==null?void 0:jr.length)||0)>0||(((li=(Wr=R.compareResult.schema_diff)==null?void 0:Wr.only_in_target)==null?void 0:li.length)||0)>0||(((Ci=(qa=R.compareResult.schema_diff)==null?void 0:qa.column_differences)==null?void 0:Ci.length)||0)>0,children:"ë™ê¸°í™” ì‹¤í–‰"})]}),children:V?e.jsxs("div",{style:{textAlign:"center",padding:"50px 0"},children:[e.jsx(gt,{size:"large"}),e.jsx("div",{style:{marginTop:16,marginBottom:8},children:e.jsx(ct,{strong:!0,children:"ë°ì´í„° ë¹„êµ ì¤‘ì…ë‹ˆë‹¤..."})}),e.jsx(qt,{type:"line",percent:Math.min(Ne*3,95),status:"active",strokeColor:{from:"#108ee9",to:"#87d068"},style:{maxWidth:250,margin:"0 auto"}}),e.jsx("div",{style:{marginTop:12},children:e.jsxs(ct,{type:"secondary",children:["ê²½ê³¼ ì‹œê°„: ",Ne,"ì´ˆ",Ne>10&&" (í…Œì´ë¸” ìˆ˜ì— ë”°ë¼ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤)"]})})]}):R!=null&&R.compareResult?e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"large",children:[e.jsx(ie,{size:"small",children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(ct,{strong:!0,children:"ì‘ì—…ëª…:"})," ",e.jsx(ct,{children:R.job.name})]}),R.job.description&&e.jsxs("div",{children:[e.jsx(ct,{strong:!0,children:"ì„¤ëª…:"})," ",e.jsx(ct,{type:"secondary",children:R.job.description})]}),e.jsxs("div",{children:[e.jsx(ct,{strong:!0,children:"ë°ì´í„° íë¦„:"})," ",e.jsx(T,{color:"green",children:(Xr=a.find(z=>z.id===R.job.source_connection_id))==null?void 0:Xr.name}),e.jsx(Gn,{}),e.jsx(T,{color:"blue",children:(ko=a.find(z=>z.id===R.job.target_connection_id))==null?void 0:ko.name})]})]})}),R.compareResult.schema_diff&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(rn,{})," ìŠ¤í‚¤ë§ˆ ê²€ì¦"]}),size:"small",children:(((Ga=R.compareResult.schema_diff.only_in_source)==null?void 0:Ga.length)||0)===0&&(((Co=R.compareResult.schema_diff.only_in_target)==null?void 0:Co.length)||0)===0&&(((ci=R.compareResult.schema_diff.column_differences)==null?void 0:ci.length)||0)===0?e.jsx(xe,{type:"success",message:"ìŠ¤í‚¤ë§ˆê°€ ë™ì¼í•©ë‹ˆë‹¤",description:"ë°ì´í„° ë™ê¸°í™”ë¥¼ ì•ˆì „í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",showIcon:!0}):e.jsx(xe,{type:"error",message:"ìŠ¤í‚¤ë§ˆ ë¶ˆì¼ì¹˜ ê°ì§€",description:e.jsxs("div",{children:[e.jsx("p",{children:"ìŠ¤í‚¤ë§ˆê°€ ë‹¤ë¥´ë¯€ë¡œ ë™ê¸°í™”ë¥¼ ì‹¤í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìˆ˜í–‰í•´ì£¼ì„¸ìš”."}),(((va=R.compareResult.schema_diff.only_in_source)==null?void 0:va.length)||0)>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(ct,{strong:!0,children:"ì†ŒìŠ¤ì—ë§Œ ìˆëŠ” í…Œì´ë¸”:"})," ",(la=R.compareResult.schema_diff.only_in_source)==null?void 0:la.slice(0,3).map(z=>e.jsx(T,{color:"blue",children:z},z)),(((xr=R.compareResult.schema_diff.only_in_source)==null?void 0:xr.length)||0)>3&&e.jsxs(ct,{type:"secondary",children:[" ","ì™¸"," ",(((en=R.compareResult.schema_diff.only_in_source)==null?void 0:en.length)||0)-3,"ê°œ"]})]}),(((_e=R.compareResult.schema_diff.only_in_target)==null?void 0:_e.length)||0)>0&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx(ct,{strong:!0,children:"íƒ€ê²Ÿì—ë§Œ ìˆëŠ” í…Œì´ë¸”:"})," ",(An=R.compareResult.schema_diff.only_in_target)==null?void 0:An.slice(0,3).map(z=>e.jsx(T,{color:"orange",children:z},z)),(((Wa=R.compareResult.schema_diff.only_in_target)==null?void 0:Wa.length)||0)>3&&e.jsxs(ct,{type:"secondary",children:[" ","ì™¸"," ",(((di=R.compareResult.schema_diff.only_in_target)==null?void 0:di.length)||0)-3,"ê°œ"]})]}),e.jsx(B,{type:"link",size:"small",style:{padding:0,marginTop:8},onClick:()=>{w(!1),t("migration")},children:"ë§ˆì´ê·¸ë ˆì´ì…˜ íƒ­ìœ¼ë¡œ ì´ë™ â†’"})]}),showIcon:!0})}),R.compareResult.data_diff&&e.jsx(ie,{title:e.jsxs(g,{children:[e.jsx(_s,{})," ë°ì´í„° ë³€ê²½ ì˜ˆìƒ"]}),size:"small",children:e.jsx(wt,{size:"small",pagination:!1,dataSource:R.compareResult.data_diff.tables,rowKey:"name",columns:[{title:"í…Œì´ë¸”ëª…",dataIndex:"name",key:"name",render:z=>e.jsx(ct,{strong:!0,children:z})},{title:"ì†ŒìŠ¤ ë ˆì½”ë“œ",dataIndex:"source_count",key:"source_count",width:120,render:z=>e.jsxs(T,{color:"green",children:[z.toLocaleString(),"ê°œ"]})},{title:"íƒ€ê²Ÿ ë ˆì½”ë“œ",dataIndex:"target_count",key:"target_count",width:120,render:z=>e.jsxs(T,{color:"blue",children:[z.toLocaleString(),"ê°œ"]})},{title:"ë™ê¸°í™” ë°©ì‹",dataIndex:"sync_mode",key:"sync_mode",width:100,render:(z,Q)=>Q.will_sync?Q.sync_mode==="incremental"?e.jsx(T,{color:"processing",children:"ì¦ë¶„"}):e.jsx(T,{color:"warning",children:"ì „ì²´êµì²´"}):e.jsx(T,{children:"ë³€ê²½ ì—†ìŒ"})},{title:"ì˜ˆìƒ ì‘ì—…",key:"expected_changes",width:180,render:(z,Q)=>{if(!Q.will_sync)return e.jsx(ct,{type:"secondary",children:"-"});const ke=Q.expected_insert||0,Re=Q.expected_delete||0;return e.jsxs(g,{direction:"vertical",size:0,children:[Re>0&&e.jsxs(ct,{type:"danger",style:{fontSize:12},children:["ì‚­ì œ: ",Re.toLocaleString(),"ê±´"]}),ke>0&&e.jsxs(ct,{type:"success",style:{fontSize:12},children:["ì‚½ì…: ",ke.toLocaleString(),"ê±´"]})]})}}],summary:z=>{const Q=z.filter($t=>$t.will_sync),ke=Q.reduce(($t,Hr)=>$t+(Hr.expected_insert||0),0),Re=Q.reduce(($t,Hr)=>$t+(Hr.expected_delete||0),0),ut=Q.length;return e.jsx(wt.Summary,{fixed:!0,children:e.jsxs(wt.Summary.Row,{style:{background:"#fafafa"},children:[e.jsx(wt.Summary.Cell,{index:0,colSpan:3,children:e.jsxs(ct,{strong:!0,children:["ì˜ˆìƒ ì´ ì‘ì—… (",ut,"ê°œ í…Œì´ë¸”):"]})}),e.jsx(wt.Summary.Cell,{index:1,colSpan:2,children:e.jsxs(g,{children:[Re>0&&e.jsxs(T,{color:"error",children:["ì‚­ì œ ",Re.toLocaleString(),"ê±´"]}),ke>0&&e.jsxs(T,{color:"success",children:["ì‚½ì… ",ke.toLocaleString(),"ê±´"]}),ke===0&&Re===0&&e.jsx(T,{children:"ë³€ê²½ ì—†ìŒ"})]})})]})})}})}),R.job.backup_before_sync&&e.jsx(xe,{type:"info",message:"ë°±ì—… ì„¤ì •",description:"ë™ê¸°í™” ì‹¤í–‰ ì „ì— íƒ€ê²Ÿ DBë¥¼ ìë™ìœ¼ë¡œ ë°±ì—…í•©ë‹ˆë‹¤.",showIcon:!0,icon:e.jsx(Bs,{})})]}):null}),e.jsxs(rt,{title:e.jsxs(g,{children:[e.jsx(Bs,{}),e.jsxs("span",{children:["ë°±ì—… ê´€ë¦¬ - ",Me==null?void 0:Me.name]})]}),open:Mt,onCancel:()=>{Ve(!1),ot(null),Ps([])},footer:[e.jsx(B,{icon:e.jsx(zs,{}),onClick:()=>Me&&Pn(Me),loading:ir,children:"ìƒˆë¡œê³ ì¹¨"},"refresh"),e.jsx(B,{onClick:()=>{Ve(!1),ot(null),Ps([])},children:"ë‹«ê¸°"},"close")],width:700,children:[ir?e.jsxs("div",{style:{textAlign:"center",padding:40},children:[e.jsx(gt,{size:"large"}),e.jsx("p",{style:{marginTop:16},children:"ë°±ì—… ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]}):Bt.length===0?e.jsx(Je,{description:e.jsxs("span",{children:["ë°±ì—… íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.",e.jsx("br",{}),"ë™ê¸°í™” ì‘ì—… ì‹¤í–‰ ì‹œ ìë™ ë°±ì—…ì´ ìƒì„±ë©ë‹ˆë‹¤."]}),image:Je.PRESENTED_IMAGE_SIMPLE}):e.jsx(wt,{dataSource:Bt,rowKey:"file_name",pagination:!1,size:"small",columns:[{title:"íŒŒì¼ëª…",dataIndex:"file_name",key:"file_name",render:z=>e.jsx(ct,{code:!0,style:{fontSize:12},children:z})},{title:"í¬ê¸°",dataIndex:"file_size",key:"file_size",width:100,render:z=>ea(z)},{title:"ìƒì„±ì¼ì‹œ",dataIndex:"created_at",key:"created_at",width:160,render:z=>new Date(z).toLocaleString("ko-KR")},{title:"ì‘ì—…",key:"actions",width:100,render:(z,Q)=>e.jsx(B,{type:"primary",size:"small",icon:e.jsx(In,{}),loading:Ge===Q.file_path,onClick:()=>Lr(Q.file_path),children:"ë³µì›"})}]}),tt&&!St&&e.jsxs("div",{className:"sync-progress",style:{marginBottom:16},children:[e.jsxs("div",{className:"sync-progress-title",children:[e.jsx(zs,{spin:tt.status==="running"||tt.status==="pending"}),"ë°±ì—… ë³µì›"," ",tt.status==="running"?"ì§„í–‰ ì¤‘":tt.status==="completed"?"ì™„ë£Œ":tt.status==="failed"?"ì‹¤íŒ¨":"ëŒ€ê¸° ì¤‘"]}),e.jsxs("div",{style:{padding:"12px 16px",background:"#fff",borderRadius:6},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs(g,{children:[e.jsx(T,{color:tt.status==="failed"?"error":tt.status==="completed"?"success":"processing",icon:e.jsx(zs,{spin:tt.status==="running"}),children:"ë³µì›"}),e.jsx(ct,{strong:!0,children:tt.connection_name})]}),e.jsxs(ct,{type:"secondary",children:["ì‹œì‘:"," ",tt.started_at?new Date(tt.started_at).toLocaleString("ko-KR"):"-"]})]}),e.jsx(qt,{percent:tt.progress_percent,status:tt.status==="failed"?"exception":tt.status==="completed"?"success":"active",strokeColor:tt.status==="running"?{from:"#108ee9",to:"#87d068"}:tt.status==="completed"?"#52c41a":void 0,format:z=>`${z}%`}),e.jsxs(ct,{type:"secondary",style:{fontSize:12},children:[tt.status==="running"&&e.jsxs(e.Fragment,{children:["ë³µì› íŒŒì¼:"," ",e.jsx(ct,{code:!0,children:tt.backup_file.split("/").pop()})]}),tt.status==="completed"&&e.jsx(ct,{type:"success",children:"ë³µì›ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),tt.status==="failed"&&e.jsxs(ct,{type:"danger",children:["ì˜¤ë¥˜: ",tt.error_message]})]})]})]}),e.jsx(xe,{type:"info",message:"ë°±ì—… íŒŒì¼ ì •ë³´",description:e.jsxs("ul",{style:{margin:"8px 0",paddingLeft:20},children:[e.jsx("li",{children:"ë°±ì—… íŒŒì¼ì€ ì„œë²„ì˜ /tmp/db_backups ê²½ë¡œì— ì €ì¥ë©ë‹ˆë‹¤."}),e.jsx("li",{children:'ë™ê¸°í™” ì‘ì—… ì‹¤í–‰ ì‹œ "ë°±ì—… í›„ ë™ê¸°í™”" ì˜µì…˜ì´ í™œì„±í™”ë˜ë©´ ìë™ìœ¼ë¡œ ë°±ì—…ë©ë‹ˆë‹¤.'}),e.jsx("li",{children:"ë³µì› ì‹œ í˜„ì¬ ë°ì´í„°ê°€ ë°±ì—… ì‹œì ì˜ ë°ì´í„°ë¡œ ëŒ€ì²´ë©ë‹ˆë‹¤."})]}),style:{marginTop:16}})]})]})};function lv(){const[s,t]=o.useState(!1),[r,n]=o.useState("registry"),[,a]=o.useState({}),[i,l]=o.useState(()=>()=>{}),[d]=H.useForm(),c=Gs();o.useState(()=>{const h=x=>{const _=x;n(_.detail.mode);const S=_.detail.initial||{};a(S),l(()=>_.detail.resolve),t(!0),setTimeout(()=>d.setFieldsValue(S),0)};return window.addEventListener("open-credential-prompt",h),()=>window.removeEventListener("open-credential-prompt",h)});const p=async()=>{const h=await d.validateFields();if(r==="registry"){const x={registryUrl:h.registryUrl||"",userId:h.userId,password:h.password};c.upsertImageRegistry(x)}else if(r==="gitlab"){const x={baseUrl:h.baseUrl,token:h.token,userId:h.userId||void 0};c.upsertSourceRepository(x)}else if(r==="server"){const x={host:h.host,port:h.port,userId:h.userId,password:h.password};c.addServer(x)}t(!1),i()};return e.jsx(rt,{title:"ìê²©ì¦ëª… ì…ë ¥",open:s,onOk:p,onCancel:()=>t(!1),destroyOnClose:!0,children:e.jsxs(H,{form:d,layout:"vertical",children:[r==="registry"&&e.jsxs(e.Fragment,{children:[e.jsx(H.Item,{label:"Registry URL",name:"registryUrl",children:e.jsx(ue,{placeholder:"https://index.docker.io/v1/"})}),e.jsxs(g,{children:[e.jsxs(H.Item,{label:"User ID",name:"userId",rules:[{required:!0}],children:[" ",e.jsx(ue,{})," "]}),e.jsxs(H.Item,{label:"Password",name:"password",rules:[{required:!0}],children:[" ",e.jsx(ue.Password,{})," "]})]})]}),r==="gitlab"&&e.jsxs(e.Fragment,{children:[e.jsx(H.Item,{label:"Base URL",name:"baseUrl",rules:[{required:!0}],children:e.jsx(ue,{placeholder:"https://gitlab.example.com"})}),e.jsx(H.Item,{label:"ì‚¬ìš©ìëª…/ì´ë©”ì¼ (ì˜µì…˜)",name:"userId",children:e.jsx(ue,{placeholder:"ì˜ˆ: john.doe ë˜ëŠ” user@company.com"})}),e.jsxs(H.Item,{label:"Token",name:"token",rules:[{required:!0}],children:[" ",e.jsx(ue.Password,{})," "]})]}),r==="server"&&e.jsxs(e.Fragment,{children:[e.jsxs(g,{children:[e.jsxs(H.Item,{label:"Host",name:"host",rules:[{required:!0}],children:[" ",e.jsx(ue,{placeholder:"10.0.0.1"})," "]}),e.jsxs(H.Item,{label:"Port",name:"port",children:[" ",e.jsx(ue,{placeholder:"22"})," "]})]}),e.jsxs(g,{children:[e.jsxs(H.Item,{label:"User ID",name:"userId",rules:[{required:!0}],children:[" ",e.jsx(ue,{})," "]}),e.jsxs(H.Item,{label:"Password",name:"password",rules:[{required:!0}],children:[" ",e.jsx(ue.Password,{})," "]})]})]})]})})}const{Option:Bp}=Ee,cv=()=>{const{id:s}=nu(),t=al(),{gitlabTokens:r}=Gs(),[n,a]=o.useState(null),[i,l]=o.useState(!1),[d,c]=o.useState([]),[p,h]=o.useState(!1),[x,_]=o.useState(!1),[S,L]=o.useState({}),[k,E]=o.useState([]),[P,I]=o.useState(!1),$=async()=>{try{l(!0);const b=await Xt.getRepoById(Number(s));a(b.data)}catch(b){O.error("Git repository fetch failed:",b),f.error("Failed to fetch git repository.")}finally{l(!1)}},y=async()=>{try{h(!0);const b=await Ft.kubernetes.request("getInfras",{});let A=[];if(b&&typeof b=="object"&&"data"in b){const W=b.data;Array.isArray(W)?A=W:W&&typeof W=="object"&&"infras"in W&&Array.isArray(W.infras)&&(A=W.infras)}c(A)}catch(b){O.error("ì¸í”„ë¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:",b),f.error("ì¸í”„ë¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{h(!1)}},v=async()=>{if(n)try{I(!0);const b=r[n.gitlabUrl];if(!b){f.warning("GitLab í† í°ì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë¸Œëœì¹˜ ëª©ë¡ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}const A=await vu(n.id,b);E(A.map(W=>({name:W.name,default:W.default})))}catch(b){O.error("ë¸Œëœì¹˜ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:",b),f.error("ë¸Œëœì¹˜ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{I(!1)}};if(o.useEffect(()=>{$(),y()},[]),i||!n)return e.jsx("div",{style:{maxWidth:520,margin:"40px auto",padding:24,textAlign:"center"},children:e.jsx(gt,{size:"large"})});const u=()=>{L({name:n.name,gitlabUrl:n.gitlabUrl,gitlabBranch:n.gitlabBranch,lastCommit:n.lastCommit}),_(!0),v()},m=(b,A)=>{L(W=>({...W,[b]:A}))},j=()=>{_(!1)};return e.jsx("div",{style:{maxWidth:520,margin:"40px auto",padding:24},children:e.jsx(ie,{title:e.jsxs("span",{style:{fontSize:20,fontWeight:600},children:["ì €ì¥ì†Œ ìƒì„¸ (ID: ",s,")"]}),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{width:100,fontWeight:500,color:"#555"},children:"ì €ì¥ì†Œëª…"}),x?e.jsx(ue,{style:{flex:1},value:S.name||"",onChange:b=>m("name",b.target.value),placeholder:"ì €ì¥ì†Œ ì´ë¦„"}):e.jsx("span",{style:{flex:1},children:n.name})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{width:100,fontWeight:500,color:"#555"},children:"Git URL"}),x?e.jsx(ue,{style:{flex:1},value:S.gitlabUrl||"",onChange:b=>m("gitlabUrl",b.target.value),placeholder:"Git ì €ì¥ì†Œ URL"}):e.jsx("span",{style:{flex:1},children:n.gitlabUrl})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{width:100,fontWeight:500,color:"#555"},children:"ë¸Œëœì¹˜"}),x?e.jsx(Ee,{style:{flex:1},value:S.gitlabBranch||"",onChange:b=>m("gitlabBranch",b),placeholder:"ë¸Œëœì¹˜ ì„ íƒ",loading:P,showSearch:!0,optionFilterProp:"children",notFoundContent:P?e.jsx(gt,{size:"small"}):"ë¸Œëœì¹˜ ì—†ìŒ",children:k.map(b=>e.jsxs(Bp,{value:b.name,children:[b.name," ",b.default&&"(ê¸°ë³¸)"]},b.name))}):e.jsx("span",{style:{flex:1},children:n.gitlabBranch})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{width:100,fontWeight:500,color:"#555"},children:"ë§ˆì§€ë§‰ ì»¤ë°‹"}),x?e.jsx(ue,{style:{flex:1},value:S.lastCommit||"",onChange:b=>m("lastCommit",b.target.value),placeholder:"ë§ˆì§€ë§‰ ì»¤ë°‹"}):e.jsx("span",{style:{flex:1},children:n.lastCommit})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{width:100,fontWeight:500,color:"#555"},children:"ì¸í”„ë¼ ì„ íƒ"}),e.jsx("div",{style:{flex:1},children:e.jsx(H.Item,{name:"infra_id",style:{marginBottom:0},rules:[{required:!0,message:"ì¸í”„ë¼ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}],children:e.jsx(Ee,{placeholder:"ì„œë¹„ìŠ¤ë¥¼ ë°°í¬í•  ì¸í”„ë¼ ì„ íƒ",loading:p,showSearch:!0,optionFilterProp:"children",children:d.map(b=>e.jsxs(Bp,{value:b.id,children:[b.name," (",b.type,")"]},b.id))})})})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:12,marginTop:24},children:x?e.jsxs(e.Fragment,{children:[e.jsx(B,{type:"primary",children:"ì €ì¥"}),e.jsx(B,{onClick:j,children:"ì·¨ì†Œ"})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{type:"primary",onClick:u,children:"ìˆ˜ì •"}),e.jsx(B,{onClick:()=>t("/services"),children:"ëª©ë¡ìœ¼ë¡œ"})]})})]})})})},dv=()=>{const{isAuthenticated:s,isLoading:t}=Tn();return t?e.jsx("div",{children:"Loading..."}):s?e.jsx(au,{}):e.jsx(rc,{to:"/login",replace:!0})};function uv(){return e.jsx(cf,{children:e.jsx(sf,{children:e.jsxs(of,{children:[e.jsxs(jm,{children:[e.jsx(Dr,{path:"/login",element:e.jsx(Yb,{})}),e.jsx(Dr,{path:"/signup",element:e.jsx(Jb,{})}),e.jsx(Dr,{element:e.jsx(dv,{}),children:e.jsxs(Dr,{path:"/",element:e.jsx(kb,{}),children:[e.jsx(Dr,{index:!0,element:e.jsx(rc,{to:"/dashboard",replace:!0})}),e.jsx(Dr,{path:"dashboard",element:e.jsx(wg,{})}),e.jsx(Dr,{path:"infrastructure",element:e.jsx(cj,{})}),e.jsx(Dr,{path:"runtimes",element:e.jsx(_h,{})}),e.jsx(Dr,{path:"runtimes/:infraId",element:e.jsx(_h,{})}),e.jsx(Dr,{path:"devices",element:e.jsx(uj,{})}),e.jsx(Dr,{path:"backup",element:e.jsx(Bj,{})}),e.jsx(Dr,{path:"/projects",element:e.jsx(s0,{})}),e.jsx(Dr,{path:"/services",element:e.jsx(BS,{})}),e.jsx(Dr,{path:"/services/edit/:id",element:e.jsx(cv,{})}),e.jsx(Dr,{path:"/database",element:e.jsx(ov,{})}),e.jsx(Dr,{path:"/projects/:projectId",element:e.jsx(a0,{})}),e.jsx(Dr,{element:e.jsx(Hh,{roles:["Owner"]}),children:e.jsx(Dr,{path:"/organizations",element:e.jsx(Tb,{})})}),e.jsxs(Dr,{element:e.jsx(Hh,{roles:["Manager","Owner"]}),children:[e.jsx(Dr,{path:"/users",element:e.jsx(Vb,{})}),e.jsx(Dr,{path:"/permissions",element:e.jsx(Kb,{})})]})]})}),e.jsx(Dr,{path:"*",element:e.jsx("main",{role:"main",style:{padding:"50px",textAlign:"center"},children:e.jsx(el,{status:"404",title:"404",subTitle:"ì£„ì†¡í•©ë‹ˆë‹¤. ìš”ì²­í•˜ì‹  í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",extra:e.jsx(B,{type:"primary",onClick:()=>window.history.back(),children:"ì´ì „ í˜ì´ì§€ë¡œ"})})})})]}),e.jsx(lv,{})]})})})}const hv=Dd.createRoot(document.getElementById("root"));hv.render(e.jsx(Ct.StrictMode,{children:e.jsx(bm,{children:e.jsx(uv,{})})}));
